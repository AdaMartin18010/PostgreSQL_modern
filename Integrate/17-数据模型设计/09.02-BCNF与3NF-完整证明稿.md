---

> **ğŸ“‹ æ–‡æ¡£æ¥æº**: `DataBaseTheory\09-æ•°æ®æ¨¡å‹ä¸è§„èŒƒåŒ–\09.02-BCNFä¸3NF-å®Œæ•´è¯æ˜ç¨¿.md`
> **ğŸ“… å¤åˆ¶æ—¥æœŸ**: 2025-12-22
> **âš ï¸ æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºå¤åˆ¶ç‰ˆæœ¬ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜

---

# BCNFä¸3NF-å®Œæ•´è¯æ˜ç¨¿

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: âœ… å†…å®¹å·²å®Œæˆ

---

## ğŸ“‹ ç›®å½•

- [BCNFä¸3NF-å®Œæ•´è¯æ˜ç¨¿](#bcnfä¸3nf-å®Œæ•´è¯æ˜ç¨¿)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 BCNFä¸3NFå·¥ä½œåŸç†æ¦‚è¿°](#10-bcnfä¸3nfå·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 BCNFåˆ†è§£ç®—æ³•](#21-bcnfåˆ†è§£ç®—æ³•)
    - [2.2 3NFåˆ†è§£ç®—æ³•](#22-3nfåˆ†è§£ç®—æ³•)
    - [2.3 ç®—æ³•å¯¹æ¯”](#23-ç®—æ³•å¯¹æ¯”)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 BCNFå½¢å¼åŒ–](#31-bcnfå½¢å¼åŒ–)
    - [3.2 3NFå½¢å¼åŒ–](#32-3nfå½¢å¼åŒ–)
  - [4. å®šç†ä¸è¯æ˜](#4-å®šç†ä¸è¯æ˜)
    - [4.1 BCNFåˆ†è§£æ­£ç¡®æ€§å®šç†](#41-bcnfåˆ†è§£æ­£ç¡®æ€§å®šç†)
    - [4.2 3NFåˆ†è§£ä¿æŒå‡½æ•°ä¾èµ–å®šç†](#42-3nfåˆ†è§£ä¿æŒå‡½æ•°ä¾èµ–å®šç†)
    - [4.3 BCNFå¯èƒ½ä¸¢å¤±å‡½æ•°ä¾èµ–](#43-bcnfå¯èƒ½ä¸¢å¤±å‡½æ•°ä¾èµ–)
  - [5. å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 PostgreSQLä¸­çš„èŒƒå¼è®¾è®¡](#51-postgresqlä¸­çš„èŒƒå¼è®¾è®¡)
    - [5.2 å®é™…åº”ç”¨åœºæ™¯](#52-å®é™…åº”ç”¨åœºæ™¯)
      - [åœºæ™¯1ï¼šBCNF vs 3NFçš„é€‰æ‹©](#åœºæ™¯1bcnf-vs-3nfçš„é€‰æ‹©)
      - [åœºæ™¯2ï¼šèŒƒå¼éªŒè¯å·¥å…·](#åœºæ™¯2èŒƒå¼éªŒè¯å·¥å…·)
  - [6. ç›¸å…³æ–‡æ¡£](#6-ç›¸å…³æ–‡æ¡£)
    - [6.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#61-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [7. å‚è€ƒæ–‡çŒ®](#7-å‚è€ƒæ–‡çŒ®)
    - [7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®](#71-æ ¸å¿ƒç†è®ºæ–‡çŒ®)
    - [7.2 è§„èŒƒåŒ–ç®—æ³•ç›¸å…³](#72-è§„èŒƒåŒ–ç®—æ³•ç›¸å…³)
    - [7.3 ç›¸å…³æ–‡æ¡£](#73-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

### 1.0 BCNFä¸3NFå·¥ä½œåŸç†æ¦‚è¿°

**èŒƒå¼åˆ†è§£**ï¼š

BCNFï¼ˆBoyce-Codd Normal Formï¼‰å’Œ3NFï¼ˆThird Normal Formï¼‰æ˜¯å…³ç³»æ•°æ®åº“è§„èŒƒåŒ–çš„é‡è¦èŒƒå¼ã€‚æœ¬æ–‡æ¡£æä¾›BCNFå’Œ3NFåˆ†è§£ç®—æ³•çš„å®Œæ•´è¯æ˜ã€‚

**èŒƒå¼å±‚æ¬¡æ€ç»´å¯¼å›¾**ï¼š

```mermaid
mindmap
  root((æ•°æ®åº“èŒƒå¼))
    1NF
      åŸå­æ€§
      æ— é‡å¤ç»„
    2NF
      1NFåŸºç¡€
      æ¶ˆé™¤éƒ¨åˆ†ä¾èµ–
    3NF
      2NFåŸºç¡€
      æ¶ˆé™¤ä¼ é€’ä¾èµ–
      ä¿æŒå‡½æ•°ä¾èµ–
    BCNF
      3NFåŸºç¡€
      æ¶ˆé™¤ä¸»å±æ€§ä¾èµ–
      å¯èƒ½ä¸¢å¤±å‡½æ•°ä¾èµ–
```

**èŒƒå¼é€‰æ‹©å†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[å…³ç³»æ¨¡å¼R] --> B{æ˜¯å¦æ»¡è¶³BCNF?}
    B -->|æ˜¯| C[BCNFåˆ†è§£å®Œæˆ]
    B -->|å¦| D{æ˜¯å¦æ»¡è¶³3NF?}
    D -->|æ˜¯| E{éœ€è¦ä¿æŒFD?}
    D -->|å¦| F[è¿›è¡Œ3NFåˆ†è§£]
    E -->|æ˜¯| G[ä¿æŒ3NF]
    E -->|å¦| H[è¿›è¡ŒBCNFåˆ†è§£]
    F --> I[æ£€æŸ¥2NF]
    I --> J[æ£€æŸ¥1NF]
    H --> K[å¯èƒ½ä¸¢å¤±FD]
    G --> L[å®Œæˆ]
    K --> L
    C --> L

    style A fill:#FFD700
    style C fill:#90EE90
    style G fill:#90EE90
    style K fill:#FF6B6B
    style L fill:#87CEEB
```

**BCNF vs 3NF å¯¹æ¯”çŸ©é˜µ**ï¼š

| ç»´åº¦ | BCNF | 3NF |
|------|------|-----|
| **å®šä¹‰** | æ¯ä¸ªå†³å®šå› å­éƒ½æ˜¯å€™é€‰é”® | éä¸»å±æ€§ä¸ä¼ é€’ä¾èµ–äºä¸»é”® |
| **æ¶ˆé™¤å¼‚å¸¸** | å®Œå…¨æ¶ˆé™¤å†—ä½™ | åŸºæœ¬æ¶ˆé™¤å†—ä½™ |
| **å‡½æ•°ä¾èµ–ä¿æŒ** | å¯èƒ½ä¸¢å¤± | ä¿æŒ |
| **åˆ†è§£å”¯ä¸€æ€§** | ä¸å”¯ä¸€ | ä¸å”¯ä¸€ |
| **é€‚ç”¨åœºæ™¯** | å¯¹ä¸€è‡´æ€§è¦æ±‚æé«˜ | éœ€è¦ä¿æŒå‡½æ•°ä¾èµ– |
| **å¤æ‚åº¦** | O(nÂ²) | O(nÂ²) |

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **BCNFåˆ†è§£ç®—æ³•**ï¼šBCNFåˆ†è§£çš„å®Œæ•´ç®—æ³•å’Œè¯æ˜
- **3NFåˆ†è§£ç®—æ³•**ï¼š3NFåˆ†è§£çš„å®Œæ•´ç®—æ³•å’Œè¯æ˜
- **ç®—æ³•æ­£ç¡®æ€§**ï¼šåˆ†è§£ç®—æ³•çš„æ­£ç¡®æ€§è¯æ˜
- **å®é™…åº”ç”¨**ï¼šèŒƒå¼åˆ†è§£åœ¨æ•°æ®åº“è®¾è®¡ä¸­çš„åº”ç”¨

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 BCNFåˆ†è§£ç®—æ³•

**BCNFåˆ†è§£ç®—æ³•æµç¨‹**ï¼š

```haskell
-- BCNFåˆ†è§£ç®—æ³•
bcnfDecompose :: Relation -> FunctionalDependencies -> [Relation]
bcnfDecompose R FDs =
    if isBCNF R FDs then [R]
    else
        let (X -> Y) = findViolatingFD R FDs
            R1 = closure(X, FDs)
            R2 = (attributes R) - (Y - X)
        in bcnfDecompose R1 FDs ++ bcnfDecompose R2 FDs
```

**BCNFåˆ†è§£è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[R, FDs] --> B{æ˜¯å¦BCNF?}
    B -->|æ˜¯| C[è¿”å›R]
    B -->|å¦| D[æ‰¾åˆ°è¿åFD: Xâ†’Y]
    D --> E[R1 = X+]
    D --> F[R2 = R - Y - X]
    E --> G{é€’å½’åˆ†è§£R1}
    F --> H{é€’å½’åˆ†è§£R2}
    G --> I[BCNFå­å…³ç³»]
    H --> J[BCNFå­å…³ç³»]
    I --> K[åˆå¹¶ç»“æœ]
    J --> K
    K --> L[æœ€ç»ˆåˆ†è§£]

    style A fill:#FFD700
    style C fill:#90EE90
    style L fill:#87CEEB
    style D fill:#FF6B6B
```

### 2.2 3NFåˆ†è§£ç®—æ³•

**3NFåˆ†è§£ç®—æ³•æµç¨‹**ï¼š

```haskell
-- 3NFåˆ†è§£ç®—æ³•ï¼ˆä¿æŒå‡½æ•°ä¾èµ–ï¼‰
threeNFDecompose :: Relation -> FunctionalDependencies -> [Relation]
threeNFDecompose R FDs =
    let canonicalFDs = canonicalCover FDs
        decomposed = [attributes(fd) | fd <- canonicalFDs]
        key = candidateKey R FDs
        result = if key `subset` (union decomposed)
                 then decomposed
                 else decomposed ++ [key]
    in result
```

**3NFåˆ†è§£å†³ç­–æµç¨‹**ï¼š

```mermaid
flowchart TD
    A[å…³ç³»R, FDs] --> B[è®¡ç®—è§„èŒƒè¦†ç›–]
    B --> C[ä¸ºæ¯ä¸ªFDåˆ›å»ºå…³ç³»]
    C --> D{å€™é€‰é”®æ˜¯å¦åŒ…å«åœ¨åˆ†è§£ä¸­?}
    D -->|æ˜¯| E[è¿”å›åˆ†è§£]
    D -->|å¦| F[æ·»åŠ å€™é€‰é”®å…³ç³»]
    F --> E
    E --> G[éªŒè¯3NF]
    G --> H{æ»¡è¶³3NF?}
    H -->|æ˜¯| I[å®Œæˆ]
    H -->|å¦| J[è°ƒæ•´åˆ†è§£]
    J --> G

    style A fill:#FFD700
    style I fill:#90EE90
    style J fill:#FF6B6B
```

### 2.3 ç®—æ³•å¯¹æ¯”

**BCNF vs 3NF ç®—æ³•å¯¹æ¯”çŸ©é˜µ**ï¼š

| ç‰¹æ€§ | BCNFç®—æ³• | 3NFç®—æ³• |
|------|----------|---------|
| **è¾“å…¥** | å…³ç³»R, FDs | å…³ç³»R, FDs |
| **è¾“å‡º** | BCNFåˆ†è§£ | 3NFåˆ†è§£ï¼ˆä¿æŒFDï¼‰ |
| **æ—¶é—´å¤æ‚åº¦** | O(nÂ²) | O(nÂ²) |
| **ç©ºé—´å¤æ‚åº¦** | O(n) | O(n) |
| **å‡½æ•°ä¾èµ–ä¿æŒ** | ä¸ä¿è¯ | ä¿è¯ |
| **åˆ†è§£å”¯ä¸€æ€§** | ä¸å”¯ä¸€ | ä¸å”¯ä¸€ |
| **é€‚ç”¨åœºæ™¯** | é«˜ä¸€è‡´æ€§è¦æ±‚ | éœ€è¦ä¿æŒFD |

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 BCNFå½¢å¼åŒ–

**BCNFå®šä¹‰**ï¼š

```haskell
-- BCNFæ¡ä»¶
isBCNF :: Relation -> FunctionalDependencies -> Bool
isBCNF R FDs =
    forall (X -> Y) in FDs:
      (X -> Y is trivial) or (X is superkey of R)
```

**BCNFå½¢å¼åŒ–**ï¼š

å…³ç³»Ræ»¡è¶³BCNFï¼Œå½“ä¸”ä»…å½“å¯¹äºæ¯ä¸ªéå¹³å‡¡å‡½æ•°ä¾èµ–Xâ†’Yï¼ŒXéƒ½æ˜¯Rçš„è¶…é”®ã€‚

### 3.2 3NFå½¢å¼åŒ–

**3NFå®šä¹‰**ï¼š

```haskell
-- 3NFæ¡ä»¶
is3NF :: Relation -> FunctionalDependencies -> Bool
is3NF R FDs =
    forall (X -> A) in FDs:
      (X -> A is trivial) or
      (X is superkey) or
      (A is prime attribute)
```

**3NFå½¢å¼åŒ–**ï¼š

å…³ç³»Ræ»¡è¶³3NFï¼Œå½“ä¸”ä»…å½“å¯¹äºæ¯ä¸ªéå¹³å‡¡å‡½æ•°ä¾èµ–Xâ†’Aï¼š

- Xæ˜¯è¶…é”®ï¼Œæˆ–
- Aæ˜¯ä¸»å±æ€§

---

## 4. å®šç†ä¸è¯æ˜

### 4.1 BCNFåˆ†è§£æ­£ç¡®æ€§å®šç†

**å®šç†1ï¼ˆBCNFåˆ†è§£æ­£ç¡®æ€§ï¼‰**ï¼š

BCNFåˆ†è§£ç®—æ³•äº§ç”Ÿçš„åˆ†è§£æ˜¯æ— æŸè¿æ¥åˆ†è§£ï¼Œå³åŸå§‹å…³ç³»Rå¯ä»¥é€šè¿‡åˆ†è§£åçš„å…³ç³»Râ‚, Râ‚‚, ..., Râ‚™çš„è‡ªç„¶è¿æ¥æ¢å¤ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾å…³ç³»Rå’Œå‡½æ•°ä¾èµ–é›†åˆFï¼ŒBCNFåˆ†è§£ç®—æ³•äº§ç”Ÿçš„åˆ†è§£ä¸º{Râ‚, Râ‚‚, ..., Râ‚™}ã€‚åˆ™R = Râ‚ â‹ˆ Râ‚‚ â‹ˆ ... â‹ˆ Râ‚™ï¼ˆæ— æŸè¿æ¥ï¼‰ã€‚

**è¯æ˜**ï¼š

**æ­¥éª¤1ï¼šå•æ¬¡åˆ†è§£çš„æ— æŸæ€§ï¼ˆå¼•ç†1ï¼‰**ï¼š

- è®¾å…³ç³»Rè¿åBCNFï¼Œå­˜åœ¨éå¹³å‡¡å‡½æ•°ä¾èµ–X â†’ Yï¼Œå…¶ä¸­Xä¸æ˜¯è¶…é”®
- BCNFåˆ†è§£ï¼šRâ‚ = Xâºï¼ˆXçš„é—­åŒ…ï¼‰ï¼ŒRâ‚‚ = R - (Y - X)
- éœ€è¦è¯æ˜ï¼šR = Râ‚ â‹ˆ Râ‚‚
- **åŒ…å«å…³ç³»ï¼ˆR âŠ† Râ‚ â‹ˆ Râ‚‚ï¼‰**ï¼š
  - å¯¹äºä»»æ„å…ƒç»„t âˆˆ Rï¼š
    - è®¾tâ‚ = t[Xâº]ï¼ˆtåœ¨Râ‚ä¸Šçš„æŠ•å½±ï¼‰
    - è®¾tâ‚‚ = t[R - (Y - X)]ï¼ˆtåœ¨Râ‚‚ä¸Šçš„æŠ•å½±ï¼‰
    - ç”±äºtâ‚[X] = tâ‚‚[X]ï¼ˆéƒ½æ˜¯t[X]ï¼‰ï¼Œä¸”X âŠ† Xâº âˆ© (R - (Y - X))
    - å› æ­¤tâ‚å’Œtâ‚‚å¯ä»¥è¿æ¥ï¼Œt âˆˆ Râ‚ â‹ˆ Râ‚‚
  - å› æ­¤R âŠ† Râ‚ â‹ˆ Râ‚‚
- **åŒ…å«å…³ç³»ï¼ˆRâ‚ â‹ˆ Râ‚‚ âŠ† Rï¼‰**ï¼š
  - å¯¹äºä»»æ„å…ƒç»„t âˆˆ Râ‚ â‹ˆ Râ‚‚ï¼š
    - å­˜åœ¨tâ‚ âˆˆ Râ‚å’Œtâ‚‚ âˆˆ Râ‚‚ï¼Œä½¿å¾—tâ‚[X] = tâ‚‚[X]
    - ç”±äºRâ‚ = Xâºï¼Œtâ‚[Xâº]åœ¨Rä¸­å­˜åœ¨
    - ç”±äºX â†’ Yï¼Œä¸”tâ‚[X] = tâ‚‚[X]ï¼Œæœ‰tâ‚[Y] = tâ‚‚[Y]
    - å› æ­¤tâ‚å’Œtâ‚‚å¯ä»¥åˆå¹¶ä¸ºRä¸­çš„å…ƒç»„t
    - å› æ­¤t âˆˆ R
  - å› æ­¤Râ‚ â‹ˆ Râ‚‚ âŠ† R
- å› æ­¤R = Râ‚ â‹ˆ Râ‚‚ï¼Œå•æ¬¡åˆ†è§£æ˜¯æ— æŸçš„

**æ­¥éª¤2ï¼šé€’å½’åˆ†è§£çš„ç»ˆæ­¢æ€§ï¼ˆå¼•ç†2ï¼‰**ï¼š

- æ¯æ¬¡åˆ†è§£åï¼ŒRâ‚å’ŒRâ‚‚çš„å±æ€§é›†éƒ½æ˜¯Rçš„çœŸå­é›†
- ç”±äºå±æ€§é›†æœ‰é™ï¼Œé€’å½’åˆ†è§£å¿…ç„¶åœ¨æœ‰é™æ­¥å†…ç»ˆæ­¢
- å¼•ç†2å¾—è¯

**æ­¥éª¤3ï¼šæœ€ç»ˆç»“æœæ»¡è¶³BCNFï¼ˆå¼•ç†3ï¼‰**ï¼š

- ç®—æ³•ç»ˆæ­¢æ—¶ï¼Œæ‰€æœ‰å­å…³ç³»éƒ½æ»¡è¶³BCNFæ¡ä»¶
- å³å¯¹äºæ¯ä¸ªå­å…³ç³»Ráµ¢ï¼Œæ‰€æœ‰éå¹³å‡¡å‡½æ•°ä¾èµ–X â†’ Yï¼ŒXéƒ½æ˜¯Ráµ¢çš„è¶…é”®
- å¼•ç†3å¾—è¯

**æ­¥éª¤4ï¼šé€’å½’åˆ†è§£çš„æ— æŸæ€§**ï¼š

- è®¾é€’å½’åˆ†è§£ä¸ºï¼šR â†’ Râ‚, Râ‚‚ â†’ Râ‚â‚, Râ‚â‚‚, Râ‚‚â‚, Râ‚‚â‚‚ â†’ ...
- ç”±äºå•æ¬¡åˆ†è§£æ˜¯æ— æŸçš„ï¼šR = Râ‚ â‹ˆ Râ‚‚
- ç”±äºé€’å½’åˆ†è§£ï¼šRâ‚ = Râ‚â‚ â‹ˆ Râ‚â‚‚, Râ‚‚ = Râ‚‚â‚ â‹ˆ Râ‚‚â‚‚
- å› æ­¤R = (Râ‚â‚ â‹ˆ Râ‚â‚‚) â‹ˆ (Râ‚‚â‚ â‹ˆ Râ‚‚â‚‚) = Râ‚â‚ â‹ˆ Râ‚â‚‚ â‹ˆ Râ‚‚â‚ â‹ˆ Râ‚‚â‚‚
- é€’å½’åº”ç”¨ï¼Œæœ€ç»ˆR = Râ‚ â‹ˆ Râ‚‚ â‹ˆ ... â‹ˆ Râ‚™

**æ­¥éª¤5ï¼šç»“è®º**ï¼š

- BCNFåˆ†è§£ç®—æ³•äº§ç”Ÿçš„åˆ†è§£æ˜¯æ— æŸè¿æ¥åˆ†è§£
- å®šç†å¾—è¯

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[BCNFåˆ†è§£æ­£ç¡®æ€§å®šç†] --> B[å¼•ç†1: å•æ¬¡åˆ†è§£æ— æŸæ€§]
    A --> C[å¼•ç†2: é€’å½’ç»ˆæ­¢æ€§]
    A --> D[å¼•ç†3: æœ€ç»ˆç»“æœBCNF]
    B --> E[R = R1 â‹ˆ R2]
    C --> F[å±æ€§é›†é€’å‡]
    D --> G[æ‰€æœ‰å­å…³ç³»BCNF]
    E --> H[é€’å½’åˆ†è§£æ— æŸæ€§]
    F --> H
    G --> H
    H --> I[å®šç†å¾—è¯]

    style A fill:#FFD700
    style I fill:#90EE90
```

### 4.2 3NFåˆ†è§£ä¿æŒå‡½æ•°ä¾èµ–å®šç†

**å®šç†2ï¼ˆ3NFåˆ†è§£ä¿æŒå‡½æ•°ä¾èµ–ï¼‰**ï¼š

3NFåˆ†è§£ç®—æ³•äº§ç”Ÿçš„åˆ†è§£ä¿æŒå‡½æ•°ä¾èµ–ï¼Œå³åŸå§‹å‡½æ•°ä¾èµ–é›†åˆFä¸­çš„æ‰€æœ‰å‡½æ•°ä¾èµ–éƒ½åœ¨åˆ†è§£åçš„å…³ç³»ä¸­ä¿æŒã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾å…³ç³»Rå’Œå‡½æ•°ä¾èµ–é›†åˆFï¼Œ3NFåˆ†è§£ç®—æ³•äº§ç”Ÿçš„åˆ†è§£ä¸º{Râ‚, Râ‚‚, ..., Râ‚™}ã€‚åˆ™å¯¹äºä»»æ„å‡½æ•°ä¾èµ–X â†’ Y âˆˆ Fâºï¼Œå­˜åœ¨Ráµ¢ä½¿å¾—X â†’ Yåœ¨Ráµ¢ä¸­ä¿æŒã€‚

**è¯æ˜**ï¼š

**æ­¥éª¤1ï¼šè§„èŒƒè¦†ç›–çš„æ€§è´¨**ï¼š

- 3NFåˆ†è§£ç®—æ³•é¦–å…ˆè®¡ç®—Fçš„è§„èŒƒè¦†ç›–F_c
- è§„èŒƒè¦†ç›–F_cæ»¡è¶³ï¼š
  - F_câº = Fâºï¼ˆé—­åŒ…ç­‰ä»·ï¼‰
  - F_cä¸­æ¯ä¸ªå‡½æ•°ä¾èµ–çš„å³éƒ¨æ˜¯å•å±æ€§
  - F_cä¸­æ¯ä¸ªå‡½æ•°ä¾èµ–çš„å·¦éƒ¨æ˜¯æå°çš„

**æ­¥éª¤2ï¼šå…³ç³»æ„é€ ä¿æŒFD**ï¼š

- å¯¹äºè§„èŒƒè¦†ç›–F_cä¸­çš„æ¯ä¸ªå‡½æ•°ä¾èµ–X â†’ Aï¼Œç®—æ³•åˆ›å»ºå…³ç³»Ráµ¢ = X âˆª {A}
- ç”±äºRáµ¢åŒ…å«Xå’ŒAï¼Œå‡½æ•°ä¾èµ–X â†’ Aåœ¨Ráµ¢ä¸­ä¿æŒ
- å› æ­¤F_cä¸­çš„æ‰€æœ‰å‡½æ•°ä¾èµ–éƒ½åœ¨åˆ†è§£åçš„å…³ç³»ä¸­ä¿æŒ

**æ­¥éª¤3ï¼šå€™é€‰é”®å¤„ç†**ï¼š

- å¦‚æœå€™é€‰é”®Kä¸åœ¨ä»»ä½•Ráµ¢ä¸­ï¼Œç®—æ³•æ·»åŠ å…³ç³»R_key = K
- ç”±äºKæ˜¯å€™é€‰é”®ï¼ŒK â†’ attributes(R)åœ¨Rä¸­æˆç«‹
- åœ¨R_keyä¸­ï¼ŒK â†’ Kæˆç«‹ï¼ˆè‡ªåå¾‹ï¼‰
- å› æ­¤å€™é€‰é”®ç›¸å…³çš„å‡½æ•°ä¾èµ–è¢«ä¿æŒ

**æ­¥éª¤4ï¼šFâºä¸­çš„å‡½æ•°ä¾èµ–ä¿æŒ**ï¼š

- å¯¹äºä»»æ„å‡½æ•°ä¾èµ–X â†’ Y âˆˆ Fâºï¼š
  - ç”±äºF_câº = Fâºï¼Œå­˜åœ¨å‡½æ•°ä¾èµ–åºåˆ—X â†’ Aâ‚, Aâ‚ â†’ Aâ‚‚, ..., Aâ‚™ â†’ Yåœ¨F_cä¸­
  - æ¯ä¸ªAáµ¢ â†’ Aáµ¢â‚Šâ‚éƒ½åœ¨æŸä¸ªRáµ¢ä¸­ä¿æŒ
  - é€šè¿‡ä¼ é€’å¾‹ï¼ŒX â†’ Yåœ¨åˆ†è§£åçš„å…³ç³»ä¸­ä¿æŒ

**æ­¥éª¤5ï¼šç»“è®º**ï¼š

- 3NFåˆ†è§£ç®—æ³•äº§ç”Ÿçš„åˆ†è§£ä¿æŒå‡½æ•°ä¾èµ–
- å®šç†å¾—è¯

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[3NFåˆ†è§£ä¿æŒFDå®šç†] --> B[è§„èŒƒè¦†ç›–æ€§è´¨]
    A --> C[å…³ç³»æ„é€ ä¿æŒFD]
    A --> D[å€™é€‰é”®å¤„ç†]
    B --> E[F_câº = Fâº]
    C --> F[æ¯ä¸ªFDå¯¹åº”ä¸€ä¸ªå…³ç³»]
    D --> G[å€™é€‰é”®å…³ç³»]
    E --> H[æ‰€æœ‰FDè¢«ä¿æŒ]
    F --> H
    G --> H
    H --> I[å®šç†å¾—è¯]

    style A fill:#FFD700
    style I fill:#90EE90
```

### 4.3 BCNFå¯èƒ½ä¸¢å¤±å‡½æ•°ä¾èµ–

**å®šç†**ï¼šBCNFåˆ†è§£å¯èƒ½ä¸¢å¤±å‡½æ•°ä¾èµ–ã€‚

**åä¾‹**ï¼š

```text
å…³ç³»R(ABCD), FDs = {ABâ†’C, Câ†’D, Dâ†’A}

å€™é€‰é”®: AB, BC, BD
è¿åBCNF: Câ†’D (Cä¸æ˜¯è¶…é”®)

BCNFåˆ†è§£:
R1(CD), FDs = {Câ†’D}
R2(ABC), FDs = {ABâ†’C}

ä¸¢å¤±FD: Dâ†’A (æ— æ³•åœ¨R1æˆ–R2ä¸­è¡¨ç¤º)
```

---

## 5. å®é™…åº”ç”¨

### 5.1 PostgreSQLä¸­çš„èŒƒå¼è®¾è®¡

**è®¾è®¡å†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[æ•°æ®åº“è®¾è®¡] --> B{éœ€è¦é«˜ä¸€è‡´æ€§?}
    B -->|æ˜¯| C{å¯ä»¥ä¸¢å¤±FD?}
    B -->|å¦| D[ä½¿ç”¨3NF]
    C -->|æ˜¯| E[ä½¿ç”¨BCNF]
    C -->|å¦| F[ä½¿ç”¨3NF]
    E --> G[åˆ›å»ºè¡¨ç»“æ„]
    F --> G
    D --> G
    G --> H[æ·»åŠ çº¦æŸ]
    H --> I[éªŒè¯èŒƒå¼]

    style A fill:#FFD700
    style E fill:#90EE90
    style F fill:#90EE90
    style I fill:#87CEEB
```

**BCNFè®¾è®¡ç¤ºä¾‹**ï¼š

```sql
-- åŸå§‹å…³ç³»ï¼ˆè¿åBCNFï¼‰
CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    customer_id INT,
    customer_name VARCHAR(100),
    product_id INT,
    product_name VARCHAR(100),
    quantity INT
);
-- é—®é¢˜: customer_id â†’ customer_name (customer_idä¸æ˜¯è¶…é”®)

-- BCNFåˆ†è§£
CREATE TABLE customers (
    customer_id INT PRIMARY KEY,
    customer_name VARCHAR(100)
);

CREATE TABLE products (
    product_id INT PRIMARY KEY,
    product_name VARCHAR(100)
);

CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    customer_id INT REFERENCES customers(customer_id),
    product_id INT REFERENCES products(product_id),
    quantity INT
);
```

**3NFè®¾è®¡ç¤ºä¾‹**ï¼š

```sql
-- éœ€è¦ä¿æŒå‡½æ•°ä¾èµ–çš„æƒ…å†µ
-- åŸå§‹å…³ç³»
CREATE TABLE employees (
    emp_id SERIAL PRIMARY KEY,
    dept_id INT,
    dept_name VARCHAR(100),
    manager_id INT,
    manager_name VARCHAR(100)
);
-- FDs: dept_id â†’ dept_name, manager_id â†’ manager_name

-- 3NFåˆ†è§£ï¼ˆä¿æŒFDï¼‰
CREATE TABLE departments (
    dept_id INT PRIMARY KEY,
    dept_name VARCHAR(100)
);

CREATE TABLE managers (
    manager_id INT PRIMARY KEY,
    manager_name VARCHAR(100)
);

CREATE TABLE employees (
    emp_id SERIAL PRIMARY KEY,
    dept_id INT REFERENCES departments(dept_id),
    manager_id INT REFERENCES managers(manager_id)
);
```

### 5.2 å®é™…åº”ç”¨åœºæ™¯

#### åœºæ™¯1ï¼šBCNF vs 3NFçš„é€‰æ‹©

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

ç³»ç»Ÿè®¾è®¡éœ€è¦é€‰æ‹©BCNFè¿˜æ˜¯3NFï¼Œéœ€è¦æƒè¡¡æ•°æ®ä¸€è‡´æ€§å’Œå‡½æ•°ä¾èµ–ä¿æŒã€‚

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åœºæ™¯ï¼šBCNF vs 3NFé€‰æ‹©
-- æƒ…å†µ1ï¼šå¯ä»¥é€‰æ‹©BCNFï¼ˆå¯ä»¥æ¥å—ä¸¢å¤±FDï¼‰
-- åŸå§‹å…³ç³»
CREATE TABLE student_courses (
    student_id BIGINT,
    course_id INT,
    instructor_id INT,
    instructor_name VARCHAR(100),
    grade CHAR(1),
    PRIMARY KEY (student_id, course_id)
);
-- FDs: {student_id, course_id} â†’ grade, instructor_id â†’ instructor_name
-- è¿åBCNF: instructor_id â†’ instructor_name (instructor_idä¸æ˜¯è¶…é”®)

-- BCNFåˆ†è§£ï¼ˆå¯èƒ½ä¸¢å¤±FDï¼‰
CREATE TABLE instructors (
    instructor_id SERIAL PRIMARY KEY,
    instructor_name VARCHAR(100) NOT NULL
);

CREATE TABLE student_courses (
    student_id BIGINT NOT NULL,
    course_id INT NOT NULL,
    instructor_id INT REFERENCES instructors(instructor_id),
    grade CHAR(1),
    PRIMARY KEY (student_id, course_id)
);
-- ä¸¢å¤±FD: å¦‚æœinstructor_id â†’ course_idï¼Œè¿™ä¸ªFDå¯èƒ½ä¸¢å¤±

-- æƒ…å†µ2ï¼šå¿…é¡»é€‰æ‹©3NFï¼ˆéœ€è¦ä¿æŒFDï¼‰
-- åŸå§‹å…³ç³»
CREATE TABLE employees (
    emp_id SERIAL PRIMARY KEY,
    dept_id INT,
    dept_name VARCHAR(100),
    manager_id INT,
    manager_name VARCHAR(100)
);
-- FDs: dept_id â†’ dept_name, manager_id â†’ manager_name, emp_id â†’ dept_id, emp_id â†’ manager_id

-- 3NFåˆ†è§£ï¼ˆä¿æŒFDï¼‰
CREATE TABLE departments (
    dept_id SERIAL PRIMARY KEY,
    dept_name VARCHAR(100) NOT NULL UNIQUE
);

CREATE TABLE managers (
    manager_id SERIAL PRIMARY KEY,
    manager_name VARCHAR(100) NOT NULL
);

CREATE TABLE employees (
    emp_id SERIAL PRIMARY KEY,
    dept_id INT NOT NULL REFERENCES departments(dept_id),
    manager_id INT NOT NULL REFERENCES managers(manager_id)
);
-- æ‰€æœ‰FDéƒ½è¢«ä¿æŒ
```

#### åœºæ™¯2ï¼šèŒƒå¼éªŒè¯å·¥å…·

**PostgreSQL 18å®ç°**ï¼š

```sql
-- èŒƒå¼éªŒè¯å‡½æ•°
CREATE OR REPLACE FUNCTION verify_bcnf(
    p_table_name TEXT,
    p_functional_dependencies JSONB
)
RETURNS TABLE (
    is_bcnf BOOLEAN,
    violations JSONB
) AS $$
DECLARE
    v_fd JSONB;
    v_violations JSONB := '[]'::JSONB;
    v_is_bcnf BOOLEAN := TRUE;
BEGIN
    -- æ£€æŸ¥æ¯ä¸ªå‡½æ•°ä¾èµ–
    FOR v_fd IN SELECT * FROM jsonb_array_elements(p_functional_dependencies)
    LOOP
        DECLARE
            v_determinant TEXT[] := ARRAY(SELECT jsonb_array_elements_text(v_fd->'determinant'));
            v_dependent TEXT[] := ARRAY(SELECT jsonb_array_elements_text(v_fd->'dependent'));
            v_is_superkey BOOLEAN;
        BEGIN
            -- æ£€æŸ¥determinantæ˜¯å¦æ˜¯è¶…é”®
            SELECT is_superkey(p_table_name, v_determinant) INTO v_is_superkey;

            IF NOT v_is_superkey THEN
                v_is_bcnf := FALSE;
                v_violations := v_violations || jsonb_build_object(
                    'determinant', v_determinant,
                    'dependent', v_dependent,
                    'reason', 'Determinant is not a superkey'
                );
            END IF;
        END;
    END LOOP;

    RETURN QUERY SELECT v_is_bcnf, v_violations;
END;
$$ LANGUAGE plpgsql;
```

---

## 6. ç›¸å…³æ–‡æ¡£

### 6.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–-å‡½æ•°ä¾èµ–ä¸èŒƒå¼è¯æ˜](./09.01-å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–-å‡½æ•°ä¾èµ–ä¸èŒƒå¼è¯æ˜.md)
- [å½¢å¼è¯­è¨€ä¸è¯æ˜ï¼šæ€»è®º](../../25-ç†è®ºä½“ç³»/25.01-å½¢å¼åŒ–æ–¹æ³•/01.05-å½¢å¼è¯­è¨€ä¸è¯æ˜-æ€»è®º.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)

---

## 7. å‚è€ƒæ–‡çŒ®

### 7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®

- **Codd, E. F. (1970). "A Relational Model of Data for Large Shared Data Banks."**
  - ä¼šè®®: Communications of the ACM 1970
  - **é‡è¦æ€§**: å…³ç³»æ¨¡å‹çš„å¥ åŸºæ€§è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†å…³ç³»æ¨¡å‹å’Œè§„èŒƒåŒ–ç†è®º

- **Boyce, R. F., & Codd, E. F. (1974). "Further Normalization of the Data Base Relational Model."**
  - ä¼šè®®: IFIP Working Conference 1974
  - **é‡è¦æ€§**: BCNFçš„æå‡º
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†BCNFèŒƒå¼

### 7.2 è§„èŒƒåŒ–ç®—æ³•ç›¸å…³

- **Bernstein, P. A. (1976). "Synthesizing Third Normal Form Relations from Functional Dependencies."**
  - ä¼šè®®: ACM TODS 1976
  - **é‡è¦æ€§**: 3NFåˆæˆç®—æ³•çš„ç»å…¸è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†ä¿æŒå‡½æ•°ä¾èµ–çš„3NFåˆ†è§£ç®—æ³•

### 7.3 ç›¸å…³æ–‡æ¡£

- [å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–-å‡½æ•°ä¾èµ–ä¸èŒƒå¼è¯æ˜](./09.01-å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–-å‡½æ•°ä¾èµ–ä¸èŒƒå¼è¯æ˜.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: âœ… å†…å®¹å·²å®Œæˆ
