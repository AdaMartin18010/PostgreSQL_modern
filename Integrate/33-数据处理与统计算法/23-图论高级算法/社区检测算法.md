# PostgreSQL ç¤¾åŒºæ£€æµ‹ç®—æ³•å®Œæ•´æŒ‡å—

> **åˆ›å»ºæ—¥æœŸ**: 2025å¹´1æœˆ
> **æŠ€æœ¯æ ˆ**: PostgreSQL 17+/18+ | å›¾ç®—æ³• | ç¤¾åŒºæ£€æµ‹ | æ¨¡å—åº¦ä¼˜åŒ–
> **éš¾åº¦çº§åˆ«**: â­â­â­â­â­ (ä¸“å®¶çº§)
> **å‚è€ƒæ ‡å‡†**: Community Detection, Modularity Optimization, Network Analysis

---

## ğŸ“‹ ç›®å½•

- [PostgreSQL ç¤¾åŒºæ£€æµ‹ç®—æ³•å®Œæ•´æŒ‡å—](#postgresql-ç¤¾åŒºæ£€æµ‹ç®—æ³•å®Œæ•´æŒ‡å—)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [ç¤¾åŒºæ£€æµ‹æ¦‚è¿°](#ç¤¾åŒºæ£€æµ‹æ¦‚è¿°)
  - [1. æ¨¡å—åº¦ä¼˜åŒ–](#1-æ¨¡å—åº¦ä¼˜åŒ–)

---

## ç¤¾åŒºæ£€æµ‹æ¦‚è¿°

**ç¤¾åŒºæ£€æµ‹**è¯†åˆ«ç½‘ç»œä¸­ç´§å¯†è¿æ¥çš„èŠ‚ç‚¹ç¾¤ç»„ã€‚

---

## 1. æ¨¡å—åº¦ä¼˜åŒ–

**æ¨¡å—åº¦**:
$$Q = \frac{1}{2m}\sum_{ij}\left(A_{ij} - \frac{k_i k_j}{2m}\right)\delta(c_i, c_j)$$

```sql
-- ç¤¾åŒºæ£€æµ‹æ•°æ®å‡†å¤‡
DO $$
BEGIN
    BEGIN
        IF EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'community_graph') THEN
            DROP TABLE community_graph CASCADE;
        END IF;

        CREATE TABLE community_graph (
            from_node INTEGER NOT NULL,
            to_node INTEGER NOT NULL,
            weight NUMERIC DEFAULT 1,
            PRIMARY KEY (from_node, to_node)
        );

        INSERT INTO community_graph (from_node, to_node) VALUES
            (1, 2), (1, 3), (2, 3),
            (4, 5), (4, 6), (5, 6);

        RAISE NOTICE 'è¡¨ community_graph åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE EXCEPTION 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
    END;
END $$;

-- æ¨¡å—åº¦è®¡ç®—
WITH node_degrees AS (
    SELECT
        from_node AS node,
        COUNT(*) AS degree
    FROM community_graph
    GROUP BY from_node
),
total_edges AS (
    SELECT COUNT(*) AS m FROM community_graph
),
modularity_calculation AS (
    SELECT
        cg.from_node,
        cg.to_node,
        nd1.degree AS k_i,
        nd2.degree AS k_j,
        (SELECT m FROM total_edges) AS total_m
    FROM community_graph cg
    JOIN node_degrees nd1 ON cg.from_node = nd1.node
    JOIN node_degrees nd2 ON cg.to_node = nd2.node
)
SELECT
    SUM((1.0 - k_i * k_j / (2.0 * total_m)) / (2.0 * total_m)) AS modularity
FROM modularity_calculation;
```

---

**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**æ–‡æ¡£çŠ¶æ€**: âœ… å·²å®Œæˆ
