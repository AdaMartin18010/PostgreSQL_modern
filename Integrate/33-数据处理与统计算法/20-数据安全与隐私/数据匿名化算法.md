# PostgreSQL æ•°æ®åŒ¿ååŒ–ç®—æ³•å®Œæ•´æŒ‡å—

> **åˆ›å»ºæ—¥æœŸ**: 2025å¹´1æœˆ
> **æŠ€æœ¯æ ˆ**: PostgreSQL 17+/18+ | æ•°æ®éšç§ | åŒ¿ååŒ– | k-åŒ¿å
> **éš¾åº¦çº§åˆ«**: â­â­â­â­â­ (ä¸“å®¶çº§)
> **å‚è€ƒæ ‡å‡†**: Privacy-Preserving Data Publishing, k-Anonymity, Data Privacy

---

## ğŸ“‹ ç›®å½•

- [PostgreSQL æ•°æ®åŒ¿ååŒ–ç®—æ³•å®Œæ•´æŒ‡å—](#postgresql-æ•°æ®åŒ¿ååŒ–ç®—æ³•å®Œæ•´æŒ‡å—)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [æ•°æ®åŒ¿ååŒ–æ¦‚è¿°](#æ•°æ®åŒ¿ååŒ–æ¦‚è¿°)
  - [1. k-åŒ¿å](#1-k-åŒ¿å)

---

## æ•°æ®åŒ¿ååŒ–æ¦‚è¿°

**æ•°æ®åŒ¿ååŒ–**é€šè¿‡æ³›åŒ–ã€æŠ‘åˆ¶ç­‰æŠ€æœ¯ä¿æŠ¤ä¸ªäººéšç§ã€‚

---

## 1. k-åŒ¿å

**k-åŒ¿å**ç¡®ä¿æ¯æ¡è®°å½•è‡³å°‘ä¸k-1æ¡å…¶ä»–è®°å½•æ— æ³•åŒºåˆ†ã€‚

```sql
-- k-åŒ¿åå®ç°ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'sensitive_person_data') THEN
            RAISE WARNING 'è¡¨ sensitive_person_data å·²å­˜åœ¨ï¼Œå…ˆåˆ é™¤';
            DROP TABLE sensitive_person_data CASCADE;
        END IF;

        CREATE TABLE sensitive_person_data (
            id SERIAL PRIMARY KEY,
            age INTEGER NOT NULL,
            zipcode VARCHAR(10) NOT NULL,
            disease VARCHAR(50) NOT NULL
        );

        INSERT INTO sensitive_person_data (age, zipcode, disease) VALUES
            (25, '12345', 'Flu'),
            (26, '12345', 'Cold'),
            (27, '12345', 'Flu'),
            (45, '67890', 'Diabetes'),
            (46, '67890', 'Diabetes');

        RAISE NOTICE 'è¡¨ sensitive_person_data åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE EXCEPTION 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
    END;
END $$;

-- k-åŒ¿åæ£€æŸ¥ï¼ˆk=2ï¼‰
WITH equivalence_classes AS (
    SELECT
        CASE
            WHEN age < 30 THEN '20-29'
            WHEN age < 40 THEN '30-39'
            ELSE '40+'
        END AS generalized_age,
        LEFT(zipcode, 3) || '**' AS generalized_zipcode,
        COUNT(*) AS class_size
    FROM sensitive_person_data
    GROUP BY generalized_age, generalized_zipcode
)
SELECT
    generalized_age,
    generalized_zipcode,
    class_size,
    CASE
        WHEN class_size >= 2 THEN 'k-anonymous (k=2)'
        ELSE 'Not k-anonymous'
    END AS anonymity_status
FROM equivalence_classes;
```

---

**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**æ–‡æ¡£çŠ¶æ€**: âœ… å·²å®Œæˆ
