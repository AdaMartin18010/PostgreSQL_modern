# æ¼æ´ç®¡ç†

> **åˆ›å»ºæ—¥æœŸ**: 2025å¹´1æœˆ
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 17+/18+
> **éš¾åº¦ç­‰çº§**: â­â­â­ ä¸­çº§

---

## ğŸ“‹ ç›®å½•

- [æ¼æ´ç®¡ç†](#æ¼æ´ç®¡ç†)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
  - [2. æ¼æ´å‘ç°](#2-æ¼æ´å‘ç°)
    - [2.1 ç‰ˆæœ¬æ£€æŸ¥](#21-ç‰ˆæœ¬æ£€æŸ¥)
    - [2.2 å®‰å…¨å…¬å‘Šç›‘æ§](#22-å®‰å…¨å…¬å‘Šç›‘æ§)
    - [2.3 å®‰å…¨æ‰«æå·¥å…·](#23-å®‰å…¨æ‰«æå·¥å…·)
  - [3. æ¼æ´è¯„ä¼°](#3-æ¼æ´è¯„ä¼°)
    - [3.1 ä¸¥é‡ç¨‹åº¦åˆ†ç±»](#31-ä¸¥é‡ç¨‹åº¦åˆ†ç±»)
    - [3.2 é£é™©è¯„ä¼°](#32-é£é™©è¯„ä¼°)
  - [4. æ¼æ´ä¿®å¤](#4-æ¼æ´ä¿®å¤)
    - [4.1 è¡¥ä¸ç®¡ç†](#41-è¡¥ä¸ç®¡ç†)
    - [4.2 å‡çº§PostgreSQL](#42-å‡çº§postgresql)
    - [4.3 ä¸´æ—¶ç¼“è§£æªæ–½](#43-ä¸´æ—¶ç¼“è§£æªæ–½)
  - [5. æ¼æ´è·Ÿè¸ª](#5-æ¼æ´è·Ÿè¸ª)
    - [5.1 æ¼æ´è·Ÿè¸ªè¡¨](#51-æ¼æ´è·Ÿè¸ªè¡¨)
    - [5.2 è·Ÿè¸ªæµç¨‹](#52-è·Ÿè¸ªæµç¨‹)
  - [6. æœ€ä½³å®è·µ](#6-æœ€ä½³å®è·µ)
    - [âœ… æ¨èåšæ³•](#-æ¨èåšæ³•)
    - [âŒ é¿å…åšæ³•](#-é¿å…åšæ³•)
  - [ğŸ“š ç›¸å…³æ–‡æ¡£](#-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

æ¼æ´ç®¡ç†æ˜¯PostgreSQLå®‰å…¨çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚åŒ…æ‹¬ï¼š

- **æ¼æ´å‘ç°** - è¯†åˆ«å®‰å…¨æ¼æ´
- **æ¼æ´è¯„ä¼°** - è¯„ä¼°æ¼æ´ä¸¥é‡ç¨‹åº¦
- **æ¼æ´ä¿®å¤** - ä¿®å¤å®‰å…¨æ¼æ´
- **æ¼æ´è·Ÿè¸ª** - è·Ÿè¸ªæ¼æ´çŠ¶æ€

---

## 2. æ¼æ´å‘ç°

### 2.1 ç‰ˆæœ¬æ£€æŸ¥

```sql
-- æ£€æŸ¥PostgreSQLç‰ˆæœ¬
SELECT version();

-- æ£€æŸ¥æ‰©å±•ç‰ˆæœ¬
SELECT extname, extversion
FROM pg_extension
ORDER BY extname;
```

### 2.2 å®‰å…¨å…¬å‘Šç›‘æ§

```bash
# è®¢é˜…PostgreSQLå®‰å…¨å…¬å‘Š
# https://www.postgresql.org/support/security/

# æ£€æŸ¥å·²çŸ¥æ¼æ´
# CVEæ•°æ®åº“: https://cve.mitre.org/
```

### 2.3 å®‰å…¨æ‰«æå·¥å…·

```bash
# ä½¿ç”¨å®‰å…¨æ‰«æå·¥å…·
# - pgAudit
# - pg_security
# - ç¬¬ä¸‰æ–¹å®‰å…¨æ‰«æå·¥å…·
```

---

## 3. æ¼æ´è¯„ä¼°

### 3.1 ä¸¥é‡ç¨‹åº¦åˆ†ç±»

| çº§åˆ« | è¯´æ˜ | å“åº”æ—¶é—´ |
|------|------|---------|
| **ä¸¥é‡** | è¿œç¨‹ä»£ç æ‰§è¡Œã€æ•°æ®æ³„éœ² | 24å°æ—¶å†… |
| **é«˜** | æƒé™æå‡ã€æ‹’ç»æœåŠ¡ | 7å¤©å†… |
| **ä¸­** | ä¿¡æ¯æ³„éœ²ã€é…ç½®é”™è¯¯ | 30å¤©å†… |
| **ä½** | ä¿¡æ¯æ³„éœ²ã€é…ç½®å»ºè®® | 90å¤©å†… |

### 3.2 é£é™©è¯„ä¼°

```sql
-- è¯„ä¼°æ¼æ´å½±å“èŒƒå›´
-- 1. å—å½±å“çš„æ•°æ®
-- 2. å—å½±å“çš„ç”¨æˆ·
-- 3. ä¸šåŠ¡å½±å“
-- 4. åˆè§„å½±å“
```

---

## 4. æ¼æ´ä¿®å¤

### 4.1 è¡¥ä¸ç®¡ç†

```bash
# 1. å¤‡ä»½æ•°æ®åº“
pg_dump -Fc mydb > backup.dump

# 2. æµ‹è¯•è¡¥ä¸ï¼ˆåœ¨æµ‹è¯•ç¯å¢ƒï¼‰
# 3. åº”ç”¨è¡¥ä¸
# 4. éªŒè¯ä¿®å¤
# 5. ç›‘æ§ç³»ç»Ÿ
```

### 4.2 å‡çº§PostgreSQL

```bash
# å°ç‰ˆæœ¬å‡çº§ï¼ˆå¦‚17.1 -> 17.2ï¼‰
# é€šå¸¸åªéœ€è¦é‡å¯

# å¤§ç‰ˆæœ¬å‡çº§ï¼ˆå¦‚16 -> 17ï¼‰
# éœ€è¦ä½¿ç”¨pg_upgradeæˆ–é€»è¾‘å¤åˆ¶
```

### 4.3 ä¸´æ—¶ç¼“è§£æªæ–½

```sql
-- å¦‚æœæ— æ³•ç«‹å³ä¿®å¤ï¼Œå®æ–½ä¸´æ—¶ç¼“è§£æªæ–½
-- ä¾‹å¦‚ï¼šç¦ç”¨å—å½±å“çš„åŠŸèƒ½
ALTER SYSTEM SET shared_preload_libraries = '';
SELECT pg_reload_conf();
```

---

## 5. æ¼æ´è·Ÿè¸ª

### 5.1 æ¼æ´è·Ÿè¸ªè¡¨

```sql
-- åˆ›å»ºæ¼æ´è·Ÿè¸ªè¡¨
CREATE TABLE vulnerability_tracking (
    id SERIAL PRIMARY KEY,
    cve_id TEXT,
    description TEXT,
    severity TEXT CHECK (severity IN ('critical', 'high', 'medium', 'low')),
    affected_version TEXT,
    fixed_version TEXT,
    status TEXT CHECK (status IN ('open', 'in_progress', 'fixed', 'mitigated')),
    discovered_at TIMESTAMPTZ DEFAULT NOW(),
    fixed_at TIMESTAMPTZ,
    notes TEXT
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX vuln_tracking_status_idx ON vulnerability_tracking (status);
CREATE INDEX vuln_tracking_severity_idx ON vulnerability_tracking (severity);
```

### 5.2 è·Ÿè¸ªæµç¨‹

```sql
-- è®°å½•æ–°æ¼æ´
INSERT INTO vulnerability_tracking (
    cve_id, description, severity, affected_version, status
) VALUES (
    'CVE-2024-XXXX',
    'PostgreSQLå®‰å…¨æ¼æ´æè¿°',
    'high',
    '17.0',
    'open'
);

-- æ›´æ–°çŠ¶æ€
UPDATE vulnerability_tracking
SET status = 'fixed',
    fixed_at = NOW(),
    fixed_version = '17.1'
WHERE cve_id = 'CVE-2024-XXXX';
```

---

## 6. æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

1. **å®šæœŸæ£€æŸ¥** - å®šæœŸæ£€æŸ¥å®‰å…¨å…¬å‘Š
2. **åŠæ—¶ä¿®å¤** - æ ¹æ®ä¸¥é‡ç¨‹åº¦åŠæ—¶ä¿®å¤
3. **æµ‹è¯•è¡¥ä¸** - åœ¨æµ‹è¯•ç¯å¢ƒæµ‹è¯•è¡¥ä¸
4. **è·Ÿè¸ªæ¼æ´** - è®°å½•æ‰€æœ‰æ¼æ´å’Œä¿®å¤çŠ¶æ€
5. **ç›‘æ§ç³»ç»Ÿ** - ä¿®å¤åç›‘æ§ç³»ç»ŸçŠ¶æ€

### âŒ é¿å…åšæ³•

1. **å¿½ç•¥æ¼æ´** - å®‰å…¨æ¼æ´å¿…é¡»ä¿®å¤
2. **ä¸æµ‹è¯•è¡¥ä¸** - å¯èƒ½å¯¼è‡´ç³»ç»Ÿé—®é¢˜
3. **ä¸å¤‡ä»½** - ä¿®å¤å‰å¿…é¡»å¤‡ä»½
4. **ä¸è·Ÿè¸ª** - æ— æ³•ç®¡ç†æ¼æ´çŠ¶æ€

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [PostgreSQLå®‰å…¨åŠ å›ºå®Œæ•´æŒ‡å—.md](./PostgreSQLå®‰å…¨åŠ å›ºå®Œæ•´æŒ‡å—.md) - å®Œæ•´åŠ å›ºæŒ‡å—
- [å®‰å…¨åŠ å›ºæ¸…å•.md](./å®‰å…¨åŠ å›ºæ¸…å•.md) - å®‰å…¨æ£€æŸ¥æ¸…å•
- [05-å®‰å…¨ä¸åˆè§„/README.md](../README.md) - å®‰å…¨ä¸åˆè§„ä¸»é¢˜

---

**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
