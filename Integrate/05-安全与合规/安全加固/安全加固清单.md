# PostgreSQL安全加固清单

> **创建日期**: 2025年1月
> **技术版本**: PostgreSQL 17+/18+
> **用途**: 系统化的安全检查清单

---

## 📋 目录

- [PostgreSQL安全加固清单](#postgresql安全加固清单)
  - [📋 目录](#-目录)
  - [1. 初始配置检查](#1-初始配置检查)
    - [1.1 基础配置](#11-基础配置)
    - [1.2 文件权限](#12-文件权限)
  - [2. 身份认证检查](#2-身份认证检查)
    - [2.1 密码策略](#21-密码策略)
    - [2.2 认证方法](#22-认证方法)
  - [3. 访问控制检查](#3-访问控制检查)
    - [3.1 权限管理](#31-权限管理)
    - [3.2 行级安全（RLS）](#32-行级安全rls)
  - [4. 数据加密检查](#4-数据加密检查)
    - [4.1 传输加密](#41-传输加密)
    - [4.2 存储加密](#42-存储加密)
  - [5. 审计与监控检查](#5-审计与监控检查)
    - [5.1 审计日志](#51-审计日志)
    - [5.2 监控](#52-监控)
  - [6. 网络安全检查](#6-网络安全检查)
    - [6.1 防火墙](#61-防火墙)
    - [6.2 连接限制](#62-连接限制)
  - [7. 系统安全检查](#7-系统安全检查)
    - [7.1 操作系统](#71-操作系统)
    - [7.2 数据库配置](#72-数据库配置)
  - [8. 合规性检查](#8-合规性检查)
    - [8.1 GDPR合规](#81-gdpr合规)
    - [8.2 其他合规](#82-其他合规)
  - [📋 检查清单使用说明](#-检查清单使用说明)
  - [📚 相关文档](#-相关文档)

---

## 1. 初始配置检查

### 1.1 基础配置

- [ ] 修改默认postgres用户密码
- [ ] 创建专用管理员用户（非postgres）
- [ ] 禁用不必要的扩展
- [ ] 检查数据库版本和补丁
- [ ] 配置日志记录

### 1.2 文件权限

- [ ] postgresql.conf权限设置为600
- [ ] pg_hba.conf权限设置为600
- [ ] 私钥文件权限设置为600
- [ ] 数据目录权限正确设置

---

## 2. 身份认证检查

### 2.1 密码策略

- [ ] 启用密码复杂度要求
- [ ] 配置密码最小长度（建议12+）
- [ ] 配置密码过期策略
- [ ] 禁用弱密码
- [ ] 使用SCRAM-SHA-256认证

### 2.2 认证方法

- [ ] 配置pg_hba.conf限制访问
- [ ] 使用SSL/TLS连接
- [ ] 配置IP白名单
- [ ] 禁用trust认证方法
- [ ] 配置连接超时

---

## 3. 访问控制检查

### 3.1 权限管理

- [ ] 遵循最小权限原则
- [ ] 创建专用应用用户（非超级用户）
- [ ] 定期审查用户权限
- [ ] 使用角色管理权限
- [ ] 禁用PUBLIC权限

### 3.2 行级安全（RLS）

- [ ] 为敏感表启用RLS
- [ ] 创建RLS策略
- [ ] 测试RLS策略有效性
- [ ] 定期审查RLS策略

---

## 4. 数据加密检查

### 4.1 传输加密

- [ ] 启用SSL/TLS
- [ ] 配置SSL证书
- [ ] 强制SSL连接
- [ ] 使用强加密算法

### 4.2 存储加密

- [ ] 使用pgcrypto扩展加密敏感数据
- [ ] 配置密钥管理
- [ ] 实施密钥轮换策略
- [ ] 保护密钥存储

---

## 5. 审计与监控检查

### 5.1 审计日志

- [ ] 启用pgAudit扩展
- [ ] 配置审计日志记录
- [ ] 记录DDL操作
- [ ] 记录DML操作
- [ ] 记录登录/登出

### 5.2 监控

- [ ] 配置慢查询日志
- [ ] 监控异常连接
- [ ] 监控权限变更
- [ ] 设置告警规则

---

## 6. 网络安全检查

### 6.1 防火墙

- [ ] 配置防火墙规则
- [ ] 限制数据库端口访问
- [ ] 只允许必要的IP访问
- [ ] 使用VPN或专用网络

### 6.2 连接限制

- [ ] 配置max_connections
- [ ] 配置连接超时
- [ ] 使用连接池
- [ ] 限制每个用户的连接数

---

## 7. 系统安全检查

### 7.1 操作系统

- [ ] 使用专用数据库用户运行PostgreSQL
- [ ] 限制数据库用户系统权限
- [ ] 定期更新操作系统
- [ ] 配置SELinux/AppArmor

### 7.2 数据库配置

- [ ] 禁用危险函数（如pg_read_file）
- [ ] 限制超级用户数量
- [ ] 配置安全参数
- [ ] 定期备份

---

## 8. 合规性检查

### 8.1 GDPR合规

- [ ] 实施数据保留策略
- [ ] 支持数据删除请求
- [ ] 实施数据脱敏
- [ ] 记录数据处理活动

### 8.2 其他合规

- [ ] HIPAA合规（如适用）
- [ ] PCI-DSS合规（如适用）
- [ ] SOC 2合规（如适用）
- [ ] 行业特定合规要求

---

## 📋 检查清单使用说明

1. **定期检查** - 建议每月执行一次完整检查
2. **新部署检查** - 新部署前必须完成所有检查项
3. **变更后检查** - 配置变更后重新检查相关项
4. **记录结果** - 记录检查结果和发现的问题
5. **及时修复** - 发现问题及时修复

---

## 📚 相关文档

- [PostgreSQL安全加固完整指南.md](./PostgreSQL安全加固完整指南.md) - 完整加固指南
- [安全配置最佳实践.md](./安全配置最佳实践.md) - 配置最佳实践
- [05-安全与合规/README.md](../README.md) - 安全与合规主题

---

**最后更新**: 2025年1月
