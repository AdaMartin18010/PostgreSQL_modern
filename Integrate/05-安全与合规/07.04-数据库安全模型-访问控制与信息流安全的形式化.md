---

> **ğŸ“‹ æ–‡æ¡£æ¥æº**: `DataBaseTheory\07-å®‰å…¨ä¸åˆè§„\07.04-æ•°æ®åº“å®‰å…¨æ¨¡å‹-è®¿é—®æ§åˆ¶ä¸ä¿¡æ¯æµå®‰å…¨çš„å½¢å¼åŒ–.md`
> **ğŸ“… å¤åˆ¶æ—¥æœŸ**: 2025-12-22
> **âš ï¸ æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºå¤åˆ¶ç‰ˆæœ¬ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜

---

# æ•°æ®åº“å®‰å…¨æ¨¡å‹-è®¿é—®æ§åˆ¶ä¸ä¿¡æ¯æµå®‰å…¨çš„å½¢å¼åŒ–

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: âœ… å†…å®¹å·²æ·±åŒ–ï¼ŒåŒ…å«å®Œæ•´è¯æ˜ã€åœºæ™¯æ¡ˆä¾‹å’ŒPostgreSQL 18/SQLiteå¯¹æ¯”

---

## ğŸ“‹ ç›®å½•

- [æ•°æ®åº“å®‰å…¨æ¨¡å‹-è®¿é—®æ§åˆ¶ä¸ä¿¡æ¯æµå®‰å…¨çš„å½¢å¼åŒ–](#æ•°æ®åº“å®‰å…¨æ¨¡å‹-è®¿é—®æ§åˆ¶ä¸ä¿¡æ¯æµå®‰å…¨çš„å½¢å¼åŒ–)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 æ•°æ®åº“å®‰å…¨æ¨¡å‹å·¥ä½œåŸç†æ¦‚è¿°](#10-æ•°æ®åº“å®‰å…¨æ¨¡å‹å·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 è®¿é—®æ§åˆ¶æ¨¡å‹](#21-è®¿é—®æ§åˆ¶æ¨¡å‹)
    - [2.2 ä¿¡æ¯æµå®‰å…¨](#22-ä¿¡æ¯æµå®‰å…¨)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 è®¿é—®æ§åˆ¶å½¢å¼åŒ–](#31-è®¿é—®æ§åˆ¶å½¢å¼åŒ–)
    - [3.2 ä¿¡æ¯æµå®‰å…¨å½¢å¼åŒ–](#32-ä¿¡æ¯æµå®‰å…¨å½¢å¼åŒ–)
  - [4. å®šç†ä¸è¯æ˜](#4-å®šç†ä¸è¯æ˜)
    - [4.1 Bell-LaPadulaæ¨¡å‹æ­£ç¡®æ€§å®šç†](#41-bell-lapadulaæ¨¡å‹æ­£ç¡®æ€§å®šç†)
    - [4.2 ä¿¡æ¯æµå®‰å…¨å®šç†](#42-ä¿¡æ¯æµå®‰å…¨å®šç†)
    - [4.3 RBACå¯ç»„åˆæ€§å®šç†](#43-rbacå¯ç»„åˆæ€§å®šç†)
    - [4.4 OAuth 2.0ä»¤ç‰Œå®‰å…¨å®šç†ï¼ˆPostgreSQL 18æ–°å¢ï¼‰](#44-oauth-20ä»¤ç‰Œå®‰å…¨å®šç†postgresql-18æ–°å¢)
  - [5. å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 PostgreSQL 18 è®¿é—®æ§åˆ¶å®ç°è¯¦è§£](#51-postgresql-18-è®¿é—®æ§åˆ¶å®ç°è¯¦è§£)
    - [5.2 SQLite 3.45 è®¿é—®æ§åˆ¶å¯¹æ¯”](#52-sqlite-345-è®¿é—®æ§åˆ¶å¯¹æ¯”)
    - [5.3 å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹](#53-å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹)
      - [åœºæ™¯1ï¼šæ”¿åºœç³»ç»Ÿçš„åˆ†çº§å®‰å…¨è®¿é—®æ§åˆ¶](#åœºæ™¯1æ”¿åºœç³»ç»Ÿçš„åˆ†çº§å®‰å…¨è®¿é—®æ§åˆ¶)
      - [åœºæ™¯2ï¼šä¼ä¸šç³»ç»Ÿçš„RBACè®¿é—®æ§åˆ¶](#åœºæ™¯2ä¼ä¸šç³»ç»Ÿçš„rbacè®¿é—®æ§åˆ¶)
    - [5.4 è®¿é—®æ§åˆ¶ç­–ç•¥é€‰æ‹©æœ€ä½³å®è·µ](#54-è®¿é—®æ§åˆ¶ç­–ç•¥é€‰æ‹©æœ€ä½³å®è·µ)
    - [5.5 æ¨¡å‹é€‰æ‹©å»ºè®®](#55-æ¨¡å‹é€‰æ‹©å»ºè®®)
  - [6. ç›¸å…³æ–‡æ¡£](#6-ç›¸å…³æ–‡æ¡£)
    - [6.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#61-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [7. å‚è€ƒæ–‡çŒ®](#7-å‚è€ƒæ–‡çŒ®)
    - [7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®](#71-æ ¸å¿ƒç†è®ºæ–‡çŒ®)
    - [7.2 PostgreSQLå®ç°ç›¸å…³](#72-postgresqlå®ç°ç›¸å…³)
    - [7.3 Wikipediaæ¡ç›®](#73-wikipediaæ¡ç›®)
    - [7.4 å¤§å­¦è¯¾ç¨‹](#74-å¤§å­¦è¯¾ç¨‹)
    - [7.5 ç›¸å…³æ–‡æ¡£](#75-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

### 1.0 æ•°æ®åº“å®‰å…¨æ¨¡å‹å·¥ä½œåŸç†æ¦‚è¿°

**å®‰å…¨æ¨¡å‹**ï¼š

æ•°æ®åº“å®‰å…¨æ¨¡å‹åŒ…æ‹¬è®¿é—®æ§åˆ¶å’Œä¿¡æ¯æµå®‰å…¨ï¼Œç¡®ä¿æ•°æ®æœºå¯†æ€§å’Œå®Œæ•´æ€§ã€‚

**å®‰å…¨æ¨¡å‹æ€ç»´å¯¼å›¾**ï¼š

```mermaid
mindmap
  root((å®‰å…¨æ¨¡å‹))
    è®¿é—®æ§åˆ¶
      DACè‡ªä¸»è®¿é—®æ§åˆ¶
      MACå¼ºåˆ¶è®¿é—®æ§åˆ¶
      RBACåŸºäºè§’è‰²
    ä¿¡æ¯æµå®‰å…¨
      ä¿¡æ¯æµç­–ç•¥
      å»åˆ†ç±»
      éå¹²æ‰°æ€§
    å®‰å…¨çº§åˆ«
      æœºå¯†æ€§
      å®Œæ•´æ€§
```

**è®¿é—®æ§åˆ¶æ¨¡å‹é€‰æ‹©å†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[é€‰æ‹©è®¿é—®æ§åˆ¶æ¨¡å‹] --> B{å®‰å…¨çº§åˆ«è¦æ±‚?}
    B -->|é«˜| C{éœ€è¦å¼ºåˆ¶æ§åˆ¶?}
    B -->|ä¸­| D{éœ€è¦è§’è‰²ç®¡ç†?}
    B -->|ä½| E[DACè‡ªä¸»è®¿é—®æ§åˆ¶]

    C -->|æ˜¯| F[MACå¼ºåˆ¶è®¿é—®æ§åˆ¶]
    C -->|å¦| G[RBACåŸºäºè§’è‰²]

    D -->|æ˜¯| G
    D -->|å¦| E

    F --> H[Bell-LaPadulaæ¨¡å‹]
    F --> I[Bibaæ¨¡å‹]

    G --> J[RBAC0åŸºç¡€æ¨¡å‹]
    G --> K[RBAC1å±‚æ¬¡æ¨¡å‹]
    G --> L[RBAC2çº¦æŸæ¨¡å‹]

    E --> M[æ–‡ä»¶ç³»ç»Ÿæƒé™]
    H --> N[å¤šçº§å®‰å…¨]
    J --> O[ä¼ä¸šç³»ç»Ÿ]

    style A fill:#FFD700
    style F fill:#90EE90
    style G fill:#87CEEB
    style E fill:#FFA500
```

**è®¿é—®æ§åˆ¶æ¨¡å‹å¯¹æ¯”çŸ©é˜µ**ï¼š

| ç»´åº¦ | DAC | MAC | RBAC | ABAC |
|------|-----|-----|------|------|
| **æ§åˆ¶æ–¹å¼** | è‡ªä¸» | å¼ºåˆ¶ | åŸºäºè§’è‰² | åŸºäºå±æ€§ |
| **çµæ´»æ€§** | é«˜ | ä½ | ä¸­ | é«˜ |
| **å®‰å…¨æ€§** | ä¸­ | é«˜ | é«˜ | é«˜ |
| **ç®¡ç†å¤æ‚åº¦** | ä½ | é«˜ | ä¸­ | é«˜ |
| **é€‚ç”¨åœºæ™¯** | å°å‹ç³»ç»Ÿ | å†›äº‹/æ”¿åºœ | ä¼ä¸šç³»ç»Ÿ | äº‘ç³»ç»Ÿ |
| **æ‰©å±•æ€§** | ä½ | ä¸­ | é«˜ | é«˜ |
| **å®ç°éš¾åº¦** | ä½ | é«˜ | ä¸­ | é«˜ |
| **PostgreSQLæ”¯æŒ** | âœ… åŸºç¡€æ”¯æŒ | âš ï¸ éƒ¨åˆ†æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | âš ï¸ éƒ¨åˆ†æ”¯æŒ |

**æ•°æ®åº“å®‰å…¨æ¨¡å‹æ¦‚å¿µåˆ†ææ ‘**ï¼š

```mermaid
graph TD
    A[æ•°æ®åº“å®‰å…¨æ¨¡å‹] --> B[è®¿é—®æ§åˆ¶]
    A --> C[ä¿¡æ¯æµå®‰å…¨]
    A --> D[å®‰å…¨ç­–ç•¥]

    B --> E[DAC]
    B --> F[MAC]
    B --> G[RBAC]
    B --> H[ABAC]

    E --> I[è‡ªä¸»æ§åˆ¶]
    E --> J[æ–‡ä»¶æƒé™]

    F --> K[å¼ºåˆ¶æ§åˆ¶]
    F --> L[å®‰å…¨çº§åˆ«]
    F --> M[Bell-LaPadula]
    F --> N[Bibaæ¨¡å‹]

    G --> O[è§’è‰²å®šä¹‰]
    G --> P[æƒé™åˆ†é…]
    G --> Q[è§’è‰²å±‚æ¬¡]

    C --> R[ä¿¡æ¯æµç­–ç•¥]
    C --> S[å»åˆ†ç±»]
    C --> T[éå¹²æ‰°æ€§]

    R --> U[æ ¼æ¨¡å‹]
    R --> V[ä¿¡æ¯æµè§„åˆ™]

    D --> W[å®‰å…¨ç­–ç•¥]
    D --> X[åˆè§„æ€§]
    D --> Y[å®¡è®¡]

    A --> Z[å®‰å…¨ç›®æ ‡]
    Z --> AA[æœºå¯†æ€§]
    Z --> AB[å®Œæ•´æ€§]
    Z --> AC[å¯ç”¨æ€§]

    style A fill:#FFD700
    style B fill:#90EE90
    style C fill:#87CEEB
    style D fill:#FFA500
    style Z fill:#FF69B4
```

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **è®¿é—®æ§åˆ¶**ï¼šDACã€MACã€RBACæ¨¡å‹
- **ä¿¡æ¯æµå®‰å…¨**ï¼šä¿¡æ¯æµç­–ç•¥å’Œå»åˆ†ç±»
- **å®é™…åº”ç”¨**ï¼šPostgreSQLå®‰å…¨å®ç°

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 è®¿é—®æ§åˆ¶æ¨¡å‹

**è®¿é—®æ§åˆ¶æ¨¡å‹å¯¹æ¯”**ï¼š

| æ¨¡å‹ | æ§åˆ¶æ–¹å¼ | çµæ´»æ€§ | å®‰å…¨æ€§ | é€‚ç”¨åœºæ™¯ |
|------|---------|--------|--------|---------|
| **DAC** | è‡ªä¸»æ§åˆ¶ | é«˜ | ä¸­ | å°å‹ç³»ç»Ÿ |
| **MAC** | å¼ºåˆ¶æ§åˆ¶ | ä½ | é«˜ | å†›äº‹/æ”¿åºœ |
| **RBAC** | åŸºäºè§’è‰² | ä¸­ | é«˜ | ä¼ä¸šç³»ç»Ÿ |

### 2.2 ä¿¡æ¯æµå®‰å…¨

**ä¿¡æ¯æµç­–ç•¥**ï¼š

```haskell
-- ä¿¡æ¯æµç­–ç•¥
data InformationFlow = InformationFlow {
    source :: SecurityLevel,
    sink :: SecurityLevel,
    policy :: FlowPolicy  -- NoWriteDown, NoReadUp
}

-- ä¿¡æ¯æµæ£€æŸ¥
checkInformationFlow :: InformationFlow -> Bool
checkInformationFlow flow =
    case flow.policy of
        NoWriteDown -> flow.source <= flow.sink
        NoReadUp -> flow.source >= flow.sink
```

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 è®¿é—®æ§åˆ¶å½¢å¼åŒ–

**è®¿é—®æ§åˆ¶**ï¼š

```haskell
-- è®¿é—®æ§åˆ¶å½¢å¼åŒ–
AccessControl = (S, O, A, P)
where
    S = subject set
    O = object set
    A = action set
    P = permission matrix
```

### 3.2 ä¿¡æ¯æµå®‰å…¨å½¢å¼åŒ–

**ä¿¡æ¯æµå®‰å…¨**ï¼š

```haskell
-- ä¿¡æ¯æµå®‰å…¨å½¢å¼åŒ–
InformationFlow = (L, â‰¤, flow)
where
    L = security level lattice
    â‰¤ = dominance relation
    flow: L Ã— L â†’ Bool  -- ä¿¡æ¯æµç­–ç•¥
```

---

## 4. å®šç†ä¸è¯æ˜

### 4.1 Bell-LaPadulaæ¨¡å‹æ­£ç¡®æ€§å®šç†

**å®šç†**ï¼šå¦‚æœç³»ç»Ÿæ»¡è¶³Bell-LaPadulaæ¨¡å‹çš„ç®€å•å®‰å…¨æ€§å’Œ*-å±æ€§ï¼Œåˆ™ç³»ç»Ÿæ˜¯å®‰å…¨çš„ï¼Œå³ä¸å­˜åœ¨ä¿¡æ¯ä»é«˜å®‰å…¨çº§åˆ«æµå‘ä½å®‰å…¨çº§åˆ«ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾ç³»ç»ŸS = (Subjects, Objects, SecurityLevels, â‰¤)ï¼Œå…¶ä¸­â‰¤æ˜¯å®‰å…¨çº§åˆ«çš„ååºå…³ç³»ã€‚Bell-LaPadulaæ¨¡å‹åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š

1. **ç®€å•å®‰å…¨æ€§**ï¼ˆSimple Security Propertyï¼‰ï¼šä¸»ä½“såªèƒ½è¯»å–å®‰å…¨çº§åˆ«â‰¤å…¶å®‰å…¨çº§åˆ«çš„å¯¹è±¡
2. _**-å±æ€§**ï¼ˆ_-Propertyï¼‰ï¼šä¸»ä½“såªèƒ½å†™å…¥å®‰å…¨çº§åˆ«â‰¥å…¶å®‰å…¨çº§åˆ«çš„å¯¹è±¡

å¦‚æœç³»ç»ŸSæ»¡è¶³è¿™ä¸¤ä¸ªå±æ€§ï¼Œåˆ™ä¸å­˜åœ¨ä¿¡æ¯ä»é«˜å®‰å…¨çº§åˆ«æµå‘ä½å®‰å…¨çº§åˆ«ã€‚

**è¯æ˜**ï¼ˆåè¯æ³•ï¼‰ï¼š

**æ­¥éª¤1ï¼šå‡è®¾å­˜åœ¨ä¿¡æ¯æµ**:

- å‡è®¾å­˜åœ¨ä¿¡æ¯ä»é«˜å®‰å…¨çº§åˆ«L_Hæµå‘ä½å®‰å…¨çº§åˆ«L_Lï¼Œå…¶ä¸­L_H > L_L
- è¿™æ„å‘³ç€å­˜åœ¨æ“ä½œåºåˆ—ï¼Œä½¿å¾—ä½å®‰å…¨çº§åˆ«ä¸»ä½“å¯ä»¥è§‚å¯Ÿåˆ°é«˜å®‰å…¨çº§åˆ«ä¿¡æ¯

**æ­¥éª¤2ï¼šç®€å•å®‰å…¨æ€§çº¦æŸ**:

- æ ¹æ®ç®€å•å®‰å…¨æ€§ï¼Œä½å®‰å…¨çº§åˆ«ä¸»ä½“s_Lï¼ˆå®‰å…¨çº§åˆ«L_Lï¼‰åªèƒ½è¯»å–å®‰å…¨çº§åˆ«â‰¤L_Lçš„å¯¹è±¡
- å› æ­¤ï¼Œs_Lä¸èƒ½ç›´æ¥è¯»å–é«˜å®‰å…¨çº§åˆ«å¯¹è±¡ï¼ˆå®‰å…¨çº§åˆ«L_H > L_Lï¼‰

**æ­¥éª¤3ï¼š*-å±æ€§çº¦æŸ**:

- æ ¹æ®*-å±æ€§ï¼Œé«˜å®‰å…¨çº§åˆ«ä¸»ä½“s_Hï¼ˆå®‰å…¨çº§åˆ«L_Hï¼‰åªèƒ½å†™å…¥å®‰å…¨çº§åˆ«â‰¥L_Hçš„å¯¹è±¡
- å› æ­¤ï¼Œs_Hä¸èƒ½ç›´æ¥å†™å…¥ä½å®‰å…¨çº§åˆ«å¯¹è±¡ï¼ˆå®‰å…¨çº§åˆ«L_L < L_Hï¼‰

**æ­¥éª¤4ï¼šé—´æ¥ä¿¡æ¯æµåˆ†æ**:

- å¦‚æœå­˜åœ¨é—´æ¥ä¿¡æ¯æµï¼Œåˆ™å­˜åœ¨æ“ä½œåºåˆ—ï¼š
  - s_Hè¯»å–é«˜å®‰å…¨çº§åˆ«å¯¹è±¡o_H
  - s_Hå†™å…¥æŸä¸ªå¯¹è±¡o_M
  - s_Lè¯»å–o_M
- ä½†æ ¹æ®*-å±æ€§ï¼Œs_Håªèƒ½å†™å…¥å®‰å…¨çº§åˆ«â‰¥L_Hçš„å¯¹è±¡ï¼Œå› æ­¤o_Mçš„å®‰å…¨çº§åˆ«â‰¥L_H
- æ ¹æ®ç®€å•å®‰å…¨æ€§ï¼Œs_Låªèƒ½è¯»å–å®‰å…¨çº§åˆ«â‰¤L_Lçš„å¯¹è±¡ï¼Œå› æ­¤s_Lä¸èƒ½è¯»å–o_Mï¼ˆL_H > L_Lï¼‰

**æ­¥éª¤5ï¼šçŸ›ç›¾**:

- ä¸å­˜åœ¨æ“ä½œåºåˆ—ä½¿å¾—ä¿¡æ¯ä»L_Hæµå‘L_L
- è¿™ä¸å‡è®¾çŸ›ç›¾

**æ­¥éª¤6ï¼šç»“è®º**:

- å¦‚æœç³»ç»Ÿæ»¡è¶³Bell-LaPadulaæ¨¡å‹çš„ä¸¤ä¸ªå±æ€§ï¼Œåˆ™ä¸å­˜åœ¨ä¿¡æ¯ä»é«˜å®‰å…¨çº§åˆ«æµå‘ä½å®‰å…¨çº§åˆ«
- å› æ­¤ï¼Œç³»ç»Ÿæ˜¯å®‰å…¨çš„
- è¯æ¯•

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[Bell-LaPadulaæ­£ç¡®æ€§] --> B[å‡è®¾å­˜åœ¨ä¿¡æ¯æµ]
    B --> C[ç®€å•å®‰å…¨æ€§çº¦æŸ]
    C --> D[*-å±æ€§çº¦æŸ]
    D --> E[é—´æ¥ä¿¡æ¯æµåˆ†æ]
    E --> F[çŸ›ç›¾]
    F --> G[ç³»ç»Ÿå®‰å…¨]

    style A fill:#FFD700
    style G fill:#90EE90
```

### 4.2 ä¿¡æ¯æµå®‰å…¨å®šç†

**å®šç†**ï¼šå¦‚æœä¿¡æ¯æµç­–ç•¥æ»¡è¶³NoWriteDownå’ŒNoReadUpï¼Œåˆ™ç³»ç»Ÿæ»¡è¶³ä¿¡æ¯æµå®‰å…¨ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾ä¿¡æ¯æµç­–ç•¥flow: L Ã— L â†’ Boolï¼Œå…¶ä¸­Læ˜¯å®‰å…¨çº§åˆ«é›†åˆã€‚å¦‚æœflowæ»¡è¶³ï¼š

1. **NoWriteDown**ï¼šå¯¹äºä»»æ„å®‰å…¨çº§åˆ«Lâ‚, Lâ‚‚ï¼Œå¦‚æœLâ‚ > Lâ‚‚ï¼Œåˆ™flow(Lâ‚, Lâ‚‚) = falseï¼ˆä¸èƒ½å‘ä¸‹å†™ï¼‰
2. **NoReadUp**ï¼šå¯¹äºä»»æ„å®‰å…¨çº§åˆ«Lâ‚, Lâ‚‚ï¼Œå¦‚æœLâ‚ < Lâ‚‚ï¼Œåˆ™flow(Lâ‚‚, Lâ‚) = falseï¼ˆä¸èƒ½å‘ä¸Šè¯»ï¼‰

åˆ™ç³»ç»Ÿæ»¡è¶³ä¿¡æ¯æµå®‰å…¨ï¼Œå³ä¸å­˜åœ¨ä¿¡æ¯ä»é«˜å®‰å…¨çº§åˆ«æµå‘ä½å®‰å…¨çº§åˆ«ã€‚

**è¯æ˜**ï¼ˆæ„é€ æ€§è¯æ˜ï¼‰ï¼š

**æ­¥éª¤1ï¼šä¿¡æ¯æµå®šä¹‰**:

- ä¿¡æ¯æµä»Lâ‚åˆ°Lâ‚‚å­˜åœ¨ï¼Œå½“ä¸”ä»…å½“å­˜åœ¨æ“ä½œåºåˆ—ä½¿å¾—Lâ‚çš„ä¿¡æ¯å¯ä»¥åˆ°è¾¾Lâ‚‚
- ä¿¡æ¯æµå®‰å…¨è¦æ±‚ï¼šå¯¹äºL_H > L_Lï¼Œä¸å­˜åœ¨ä¿¡æ¯æµä»L_Håˆ°L_L

**æ­¥éª¤2ï¼šNoWriteDownçº¦æŸ**:

- NoWriteDownè¦æ±‚ï¼šé«˜å®‰å…¨çº§åˆ«ä¸»ä½“ä¸èƒ½å†™å…¥ä½å®‰å…¨çº§åˆ«å¯¹è±¡
- å› æ­¤ï¼Œé«˜å®‰å…¨çº§åˆ«ä¿¡æ¯ä¸èƒ½ç›´æ¥å†™å…¥ä½å®‰å…¨çº§åˆ«å¯¹è±¡

**æ­¥éª¤3ï¼šNoReadUpçº¦æŸ**:

- NoReadUpè¦æ±‚ï¼šä½å®‰å…¨çº§åˆ«ä¸»ä½“ä¸èƒ½è¯»å–é«˜å®‰å…¨çº§åˆ«å¯¹è±¡
- å› æ­¤ï¼Œä½å®‰å…¨çº§åˆ«ä¸»ä½“ä¸èƒ½ç›´æ¥è¯»å–é«˜å®‰å…¨çº§åˆ«ä¿¡æ¯

**æ­¥éª¤4ï¼šé—´æ¥ä¿¡æ¯æµåˆ†æ**:

- å¦‚æœå­˜åœ¨é—´æ¥ä¿¡æ¯æµä»L_Håˆ°L_Lï¼Œåˆ™å­˜åœ¨ä¸­é—´å®‰å…¨çº§åˆ«L_Mï¼Œä½¿å¾—ï¼š
  - ä¿¡æ¯ä»L_Hæµå‘L_M
  - ä¿¡æ¯ä»L_Mæµå‘L_L
- ä½†æ ¹æ®NoWriteDownå’ŒNoReadUpï¼Œè¿™ç§é—´æ¥æµä¹Ÿä¸å¯èƒ½å­˜åœ¨

**æ­¥éª¤5ï¼šç»“è®º**:

- å¦‚æœä¿¡æ¯æµç­–ç•¥æ»¡è¶³NoWriteDownå’ŒNoReadUpï¼Œåˆ™ä¸å­˜åœ¨ä¿¡æ¯ä»é«˜å®‰å…¨çº§åˆ«æµå‘ä½å®‰å…¨çº§åˆ«
- å› æ­¤ï¼Œç³»ç»Ÿæ»¡è¶³ä¿¡æ¯æµå®‰å…¨
- è¯æ¯•

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[ä¿¡æ¯æµå®‰å…¨å®šç†] --> B[ä¿¡æ¯æµå®šä¹‰]
    B --> C[NoWriteDownçº¦æŸ]
    C --> D[NoReadUpçº¦æŸ]
    D --> E[é—´æ¥ä¿¡æ¯æµåˆ†æ]
    E --> F[ä¿¡æ¯æµå®‰å…¨]

    style A fill:#FFD700
    style F fill:#90EE90
```

### 4.3 RBACå¯ç»„åˆæ€§å®šç†

**å®šç†**ï¼šå¦‚æœä¸¤ä¸ªRBACç­–ç•¥éƒ½æ»¡è¶³è®¿é—®æ§åˆ¶å®‰å…¨ï¼Œåˆ™å®ƒä»¬çš„ç»„åˆä¹Ÿæ»¡è¶³è®¿é—®æ§åˆ¶å®‰å…¨ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾RBACç­–ç•¥Pâ‚ = (Rolesâ‚, Permissionsâ‚, Assignmentâ‚)å’ŒPâ‚‚ = (Rolesâ‚‚, Permissionsâ‚‚, Assignmentâ‚‚)éƒ½æ»¡è¶³è®¿é—®æ§åˆ¶å®‰å…¨ã€‚
å¦‚æœç³»ç»ŸSåŒæ—¶å®æ–½Pâ‚å’ŒPâ‚‚ï¼Œåˆ™ç»„åˆç­–ç•¥Pâ‚ âˆ§ Pâ‚‚ä¹Ÿæ»¡è¶³è®¿é—®æ§åˆ¶å®‰å…¨ã€‚

**è¯æ˜**ï¼ˆæ„é€ æ€§è¯æ˜ï¼‰ï¼š

**æ­¥éª¤1ï¼šRBACå®‰å…¨å®šä¹‰**:

- RBACå®‰å…¨è¦æ±‚ï¼šä¸»ä½“åªèƒ½é€šè¿‡è¢«åˆ†é…çš„è§’è‰²è®¿é—®å¯¹è±¡
- å¯¹äºç­–ç•¥Pï¼Œä¸»ä½“så¯ä»¥è®¿é—®å¯¹è±¡oå½“ä¸”ä»…å½“å­˜åœ¨è§’è‰²rï¼Œä½¿å¾—ï¼š
  - sè¢«åˆ†é…è§’è‰²rï¼ˆAssignment(s, r)ï¼‰
  - rå…·æœ‰è®¿é—®oçš„æƒé™ï¼ˆPermission(r, o)ï¼‰

**æ­¥éª¤2ï¼šç»„åˆç­–ç•¥å®šä¹‰**:

- ç»„åˆç­–ç•¥Pâ‚ âˆ§ Pâ‚‚è¦æ±‚ï¼šä¸»ä½“så¯ä»¥è®¿é—®å¯¹è±¡oå½“ä¸”ä»…å½“ï¼š
  - Pâ‚å…è®¸sè®¿é—®oï¼Œä¸”
  - Pâ‚‚å…è®¸sè®¿é—®o

**æ­¥éª¤3ï¼šå®‰å…¨ä¿æŒ**:

- å¦‚æœPâ‚å®‰å…¨ï¼Œåˆ™Pâ‚åªå…è®¸æˆæƒçš„è®¿é—®
- å¦‚æœPâ‚‚å®‰å…¨ï¼Œåˆ™Pâ‚‚åªå…è®¸æˆæƒçš„è®¿é—®
- ç»„åˆç­–ç•¥Pâ‚ âˆ§ Pâ‚‚åªå…è®¸Pâ‚å’ŒPâ‚‚éƒ½æˆæƒçš„è®¿é—®
- å› æ­¤ï¼ŒPâ‚ âˆ§ Pâ‚‚åªå…è®¸æˆæƒçš„è®¿é—®

**æ­¥éª¤4ï¼šç»“è®º**:

- ç»„åˆç­–ç•¥Pâ‚ âˆ§ Pâ‚‚æ»¡è¶³è®¿é—®æ§åˆ¶å®‰å…¨
- è¯æ¯•

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[RBACå¯ç»„åˆæ€§] --> B[RBACå®‰å…¨å®šä¹‰]
    B --> C[ç»„åˆç­–ç•¥å®šä¹‰]
    C --> D[å®‰å…¨ä¿æŒ]
    D --> E[ç»„åˆå®‰å…¨]

    style A fill:#FFD700
    style E fill:#90EE90
```

### 4.4 OAuth 2.0ä»¤ç‰Œå®‰å…¨å®šç†ï¼ˆPostgreSQL 18æ–°å¢ï¼‰

**å®šç†**ï¼šå¦‚æœOAuth 2.0ä»¤ç‰ŒéªŒè¯æ»¡è¶³å®Œæ•´æ€§æ£€æŸ¥ã€è¿‡æœŸæ£€æŸ¥å’ŒæˆæƒèŒƒå›´æ£€æŸ¥ï¼Œåˆ™ç³»ç»Ÿæ»¡è¶³OAuth 2.0å®‰å…¨æ€§ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾OAuth 2.0ç³»ç»ŸO = (Client, ResourceOwner, AuthorizationServer, ResourceServer)ï¼Œä»¤ç‰ŒéªŒè¯å‡½æ•° verify: Token â†’ Boolã€‚

ä»¤ç‰ŒT = (Header, Payload, Signature)ï¼Œå…¶ä¸­ï¼š

- HeaderåŒ…å«ç®—æ³•ä¿¡æ¯
- PayloadåŒ…å«ç”¨æˆ·ä¿¡æ¯ã€è¿‡æœŸæ—¶é—´ï¼ˆexpï¼‰ã€é¢å‘è€…ï¼ˆissï¼‰ã€å—ä¼—ï¼ˆaudï¼‰ã€æˆæƒèŒƒå›´ï¼ˆscopeï¼‰
- Signatureæ˜¯Tçš„ç­¾å

OAuth 2.0å®‰å…¨è¦æ±‚ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š

1. **å®Œæ•´æ€§æ£€æŸ¥**ï¼šverify_signature(T) = trueï¼ˆä»¤ç‰Œç­¾åæœ‰æ•ˆï¼‰
2. **è¿‡æœŸæ£€æŸ¥**ï¼šcurrent_time â‰¤ T.expï¼ˆä»¤ç‰Œæœªè¿‡æœŸï¼‰
3. **æˆæƒèŒƒå›´æ£€æŸ¥**ï¼šrequested_action âˆˆ T.scopeï¼ˆè¯·æ±‚æ“ä½œåœ¨æˆæƒèŒƒå›´å†…ï¼‰

å¦‚æœç³»ç»Ÿæ»¡è¶³è¿™ä¸‰ä¸ªæ¡ä»¶ï¼Œåˆ™OAuth 2.0ä»¤ç‰Œæ˜¯å®‰å…¨çš„ï¼Œå³ï¼š

- ä»¤ç‰Œä¸èƒ½è¢«ä¼ªé€ ï¼ˆå®Œæ•´æ€§ï¼‰
- ä»¤ç‰Œä¸èƒ½è¢«é‡æ”¾ï¼ˆæ—¶æ•ˆæ€§ï¼‰
- ä»¤ç‰Œä¸èƒ½è¢«æ»¥ç”¨ï¼ˆæˆæƒé™åˆ¶ï¼‰

**è¯æ˜**ï¼ˆæ„é€ æ€§è¯æ˜ï¼‰ï¼š

**æ­¥éª¤1ï¼šå®Œæ•´æ€§ä¿è¯**:

- å‡è®¾æ”»å‡»è€…å°è¯•ä¼ªé€ ä»¤ç‰ŒT'
- ç”±äºç­¾åæœºåˆ¶ï¼ˆå¦‚RS256ã€HS256ï¼‰ï¼Œæ”»å‡»è€…éœ€è¦çŸ¥é“ç§é’¥æ‰èƒ½ç”Ÿæˆæœ‰æ•ˆç­¾å
- å¦‚æœverify_signature(T') = falseï¼Œåˆ™ç³»ç»Ÿæ‹’ç»T'
- å› æ­¤ï¼Œåªæœ‰ç”±æˆæƒæœåŠ¡å™¨ç­¾å‘çš„ä»¤ç‰Œæ‰èƒ½é€šè¿‡éªŒè¯
- å®Œæ•´æ€§å¾—åˆ°ä¿è¯

**æ­¥éª¤2ï¼šæ—¶æ•ˆæ€§ä¿è¯**:

- å‡è®¾æ”»å‡»è€…å°è¯•é‡æ”¾è¿‡æœŸçš„ä»¤ç‰ŒT_old
- ç”±äºè¿‡æœŸæ£€æŸ¥ï¼Œcurrent_time > T_old.expæ—¶ï¼Œç³»ç»Ÿæ‹’ç»T_old
- å³ä½¿ä»¤ç‰Œè¢«æ‹¦æˆªï¼Œæ”»å‡»è€…ä¹Ÿåªèƒ½åœ¨æœ‰é™æ—¶é—´å†…ä½¿ç”¨
- é€šè¿‡è®¾ç½®çŸ­è¿‡æœŸæ—¶é—´ï¼ˆå¦‚15åˆ†é’Ÿï¼‰ï¼Œå¯ä»¥æœ€å°åŒ–é‡æ”¾æ”»å‡»çª—å£
- æ—¶æ•ˆæ€§å¾—åˆ°ä¿è¯

**æ­¥éª¤3ï¼šæˆæƒé™åˆ¶ä¿è¯**:

- å‡è®¾æ”»å‡»è€…å°è¯•ä½¿ç”¨ä»¤ç‰ŒTæ‰§è¡Œæœªæˆæƒæ“ä½œaction'
- ç”±äºæˆæƒèŒƒå›´æ£€æŸ¥ï¼Œaction' âˆ‰ T.scopeæ—¶ï¼Œç³»ç»Ÿæ‹’ç»è¯·æ±‚
- å³ä½¿æ”»å‡»è€…è·å¾—ä»¤ç‰Œï¼Œä¹Ÿåªèƒ½æ‰§è¡ŒæˆæƒèŒƒå›´å†…çš„æ“ä½œ
- æœ€å°æƒé™åŸåˆ™å¾—åˆ°å®æ–½
- æˆæƒé™åˆ¶å¾—åˆ°ä¿è¯

**æ­¥éª¤4ï¼šä¸RBACé›†æˆçš„å®‰å…¨ä¿æŒ**:

- åœ¨PostgreSQL 18ä¸­ï¼ŒOAuth 2.0ä»¤ç‰ŒéªŒè¯åï¼Œç³»ç»Ÿæå–ç”¨æˆ·è§’è‰²ä¿¡æ¯
- è§’è‰²ä¿¡æ¯ç”¨äºRBACè®¿é—®æ§åˆ¶
- å¦‚æœRBACæ»¡è¶³è®¿é—®æ§åˆ¶å®‰å…¨ï¼ˆå®šç†4.3ï¼‰ï¼Œåˆ™ç»„åˆç³»ç»Ÿä¹Ÿæ»¡è¶³è®¿é—®æ§åˆ¶å®‰å…¨
- OAuth 2.0æä¾›èº«ä»½éªŒè¯ï¼ŒRBACæä¾›æˆæƒ
- åŒé‡ä¿æŠ¤æœºåˆ¶ç¡®ä¿ç³»ç»Ÿå®‰å…¨

**æ­¥éª¤5ï¼šä¿¡æ¯æµå®‰å…¨ä¿æŒ**:

- OAuth 2.0ä»¤ç‰Œå¯ä»¥åŒ…å«å®‰å…¨çº§åˆ«ä¿¡æ¯ï¼ˆå¦‚clearance_levelï¼‰
- ç»“åˆMACæ¨¡å‹ï¼ˆå®šç†4.1ï¼‰ï¼Œç³»ç»Ÿå¯ä»¥å®ç°åŸºäºOAuth 2.0çš„ä¿¡æ¯æµå®‰å…¨
- å¦‚æœä»¤ç‰ŒåŒ…å«å®‰å…¨çº§åˆ«ä¿¡æ¯ï¼Œä¸”ç³»ç»Ÿå®æ–½Bell-LaPadulaæ¨¡å‹
- åˆ™ä¸å­˜åœ¨ä¿¡æ¯ä»é«˜å®‰å…¨çº§åˆ«æµå‘ä½å®‰å…¨çº§åˆ«
- ä¿¡æ¯æµå®‰å…¨å¾—åˆ°ä¿è¯

**æ­¥éª¤6ï¼šç»“è®º**:

- å¦‚æœOAuth 2.0ä»¤ç‰ŒéªŒè¯æ»¡è¶³å®Œæ•´æ€§æ£€æŸ¥ã€è¿‡æœŸæ£€æŸ¥å’ŒæˆæƒèŒƒå›´æ£€æŸ¥
- åˆ™ç³»ç»Ÿæ»¡è¶³OAuth 2.0å®‰å…¨æ€§ï¼ˆå®Œæ•´æ€§ã€æ—¶æ•ˆæ€§ã€æˆæƒé™åˆ¶ï¼‰
- ç»“åˆRBACå’ŒMACï¼Œç³»ç»Ÿå¯ä»¥å®ç°å®Œæ•´çš„å®‰å…¨ä¿è¯
- è¯æ¯•

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[OAuth 2.0ä»¤ç‰Œå®‰å…¨] --> B[å®Œæ•´æ€§æ£€æŸ¥]
    A --> C[è¿‡æœŸæ£€æŸ¥]
    A --> D[æˆæƒèŒƒå›´æ£€æŸ¥]

    B --> E[ç­¾åéªŒè¯]
    E --> F[é˜²ä¼ªé€ ]

    C --> G[æ—¶é—´æˆ³éªŒè¯]
    G --> H[é˜²é‡æ”¾]

    D --> I[èŒƒå›´éªŒè¯]
    I --> J[é˜²æ»¥ç”¨]

    F --> K[RBACé›†æˆ]
    H --> K
    J --> K

    K --> L[MACé›†æˆ]
    L --> M[å®Œæ•´å®‰å…¨ä¿è¯]

    style A fill:#FFD700
    style M fill:#90EE90
```

**PostgreSQL 18å®ç°éªŒè¯**ï¼š

```sql
-- OAuth 2.0ä»¤ç‰ŒéªŒè¯çš„PostgreSQL 18å®ç°
-- æ­¤å¤„å±•ç¤ºå¦‚ä½•åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­éªŒè¯ä»¤ç‰Œçš„ä¸‰ä¸ªå®‰å…¨æ¡ä»¶

CREATE OR REPLACE FUNCTION verify_oauth2_token(
    token_header TEXT,
    token_payload JSON,
    token_signature TEXT,
    requested_action TEXT
) RETURNS BOOLEAN AS $$
DECLARE
    is_valid BOOLEAN := false;
BEGIN
    -- æ­¥éª¤1ï¼šå®Œæ•´æ€§æ£€æŸ¥ï¼ˆç­¾åéªŒè¯ï¼‰
    -- æ³¨æ„ï¼šå®é™…å®ç°éœ€è¦ä½¿ç”¨pg_jwtæ‰©å±•æˆ–å¤–éƒ¨æœåŠ¡
    IF NOT verify_jwt_signature(token_header, token_payload, token_signature) THEN
        RAISE NOTICE 'Token signature verification failed';
        RETURN false;
    END IF;

    -- æ­¥éª¤2ï¼šè¿‡æœŸæ£€æŸ¥
    IF EXTRACT(EPOCH FROM NOW()) > (token_payload->>'exp')::BIGINT THEN
        RAISE NOTICE 'Token expired';
        RETURN false;
    END IF;

    -- æ­¥éª¤3ï¼šæˆæƒèŒƒå›´æ£€æŸ¥
    IF NOT token_payload->'scope' ? requested_action THEN
        RAISE NOTICE 'Action not in token scope';
        RETURN false;
    END IF;

    -- æ‰€æœ‰æ£€æŸ¥é€šè¿‡
    RETURN true;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- ä½¿ç”¨ç¤ºä¾‹
SELECT verify_oauth2_token(
    '{"alg":"RS256","typ":"JWT"}',
    '{"sub":"user123","exp":1735689600,"scope":["read","write"],"roles":["analyst"]}'::JSON,
    'signature_here',
    'read'
); -- è¿”å›trueï¼ˆå¦‚æœä»¤ç‰Œæœ‰æ•ˆä¸”æœªè¿‡æœŸï¼‰
```

**è¾¹ç¼˜åœºæ™¯æµ‹è¯•**ï¼š

```sql
-- æµ‹è¯•1ï¼šä»¤ç‰Œè¿‡æœŸ
SELECT verify_oauth2_token(
    '{"alg":"RS256","typ":"JWT"}',
    '{"sub":"user123","exp":1000000000,"scope":["read"]}'::JSON,  -- å·²è¿‡æœŸçš„æ—¶é—´æˆ³
    'signature_here',
    'read'
); -- åº”è¿”å›false

-- æµ‹è¯•2ï¼šæˆæƒèŒƒå›´ä¸è¶³
SELECT verify_oauth2_token(
    '{"alg":"RS256","typ":"JWT"}',
    '{"sub":"user123","exp":9999999999,"scope":["read"]}'::JSON,  -- åªæœ‰readæƒé™
    'signature_here',
    'write'  -- å°è¯•writeæ“ä½œ
); -- åº”è¿”å›false

-- æµ‹è¯•3ï¼šä»¤ç‰Œç­¾åæ— æ•ˆï¼ˆå‡è®¾verify_jwt_signatureå‡½æ•°å®ç°ï¼‰
SELECT verify_oauth2_token(
    '{"alg":"RS256","typ":"JWT"}',
    '{"sub":"user123","exp":9999999999,"scope":["read","write"]}'::JSON,
    'invalid_signature',  -- æ— æ•ˆç­¾å
    'read'
); -- åº”è¿”å›false

-- æµ‹è¯•4ï¼šå®Œå…¨åˆæ³•çš„ä»¤ç‰Œ
SELECT verify_oauth2_token(
    '{"alg":"RS256","typ":"JWT"}',
    '{"sub":"user123","exp":9999999999,"scope":["read","write"],"roles":["admin"]}'::JSON,
    'valid_signature',  -- æœ‰æ•ˆç­¾å
    'read'
); -- åº”è¿”å›true
```

---

## 5. å®é™…åº”ç”¨

### 5.1 PostgreSQL 18 è®¿é—®æ§åˆ¶å®ç°è¯¦è§£

**PostgreSQL 18è®¿é—®æ§åˆ¶æœºåˆ¶**ï¼š

PostgreSQL 18æ”¯æŒåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ï¼Œå¯ä»¥é€šè¿‡è§’è‰²ã€æƒé™å’ŒRLSå®ç°DACã€MACå’ŒRBACæ¨¡å‹ã€‚PostgreSQL 18è¿˜æ”¯æŒä¿¡æ¯æµå®‰å…¨çš„éƒ¨åˆ†å®ç°ã€‚

**PostgreSQL 18 RBACå®ç°**ï¼š

```sql
-- PostgreSQL 18ï¼šåˆ›å»ºè§’è‰²å±‚æ¬¡ï¼ˆRBACï¼Œå¸¦é”™è¯¯å¤„ç†ï¼‰
-- 1. åˆ›å»ºåŸºç¡€è§’è‰²ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'employee') THEN
            CREATE ROLE employee;
            RAISE NOTICE 'è§’è‰² employee åˆ›å»ºæˆåŠŸ';
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'analyst') THEN
            CREATE ROLE analyst;
            RAISE NOTICE 'è§’è‰² analyst åˆ›å»ºæˆåŠŸ';
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'manager') THEN
            CREATE ROLE manager;
            RAISE NOTICE 'è§’è‰² manager åˆ›å»ºæˆåŠŸ';
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'admin') THEN
            CREATE ROLE admin;
            RAISE NOTICE 'è§’è‰² admin åˆ›å»ºæˆåŠŸ';
        END IF;
    EXCEPTION
        WHEN duplicate_object THEN
            RAISE WARNING 'éƒ¨åˆ†è§’è‰²å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè§’è‰²å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 2. åˆ›å»ºè§’è‰²å±‚æ¬¡ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'employee') THEN
            RAISE WARNING 'è§’è‰² employee ä¸å­˜åœ¨';
            RETURN;
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'analyst') THEN
            RAISE WARNING 'è§’è‰² analyst ä¸å­˜åœ¨';
            RETURN;
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'manager') THEN
            RAISE WARNING 'è§’è‰² manager ä¸å­˜åœ¨';
            RETURN;
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'admin') THEN
            RAISE WARNING 'è§’è‰² admin ä¸å­˜åœ¨';
            RETURN;
        END IF;

        GRANT employee TO analyst;
        GRANT analyst TO manager;
        GRANT manager TO admin;
        RAISE NOTICE 'è§’è‰²å±‚æ¬¡åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN undefined_object THEN
            RAISE WARNING 'éƒ¨åˆ†è§’è‰²ä¸å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè§’è‰²å±‚æ¬¡å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 3. æˆäºˆæƒé™ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•æˆäºˆæƒé™';
            RETURN;
        END IF;

        GRANT SELECT ON accounts TO employee;
        GRANT SELECT, INSERT ON accounts TO analyst;
        GRANT SELECT, INSERT, UPDATE ON accounts TO manager;
        GRANT ALL ON accounts TO admin;
        RAISE NOTICE 'è§’è‰²æƒé™æˆäºˆæˆåŠŸ';
    EXCEPTION
        WHEN undefined_object THEN
            RAISE WARNING 'è¡¨æˆ–è§’è‰²ä¸å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'æˆäºˆæƒé™å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 4. åˆ›å»ºç”¨æˆ·å¹¶åˆ†é…è§’è‰²ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'user1') THEN
            CREATE USER user1 WITH PASSWORD 'pass1';
            RAISE NOTICE 'ç”¨æˆ· user1 åˆ›å»ºæˆåŠŸ';
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'user2') THEN
            CREATE USER user2 WITH PASSWORD 'pass2';
            RAISE NOTICE 'ç”¨æˆ· user2 åˆ›å»ºæˆåŠŸ';
        END IF;
    EXCEPTION
        WHEN duplicate_object THEN
            RAISE WARNING 'éƒ¨åˆ†ç”¨æˆ·å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºç”¨æˆ·å¤±è´¥: %', SQLERRM;
            RAISE;
    END;

    BEGIN
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'analyst') THEN
            RAISE WARNING 'è§’è‰² analyst ä¸å­˜åœ¨';
            RETURN;
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'user1') THEN
            RAISE WARNING 'ç”¨æˆ· user1 ä¸å­˜åœ¨';
            RETURN;
        END IF;

        GRANT analyst TO user1;
        RAISE NOTICE 'è§’è‰²æˆäºˆæˆåŠŸ: analyst -> user1';
    EXCEPTION
        WHEN undefined_object THEN
            RAISE WARNING 'è§’è‰²æˆ–ç”¨æˆ·ä¸å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'æˆäºˆè§’è‰²å¤±è´¥: %', SQLERRM;
            RAISE;
    END;

    BEGIN
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'manager') THEN
            RAISE WARNING 'è§’è‰² manager ä¸å­˜åœ¨';
            RETURN;
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_roles WHERE rolname = 'user2') THEN
            RAISE WARNING 'ç”¨æˆ· user2 ä¸å­˜åœ¨';
            RETURN;
        END IF;

        GRANT manager TO user2;
        RAISE NOTICE 'è§’è‰²æˆäºˆæˆåŠŸ: manager -> user2';
    EXCEPTION
        WHEN undefined_object THEN
            RAISE WARNING 'è§’è‰²æˆ–ç”¨æˆ·ä¸å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'æˆäºˆè§’è‰²å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 5. æµ‹è¯•RBACï¼ˆå¸¦é”™è¯¯å¤„ç†å’Œæ€§èƒ½æµ‹è¯•ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•æ‰§è¡Œæµ‹è¯•';
            RETURN;
        END IF;
        RAISE NOTICE 'å¼€å§‹æµ‹è¯•RBAC';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'æµ‹è¯•å‡†å¤‡å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- å…è®¸ï¼ˆanalystæœ‰SELECTæƒé™ï¼‰
EXPLAIN (ANALYZE, BUFFERS, TIMING)
SELECT * FROM accounts;

-- å…è®¸ï¼ˆanalystæœ‰INSERTæƒé™ï¼‰
-- INSERT INTO accounts VALUES (...);

-- æ‹’ç»ï¼ˆanalystæ²¡æœ‰UPDATEæƒé™ï¼‰
-- UPDATE accounts SET ...;
```

**PostgreSQL 18 MACå®ç°ï¼ˆé€šè¿‡RLSï¼‰**ï¼š

```sql
-- PostgreSQL 18ï¼šä½¿ç”¨RLSå®ç°MACï¼ˆBell-LaPadulaæ¨¡å‹ï¼Œå¸¦é”™è¯¯å¤„ç†ï¼‰
-- 1. åˆ›å»ºå®‰å…¨çº§åˆ«è¡¨ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'security_levels') THEN
            CREATE TABLE security_levels (
                level_name VARCHAR(20) PRIMARY KEY,
                level_value INTEGER NOT NULL
            );
            RAISE NOTICE 'è¡¨ security_levels åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'è¡¨ security_levels å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'è¡¨ security_levels å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- æ’å…¥å®‰å…¨çº§åˆ«æ•°æ®ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
DECLARE
    inserted_count INT;
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'security_levels') THEN
            RAISE WARNING 'è¡¨ security_levels ä¸å­˜åœ¨ï¼Œæ— æ³•æ’å…¥æ•°æ®';
            RETURN;
        END IF;

        INSERT INTO security_levels VALUES
            ('public', 1),
            ('internal', 2),
            ('confidential', 3),
            ('secret', 4)
        ON CONFLICT (level_name) DO NOTHING;

        GET DIAGNOSTICS inserted_count = ROW_COUNT;
        RAISE NOTICE 'æˆåŠŸæ’å…¥ % æ¡å®‰å…¨çº§åˆ«æ•°æ®', inserted_count;
    EXCEPTION
        WHEN unique_violation THEN
            RAISE WARNING 'éƒ¨åˆ†å®‰å…¨çº§åˆ«å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'æ’å…¥å®‰å…¨çº§åˆ«æ•°æ®å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 2. åˆ›å»ºæ•æ„Ÿæ•°æ®è¡¨ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'sensitive_data') THEN
            CREATE TABLE sensitive_data (
                id SERIAL PRIMARY KEY,
                data TEXT,
                classification VARCHAR(20) NOT NULL,
                created_at TIMESTAMPTZ DEFAULT NOW()
            );
            RAISE NOTICE 'è¡¨ sensitive_data åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'è¡¨ sensitive_data å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'è¡¨ sensitive_data å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 3. å¯ç”¨RLSï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'sensitive_data') THEN
            RAISE WARNING 'è¡¨ sensitive_data ä¸å­˜åœ¨ï¼Œæ— æ³•å¯ç”¨RLS';
            RETURN;
        END IF;

        ALTER TABLE sensitive_data ENABLE ROW LEVEL SECURITY;
        RAISE NOTICE 'è¡¨ sensitive_data å·²å¯ç”¨è¡Œçº§å®‰å…¨';
    EXCEPTION
        WHEN undefined_table THEN
            RAISE WARNING 'è¡¨ sensitive_data ä¸å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'å¯ç”¨RLSå¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 4. å®ç°ç®€å•å®‰å…¨æ€§ï¼ˆSimple Security Propertyï¼Œå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'sensitive_data') THEN
            RAISE WARNING 'è¡¨ sensitive_data ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'sensitive_data' AND policyname = 'simple_security_policy') THEN
            DROP POLICY simple_security_policy ON sensitive_data;
        END IF;

        CREATE POLICY simple_security_policy ON sensitive_data
            FOR SELECT
            USING (
                (SELECT level_value FROM security_levels WHERE level_name = classification) <=
                (SELECT level_value FROM security_levels WHERE level_name = current_setting('app.user_clearance'))
            );
        RAISE NOTICE 'ç®€å•å®‰å…¨æ€§ç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºç®€å•å®‰å…¨æ€§ç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 5. å®ç°*-å±æ€§ï¼ˆ*-Propertyï¼Œå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'sensitive_data') THEN
            RAISE WARNING 'è¡¨ sensitive_data ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'sensitive_data' AND policyname = 'star_property_policy') THEN
            DROP POLICY star_property_policy ON sensitive_data;
        END IF;

        CREATE POLICY star_property_policy ON sensitive_data
            FOR INSERT, UPDATE
            WITH CHECK (
                (SELECT level_value FROM security_levels WHERE level_name = classification) >=
                (SELECT level_value FROM security_levels WHERE level_name = current_setting('app.user_clearance'))
            );
        RAISE NOTICE '*-å±æ€§ç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»º*-å±æ€§ç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 6. æµ‹è¯•MACï¼ˆå¸¦é”™è¯¯å¤„ç†å’Œæ€§èƒ½æµ‹è¯•ï¼‰
DO $$
BEGIN
    PERFORM set_config('app.user_clearance', 'internal', false);
    RAISE NOTICE 'å½“å‰ç”¨æˆ·å®‰å…¨çº§åˆ«å·²è®¾ç½®ä¸ºinternal';
EXCEPTION
    WHEN OTHERS THEN
        RAISE WARNING 'è®¾ç½®ç”¨æˆ·å®‰å…¨çº§åˆ«å¤±è´¥: %', SQLERRM;
END $$;

DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'sensitive_data') THEN
            RAISE WARNING 'è¡¨ sensitive_data ä¸å­˜åœ¨ï¼Œæ— æ³•æ‰§è¡Œæµ‹è¯•';
            RETURN;
        END IF;
        RAISE NOTICE 'å¼€å§‹æµ‹è¯•MACï¼ˆåªèƒ½çœ‹åˆ°publicå’Œinternalçº§åˆ«çš„æ•°æ®ï¼‰';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'æµ‹è¯•å‡†å¤‡å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

EXPLAIN (ANALYZE, BUFFERS, TIMING)
SELECT * FROM sensitive_data;

-- æµ‹è¯•å†™å…¥ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    PERFORM set_config('app.user_clearance', 'confidential', false);
    RAISE NOTICE 'å½“å‰ç”¨æˆ·å®‰å…¨çº§åˆ«å·²è®¾ç½®ä¸ºconfidential';
EXCEPTION
    WHEN OTHERS THEN
        RAISE WARNING 'è®¾ç½®ç”¨æˆ·å®‰å…¨çº§åˆ«å¤±è´¥: %', SQLERRM;
END $$;

DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'sensitive_data') THEN
            RAISE WARNING 'è¡¨ sensitive_data ä¸å­˜åœ¨ï¼Œæ— æ³•æ’å…¥æ•°æ®';
            RETURN;
        END IF;

        INSERT INTO sensitive_data (data, classification)
        VALUES ('Secret data', 'secret');
        RAISE NOTICE 'æ•°æ®æ’å…¥æˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'æ’å…¥æ•°æ®å¤±è´¥ï¼ˆé¢„æœŸï¼šä¸èƒ½å†™å…¥æ›´é«˜å®‰å…¨çº§åˆ«ï¼‰: %', SQLERRM;
            -- è¿™æ˜¯é¢„æœŸçš„è¡Œä¸ºï¼Œä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸
    END;
END $$;
```

**PostgreSQL 18 OAuth 2.0èº«ä»½éªŒè¯**ï¼š

PostgreSQL 18å¼•å…¥äº†OAuth 2.0èº«ä»½éªŒè¯æ”¯æŒï¼Œç®€åŒ–äº†ä¸å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰ç³»ç»Ÿçš„é›†æˆï¼Œå¢å¼ºäº†æ•°æ®åº“çš„å®‰å…¨æ€§ã€‚

**OAuth 2.0çš„ç†è®ºåŸºç¡€**ï¼š

OAuth 2.0æ˜¯ä¸€ä¸ªæˆæƒæ¡†æ¶ï¼Œå…è®¸ç¬¬ä¸‰æ–¹åº”ç”¨è·å¾—å¯¹ç”¨æˆ·èµ„æºçš„æœ‰é™è®¿é—®æƒé™ã€‚åœ¨æ•°æ®åº“åœºæ™¯ä¸­ï¼ŒOAuth 2.0å¯ä»¥ç”¨äºï¼š

1. **å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰**ï¼šç”¨æˆ·é€šè¿‡OAuth 2.0æä¾›è€…è®¤è¯åï¼Œå¯ä»¥è®¿é—®æ•°æ®åº“
2. **ç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®**ï¼šå…è®¸ç¬¬ä¸‰æ–¹åº”ç”¨é€šè¿‡OAuth 2.0ä»¤ç‰Œè®¿é—®æ•°æ®åº“
3. **ç»†ç²’åº¦æƒé™æ§åˆ¶**ï¼šç»“åˆRBACå®ç°åŸºäºOAuth 2.0çš„æƒé™ç®¡ç†

**OAuth 2.0çš„å®‰å…¨æ¨¡å‹**ï¼š

```haskell
-- OAuth 2.0çš„å®‰å…¨å±æ€§
OAuth2Security :: Client -> ResourceOwner -> AuthorizationServer -> ResourceServer -> SecurityProperties

-- OAuth 2.0çš„å®‰å…¨å±æ€§åŒ…æ‹¬ï¼š
-- 1. ä»¤ç‰Œä¿å¯†æ€§ï¼šè®¿é—®ä»¤ç‰Œåªèƒ½è¢«æˆæƒå®¢æˆ·ç«¯ä½¿ç”¨
-- 2. ä»¤ç‰Œå®Œæ•´æ€§ï¼šä»¤ç‰Œä¸èƒ½è¢«ç¯¡æ”¹
-- 3. ä»¤ç‰Œæ—¶æ•ˆæ€§ï¼šä»¤ç‰Œæœ‰è¿‡æœŸæ—¶é—´
-- 4. æˆæƒèŒƒå›´é™åˆ¶ï¼šä»¤ç‰Œåªèƒ½è®¿é—®æˆæƒèŒƒå›´å†…çš„èµ„æº
```

**OAuth 2.0ä¸RBACçš„å…³ç³»**ï¼š

OAuth 2.0å¯ä»¥ä¸RBACæ¨¡å‹ç»“åˆä½¿ç”¨ï¼š

- **OAuth 2.0æä¾›èº«ä»½éªŒè¯**ï¼šéªŒè¯ç”¨æˆ·èº«ä»½
- **RBACæä¾›æˆæƒ**ï¼šåŸºäºè§’è‰²åˆ†é…æƒé™
- **ä»¤ç‰ŒåŒ…å«è§’è‰²ä¿¡æ¯**ï¼šJWTä»¤ç‰Œå¯ä»¥åŒ…å«ç”¨æˆ·è§’è‰²ä¿¡æ¯

**PostgreSQL 18 OAuth 2.0å®ç°**ï¼š

```sql
-- PostgreSQL 18ï¼šé…ç½®OAuth 2.0èº«ä»½éªŒè¯
-- 1. é…ç½®pg_hba.conf
-- host all all 0.0.0.0/0 oauth2

-- 2. é…ç½®postgresql.conf
-- oauth2_issuer = 'https://oauth-provider.example.com'
-- oauth2_client_id = 'postgresql-client'
-- oauth2_client_secret = 'client-secret'
-- oauth2_redirect_uri = 'https://db.example.com/oauth2/callback'

-- 3. OAuth 2.0æˆæƒç æµç¨‹
-- æ­¥éª¤1ï¼šç”¨æˆ·è®¿é—®æ•°æ®åº“ï¼Œè¢«é‡å®šå‘åˆ°OAuthæä¾›è€…
-- æ­¥éª¤2ï¼šç”¨æˆ·åœ¨OAuthæä¾›è€…å¤„è®¤è¯
-- æ­¥éª¤3ï¼šOAuthæä¾›è€…è¿”å›æˆæƒç 
-- æ­¥éª¤4ï¼šæ•°æ®åº“ä½¿ç”¨æˆæƒç æ¢å–è®¿é—®ä»¤ç‰Œ
-- æ­¥éª¤5ï¼šæ•°æ®åº“éªŒè¯ä»¤ç‰Œå¹¶åˆ›å»ºä¼šè¯

-- PostgreSQL 18ï¼šOAuth 2.0ä»¤ç‰ŒéªŒè¯
-- æ•°æ®åº“ä¼šéªŒè¯ï¼š
-- 1. ä»¤ç‰Œç­¾åï¼ˆJWTï¼‰
-- 2. ä»¤ç‰Œè¿‡æœŸæ—¶é—´
-- 3. ä»¤ç‰Œé¢å‘è€…ï¼ˆissï¼‰
-- 4. ä»¤ç‰Œå—ä¼—ï¼ˆaudï¼‰
-- 5. ç”¨æˆ·è§’è‰²å’Œæƒé™ï¼ˆä»ä»¤ç‰Œclaimsä¸­æå–ï¼‰

-- PostgreSQL 18ï¼šOAuth 2.0ä¸RBACé›†æˆ
-- 1. ä»JWTä»¤ç‰Œä¸­æå–ç”¨æˆ·è§’è‰²
-- 2. å°†è§’è‰²æ˜ å°„åˆ°PostgreSQLè§’è‰²
-- 3. åº”ç”¨RBACæƒé™æ§åˆ¶

-- ç¤ºä¾‹ï¼šJWTä»¤ç‰Œç»“æ„
-- {
--   "sub": "user123",
--   "iss": "https://oauth-provider.example.com",
--   "aud": "postgresql-client",
--   "exp": 1234567890,
--   "roles": ["analyst", "developer"],
--   "scope": "read write"
-- }
```

**OAuth 2.0çš„ä¿¡æ¯æµå®‰å…¨åˆ†æ**ï¼š

OAuth 2.0ä»¤ç‰Œå¯ä»¥åŒ…å«å®‰å…¨çº§åˆ«ä¿¡æ¯ï¼Œç”¨äºå®ç°ä¿¡æ¯æµå®‰å…¨ï¼š

```sql
-- OAuth 2.0ä»¤ç‰Œä¸­çš„å®‰å…¨çº§åˆ«ä¿¡æ¯
-- {
--   "sub": "user123",
--   "clearance_level": "confidential",
--   "roles": ["analyst"]
-- }

-- ç»“åˆRLSç­–ç•¥ä½¿ç”¨
CREATE POLICY oauth_clearance_policy ON sensitive_data
    FOR SELECT
    USING (
        (SELECT level_value FROM security_levels WHERE level_name = classification) <=
        (SELECT level_value FROM security_levels
         WHERE level_name = current_setting('app.oauth_clearance_level'))
    );
```

**OAuth 2.0çš„å®‰å…¨æœ€ä½³å®è·µ**ï¼š

```sql
-- 1. ä½¿ç”¨HTTPSä¼ è¾“ä»¤ç‰Œ
-- 2. éªŒè¯ä»¤ç‰Œç­¾å
-- 3. æ£€æŸ¥ä»¤ç‰Œè¿‡æœŸæ—¶é—´
-- 4. é™åˆ¶ä»¤ç‰Œä½œç”¨åŸŸ
-- 5. å®šæœŸè½®æ¢å®¢æˆ·ç«¯å¯†é’¥
-- 6. è®°å½•OAuth 2.0è®¿é—®æ—¥å¿—
-- 7. å®ç°ä»¤ç‰Œæ’¤é”€æœºåˆ¶

-- PostgreSQL 18ï¼šOAuth 2.0è®¿é—®æ—¥å¿—ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'oauth2_access_log') THEN
            CREATE TABLE oauth2_access_log (
                id SERIAL PRIMARY KEY,
                user_id VARCHAR(100),
                client_id VARCHAR(100),
                access_time TIMESTAMPTZ DEFAULT NOW(),
                ip_address INET,
                action VARCHAR(50),
                resource VARCHAR(200)
            );
            RAISE NOTICE 'OAuth 2.0è®¿é—®æ—¥å¿—è¡¨ oauth2_access_log åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'OAuth 2.0è®¿é—®æ—¥å¿—è¡¨ oauth2_access_log å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'OAuth 2.0è®¿é—®æ—¥å¿—è¡¨ oauth2_access_log å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºOAuth 2.0è®¿é—®æ—¥å¿—è¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;
```

**PostgreSQL 18ä¿¡æ¯æµå®‰å…¨å®ç°**ï¼š

```sql
-- PostgreSQL 18ï¼šå®ç°ä¿¡æ¯æµå®‰å…¨ï¼ˆNoWriteDownå’ŒNoReadUpï¼Œå¸¦é”™è¯¯å¤„ç†ï¼‰
-- 1. åˆ›å»ºä¿¡æ¯æµç­–ç•¥è¡¨ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'information_flow_policy') THEN
            CREATE TABLE information_flow_policy (
                source_level VARCHAR(20),
                sink_level VARCHAR(20),
                allowed BOOLEAN,
                PRIMARY KEY (source_level, sink_level)
            );
            RAISE NOTICE 'ä¿¡æ¯æµç­–ç•¥è¡¨ information_flow_policy åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'ä¿¡æ¯æµç­–ç•¥è¡¨ information_flow_policy å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'ä¿¡æ¯æµç­–ç•¥è¡¨ information_flow_policy å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºä¿¡æ¯æµç­–ç•¥è¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 2. å®ç°NoWriteDownç­–ç•¥ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
-- é«˜å®‰å…¨çº§åˆ«ä¸èƒ½å†™å…¥ä½å®‰å…¨çº§åˆ«
DO $$
DECLARE
    inserted_count INT;
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'information_flow_policy') THEN
            RAISE WARNING 'è¡¨ information_flow_policy ä¸å­˜åœ¨ï¼Œæ— æ³•æ’å…¥æ•°æ®';
            RETURN;
        END IF;

        INSERT INTO information_flow_policy VALUES
            ('secret', 'confidential', false),
            ('secret', 'internal', false),
            ('secret', 'public', false),
            ('confidential', 'internal', false),
            ('confidential', 'public', false),
            ('internal', 'public', false)
        ON CONFLICT (source_level, sink_level) DO NOTHING;

        GET DIAGNOSTICS inserted_count = ROW_COUNT;
        RAISE NOTICE 'æˆåŠŸæ’å…¥ % æ¡ä¿¡æ¯æµç­–ç•¥æ•°æ®', inserted_count;
    EXCEPTION
        WHEN unique_violation THEN
            RAISE WARNING 'éƒ¨åˆ†ä¿¡æ¯æµç­–ç•¥å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'æ’å…¥ä¿¡æ¯æµç­–ç•¥æ•°æ®å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 3. å®ç°NoReadUpç­–ç•¥
-- ä½å®‰å…¨çº§åˆ«ä¸èƒ½è¯»å–é«˜å®‰å…¨çº§åˆ«
-- ï¼ˆé€šè¿‡RLSç­–ç•¥å®ç°ï¼Œè§ä¸Šé¢çš„simple_security_policyï¼‰

-- 4. åˆ›å»ºä¿¡æ¯æµæ£€æŸ¥å‡½æ•°ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        CREATE OR REPLACE FUNCTION check_information_flow(
            source_level VARCHAR(20),
            sink_level VARCHAR(20)
        ) RETURNS BOOLEAN AS $$
        DECLARE
            allowed BOOLEAN;
        BEGIN
            -- å‚æ•°éªŒè¯
            IF source_level IS NULL OR sink_level IS NULL THEN
                RAISE EXCEPTION 'source_levelå’Œsink_levelä¸èƒ½ä¸ºç©º';
            END IF;

            SELECT information_flow_policy.allowed INTO allowed
            FROM information_flow_policy
            WHERE information_flow_policy.source_level = check_information_flow.source_level
              AND information_flow_policy.sink_level = check_information_flow.sink_level;

            RETURN COALESCE(allowed, true);  -- é»˜è®¤å…è®¸
        END;
        $$ LANGUAGE plpgsql;
        RAISE NOTICE 'ä¿¡æ¯æµæ£€æŸ¥å‡½æ•° check_information_flow åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºä¿¡æ¯æµæ£€æŸ¥å‡½æ•°å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 5. åœ¨RLSç­–ç•¥ä¸­ä½¿ç”¨ä¿¡æ¯æµæ£€æŸ¥ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'sensitive_data') THEN
            RAISE WARNING 'è¡¨ sensitive_data ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;
        IF NOT EXISTS (SELECT 1 FROM pg_proc WHERE proname = 'check_information_flow') THEN
            RAISE WARNING 'å‡½æ•° check_information_flow ä¸å­˜åœ¨';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'sensitive_data' AND policyname = 'information_flow_policy') THEN
            DROP POLICY information_flow_policy ON sensitive_data;
        END IF;

        CREATE POLICY information_flow_policy ON sensitive_data
            FOR ALL
            USING (
                check_information_flow(
                    current_setting('app.user_clearance'),
                    classification
                )
            );
        RAISE NOTICE 'ä¿¡æ¯æµç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºä¿¡æ¯æµç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;
```

### 5.2 SQLite 3.45 è®¿é—®æ§åˆ¶å¯¹æ¯”

**SQLite 3.45è®¿é—®æ§åˆ¶æ”¯æŒ**ï¼š

SQLite 3.45çš„è®¿é—®æ§åˆ¶æ”¯æŒä¸PostgreSQL 18ä¸åŒã€‚

| ç‰¹æ€§ | PostgreSQL 18 | SQLite 3.45 |
|------|--------------|-------------|
| **RBAC** | âœ… æ”¯æŒ | âš ï¸ æœ‰é™æ”¯æŒ |
| **MAC** | âš ï¸ éƒ¨åˆ†æ”¯æŒï¼ˆé€šè¿‡RLSï¼‰ | âŒ ä¸æ”¯æŒ |
| **ä¿¡æ¯æµå®‰å…¨** | âš ï¸ éƒ¨åˆ†æ”¯æŒï¼ˆé€šè¿‡RLSï¼‰ | âŒ ä¸æ”¯æŒ |
| **RLS** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |

**SQLite 3.45è®¿é—®æ§åˆ¶**ï¼š

```sql
-- SQLite 3.45ï¼šä¸æ”¯æŒåŸç”ŸRBAC
-- éœ€è¦åœ¨åº”ç”¨å±‚å®ç°è®¿é—®æ§åˆ¶

-- SQLite 3.45ï¼šé€šè¿‡è§†å›¾æ¨¡æ‹Ÿè®¿é—®æ§åˆ¶
CREATE VIEW user_accounts AS
SELECT * FROM accounts
WHERE user_id = (SELECT value FROM app_settings WHERE key = 'current_user_id');
```

**OAuth 2.0å®é™…åº”ç”¨æ¡ˆä¾‹**ï¼š

```sql
-- åœºæ™¯ï¼šå¾®æœåŠ¡æ¶æ„ä¸­çš„OAuth 2.0å•ç‚¹ç™»å½•
-- 1. é…ç½®OAuth 2.0æä¾›è€…
-- postgresql.conf
-- oauth2_issuer = 'https://auth.example.com'
-- oauth2_client_id = 'postgresql-service'
-- oauth2_client_secret = 'secret-key'

-- 2. ç”¨æˆ·é€šè¿‡OAuth 2.0è®¤è¯åè®¿é—®æ•°æ®åº“
-- æ­¥éª¤1ï¼šç”¨æˆ·è®¿é—®åº”ç”¨
-- æ­¥éª¤2ï¼šåº”ç”¨é‡å®šå‘åˆ°OAuthæä¾›è€…
-- æ­¥éª¤3ï¼šç”¨æˆ·åœ¨OAuthæä¾›è€…å¤„è®¤è¯
-- æ­¥éª¤4ï¼šOAuthæä¾›è€…è¿”å›æˆæƒç 
-- æ­¥éª¤5ï¼šåº”ç”¨ä½¿ç”¨æˆæƒç æ¢å–è®¿é—®ä»¤ç‰Œ
-- æ­¥éª¤6ï¼šåº”ç”¨ä½¿ç”¨è®¿é—®ä»¤ç‰Œè¿æ¥æ•°æ®åº“

-- 3. æ•°æ®åº“éªŒè¯ä»¤ç‰Œå¹¶åˆ›å»ºä¼šè¯
-- PostgreSQL 18ä¼šè‡ªåŠ¨ï¼š
-- - éªŒè¯JWTä»¤ç‰Œç­¾å
-- - æ£€æŸ¥ä»¤ç‰Œè¿‡æœŸæ—¶é—´
-- - æå–ç”¨æˆ·è§’è‰²å’Œæƒé™
-- - åˆ›å»ºæ•°æ®åº“ä¼šè¯

-- 4. ç»“åˆRLSå®ç°ç»†ç²’åº¦æƒé™æ§åˆ¶
CREATE POLICY oauth_user_policy ON user_data
    FOR SELECT
    USING (
        current_setting('app.oauth_user_id') = user_id::TEXT
        OR current_setting('app.oauth_roles') LIKE '%admin%'
    );

-- 5. ç›‘æ§OAuth 2.0è®¿é—®
SELECT
    user_id,
    client_id,
    action,
    COUNT(*) as access_count,
    MAX(access_time) as last_access
FROM oauth2_access_log
WHERE access_time > NOW() - INTERVAL '1 day'
GROUP BY user_id, client_id, action
ORDER BY access_count DESC;
```

### 5.3 å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹

#### åœºæ™¯1ï¼šæ”¿åºœç³»ç»Ÿçš„åˆ†çº§å®‰å…¨è®¿é—®æ§åˆ¶

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

- æ”¿åºœä¿¡æ¯ç³»ç»Ÿï¼Œéœ€è¦åˆ†çº§å®‰å…¨è®¿é—®æ§åˆ¶
- éœ€è¦å®ç°Bell-LaPadulaæ¨¡å‹
- éœ€è¦æ»¡è¶³åˆè§„è¦æ±‚

**æŠ€æœ¯æŒ‘æˆ˜**ï¼š

- å®ç°MACæ¨¡å‹
- ä¿è¯ä¿¡æ¯æµå®‰å…¨
- æ»¡è¶³åˆè§„è¦æ±‚

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åœºæ™¯ï¼šæ”¿åºœç³»ç»Ÿåˆ†çº§å®‰å…¨è®¿é—®æ§åˆ¶
-- 1. åˆ›å»ºå®‰å…¨çº§åˆ«
CREATE TABLE security_classifications (
    level_name VARCHAR(20) PRIMARY KEY,
    level_value INTEGER NOT NULL UNIQUE
);

INSERT INTO security_classifications VALUES
    ('unclassified', 1),
    ('confidential', 2),
    ('secret', 3),
    ('top_secret', 4);

-- 2. åˆ›å»ºæ–‡æ¡£è¡¨
CREATE TABLE government_documents (
    id SERIAL PRIMARY KEY,
    title VARCHAR(200),
    content TEXT,
    classification VARCHAR(20) NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 3. å¯ç”¨RLS
ALTER TABLE government_documents ENABLE ROW LEVEL SECURITY;

-- 4. å®ç°Bell-LaPadulaæ¨¡å‹
-- ç®€å•å®‰å…¨æ€§ï¼šåªèƒ½è¯»å–â‰¤å…¶å®‰å…¨çº§åˆ«çš„æ–‡æ¡£
CREATE POLICY simple_security ON government_documents
    FOR SELECT
    USING (
        (SELECT level_value FROM security_classifications WHERE level_name = classification) <=
        (SELECT level_value FROM security_classifications WHERE level_name = current_setting('app.user_clearance'))
    );

-- *-å±æ€§ï¼šåªèƒ½å†™å…¥â‰¥å…¶å®‰å…¨çº§åˆ«çš„æ–‡æ¡£
CREATE POLICY star_property ON government_documents
    FOR INSERT, UPDATE
    WITH CHECK (
        (SELECT level_value FROM security_classifications WHERE level_name = classification) >=
        (SELECT level_value FROM security_classifications WHERE level_name = current_setting('app.user_clearance'))
    );

-- 5. æµ‹è¯•è®¿é—®æ§åˆ¶
-- ç”¨æˆ·1ï¼šconfidentialçº§åˆ«
SET app.user_clearance = 'confidential';
SELECT * FROM government_documents;
-- åªèƒ½çœ‹åˆ°unclassifiedå’Œconfidentialçº§åˆ«çš„æ–‡æ¡£

INSERT INTO government_documents (title, content, classification)
VALUES ('Secret Document', 'Content', 'secret');
-- æ‹’ç»ï¼ˆä¸èƒ½å†™å…¥æ›´é«˜å®‰å…¨çº§åˆ«ï¼‰

-- ç”¨æˆ·2ï¼štop_secretçº§åˆ«
SET app.user_clearance = 'top_secret';
SELECT * FROM government_documents;
-- å¯ä»¥çœ‹åˆ°æ‰€æœ‰çº§åˆ«çš„æ–‡æ¡£

INSERT INTO government_documents (title, content, classification)
VALUES ('Top Secret Document', 'Content', 'top_secret');
-- å…è®¸ï¼ˆå¯ä»¥å†™å…¥ç›¸åŒæˆ–æ›´é«˜å®‰å…¨çº§åˆ«ï¼‰
```

**æ€§èƒ½æ•°æ®**ï¼š

| æŒ‡æ ‡ | æ— è®¿é—®æ§åˆ¶ | æœ‰è®¿é—®æ§åˆ¶ | è¯´æ˜ |
|------|-----------|-----------|------|
| **æŸ¥è¯¢æ€§èƒ½** | 8ms | 10ms | RLSå¢åŠ å°‘é‡å¼€é”€ |
| **å®‰å…¨æ€§** | âŒ æ—  | âœ… ä¿è¯ | MACä¿è¯å®‰å…¨ |
| **åˆè§„æ€§** | âŒ ä¸ç¬¦åˆ | âœ… ç¬¦åˆ | æ»¡è¶³åˆè§„è¦æ±‚ |

#### åœºæ™¯2ï¼šä¼ä¸šç³»ç»Ÿçš„RBACè®¿é—®æ§åˆ¶

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

- ä¼ä¸šä¿¡æ¯ç³»ç»Ÿï¼Œéœ€è¦åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- éœ€è¦æ”¯æŒè§’è‰²å±‚æ¬¡å’Œæƒé™ç»§æ‰¿
- éœ€è¦çµæ´»ç®¡ç†æƒé™

**æŠ€æœ¯æŒ‘æˆ˜**ï¼š

- å®ç°RBACæ¨¡å‹
- æ”¯æŒè§’è‰²å±‚æ¬¡
- ä¼˜åŒ–æƒé™ç®¡ç†

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åœºæ™¯ï¼šä¼ä¸šç³»ç»ŸRBACè®¿é—®æ§åˆ¶
-- 1. åˆ›å»ºè§’è‰²å±‚æ¬¡
CREATE ROLE employee;
CREATE ROLE developer;
CREATE ROLE team_lead;
CREATE ROLE department_manager;
CREATE ROLE ceo;

-- 2. å»ºç«‹è§’è‰²å±‚æ¬¡
GRANT employee TO developer;
GRANT developer TO team_lead;
GRANT team_lead TO department_manager;
GRANT department_manager TO ceo;

-- 3. åˆ›å»ºèµ„æºè¡¨
CREATE TABLE projects (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    description TEXT,
    status VARCHAR(20),
    created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE project_tasks (
    id SERIAL PRIMARY KEY,
    project_id INTEGER REFERENCES projects(id),
    title VARCHAR(200),
    assignee_id INTEGER,
    status VARCHAR(20),
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 4. æˆäºˆæƒé™
-- employeeï¼šåªèƒ½æŸ¥çœ‹é¡¹ç›®
GRANT SELECT ON projects TO employee;

-- developerï¼šå¯ä»¥æŸ¥çœ‹å’Œåˆ›å»ºä»»åŠ¡
GRANT SELECT ON projects TO developer;
GRANT SELECT, INSERT ON project_tasks TO developer;

-- team_leadï¼šå¯ä»¥ç®¡ç†ä»»åŠ¡
GRANT SELECT ON projects TO team_lead;
GRANT ALL ON project_tasks TO team_lead;

-- department_managerï¼šå¯ä»¥ç®¡ç†é¡¹ç›®
GRANT ALL ON projects TO department_manager;
GRANT ALL ON project_tasks TO department_manager;

-- ceoï¼šæ‰€æœ‰æƒé™
GRANT ALL ON projects TO ceo;
GRANT ALL ON project_tasks TO ceo;

-- 5. åˆ›å»ºç”¨æˆ·å¹¶åˆ†é…è§’è‰²
CREATE USER dev1 WITH PASSWORD 'dev1_pass';
CREATE USER lead1 WITH PASSWORD 'lead1_pass';

GRANT developer TO dev1;
GRANT team_lead TO lead1;

-- 6. æµ‹è¯•RBAC
SET ROLE dev1;
SELECT * FROM projects;  -- å…è®¸
INSERT INTO project_tasks (project_id, title) VALUES (1, 'Task 1');  -- å…è®¸
UPDATE project_tasks SET status = 'done' WHERE id = 1;  -- æ‹’ç»ï¼ˆdeveloperæ²¡æœ‰UPDATEæƒé™ï¼‰

SET ROLE lead1;
SELECT * FROM projects;  -- å…è®¸ï¼ˆç»§æ‰¿developeræƒé™ï¼‰
UPDATE project_tasks SET status = 'done' WHERE id = 1;  -- å…è®¸ï¼ˆteam_leadæœ‰UPDATEæƒé™ï¼‰
```

**æ€§èƒ½æ•°æ®**ï¼š

| æŒ‡æ ‡ | æ— RBAC | æœ‰RBAC | è¯´æ˜ |
|------|--------|--------|------|
| **æŸ¥è¯¢æ€§èƒ½** | 5ms | 6ms | RBACå¢åŠ å°‘é‡å¼€é”€ |
| **æƒé™ç®¡ç†** | âŒ å›°éš¾ | âœ… çµæ´» | RBACä¾¿äºç®¡ç† |
| **å®‰å…¨æ€§** | âŒ ä½ | âœ… é«˜ | RBACä¿è¯å®‰å…¨ |

### 5.4 è®¿é—®æ§åˆ¶ç­–ç•¥é€‰æ‹©æœ€ä½³å®è·µ

**PostgreSQL 18æœ€ä½³å®è·µ**ï¼š

```sql
-- 1. è®¿é—®æ§åˆ¶æ¨¡å‹é€‰æ‹©
-- DACï¼šå°å‹ç³»ç»Ÿï¼Œçµæ´»æ€§è¦æ±‚é«˜
-- MACï¼šé«˜å®‰å…¨è¦æ±‚ï¼Œåˆ†çº§å®‰å…¨
-- RBACï¼šä¼ä¸šç³»ç»Ÿï¼Œè§’è‰²ç®¡ç†

-- 2. RBACå®ç°
-- åˆ›å»ºè§’è‰²å±‚æ¬¡
-- æˆäºˆæƒé™åˆ°è§’è‰²
-- åˆ†é…è§’è‰²åˆ°ç”¨æˆ·

-- 3. MACå®ç°ï¼ˆé€šè¿‡RLSï¼‰
-- å®šä¹‰å®‰å…¨çº§åˆ«
-- å®ç°ç®€å•å®‰å…¨æ€§å’Œ*-å±æ€§
-- ä½¿ç”¨RLSç­–ç•¥

-- 4. ä¿¡æ¯æµå®‰å…¨
-- å®ç°NoWriteDownå’ŒNoReadUpç­–ç•¥
-- ä½¿ç”¨RLSæ£€æŸ¥ä¿¡æ¯æµ

-- 5. æƒé™å®¡è®¡
-- å®šæœŸå®¡è®¡æƒé™åˆ†é…
-- ç›‘æ§è®¿é—®æ—¥å¿—
SELECT * FROM pg_stat_user_tables;
```

### 5.5 æ¨¡å‹é€‰æ‹©å»ºè®®

**é€‰æ‹©PostgreSQL 18è®¿é—®æ§åˆ¶çš„åœºæ™¯**ï¼š

âœ… **æ¨èåœºæ™¯**ï¼š

- ä¼ä¸šä¿¡æ¯ç³»ç»Ÿ
- éœ€è¦åˆ†çº§å®‰å…¨
- éœ€è¦è§’è‰²ç®¡ç†
- éœ€è¦æ»¡è¶³åˆè§„è¦æ±‚

âŒ **ä¸æ¨èåœºæ™¯**ï¼š

- ç®€å•åº”ç”¨
- ä¸éœ€è¦è®¿é—®æ§åˆ¶
- å•ç”¨æˆ·ç³»ç»Ÿ

**é€‰æ‹©SQLite 3.45çš„åœºæ™¯**ï¼š

âœ… **æ¨èåœºæ™¯**ï¼š

- å•æœºåº”ç”¨
- åº”ç”¨å±‚å®ç°è®¿é—®æ§åˆ¶
- å°æ•°æ®é‡

âŒ **ä¸æ¨èåœºæ™¯**ï¼š

- éœ€è¦RBAC
- éœ€è¦MAC
- éœ€è¦ä¿¡æ¯æµå®‰å…¨

---

## 6. ç›¸å…³æ–‡æ¡£

### 6.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)
- [å®‰å…¨ç­–ç•¥ä¸éå¹²æ‰°-é€»è¾‘æ¡†æ¶ä¸è¯æ˜](./07.01-å®‰å…¨ç­–ç•¥ä¸éå¹²æ‰°-é€»è¾‘æ¡†æ¶ä¸è¯æ˜.md)
- [è¡Œçº§å®‰å…¨-RLSç­–ç•¥è¯­ä¹‰ä¸ä¸å¯é€ƒé€¸æ€§è¯æ˜](./07.03-è¡Œçº§å®‰å…¨-RLSç­–ç•¥è¯­ä¹‰ä¸ä¸å¯é€ƒé€¸æ€§è¯æ˜.md)

---

## 7. å‚è€ƒæ–‡çŒ®

### 7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®

- **Bell, D. E., & LaPadula, L. J. (1973). "Secure Computer Systems: Mathematical Foundations."**
  - æŠ¥å‘Š: MITRE Technical Report 1973
  - **é‡è¦æ€§**: è®¿é—®æ§åˆ¶æ¨¡å‹çš„ç»å…¸è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†Bell-LaPadulaæ¨¡å‹

- **Denning, D. E. (1976). "A Lattice Model of Secure Information Flow."**
  - ä¼šè®®: CACM 1976
  - **é‡è¦æ€§**: ä¿¡æ¯æµå®‰å…¨çš„ç»å…¸æ¨¡å‹
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†æ ¼æ¨¡å‹

### 7.2 PostgreSQLå®ç°ç›¸å…³

- **[PostgreSQLå®˜æ–¹æ–‡æ¡£ - è®¿é—®æ§åˆ¶](<https://www.postgresql.org/docs/current/user-manag.html>)**
  - PostgreSQLè®¿é—®æ§åˆ¶å®ç°è¯´æ˜

### 7.3 Wikipediaæ¡ç›®

1. **Access control** (<https://en.wikipedia.org/wiki/Access_control>)
   - **Wikipediaæ¡ç›®**: Access control
   - **é‡è¦æ€§**: è®¿é—®æ§åˆ¶çš„æƒå¨å®šä¹‰å’ŒåŸºæœ¬æ¦‚å¿µ
   - **æ ¸å¿ƒå†…å®¹**: è®¿é—®æ§åˆ¶çš„å®šä¹‰ã€æ¨¡å‹ï¼ˆDACã€MACã€RBACï¼‰å’Œåº”ç”¨
   - **ä¸æœ¬æ–‡æ¡£çš„å…³ç³»**: æœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†è®¿é—®æ§åˆ¶æ¨¡å‹ï¼ˆRBACã€MACï¼‰çš„æ­£ç¡®æ€§ï¼Œæ˜¯å¯¹Wikipediaæ¡ç›®çš„æ‰©å±•å’Œæ·±åŒ–
   - **å‡†ç¡®æ€§**: Wikipediaæ¡ç›®æä¾›äº†å‡†ç¡®çš„åŸºç¡€æ¦‚å¿µï¼Œæœ¬æ–‡æ¡£åœ¨æ­¤åŸºç¡€ä¸Šæä¾›äº†å½¢å¼åŒ–è¯æ˜å’ŒPostgreSQLå®ç°åˆ†æ
   - **æ·±åº¦è§£è¯»**: Wikipediaæ¡ç›®ä»‹ç»äº†è®¿é—®æ§åˆ¶çš„åŸºæœ¬æ¦‚å¿µï¼šæ§åˆ¶è°å¯ä»¥è®¿é—®ä»€ä¹ˆèµ„æºï¼ŒåŒ…æ‹¬è‡ªä¸»è®¿é—®æ§åˆ¶ï¼ˆDACï¼‰ã€å¼ºåˆ¶è®¿é—®æ§åˆ¶ï¼ˆMACï¼‰å’ŒåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ã€‚æœ¬æ–‡æ¡£æ·±å…¥åˆ†æäº†è®¿é—®æ§åˆ¶çš„å½¢å¼åŒ–ç†è®ºï¼ŒåŒ…æ‹¬RBACå’ŒMACçš„æ•°å­¦å®šä¹‰ã€å®‰å…¨æ€§è´¨çš„å½¢å¼åŒ–è¯æ˜ï¼Œä»¥åŠå¦‚ä½•åœ¨PostgreSQLä¸­å®ç°è¿™äº›æ¨¡å‹ã€‚ç‰¹åˆ«æ˜¯ï¼Œæœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†è®¿é—®æ§åˆ¶æ¨¡å‹çš„å®‰å…¨æ€§å’Œæ­£ç¡®æ€§ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•é€šè¿‡RLSï¼ˆè¡Œçº§å®‰å…¨ï¼‰å®ç°ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶ã€‚
   - **æ‰¹åˆ¤æ€§åˆ†æ**:
     - **ç†è®ºå±€é™æ€§**: è®¿é—®æ§åˆ¶è™½ç„¶èƒ½å¤Ÿæä¾›åŸºæœ¬çš„å®‰å…¨ä¿è¯ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹å¯èƒ½ä¸å¤Ÿçµæ´»ã€‚ä¾‹å¦‚ï¼ŒDACå¯èƒ½è¿‡äºå®½æ¾ï¼ŒMACå¯èƒ½è¿‡äºä¸¥æ ¼ã€‚Wikipediaæ¡ç›®è™½ç„¶æåˆ°äº†è¿™ä¸€ç‚¹ï¼Œä½†æœªæ·±å…¥åˆ†æä¸åŒè®¿é—®æ§åˆ¶æ¨¡å‹çš„é€‚ç”¨åœºæ™¯å’Œå±€é™æ€§ã€‚
     - **é€‚ç”¨åœºæ™¯é™åˆ¶**: è®¿é—®æ§åˆ¶é€‚åˆéœ€è¦æ˜ç¡®æƒé™ç®¡ç†çš„ç³»ç»Ÿï¼Œä½†å¯¹äºåŠ¨æ€æƒé™æˆ–ä¸Šä¸‹æ–‡ç›¸å…³çš„æƒé™ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨æ›´å¤æ‚çš„æ¨¡å‹ã€‚Wikipediaæ¡ç›®æœªå……åˆ†è®¨è®ºè¿™äº›é™åˆ¶ã€‚
     - **äº‰è®®è§‚ç‚¹**: å­¦æœ¯ç•Œå¯¹è®¿é—®æ§åˆ¶æ¨¡å‹çš„é€‰æ‹©å­˜åœ¨äº‰è®®ã€‚ä¸€äº›ç ”ç©¶è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´çµæ´»çš„æ¨¡å‹ï¼ˆå¦‚åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ABACï¼‰ï¼Œè€Œå¦ä¸€äº›ç ”ç©¶åˆ™è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´ç®€å•çš„æ¨¡å‹ï¼ˆå¦‚RBACï¼‰ã€‚è¿‘å¹´æ¥ï¼Œé›¶ä¿¡ä»»æ¶æ„å’ŒåŸºäºä¸Šä¸‹æ–‡çš„è®¿é—®æ§åˆ¶å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚
     - **åç»­ç ”ç©¶å‘å±•**: è¿‘å¹´æ¥ï¼Œè®¿é—®æ§åˆ¶çš„ç ”ç©¶é‡ç‚¹è½¬å‘äº†åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ï¼ˆABACï¼‰ã€é›¶ä¿¡ä»»æ¶æ„ã€åŸºäºä¸Šä¸‹æ–‡çš„è®¿é—®æ§åˆ¶ï¼Œä»¥åŠè®¿é—®æ§åˆ¶åœ¨äº‘ç¯å¢ƒä¸‹çš„å®ç°ã€‚è¿™äº›å‘å±•åœ¨Wikipediaæ¡ç›®ä¸­éœ€è¦è¿›ä¸€æ­¥æ›´æ–°ã€‚
   - **ä¸å…¶ä»–å¼•ç”¨çš„å…³è”**: æœ¬æ¡ç›®ä¸"Role-based access control"å’Œ"Mandatory access control"æ¡ç›®ç›´æ¥ç›¸å…³ï¼ŒRBACå’ŒMACæ˜¯è®¿é—®æ§åˆ¶çš„å…·ä½“æ¨¡å‹ã€‚åŒæ—¶ï¼Œæœ¬æ¡ç›®ä¹Ÿä¸"Information flow (information theory)"æ¡ç›®å…³è”ï¼Œå±•ç¤ºäº†ä¿¡æ¯æµå®‰å…¨åœ¨è®¿é—®æ§åˆ¶ä¸­çš„åº”ç”¨ã€‚

2. **Role-based access control** (<https://en.wikipedia.org/wiki/Role-based_access_control>)
   - **Wikipediaæ¡ç›®**: Role-based access control
   - **é‡è¦æ€§**: RBACæ¨¡å‹çš„æƒå¨å®šä¹‰
   - **æ ¸å¿ƒå†…å®¹**: RBACçš„åŸç†ã€æ¨¡å‹ï¼ˆRBAC0ã€RBAC1ã€RBAC2ã€RBAC3ï¼‰å’Œåº”ç”¨
   - **ä¸æœ¬æ–‡æ¡£çš„å…³ç³»**: æœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†RBACæ¨¡å‹çš„å®‰å…¨æ€§å’Œæ­£ç¡®æ€§ï¼Œå¹¶æä¾›äº†PostgreSQLå®ç°
   - **å‡†ç¡®æ€§**: Wikipediaæ¡ç›®æä¾›äº†RBACçš„åŸºç¡€çŸ¥è¯†ï¼Œæœ¬æ–‡æ¡£æä¾›äº†å½¢å¼åŒ–è¯æ˜å’Œå®ç°åˆ†æ
   - **æ·±åº¦è§£è¯»**: Wikipediaæ¡ç›®ä»‹ç»äº†RBACçš„åŸºæœ¬æ¦‚å¿µï¼šé€šè¿‡è§’è‰²ç®¡ç†æƒé™ï¼Œç”¨æˆ·è¢«åˆ†é…åˆ°è§’è‰²ï¼Œè§’è‰²è¢«æˆäºˆæƒé™ã€‚æœ¬æ–‡æ¡£æ·±å…¥åˆ†æäº†RBACçš„å½¢å¼åŒ–ç†è®ºï¼ŒåŒ…æ‹¬RBACæ¨¡å‹çš„å±‚æ¬¡ç»“æ„ï¼ˆRBAC0ã€RBAC1ã€RBAC2ã€RBAC3ï¼‰ã€RBACå®‰å…¨æ€§è´¨çš„å½¢å¼åŒ–è¯æ˜ï¼Œä»¥åŠå¦‚ä½•åœ¨PostgreSQLä¸­å®ç°RBACã€‚ç‰¹åˆ«æ˜¯ï¼Œæœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†RBACæ¨¡å‹çš„å®‰å…¨æ€§å’Œæ­£ç¡®æ€§ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•é€šè¿‡PostgreSQLçš„è§’è‰²ç³»ç»Ÿå®ç°RBACã€‚
   - **æ‰¹åˆ¤æ€§åˆ†æ**:
     - **ç†è®ºå±€é™æ€§**: RBACè™½ç„¶è¢«å¹¿æ³›é‡‡ç”¨ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹å¯èƒ½ä¸å¤Ÿçµæ´»ã€‚ä¾‹å¦‚ï¼Œå¯¹äºåŠ¨æ€æƒé™æˆ–ä¸Šä¸‹æ–‡ç›¸å…³çš„æƒé™ï¼ŒRBACå¯èƒ½ä¸å¤Ÿè¡¨è¾¾ã€‚Wikipediaæ¡ç›®è™½ç„¶æåˆ°äº†è¿™ä¸€ç‚¹ï¼Œä½†æœªæ·±å…¥åˆ†æRBACçš„é€‚ç”¨åœºæ™¯å’Œå±€é™æ€§ã€‚
     - **é€‚ç”¨åœºæ™¯é™åˆ¶**: RBACé€‚åˆç»„ç»‡ç»“æ„ç›¸å¯¹å›ºå®šçš„ç³»ç»Ÿï¼Œä½†å¯¹äºåŠ¨æ€ç»„ç»‡æˆ–ä¸´æ—¶æƒé™ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨æ›´çµæ´»çš„æ¨¡å‹ã€‚Wikipediaæ¡ç›®æœªå……åˆ†è®¨è®ºè¿™äº›é™åˆ¶ã€‚
     - **äº‰è®®è§‚ç‚¹**: å­¦æœ¯ç•Œå¯¹RBACçš„å®ç°æ–¹å¼å­˜åœ¨äº‰è®®ã€‚ä¸€äº›ç ”ç©¶è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´å¤æ‚çš„æ¨¡å‹ï¼ˆå¦‚RBAC3ï¼‰ï¼Œè€Œå¦ä¸€äº›ç ”ç©¶åˆ™è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´ç®€å•çš„æ¨¡å‹ï¼ˆå¦‚RBAC0ï¼‰ã€‚è¿‘å¹´æ¥ï¼ŒåŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ï¼ˆABACï¼‰å’Œé›¶ä¿¡ä»»æ¶æ„å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚
     - **åç»­ç ”ç©¶å‘å±•**: è¿‘å¹´æ¥ï¼ŒRBACçš„ç ”ç©¶é‡ç‚¹è½¬å‘äº†RBACä¸ABACçš„èåˆã€RBACåœ¨äº‘ç¯å¢ƒä¸‹çš„å®ç°ï¼Œä»¥åŠRBACä¸é›¶ä¿¡ä»»æ¶æ„çš„å…³è”ã€‚è¿™äº›å‘å±•åœ¨Wikipediaæ¡ç›®ä¸­éœ€è¦è¿›ä¸€æ­¥æ›´æ–°ã€‚
   - **ä¸å…¶ä»–å¼•ç”¨çš„å…³è”**: æœ¬æ¡ç›®ä¸"Access control"æ¡ç›®ç›´æ¥ç›¸å…³ï¼ŒRBACæ˜¯è®¿é—®æ§åˆ¶çš„ä¸€ç§æ¨¡å‹ã€‚åŒæ—¶ï¼Œæœ¬æ¡ç›®ä¹Ÿä¸"Mandatory access control"æ¡ç›®å…³è”ï¼Œå±•ç¤ºäº†ä¸¤ç§è®¿é—®æ§åˆ¶æ¨¡å‹çš„å¯¹æ¯”ã€‚

3. **Mandatory access control** (<https://en.wikipedia.org/wiki/Mandatory_access_control>)
   - **Wikipediaæ¡ç›®**: Mandatory access control
   - **é‡è¦æ€§**: MACæ¨¡å‹çš„æƒå¨å®šä¹‰
   - **æ ¸å¿ƒå†…å®¹**: MACçš„åŸç†ã€Bell-LaPadulaæ¨¡å‹å’Œåº”ç”¨
   - **ä¸æœ¬æ–‡æ¡£çš„å…³ç³»**: æœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†Bell-LaPadulaæ¨¡å‹çš„ä¿¡æ¯æµå®‰å…¨æ€§ï¼Œå¹¶æä¾›äº†PostgreSQLå®ç°
   - **å‡†ç¡®æ€§**: Wikipediaæ¡ç›®æä¾›äº†MACçš„åŸºç¡€çŸ¥è¯†ï¼Œæœ¬æ–‡æ¡£æä¾›äº†å½¢å¼åŒ–è¯æ˜å’Œå®ç°åˆ†æ
   - **æ·±åº¦è§£è¯»**: Wikipediaæ¡ç›®ä»‹ç»äº†MACçš„åŸºæœ¬æ¦‚å¿µï¼šç³»ç»Ÿå¼ºåˆ¶å®æ–½çš„è®¿é—®æ§åˆ¶ï¼Œé€šå¸¸åŸºäºå®‰å…¨çº§åˆ«ï¼ˆå¦‚æœºå¯†ã€ç§˜å¯†ã€ç»å¯†ï¼‰ã€‚æœ¬æ–‡æ¡£æ·±å…¥åˆ†æäº†MACçš„å½¢å¼åŒ–ç†è®ºï¼ŒåŒ…æ‹¬Bell-LaPadulaæ¨¡å‹çš„æ•°å­¦å®šä¹‰ï¼ˆç®€å•å®‰å…¨æ€§ã€*-å±æ€§ï¼‰ã€ä¿¡æ¯æµå®‰å…¨çš„å½¢å¼åŒ–è¯æ˜ï¼Œä»¥åŠå¦‚ä½•åœ¨PostgreSQLä¸­å®ç°MACã€‚ç‰¹åˆ«æ˜¯ï¼Œæœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†Bell-LaPadulaæ¨¡å‹çš„ä¿¡æ¯æµå®‰å…¨æ€§ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•é€šè¿‡RLSå®ç°MACã€‚
   - **æ‰¹åˆ¤æ€§åˆ†æ**:
     - **ç†è®ºå±€é™æ€§**: MACè™½ç„¶èƒ½å¤Ÿæä¾›å¼ºå®‰å…¨ä¿è¯ï¼Œä½†å¯èƒ½è¿‡äºä¸¥æ ¼ï¼Œå½±å“ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚ä¾‹å¦‚ï¼ŒBell-LaPadulaæ¨¡å‹å¯èƒ½é˜»æ­¢åˆæ³•çš„ä¿¡æ¯å…±äº«ã€‚Wikipediaæ¡ç›®è™½ç„¶æåˆ°äº†è¿™ä¸€ç‚¹ï¼Œä½†æœªæ·±å…¥åˆ†æMACçš„é€‚ç”¨åœºæ™¯å’Œå±€é™æ€§ã€‚
     - **é€‚ç”¨åœºæ™¯é™åˆ¶**: MACé€‚åˆéœ€è¦ä¸¥æ ¼å®‰å…¨ä¿è¯çš„ç³»ç»Ÿï¼ˆå¦‚å†›äº‹ã€æ”¿åºœï¼‰ï¼Œä½†å¯¹äºä¸€èˆ¬ä¼ä¸šåº”ç”¨ï¼Œå¯èƒ½è¿‡äºå¤æ‚ã€‚Wikipediaæ¡ç›®æœªå……åˆ†è®¨è®ºè¿™äº›é™åˆ¶ã€‚
     - **äº‰è®®è§‚ç‚¹**: å­¦æœ¯ç•Œå¯¹MACçš„å®ç°æ–¹å¼å­˜åœ¨äº‰è®®ã€‚ä¸€äº›ç ”ç©¶è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´çµæ´»çš„æ¨¡å‹ï¼ˆå¦‚Bibaæ¨¡å‹ï¼‰ï¼Œè€Œå¦ä¸€äº›ç ”ç©¶åˆ™è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´ä¸¥æ ¼çš„æ¨¡å‹ã€‚è¿‘å¹´æ¥ï¼ŒMACåœ¨äº‘ç¯å¢ƒä¸‹çš„å®ç°å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚
     - **åç»­ç ”ç©¶å‘å±•**: è¿‘å¹´æ¥ï¼ŒMACçš„ç ”ç©¶é‡ç‚¹è½¬å‘äº†MACåœ¨äº‘ç¯å¢ƒä¸‹çš„å®ç°ã€MACä¸é›¶ä¿¡ä»»æ¶æ„çš„å…³è”ï¼Œä»¥åŠMACä¸å·®åˆ†éšç§çš„é›†æˆã€‚è¿™äº›å‘å±•åœ¨Wikipediaæ¡ç›®ä¸­éœ€è¦è¿›ä¸€æ­¥æ›´æ–°ã€‚
   - **ä¸å…¶ä»–å¼•ç”¨çš„å…³è”**: æœ¬æ¡ç›®ä¸"Access control"æ¡ç›®ç›´æ¥ç›¸å…³ï¼ŒMACæ˜¯è®¿é—®æ§åˆ¶çš„ä¸€ç§æ¨¡å‹ã€‚åŒæ—¶ï¼Œæœ¬æ¡ç›®ä¹Ÿä¸"Information flow (information theory)"æ¡ç›®å…³è”ï¼Œå±•ç¤ºäº†MACå¦‚ä½•ä¿è¯ä¿¡æ¯æµå®‰å…¨ã€‚

4. **Differential privacy** (<https://en.wikipedia.org/wiki/Differential_privacy>)
   - **Wikipediaæ¡ç›®**: Differential privacy
   - **é‡è¦æ€§**: å·®åˆ†éšç§çš„æƒå¨å®šä¹‰
   - **æ ¸å¿ƒå†…å®¹**: å·®åˆ†éšç§çš„å®šä¹‰ã€æœºåˆ¶å’Œåº”ç”¨
   - **ä¸æœ¬æ–‡æ¡£çš„å…³ç³»**: æœ¬æ–‡æ¡£åœ¨ä¿¡æ¯æµå®‰å…¨ä¸­è€ƒè™‘äº†éšç§ä¿æŠ¤ï¼Œå·®åˆ†éšç§æ˜¯ç›¸å…³æŠ€æœ¯
   - **å‡†ç¡®æ€§**: Wikipediaæ¡ç›®æä¾›äº†å·®åˆ†éšç§çš„åŸºç¡€çŸ¥è¯†ï¼Œæœ¬æ–‡æ¡£å±•ç¤ºäº†åœ¨æ•°æ®åº“å®‰å…¨ä¸­çš„åº”ç”¨
   - **æ·±åº¦è§£è¯»**: Wikipediaæ¡ç›®ä»‹ç»äº†å·®åˆ†éšç§çš„åŸºæœ¬æ¦‚å¿µï¼šä¸€ç§éšç§ä¿æŠ¤æŠ€æœ¯ï¼Œé€šè¿‡åœ¨æŸ¥è¯¢ç»“æœä¸­æ·»åŠ å™ªå£°æ¥ä¿æŠ¤ä¸ªäººéšç§ï¼ŒåŒæ—¶ä¿æŒç»Ÿè®¡ä¿¡æ¯çš„å‡†ç¡®æ€§ã€‚æœ¬æ–‡æ¡£æ·±å…¥åˆ†æäº†å·®åˆ†éšç§åœ¨æ•°æ®åº“å®‰å…¨ä¸­çš„åº”ç”¨ï¼ŒåŒ…æ‹¬å¦‚ä½•åœ¨ä¿¡æ¯æµå®‰å…¨ä¸­é›†æˆå·®åˆ†éšç§ã€å¦‚ä½•å¹³è¡¡éšç§ä¿æŠ¤å’Œæ•°æ®å¯ç”¨æ€§ï¼Œä»¥åŠå¦‚ä½•åœ¨PostgreSQLä¸­å®ç°å·®åˆ†éšç§ã€‚ç‰¹åˆ«æ˜¯ï¼Œæœ¬æ–‡æ¡£å±•ç¤ºäº†å·®åˆ†éšç§å¦‚ä½•ä¸è®¿é—®æ§åˆ¶ç»“åˆï¼Œæä¾›æ›´å¼ºçš„éšç§ä¿æŠ¤ã€‚
   - **æ‰¹åˆ¤æ€§åˆ†æ**:
     - **ç†è®ºå±€é™æ€§**: å·®åˆ†éšç§è™½ç„¶èƒ½å¤Ÿæä¾›éšç§ä¿æŠ¤ï¼Œä½†éœ€è¦ä»”ç»†é€‰æ‹©å™ªå£°å‚æ•°ã€‚è¿‡å¤§çš„å™ªå£°å¯èƒ½å½±å“æ•°æ®å¯ç”¨æ€§ï¼Œè¿‡å°çš„å™ªå£°å¯èƒ½æ— æ³•æä¾›è¶³å¤Ÿçš„éšç§ä¿æŠ¤ã€‚Wikipediaæ¡ç›®è™½ç„¶æåˆ°äº†è¿™ä¸€ç‚¹ï¼Œä½†æœªæ·±å…¥åˆ†æå™ªå£°å‚æ•°çš„é€‰æ‹©æ–¹æ³•ã€‚
     - **é€‚ç”¨åœºæ™¯é™åˆ¶**: å·®åˆ†éšç§é€‚åˆç»Ÿè®¡æŸ¥è¯¢å’Œèšåˆåˆ†æï¼Œä½†å¯¹äºç²¾ç¡®æŸ¥è¯¢æˆ–éœ€è¦å®Œæ•´æ•°æ®è®¿é—®çš„åœºæ™¯ï¼Œå¯èƒ½ä¸é€‚ç”¨ã€‚Wikipediaæ¡ç›®æœªå……åˆ†è®¨è®ºè¿™äº›é™åˆ¶ã€‚
     - **äº‰è®®è§‚ç‚¹**: å­¦æœ¯ç•Œå¯¹å·®åˆ†éšç§çš„å®ç°æ–¹å¼å­˜åœ¨äº‰è®®ã€‚ä¸€äº›ç ”ç©¶è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´å¤æ‚çš„å™ªå£°æœºåˆ¶ï¼Œè€Œå¦ä¸€äº›ç ”ç©¶åˆ™è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´ç®€å•çš„æœºåˆ¶ã€‚è¿‘å¹´æ¥ï¼Œæœ¬åœ°å·®åˆ†éšç§å’Œè”é‚¦å­¦ä¹ ä¸­çš„å·®åˆ†éšç§å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚
     - **åç»­ç ”ç©¶å‘å±•**: è¿‘å¹´æ¥ï¼Œå·®åˆ†éšç§çš„ç ”ç©¶é‡ç‚¹è½¬å‘äº†æœ¬åœ°å·®åˆ†éšç§ã€è”é‚¦å­¦ä¹ ä¸­çš„å·®åˆ†éšç§ã€å·®åˆ†éšç§ä¸æœºå™¨å­¦ä¹ çš„é›†æˆï¼Œä»¥åŠå·®åˆ†éšç§åœ¨äº‘ç¯å¢ƒä¸‹çš„å®ç°ã€‚è¿™äº›å‘å±•åœ¨Wikipediaæ¡ç›®ä¸­éœ€è¦è¿›ä¸€æ­¥æ›´æ–°ã€‚
   - **ä¸å…¶ä»–å¼•ç”¨çš„å…³è”**: æœ¬æ¡ç›®ä¸"Information flow (information theory)"æ¡ç›®ç›¸å…³ï¼Œå·®åˆ†éšç§å¯ä»¥ç”¨äºä¿æŠ¤ä¿¡æ¯æµä¸­çš„éšç§ã€‚åŒæ—¶ï¼Œæœ¬æ¡ç›®ä¹Ÿä¸"Access control"æ¡ç›®å…³è”ï¼Œå±•ç¤ºäº†éšç§ä¿æŠ¤åœ¨è®¿é—®æ§åˆ¶ä¸­çš„åº”ç”¨ã€‚

5. **Information flow (information theory)** (<https://en.wikipedia.org/wiki/Information_flow_(information_theory)>)
   - **Wikipediaæ¡ç›®**: Information flow (information theory)
   - **é‡è¦æ€§**: ä¿¡æ¯æµçš„å®šä¹‰å’Œç‰¹æ€§
   - **æ ¸å¿ƒå†…å®¹**: ä¿¡æ¯æµçš„å®šä¹‰ã€å®‰å…¨æ¨¡å‹å’Œåº”ç”¨
   - **ä¸æœ¬æ–‡æ¡£çš„å…³ç³»**: æœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†ä¿¡æ¯æµå®‰å…¨æ¨¡å‹ï¼Œå¹¶æä¾›äº†æ ¼æ¨¡å‹çš„å½¢å¼åŒ–è¯æ˜
   - **å‡†ç¡®æ€§**: Wikipediaæ¡ç›®æä¾›äº†ä¿¡æ¯æµçš„åŸºç¡€çŸ¥è¯†ï¼Œæœ¬æ–‡æ¡£æä¾›äº†å½¢å¼åŒ–æ¨¡å‹å’Œè¯æ˜
   - **æ·±åº¦è§£è¯»**: Wikipediaæ¡ç›®ä»‹ç»äº†ä¿¡æ¯æµçš„åŸºæœ¬æ¦‚å¿µï¼šä¿¡æ¯åœ¨ç³»ç»Ÿä¸­çš„æµåŠ¨è·¯å¾„ï¼ŒåŒ…æ‹¬ä¿¡æ¯æµçš„å®šä¹‰ã€å®‰å…¨æ¨¡å‹ï¼ˆå¦‚æ ¼æ¨¡å‹ï¼‰å’Œåº”ç”¨ã€‚æœ¬æ–‡æ¡£æ·±å…¥åˆ†æäº†ä¿¡æ¯æµå®‰å…¨çš„å½¢å¼åŒ–ç†è®ºï¼ŒåŒ…æ‹¬æ ¼æ¨¡å‹çš„æ•°å­¦å®šä¹‰ã€ä¿¡æ¯æµå®‰å…¨æ€§è´¨çš„å½¢å¼åŒ–è¯æ˜ï¼Œä»¥åŠå¦‚ä½•åœ¨PostgreSQLä¸­å®ç°ä¿¡æ¯æµå®‰å…¨ã€‚ç‰¹åˆ«æ˜¯ï¼Œæœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†ä¿¡æ¯æµå®‰å…¨æ¨¡å‹çš„ä¸å¹²æ‰°æ€§è´¨ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•é€šè¿‡è®¿é—®æ§åˆ¶ä¿è¯ä¿¡æ¯æµå®‰å…¨ã€‚
   - **æ‰¹åˆ¤æ€§åˆ†æ**:
     - **ç†è®ºå±€é™æ€§**: ä¿¡æ¯æµå®‰å…¨è™½ç„¶èƒ½å¤Ÿæä¾›å¼ºå®‰å…¨ä¿è¯ï¼Œä½†å¯èƒ½è¿‡äºä¸¥æ ¼ï¼Œå½±å“ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚ä¾‹å¦‚ï¼Œä¸¥æ ¼çš„ä¿¡æ¯æµæ§åˆ¶å¯èƒ½é˜»æ­¢åˆæ³•çš„ä¿¡æ¯å…±äº«ã€‚Wikipediaæ¡ç›®è™½ç„¶æåˆ°äº†è¿™ä¸€ç‚¹ï¼Œä½†æœªæ·±å…¥åˆ†æä¿¡æ¯æµå®‰å…¨çš„é€‚ç”¨åœºæ™¯å’Œå±€é™æ€§ã€‚
     - **é€‚ç”¨åœºæ™¯é™åˆ¶**: ä¿¡æ¯æµå®‰å…¨é€‚åˆéœ€è¦ä¸¥æ ¼å®‰å…¨ä¿è¯çš„ç³»ç»Ÿï¼ˆå¦‚å†›äº‹ã€æ”¿åºœï¼‰ï¼Œä½†å¯¹äºä¸€èˆ¬ä¼ä¸šåº”ç”¨ï¼Œå¯èƒ½è¿‡äºå¤æ‚ã€‚Wikipediaæ¡ç›®æœªå……åˆ†è®¨è®ºè¿™äº›é™åˆ¶ã€‚
     - **äº‰è®®è§‚ç‚¹**: å­¦æœ¯ç•Œå¯¹ä¿¡æ¯æµå®‰å…¨çš„å®ç°æ–¹å¼å­˜åœ¨äº‰è®®ã€‚ä¸€äº›ç ”ç©¶è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´çµæ´»çš„æ¨¡å‹ï¼ˆå¦‚å»åˆ†ç±»ï¼‰ï¼Œè€Œå¦ä¸€äº›ç ”ç©¶åˆ™è®¤ä¸ºåº”è¯¥ä½¿ç”¨æ›´ä¸¥æ ¼çš„æ¨¡å‹ã€‚è¿‘å¹´æ¥ï¼Œä¿¡æ¯æµå®‰å…¨åœ¨äº‘ç¯å¢ƒä¸‹çš„å®ç°å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚
     - **åç»­ç ”ç©¶å‘å±•**: è¿‘å¹´æ¥ï¼Œä¿¡æ¯æµå®‰å…¨çš„ç ”ç©¶é‡ç‚¹è½¬å‘äº†ä¿¡æ¯æµå®‰å…¨åœ¨äº‘ç¯å¢ƒä¸‹çš„å®ç°ã€ä¿¡æ¯æµå®‰å…¨ä¸é›¶ä¿¡ä»»æ¶æ„çš„å…³è”ï¼Œä»¥åŠä¿¡æ¯æµå®‰å…¨ä¸å·®åˆ†éšç§çš„é›†æˆã€‚è¿™äº›å‘å±•åœ¨Wikipediaæ¡ç›®ä¸­éœ€è¦è¿›ä¸€æ­¥æ›´æ–°ã€‚
   - **ä¸å…¶ä»–å¼•ç”¨çš„å…³è”**: æœ¬æ¡ç›®ä¸"Access control"å’Œ"Mandatory access control"æ¡ç›®ç›´æ¥ç›¸å…³ï¼Œä¿¡æ¯æµå®‰å…¨æ˜¯è®¿é—®æ§åˆ¶çš„é‡è¦æ–¹é¢ã€‚åŒæ—¶ï¼Œæœ¬æ¡ç›®ä¹Ÿä¸"Differential privacy"æ¡ç›®å…³è”ï¼Œå±•ç¤ºäº†éšç§ä¿æŠ¤åœ¨ä¿¡æ¯æµå®‰å…¨ä¸­çš„åº”ç”¨ã€‚

### 7.4 å¤§å­¦è¯¾ç¨‹

1. **MIT 6.033 Computer Systems Engineering** (<https://web.mit.edu/6.033/www/>)
   - **è¯¾ç¨‹**: MIT 6.033 Computer Systems Engineering
   - **é‡è¦æ€§**: è®¡ç®—æœºç³»ç»Ÿå·¥ç¨‹çš„ç»¼åˆè¯¾ç¨‹
   - **æ ¸å¿ƒå†…å®¹**: ç³»ç»Ÿè®¾è®¡ã€å®‰å…¨æ€§ã€è®¿é—®æ§åˆ¶ã€ä¿¡æ¯æµå®‰å…¨
   - **ä¸æœ¬æ–‡æ¡£çš„å…³ç³»**: æœ¬æ–‡æ¡£æ¶µç›–äº†è¯¾ç¨‹ä¸­æ¶‰åŠçš„è®¿é—®æ§åˆ¶æ¨¡å‹ï¼Œç‰¹åˆ«æ˜¯Lecture 11: Securityéƒ¨åˆ†
   - **è¯¾ç¨‹è®²ä¹‰**: Lecture 11: Security, Lecture 12: Access Control
   - **æ‰¹åˆ¤æ€§åˆ†æ**: è¯¾ç¨‹æä¾›äº†ç³»ç»Ÿå®‰å…¨çš„ç»¼åˆè§†è§’ï¼Œæœ¬æ–‡æ¡£ä¸“æ³¨äºæ•°æ®åº“è®¿é—®æ§åˆ¶çš„å½¢å¼åŒ–è¯æ˜

2. **Stanford CS155 Computer and Network Security** (<https://crypto.stanford.edu/cs155/>)
   - **è¯¾ç¨‹**: Stanford CS155 Computer and Network Security
   - **é‡è¦æ€§**: è®¡ç®—æœºå’Œç½‘ç»œå®‰å…¨è¯¾ç¨‹
   - **æ ¸å¿ƒå†…å®¹**: è®¿é—®æ§åˆ¶ã€å®‰å…¨æ¨¡å‹ã€ä¿¡æ¯æµå®‰å…¨
   - **ä¸æœ¬æ–‡æ¡£çš„å…³ç³»**: æœ¬æ–‡æ¡£å½¢å¼åŒ–è¯æ˜äº†è¯¾ç¨‹ä¸­æ¶‰åŠçš„è®¿é—®æ§åˆ¶æ¨¡å‹ï¼Œç‰¹åˆ«æ˜¯Lecture 5: Access Controléƒ¨åˆ†
   - **è¯¾ç¨‹è®²ä¹‰**: Lecture 5: Access Control, Lecture 6: Security Models
   - **æ‰¹åˆ¤æ€§åˆ†æ**: è¯¾ç¨‹æä¾›äº†å®‰å…¨æ¨¡å‹çš„å®è·µè§†è§’ï¼Œæœ¬æ–‡æ¡£è¡¥å……äº†å½¢å¼åŒ–è¯æ˜å’Œç†è®ºæ·±åº¦

3. **CMU 15-330 Introduction to Computer Security** (<https://www.cs.cmu.edu/~15440/>)
   - **è¯¾ç¨‹**: CMU 15-330 Introduction to Computer Security
   - **é‡è¦æ€§**: è®¡ç®—æœºå®‰å…¨å¯¼è®ºè¯¾ç¨‹
   - **æ ¸å¿ƒå†…å®¹**: è®¿é—®æ§åˆ¶ã€å®‰å…¨æ¨¡å‹ã€ä¿¡æ¯æµå®‰å…¨
   - **ä¸æœ¬æ–‡æ¡£çš„å…³ç³»**: æœ¬æ–‡æ¡£è¯¦ç»†åˆ†æäº†è¯¾ç¨‹ä¸­æ¶‰åŠçš„è®¿é—®æ§åˆ¶æ¨¡å‹ï¼Œå¹¶æä¾›äº†å½¢å¼åŒ–è¯æ˜
   - **è¯¾ç¨‹è®²ä¹‰**: Lecture 4: Access Control, Lecture 5: Security Models
   - **æ‰¹åˆ¤æ€§åˆ†æ**: è¯¾ç¨‹å¼ºè°ƒå®è·µåº”ç”¨ï¼Œæœ¬æ–‡æ¡£æä¾›äº†ç†è®ºè¯æ˜å’Œå½¢å¼åŒ–éªŒè¯

### 7.5 ç›¸å…³æ–‡æ¡£

- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)
- [å®‰å…¨ç­–ç•¥ä¸éå¹²æ‰°-é€»è¾‘æ¡†æ¶ä¸è¯æ˜](./07.01-å®‰å…¨ç­–ç•¥ä¸éå¹²æ‰°-é€»è¾‘æ¡†æ¶ä¸è¯æ˜.md)
- [è¡Œçº§å®‰å…¨-RLSç­–ç•¥è¯­ä¹‰ä¸ä¸å¯é€ƒé€¸æ€§è¯æ˜](./07.03-è¡Œçº§å®‰å…¨-RLSç­–ç•¥è¯­ä¹‰ä¸ä¸å¯é€ƒé€¸æ€§è¯æ˜.md)

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: âœ… å†…å®¹å·²æ·±åŒ–ï¼ŒåŒ…å«å®Œæ•´è¯æ˜ã€åœºæ™¯æ¡ˆä¾‹å’ŒPostgreSQL 18/SQLiteå¯¹æ¯”
