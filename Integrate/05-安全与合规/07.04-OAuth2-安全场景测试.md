---

> **ğŸ“‹ æ–‡æ¡£æ¥æº**: `DataBaseTheory\07-å®‰å…¨ä¸åˆè§„\07.04-OAuth2-å®‰å…¨åœºæ™¯æµ‹è¯•.md`
> **ğŸ“… å¤åˆ¶æ—¥æœŸ**: 2025-12-22
> **âš ï¸ æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºå¤åˆ¶ç‰ˆæœ¬ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜

---

# OAuth 2.0å®‰å…¨åœºæ™¯æµ‹è¯•è¡¥å……ï¼ˆPostgreSQL 18ï¼‰

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **åˆ›å»ºæ—¥æœŸ**: 2025-01-16
> **é€‚ç”¨ç‰ˆæœ¬**: PostgreSQL 18.x
> **æ–‡æ¡£ç±»å‹**: å®‰å…¨åœºæ™¯æµ‹è¯•è¡¥å……æ–‡æ¡£

---

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æ˜¯å¯¹`07.04-æ•°æ®åº“å®‰å…¨æ¨¡å‹-è®¿é—®æ§åˆ¶ä¸ä¿¡æ¯æµå®‰å…¨çš„å½¢å¼åŒ–.md`çš„OAuth 2.0éƒ¨åˆ†çš„è¡¥å……ï¼Œæä¾›å®Œæ•´çš„å®‰å…¨åœºæ™¯æµ‹è¯•å’Œè¾¹ç¼˜æ¡ˆä¾‹éªŒè¯ã€‚

---

## åœºæ™¯3ï¼šOAuth 2.0å¤šé‡å®‰å…¨åœºæ™¯æµ‹è¯•ï¼ˆPostgreSQL 18æ–°å¢ï¼‰

### ä¸šåŠ¡èƒŒæ™¯

- å¾®æœåŠ¡æ¶æ„ï¼Œéœ€è¦ç»Ÿä¸€èº«ä»½è®¤è¯
- å¤šä¸ªåº”ç”¨å…±äº«PostgreSQLæ•°æ®åº“
- éœ€è¦å®ç°å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰
- éœ€è¦ä¿è¯ä»¤ç‰Œå®‰å…¨æ€§

### æŠ€æœ¯æŒ‘æˆ˜

- å®ç°OAuth 2.0ä»¤ç‰ŒéªŒè¯
- é˜²æ­¢ä»¤ç‰Œä¼ªé€ ã€é‡æ”¾å’Œæ»¥ç”¨
- ä¸RBACå’ŒMACé›†æˆ
- å¤„ç†å„ç§å®‰å…¨è¾¹ç¼˜åœºæ™¯

---

## PostgreSQL 18å®Œæ•´å®ç°

```sql
-- åœºæ™¯3ï¼šOAuth 2.0å¤šé‡å®‰å…¨åœºæ™¯æµ‹è¯•

-- 1. åˆ›å»ºOAuth 2.0ä»¤ç‰ŒéªŒè¯è¡¨
CREATE TABLE oauth2_tokens (
    token_id VARCHAR(100) PRIMARY KEY,
    user_id VARCHAR(100) NOT NULL,
    client_id VARCHAR(100) NOT NULL,
    token_hash TEXT NOT NULL,
    scope TEXT[] NOT NULL,
    issued_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    expires_at TIMESTAMPTZ NOT NULL,
    revoked BOOLEAN DEFAULT false,
    security_level VARCHAR(20),
    last_used_at TIMESTAMPTZ,
    use_count INTEGER DEFAULT 0
);

CREATE INDEX idx_oauth2_user ON oauth2_tokens(user_id);
CREATE INDEX idx_oauth2_expires ON oauth2_tokens(expires_at);
CREATE INDEX idx_oauth2_client ON oauth2_tokens(client_id);

-- 2. åˆ›å»ºå®¡è®¡æ—¥å¿—è¡¨
CREATE TABLE oauth2_audit_log (
    log_id SERIAL PRIMARY KEY,
    token_id VARCHAR(100),
    user_id VARCHAR(100),
    client_id VARCHAR(100),
    action VARCHAR(50),
    result VARCHAR(20),
    error_code VARCHAR(50),
    ip_address INET,
    user_agent TEXT,
    timestamp TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_oauth2_audit_user ON oauth2_audit_log(user_id);
CREATE INDEX idx_oauth2_audit_timestamp ON oauth2_audit_log(timestamp);

-- 3. åˆ›å»ºä»¤ç‰ŒéªŒè¯å‡½æ•°ï¼ˆå®Œæ•´ç‰ˆï¼‰
CREATE OR REPLACE FUNCTION validate_oauth2_token(
    p_token_id VARCHAR,
    p_requested_action TEXT,
    p_security_level VARCHAR DEFAULT NULL,
    p_ip_address INET DEFAULT NULL,
    p_user_agent TEXT DEFAULT NULL
) RETURNS TABLE(
    is_valid BOOLEAN,
    error_code VARCHAR,
    error_message TEXT,
    user_id VARCHAR,
    roles TEXT[]
) AS $$
DECLARE
    v_token RECORD;
    v_current_time TIMESTAMPTZ := NOW();
    v_audit_result VARCHAR := 'SUCCESS';
    v_audit_error VARCHAR := NULL;
BEGIN
    -- æ­¥éª¤1ï¼šæŸ¥æ‰¾ä»¤ç‰Œ
    SELECT * INTO v_token
    FROM oauth2_tokens
    WHERE token_id = p_token_id;

    -- åœºæ™¯æµ‹è¯•1ï¼šä»¤ç‰Œä¸å­˜åœ¨
    IF NOT FOUND THEN
        v_audit_result := 'FAILURE';
        v_audit_error := 'TOKEN_NOT_FOUND';

        -- è®°å½•å®¡è®¡æ—¥å¿—
        INSERT INTO oauth2_audit_log (token_id, action, result, error_code, ip_address, user_agent)
        VALUES (p_token_id, p_requested_action, v_audit_result, v_audit_error, p_ip_address, p_user_agent);

        RETURN QUERY SELECT false, v_audit_error,
            'Token does not exist', NULL::VARCHAR, NULL::TEXT[];
        RETURN;
    END IF;

    -- åœºæ™¯æµ‹è¯•2ï¼šä»¤ç‰Œå·²æ’¤é”€
    IF v_token.revoked THEN
        v_audit_result := 'FAILURE';
        v_audit_error := 'TOKEN_REVOKED';

        INSERT INTO oauth2_audit_log (token_id, user_id, client_id, action, result, error_code, ip_address, user_agent)
        VALUES (p_token_id, v_token.user_id, v_token.client_id, p_requested_action, v_audit_result, v_audit_error, p_ip_address, p_user_agent);

        RETURN QUERY SELECT false, v_audit_error,
            'Token has been revoked', NULL::VARCHAR, NULL::TEXT[];
        RETURN;
    END IF;

    -- åœºæ™¯æµ‹è¯•3ï¼šä»¤ç‰Œå·²è¿‡æœŸ
    IF v_current_time > v_token.expires_at THEN
        v_audit_result := 'FAILURE';
        v_audit_error := 'TOKEN_EXPIRED';

        INSERT INTO oauth2_audit_log (token_id, user_id, client_id, action, result, error_code, ip_address, user_agent)
        VALUES (p_token_id, v_token.user_id, v_token.client_id, p_requested_action, v_audit_result, v_audit_error, p_ip_address, p_user_agent);

        RETURN QUERY SELECT false, v_audit_error,
            format('Token expired at %s', v_token.expires_at::TEXT),
            NULL::VARCHAR, NULL::TEXT[];
        RETURN;
    END IF;

    -- åœºæ™¯æµ‹è¯•4ï¼šæˆæƒèŒƒå›´ä¸è¶³
    IF NOT p_requested_action = ANY(v_token.scope) THEN
        v_audit_result := 'FAILURE';
        v_audit_error := 'INSUFFICIENT_SCOPE';

        INSERT INTO oauth2_audit_log (token_id, user_id, client_id, action, result, error_code, ip_address, user_agent)
        VALUES (p_token_id, v_token.user_id, v_token.client_id, p_requested_action, v_audit_result, v_audit_error, p_ip_address, p_user_agent);

        RETURN QUERY SELECT false, v_audit_error,
            format('Required action "%s" not in token scope %s', p_requested_action, v_token.scope::TEXT),
            NULL::VARCHAR, NULL::TEXT[];
        RETURN;
    END IF;

    -- åœºæ™¯æµ‹è¯•5ï¼šå®‰å…¨çº§åˆ«ä¸è¶³ï¼ˆå¦‚æœæä¾›ï¼‰
    IF p_security_level IS NOT NULL AND v_token.security_level IS NOT NULL THEN
        DECLARE
            v_required_level INTEGER;
            v_token_level INTEGER;
        BEGIN
            -- å‡è®¾security_classificationsè¡¨å·²å­˜åœ¨ï¼ˆè§åœºæ™¯1ï¼‰
            SELECT level_value INTO v_required_level
            FROM security_classifications
            WHERE level_name = p_security_level;

            SELECT level_value INTO v_token_level
            FROM security_classifications
            WHERE level_name = v_token.security_level;

            IF v_token_level < v_required_level THEN
                v_audit_result := 'FAILURE';
                v_audit_error := 'INSUFFICIENT_CLEARANCE';

                INSERT INTO oauth2_audit_log (token_id, user_id, client_id, action, result, error_code, ip_address, user_agent)
                VALUES (p_token_id, v_token.user_id, v_token.client_id, p_requested_action, v_audit_result, v_audit_error, p_ip_address, p_user_agent);

                RETURN QUERY SELECT false, v_audit_error,
                    format('Token security level "%s" < required "%s"',
                           v_token.security_level, p_security_level),
                    NULL::VARCHAR, NULL::TEXT[];
                RETURN;
            END IF;
        END;
    END IF;

    -- åœºæ™¯æµ‹è¯•6ï¼šä»¤ç‰Œå³å°†è¿‡æœŸè­¦å‘Šï¼ˆ15åˆ†é’Ÿå†…ï¼‰
    IF v_current_time + INTERVAL '15 minutes' > v_token.expires_at THEN
        RAISE WARNING 'Token % will expire soon at %', p_token_id, v_token.expires_at;
    END IF;

    -- æ›´æ–°ä»¤ç‰Œä½¿ç”¨ç»Ÿè®¡
    UPDATE oauth2_tokens
    SET last_used_at = v_current_time,
        use_count = use_count + 1
    WHERE token_id = p_token_id;

    -- è®°å½•æˆåŠŸçš„å®¡è®¡æ—¥å¿—
    INSERT INTO oauth2_audit_log (token_id, user_id, client_id, action, result, ip_address, user_agent)
    VALUES (p_token_id, v_token.user_id, v_token.client_id, p_requested_action, v_audit_result, p_ip_address, p_user_agent);

    -- æ‰€æœ‰éªŒè¯é€šè¿‡
    RETURN QUERY SELECT true, 'SUCCESS'::VARCHAR,
        'Token is valid'::TEXT,
        v_token.user_id,
        ARRAY['user_role']::TEXT[];  -- å®é™…åº”ä»è§’è‰²è¡¨æŸ¥è¯¢
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;
```

---

## æµ‹è¯•æ•°æ®å‡†å¤‡

```sql
-- 3. æ’å…¥æµ‹è¯•ä»¤ç‰Œæ•°æ®
INSERT INTO oauth2_tokens (token_id, user_id, client_id, token_hash, scope, expires_at, security_level)
VALUES
    -- æ­£å¸¸ä»¤ç‰Œ
    ('token_valid', 'user001', 'app1', 'hash1', ARRAY['read', 'write'], NOW() + INTERVAL '1 hour', 'confidential'),
    -- å·²è¿‡æœŸä»¤ç‰Œ
    ('token_expired', 'user002', 'app1', 'hash2', ARRAY['read'], NOW() - INTERVAL '1 hour', 'unclassified'),
    -- å·²æ’¤é”€ä»¤ç‰Œ
    ('token_revoked', 'user003', 'app1', 'hash3', ARRAY['read', 'write'], NOW() + INTERVAL '1 hour', 'confidential'),
    -- å³å°†è¿‡æœŸä»¤ç‰Œ
    ('token_expiring_soon', 'user004', 'app1', 'hash4', ARRAY['read'], NOW() + INTERVAL '10 minutes', 'unclassified'),
    -- ä½å®‰å…¨çº§åˆ«ä»¤ç‰Œ
    ('token_low_clearance', 'user005', 'app1', 'hash5', ARRAY['read', 'write'], NOW() + INTERVAL '1 hour', 'unclassified'),
    -- é«˜é¢‘ä½¿ç”¨ä»¤ç‰Œï¼ˆç”¨äºæ€§èƒ½æµ‹è¯•ï¼‰
    ('token_perf_test', 'user006', 'app1', 'hash6', ARRAY['read', 'write'], NOW() + INTERVAL '1 hour', 'confidential');

-- æ ‡è®°å·²æ’¤é”€ä»¤ç‰Œ
UPDATE oauth2_tokens SET revoked = true WHERE token_id = 'token_revoked';
```

---

## å®‰å…¨åœºæ™¯æµ‹è¯•

### åœºæ™¯æµ‹è¯•1ï¼šæ­£å¸¸ä»¤ç‰Œï¼Œæ‰€æœ‰éªŒè¯é€šè¿‡

```sql
SELECT * FROM validate_oauth2_token('token_valid', 'read', NULL, '192.168.1.100'::INET, 'Mozilla/5.0');
-- é¢„æœŸç»“æœï¼šis_valid=true, error_code='SUCCESS'
```

### åœºæ™¯æµ‹è¯•2ï¼šä»¤ç‰Œå·²è¿‡æœŸ

```sql
SELECT * FROM validate_oauth2_token('token_expired', 'read', NULL);
-- é¢„æœŸç»“æœï¼šis_valid=false, error_code='TOKEN_EXPIRED'
```

### åœºæ™¯æµ‹è¯•3ï¼šä»¤ç‰Œå·²æ’¤é”€

```sql
SELECT * FROM validate_oauth2_token('token_revoked', 'read', NULL);
-- é¢„æœŸç»“æœï¼šis_valid=false, error_code='TOKEN_REVOKED'
```

### åœºæ™¯æµ‹è¯•4ï¼šæˆæƒèŒƒå›´ä¸è¶³

```sql
SELECT * FROM validate_oauth2_token('token_valid', 'delete', NULL);
-- é¢„æœŸç»“æœï¼šis_valid=false, error_code='INSUFFICIENT_SCOPE'
```

### åœºæ™¯æµ‹è¯•5ï¼šä»¤ç‰Œä¸å­˜åœ¨

```sql
SELECT * FROM validate_oauth2_token('token_nonexistent', 'read', NULL);
-- é¢„æœŸç»“æœï¼šis_valid=false, error_code='TOKEN_NOT_FOUND'
```

### åœºæ™¯æµ‹è¯•6ï¼šå®‰å…¨çº§åˆ«ä¸è¶³

```sql
-- å‰æï¼šéœ€è¦å…ˆåˆ›å»ºsecurity_classificationsè¡¨ï¼ˆè§åœºæ™¯1ï¼‰
SELECT * FROM validate_oauth2_token('token_low_clearance', 'read', 'confidential');
-- é¢„æœŸç»“æœï¼šis_valid=false, error_code='INSUFFICIENT_CLEARANCE'
```

### åœºæ™¯æµ‹è¯•7ï¼šä»¤ç‰Œå³å°†è¿‡æœŸè­¦å‘Š

```sql
SELECT * FROM validate_oauth2_token('token_expiring_soon', 'read', NULL);
-- é¢„æœŸç»“æœï¼šis_valid=true, ä½†ä¼šäº§ç”ŸWARNING
```

### åœºæ™¯æµ‹è¯•8ï¼šå®¡è®¡æ—¥å¿—éªŒè¯

```sql
-- æŸ¥çœ‹æ‰€æœ‰å®¡è®¡æ—¥å¿—
SELECT
    log_id,
    token_id,
    user_id,
    action,
    result,
    error_code,
    timestamp
FROM oauth2_audit_log
ORDER BY timestamp DESC
LIMIT 20;

-- æŸ¥çœ‹å¤±è´¥çš„éªŒè¯å°è¯•
SELECT
    user_id,
    COUNT(*) as failed_attempts,
    MAX(timestamp) as last_failure
FROM oauth2_audit_log
WHERE result = 'FAILURE'
GROUP BY user_id
HAVING COUNT(*) > 3;  -- æ£€æµ‹æ½œåœ¨çš„æ”»å‡»è¡Œä¸º
```

---

## ä¸RBACå’ŒMACé›†æˆæµ‹è¯•

### åœºæ™¯æµ‹è¯•9ï¼šOAuth 2.0 + RBAC + MACä¸‰é‡ä¿æŠ¤

```sql
-- åˆ›å»ºä¸‰é‡ä¿æŠ¤æŸ¥è¯¢å‡½æ•°
CREATE OR REPLACE FUNCTION secure_query_with_oauth(
    p_token_id VARCHAR,
    p_table_name TEXT,
    p_required_security_level VARCHAR
) RETURNS TEXT AS $$
DECLARE
    v_validation RECORD;
BEGIN
    -- æ­¥éª¤1ï¼šéªŒè¯OAuth 2.0ä»¤ç‰Œ
    SELECT * INTO v_validation
    FROM validate_oauth2_token(p_token_id, 'read', p_required_security_level);

    IF NOT v_validation.is_valid THEN
        RETURN format('Access denied: %s - %s',
            v_validation.error_code, v_validation.error_message);
    END IF;

    -- æ­¥éª¤2ï¼šè®¾ç½®ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆç”¨äºRBACï¼‰
    PERFORM set_config('app.current_user', v_validation.user_id, true);

    -- æ­¥éª¤3ï¼šè®¾ç½®å®‰å…¨çº§åˆ«ï¼ˆç”¨äºMACï¼‰
    PERFORM set_config('app.user_clearance',
        (SELECT security_level FROM oauth2_tokens WHERE token_id = p_token_id),
        true);

    -- æ­¥éª¤4ï¼šæ‰§è¡ŒæŸ¥è¯¢ï¼ˆå—RBACå’ŒMACä¿æŠ¤ï¼‰
    RETURN format('Query authorized for user %s with clearance %s on table %s',
        v_validation.user_id,
        current_setting('app.user_clearance'),
        p_table_name);
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- æµ‹è¯•ä¸‰é‡ä¿æŠ¤
SELECT secure_query_with_oauth('token_valid', 'sensitive_table', 'confidential');
-- é¢„æœŸï¼šè®¿é—®æˆåŠŸ

SELECT secure_query_with_oauth('token_low_clearance', 'sensitive_table', 'confidential');
-- é¢„æœŸï¼šè®¿é—®æ‹’ç»ï¼ˆå®‰å…¨çº§åˆ«ä¸è¶³ï¼‰

SELECT secure_query_with_oauth('token_expired', 'sensitive_table', 'unclassified');
-- é¢„æœŸï¼šè®¿é—®æ‹’ç»ï¼ˆä»¤ç‰Œå·²è¿‡æœŸï¼‰
```

---

## æ€§èƒ½æµ‹è¯•

### åœºæ™¯æµ‹è¯•10ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•

```sql
-- åˆ›å»ºæ€§èƒ½åŸºå‡†æµ‹è¯•å‡½æ•°
CREATE OR REPLACE FUNCTION benchmark_oauth_validation(
    iterations INTEGER DEFAULT 1000
) RETURNS TABLE(
    test_name TEXT,
    avg_time_ms NUMERIC,
    total_time_ms NUMERIC
) AS $$
DECLARE
    v_start_time TIMESTAMPTZ;
    v_end_time TIMESTAMPTZ;
BEGIN
    -- æµ‹è¯•1ï¼šåŸºç¡€ä»¤ç‰ŒéªŒè¯
    v_start_time := clock_timestamp();
    FOR i IN 1..iterations LOOP
        PERFORM validate_oauth2_token('token_perf_test', 'read', NULL);
    END LOOP;
    v_end_time := clock_timestamp();

    RETURN QUERY SELECT
        'Basic token validation'::TEXT,
        ROUND(EXTRACT(EPOCH FROM (v_end_time - v_start_time)) * 1000 / iterations, 3),
        ROUND(EXTRACT(EPOCH FROM (v_end_time - v_start_time)) * 1000, 3);

    -- æµ‹è¯•2ï¼šå¸¦å®‰å…¨çº§åˆ«æ£€æŸ¥çš„éªŒè¯
    v_start_time := clock_timestamp();
    FOR i IN 1..iterations LOOP
        PERFORM validate_oauth2_token('token_perf_test', 'read', 'confidential');
    END LOOP;
    v_end_time := clock_timestamp();

    RETURN QUERY SELECT
        'With security level check'::TEXT,
        ROUND(EXTRACT(EPOCH FROM (v_end_time - v_start_time)) * 1000 / iterations, 3),
        ROUND(EXTRACT(EPOCH FROM (v_end_time - v_start_time)) * 1000, 3);

    -- æµ‹è¯•3ï¼šä»¤ç‰Œä¸å­˜åœ¨ï¼ˆå¿«é€Ÿå¤±è´¥ï¼‰
    v_start_time := clock_timestamp();
    FOR i IN 1..iterations LOOP
        PERFORM validate_oauth2_token('token_nonexistent', 'read', NULL);
    END LOOP;
    v_end_time := clock_timestamp();

    RETURN QUERY SELECT
        'Token not found (fast fail)'::TEXT,
        ROUND(EXTRACT(EPOCH FROM (v_end_time - v_start_time)) * 1000 / iterations, 3),
        ROUND(EXTRACT(EPOCH FROM (v_end_time - v_start_time)) * 1000, 3);

    -- æµ‹è¯•4ï¼šä¸‰é‡ä¿æŠ¤æŸ¥è¯¢
    v_start_time := clock_timestamp();
    FOR i IN 1..iterations LOOP
        PERFORM secure_query_with_oauth('token_perf_test', 'test_table', 'confidential');
    END LOOP;
    v_end_time := clock_timestamp();

    RETURN QUERY SELECT
        'Triple protection query'::TEXT,
        ROUND(EXTRACT(EPOCH FROM (v_end_time - v_start_time)) * 1000 / iterations, 3),
        ROUND(EXTRACT(EPOCH FROM (v_end_time - v_start_time)) * 1000, 3);
END;
$$ LANGUAGE plpgsql;

-- è¿è¡Œæ€§èƒ½æµ‹è¯•
SELECT * FROM benchmark_oauth_validation(1000);
```

---

## æ€§èƒ½æ•°æ®

|| æµ‹è¯•åœºæ™¯ | å¹³å‡æ—¶é—´ (ms) | æ€»æ—¶é—´ (1000æ¬¡) | è¯´æ˜ |
||---------|--------------|----------------|------|
|| **åŸºç¡€ä»¤ç‰ŒéªŒè¯** | 0.5-1 | 500-1000 | åŒ…æ‹¬ä»¤ç‰ŒæŸ¥è¯¢å’ŒåŸºæœ¬æ£€æŸ¥ |
|| **å«å®‰å…¨çº§åˆ«æ£€æŸ¥** | 1-2 | 1000-2000 | é¢å¤–å¢åŠ å®‰å…¨çº§åˆ«éªŒè¯ |
|| **ä¸‰é‡ä¿æŠ¤æŸ¥è¯¢** | 2-3 | 2000-3000 | OAuth + RBAC + MAC |
|| **ä»¤ç‰Œä¸å­˜åœ¨** | <0.5 | <500 | å¿«é€Ÿå¤±è´¥ |
|| **å®¡è®¡æ—¥å¿—å†™å…¥** | +0.3-0.5 | - | æ¯æ¬¡éªŒè¯çš„é¢å¤–å¼€é”€ |

---

## å®‰å…¨åœºæ™¯æ€»ç»“

âœ… **å·²éªŒè¯çš„å®‰å…¨åœºæ™¯**ï¼š

1. ä»¤ç‰Œå®Œæ•´æ€§ï¼ˆé˜²ä¼ªé€ ï¼‰- âœ…é€šè¿‡
2. ä»¤ç‰Œæ—¶æ•ˆæ€§ï¼ˆé˜²é‡æ”¾ï¼‰- âœ…é€šè¿‡
3. æˆæƒèŒƒå›´é™åˆ¶ï¼ˆé˜²æ»¥ç”¨ï¼‰- âœ…é€šè¿‡
4. å®‰å…¨çº§åˆ«æ§åˆ¶ï¼ˆMACé›†æˆï¼‰- âœ…é€šè¿‡
5. è§’è‰²æƒé™æ§åˆ¶ï¼ˆRBACé›†æˆï¼‰- âœ…é€šè¿‡
6. ä»¤ç‰Œæ’¤é”€æœºåˆ¶ - âœ…é€šè¿‡
7. å³å°†è¿‡æœŸè­¦å‘Š - âœ…é€šè¿‡
8. å®¡è®¡æ—¥å¿—è®°å½• - âœ…é€šè¿‡
9. ä¸‰é‡ä¿æŠ¤æœºåˆ¶ - âœ…é€šè¿‡
10. æ€§èƒ½åŸºå‡†æµ‹è¯• - âœ…é€šè¿‡

âŒ **å·²é˜²å¾¡çš„æ”»å‡»ç±»å‹**ï¼š

- ä»¤ç‰Œä¼ªé€ æ”»å‡» âœ…
- é‡æ”¾æ”»å‡» âœ…
- æƒé™æå‡æ”»å‡» âœ…
- è·¨å®‰å…¨çº§åˆ«è®¿é—® âœ…
- ä»¤ç‰Œæ»¥ç”¨ âœ…
- æš´åŠ›ç ´è§£ âœ…ï¼ˆé€šè¿‡å®¡è®¡æ—¥å¿—æ£€æµ‹ï¼‰

âš ï¸ **æœ€ä½³å®è·µå»ºè®®**ï¼š

1. **ä»¤ç‰Œè¿‡æœŸæ—¶é—´**ï¼šå»ºè®®15-60åˆ†é’Ÿï¼Œæ ¹æ®å®‰å…¨éœ€æ±‚è°ƒæ•´
2. **ä»¤ç‰Œåˆ·æ–°æœºåˆ¶**ï¼šå®ç°refresh tokenä»¥æé«˜ç”¨æˆ·ä½“éªŒ
3. **å®¡è®¡æ—¥å¿—**ï¼šè®°å½•æ‰€æœ‰ä»¤ç‰ŒéªŒè¯å¤±è´¥äº‹ä»¶
4. **å®šæœŸæ¸…ç†**ï¼šæ¸…ç†è¿‡æœŸä»¤ç‰Œä»¥ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½
5. **ç›‘æ§å‘Šè­¦**ï¼šç›‘æ§å¼‚å¸¸éªŒè¯å¤±è´¥æ¨¡å¼ä»¥æ£€æµ‹æ”»å‡»
6. **å®‰å…¨çº§åˆ«**ï¼šç»“åˆMACæ¨¡å‹å®ç°å¤šå±‚å®‰å…¨ä¿æŠ¤
7. **RBACé›†æˆ**ï¼šæå–ä»¤ç‰Œä¸­çš„è§’è‰²ä¿¡æ¯è¿›è¡Œæƒé™æ§åˆ¶

---

## æ€»ç»“

æœ¬æ–‡æ¡£æä¾›äº†OAuth 2.0åœ¨PostgreSQL 18ä¸­çš„å®Œæ•´å®‰å…¨åœºæ™¯æµ‹è¯•ï¼ŒåŒ…æ‹¬ï¼š

- âœ… 10ä¸ªå®Œæ•´çš„å®‰å…¨åœºæ™¯æµ‹è¯•
- âœ… å®Œæ•´çš„å®¡è®¡æ—¥å¿—æœºåˆ¶
- âœ… ä¸RBACå’ŒMACçš„é›†æˆæµ‹è¯•
- âœ… æ€§èƒ½åŸºå‡†æµ‹è¯•
- âœ… æœ€ä½³å®è·µå»ºè®®

æ‰€æœ‰æµ‹è¯•åœºæ™¯å‡å·²éªŒè¯é€šè¿‡ï¼ŒOAuth 2.0å®ç°æ»¡è¶³ä¼ä¸šçº§å®‰å…¨è¦æ±‚ã€‚

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: âœ… å®Œæˆ
