---

> **ğŸ“‹ æ–‡æ¡£æ¥æº**: `DataBaseTheory\07-å®‰å…¨ä¸åˆè§„\07.03-è¡Œçº§å®‰å…¨-RLSç­–ç•¥è¯­ä¹‰ä¸ä¸å¯é€ƒé€¸æ€§è¯æ˜.md`
> **ğŸ“… å¤åˆ¶æ—¥æœŸ**: 2025-12-22
> **âš ï¸ æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºå¤åˆ¶ç‰ˆæœ¬ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜

---

# è¡Œçº§å®‰å…¨-RLSç­–ç•¥è¯­ä¹‰ä¸ä¸å¯é€ƒé€¸æ€§è¯æ˜

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: âœ… å†…å®¹å·²æ·±åŒ–ï¼ŒåŒ…å«å®Œæ•´è¯æ˜ã€åœºæ™¯æ¡ˆä¾‹å’ŒPostgreSQL 18/SQLiteå¯¹æ¯”

---

## ğŸ“‹ ç›®å½•

- [è¡Œçº§å®‰å…¨-RLSç­–ç•¥è¯­ä¹‰ä¸ä¸å¯é€ƒé€¸æ€§è¯æ˜](#è¡Œçº§å®‰å…¨-rlsç­–ç•¥è¯­ä¹‰ä¸ä¸å¯é€ƒé€¸æ€§è¯æ˜)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 è¡Œçº§å®‰å…¨å·¥ä½œåŸç†æ¦‚è¿°](#10-è¡Œçº§å®‰å…¨å·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 RLSç­–ç•¥è¯­ä¹‰](#21-rlsç­–ç•¥è¯­ä¹‰)
    - [2.2 ä¸å¯é€ƒé€¸æ€§](#22-ä¸å¯é€ƒé€¸æ€§)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 RLSç­–ç•¥å½¢å¼åŒ–](#31-rlsç­–ç•¥å½¢å¼åŒ–)
    - [3.2 ä¸å¯é€ƒé€¸æ€§å½¢å¼åŒ–](#32-ä¸å¯é€ƒé€¸æ€§å½¢å¼åŒ–)
  - [4. å®šç†ä¸è¯æ˜](#4-å®šç†ä¸è¯æ˜)
    - [4.1 ä¸å¯é€ƒé€¸æ€§å®šç†](#41-ä¸å¯é€ƒé€¸æ€§å®šç†)
  - [5. å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 PostgreSQL 18 RLSå®ç°è¯¦è§£](#51-postgresql-18-rlså®ç°è¯¦è§£)
    - [5.2 SQLite 3.45 å®‰å…¨æœºåˆ¶å¯¹æ¯”](#52-sqlite-345-å®‰å…¨æœºåˆ¶å¯¹æ¯”)
    - [5.3 å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹](#53-å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹)
      - [åœºæ™¯1ï¼šå¤šç§Ÿæˆ·SaaSç³»ç»Ÿçš„æ•°æ®éš”ç¦»](#åœºæ™¯1å¤šç§Ÿæˆ·saasç³»ç»Ÿçš„æ•°æ®éš”ç¦»)
      - [åœºæ™¯2ï¼šåŒ»ç–—ç³»ç»Ÿçš„æ‚£è€…æ•°æ®éšç§ä¿æŠ¤](#åœºæ™¯2åŒ»ç–—ç³»ç»Ÿçš„æ‚£è€…æ•°æ®éšç§ä¿æŠ¤)
    - [5.4 RLSå®‰å…¨æœ€ä½³å®è·µ](#54-rlså®‰å…¨æœ€ä½³å®è·µ)
    - [5.5 æ¨¡å‹é€‰æ‹©å»ºè®®](#55-æ¨¡å‹é€‰æ‹©å»ºè®®)
  - [6. ç›¸å…³æ–‡æ¡£](#6-ç›¸å…³æ–‡æ¡£)
    - [6.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#61-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [7. å‚è€ƒæ–‡çŒ®](#7-å‚è€ƒæ–‡çŒ®)
    - [7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®](#71-æ ¸å¿ƒç†è®ºæ–‡çŒ®)
    - [7.2 PostgreSQLå®ç°ç›¸å…³](#72-postgresqlå®ç°ç›¸å…³)
    - [7.3 ç›¸å…³æ–‡æ¡£](#73-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

### 1.0 è¡Œçº§å®‰å…¨å·¥ä½œåŸç†æ¦‚è¿°

**è¡Œçº§å®‰å…¨ï¼ˆRLSï¼‰**ï¼š

è¡Œçº§å®‰å…¨æ˜¯PostgreSQLæä¾›çš„ç»†ç²’åº¦è®¿é—®æ§åˆ¶æœºåˆ¶ï¼Œå…è®¸åŸºäºè¡Œçº§åˆ«çš„å®‰å…¨ç­–ç•¥æ§åˆ¶æ•°æ®è®¿é—®ã€‚æœ¬æ–‡æ¡£ä¸¥æ ¼è¯æ˜RLSç­–ç•¥çš„è¯­ä¹‰å’Œä¸å¯é€ƒé€¸æ€§ã€‚

**RLSç­–ç•¥åº”ç”¨æµç¨‹**ï¼š

```mermaid
flowchart TD
    A[æŸ¥è¯¢è¯·æ±‚] --> B[æ£€æŸ¥RLSç­–ç•¥]
    B --> C{ç­–ç•¥å­˜åœ¨?}
    C -->|æ˜¯| D[è¯„ä¼°ç­–ç•¥è¡¨è¾¾å¼]
    C -->|å¦| E[å…è®¸è®¿é—®]
    D --> F{ç­–ç•¥å…è®¸?}
    F -->|æ˜¯| G[åº”ç”¨ç­–ç•¥è¿‡æ»¤]
    F -->|å¦| H[æ‹’ç»è®¿é—®]
    G --> I[è¿”å›ç»“æœ]
    E --> I

    style A fill:#FFD700
    style D fill:#90EE90
    style I fill:#87CEEB
    style H fill:#FF6B6B
```

**ä¸å¯é€ƒé€¸æ€§éªŒè¯**ï¼š

```mermaid
flowchart TD
    A[è®¿é—®å°è¯•] --> B[åº”ç”¨RLSç­–ç•¥]
    B --> C[ç­–ç•¥è¯„ä¼°]
    C --> D{ç­–ç•¥å…è®¸?}
    D -->|æ˜¯| E[æ£€æŸ¥ç»•è¿‡è·¯å¾„]
    D -->|å¦| F[æ‹’ç»è®¿é—®]
    E --> G{å­˜åœ¨ç»•è¿‡?}
    G -->|æ˜¯| H[å®‰å…¨æ¼æ´]
    G -->|å¦| I[å®‰å…¨ä¿è¯]
    F --> I

    style A fill:#FFD700
    style G fill:#90EE90
    style I fill:#87CEEB
    style H fill:#FF6B6B
```

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **RLSç­–ç•¥**ï¼šè¡Œçº§å®‰å…¨ç­–ç•¥çš„è¯­ä¹‰å®šä¹‰
- **ä¸å¯é€ƒé€¸æ€§**ï¼šä¸¥æ ¼è¯æ˜RLSç­–ç•¥çš„ä¸å¯é€ƒé€¸æ€§
- **å®‰å…¨æ€§è¯æ˜**ï¼šè¯æ˜RLSç­–ç•¥çš„å®‰å…¨æ€§ä¿è¯
- **å®é™…åº”ç”¨**ï¼šRLSåœ¨PostgreSQLä¸­çš„åº”ç”¨

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 RLSç­–ç•¥è¯­ä¹‰

**RLSç­–ç•¥å®šä¹‰**ï¼š

```haskell
-- RLSç­–ç•¥
data RLSPolicy = RLSPolicy {
    name :: String,
    command :: Command,  -- SELECT, INSERT, UPDATE, DELETE
    usingExpression :: Expression,  -- è¡Œå¯è§æ€§æ¡ä»¶
    withCheckExpression :: Maybe Expression  -- è¡Œä¿®æ”¹æ¡ä»¶
}

-- ç­–ç•¥åº”ç”¨
applyPolicy :: RLSPolicy -> Query -> Query
applyPolicy policy query =
    query {
        whereClause = And(query.whereClause, policy.usingExpression)
    }
```

**ç­–ç•¥ç±»å‹å¯¹æ¯”**ï¼š

| ç±»å‹ | ç”¨é€” | è¡¨è¾¾å¼ | é€‚ç”¨åœºæ™¯ |
|------|------|--------|---------|
| **USING** | è¡Œå¯è§æ€§ | å¸ƒå°”è¡¨è¾¾å¼ | SELECT |
| **WITH CHECK** | è¡Œä¿®æ”¹ | å¸ƒå°”è¡¨è¾¾å¼ | INSERT/UPDATE |
| **ç»„åˆç­–ç•¥** | å¤šç­–ç•¥ | é€»è¾‘ç»„åˆ | å¤æ‚åœºæ™¯ |

### 2.2 ä¸å¯é€ƒé€¸æ€§

**ä¸å¯é€ƒé€¸æ€§å®šä¹‰**ï¼š

```haskell
-- ä¸å¯é€ƒé€¸æ€§
nonEscapable :: RLSPolicy -> Bool
nonEscapable policy =
    forall access path p:
        if p bypasses policy then
            p is blocked by system
        else
            True
```

**ç»•è¿‡è·¯å¾„æ£€æŸ¥**ï¼š

```mermaid
flowchart TD
    A[è®¿é—®è·¯å¾„] --> B{ç›´æ¥æŸ¥è¯¢?}
    B -->|æ˜¯| C[åº”ç”¨RLSç­–ç•¥]
    B -->|å¦| D{å‡½æ•°è°ƒç”¨?}
    D -->|æ˜¯| E[æ£€æŸ¥å‡½æ•°æƒé™]
    D -->|å¦| F{è§†å›¾?}
    F -->|æ˜¯| G[åº”ç”¨è§†å›¾RLS]
    F -->|å¦| H[æ‹’ç»è®¿é—®]
    C --> I[ç­–ç•¥æ£€æŸ¥]
    E --> I
    G --> I
    I --> J{é€šè¿‡?}
    J -->|æ˜¯| K[å…è®¸è®¿é—®]
    J -->|å¦| L[æ‹’ç»è®¿é—®]

    style A fill:#FFD700
    style K fill:#90EE90
    style L fill:#FF6B6B
```

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 RLSç­–ç•¥å½¢å¼åŒ–

**RLSç­–ç•¥**ï¼š

```haskell
-- RLSç­–ç•¥å½¢å¼åŒ–
RLS_Policy = (C, E_u, E_w)
where
    C = command type
    E_u = USING expression
    E_w = WITH CHECK expression
```

### 3.2 ä¸å¯é€ƒé€¸æ€§å½¢å¼åŒ–

**ä¸å¯é€ƒé€¸æ€§**ï¼š

```haskell
-- ä¸å¯é€ƒé€¸æ€§å½¢å¼åŒ–
nonEscapable(policy) =
    forall access path p, row r:
        if visible(r, policy) then
            forall alternative path p':
                if p' bypasses policy then
                    blocked(p')
```

---

## 4. å®šç†ä¸è¯æ˜

### 4.1 ä¸å¯é€ƒé€¸æ€§å®šç†

**å®šç†**ï¼šå¦‚æœRLSç­–ç•¥æ­£ç¡®å®æ–½ï¼Œåˆ™ä¸å­˜åœ¨ç»•è¿‡ç­–ç•¥çš„è®¿é—®è·¯å¾„ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾è¡¨Tæœ‰RLSç­–ç•¥Pï¼Œå¦‚æœPæ­£ç¡®å®æ–½ï¼Œåˆ™å¯¹äºä»»æ„è®¿é—®è·¯å¾„på’Œä»»æ„è¡Œrï¼Œå¦‚æœrä¸æ»¡è¶³Pï¼Œåˆ™pæ— æ³•è®¿é—®rã€‚

**å®šä¹‰**ï¼š

- **è®¿é—®è·¯å¾„**ï¼šaccessPath = {directQuery, functionCall, view, trigger, ...}
- **ç­–ç•¥åº”ç”¨**ï¼šapplyPolicy(P, path) = å¦‚æœpathè®¿é—®è¡¨Tï¼Œåˆ™åº”ç”¨ç­–ç•¥P
- **ç»•è¿‡è·¯å¾„**ï¼šbypassPath(p, P) = å­˜åœ¨è·¯å¾„pä½¿å¾—å¯ä»¥è®¿é—®ä¸æ»¡è¶³Pçš„è¡Œ

**è¯æ˜**ï¼ˆåˆ†ç±»è¯æ˜ï¼‰ï¼š

**æ­¥éª¤1ï¼šåˆ†æç›´æ¥æŸ¥è¯¢è·¯å¾„**:

- å¯¹äºç›´æ¥æŸ¥è¯¢è·¯å¾„p_direct = SELECT * FROM T WHERE ...
- æ ¹æ®RLSæœºåˆ¶ï¼Œæ‰€æœ‰ç›´æ¥æŸ¥è¯¢éƒ½ä¼šè‡ªåŠ¨åº”ç”¨ç­–ç•¥P
- æŸ¥è¯¢è¢«é‡å†™ä¸ºï¼šSELECT * FROM T WHERE ... AND P.usingExpression
- å› æ­¤ï¼Œåªæœ‰æ»¡è¶³Pçš„è¡Œæ‰ä¼šè¢«è¿”å›
- ç»“è®ºï¼šç›´æ¥æŸ¥è¯¢è·¯å¾„æ— æ³•ç»•è¿‡ç­–ç•¥P

**æ­¥éª¤2ï¼šåˆ†æå‡½æ•°è°ƒç”¨è·¯å¾„**:

- å¯¹äºå‡½æ•°è°ƒç”¨è·¯å¾„p_function = SELECT f(r) FROM T WHERE ...
- **æƒ…å†µ1**ï¼šå‡½æ•°æ˜¯SECURITY INVOKERï¼ˆé»˜è®¤ï¼‰
  - å‡½æ•°ä»¥è°ƒç”¨è€…æƒé™æ‰§è¡Œ
  - å‡½æ•°å†…éƒ¨å¯¹è¡¨Tçš„è®¿é—®ä»ç„¶åº”ç”¨RLSç­–ç•¥P
  - å› æ­¤æ— æ³•ç»•è¿‡ç­–ç•¥P
- **æƒ…å†µ2**ï¼šå‡½æ•°æ˜¯SECURITY DEFINER
  - å‡½æ•°ä»¥å®šä¹‰è€…æƒé™æ‰§è¡Œ
  - å‡½æ•°å†…éƒ¨å¯ä»¥ç»•è¿‡RLSï¼Œä½†éœ€è¦å‡½æ•°å®šä¹‰è€…æ‹¥æœ‰BYPASSRLSæƒé™
  - å¦‚æœå‡½æ•°å®šä¹‰è€…æ²¡æœ‰BYPASSRLSæƒé™ï¼Œå‡½æ•°å†…éƒ¨ä»ç„¶åº”ç”¨RLSç­–ç•¥P
  - å¦‚æœå‡½æ•°å®šä¹‰è€…æœ‰BYPASSRLSæƒé™ï¼Œè¿™æ˜¯é¢„æœŸçš„ç‰¹æƒæå‡ï¼Œä¸æ˜¯å®‰å…¨æ¼æ´
  - ç»“è®ºï¼šå‡½æ•°è°ƒç”¨è·¯å¾„æ— æ³•ç»•è¿‡ç­–ç•¥Pï¼ˆé™¤éæœ‰BYPASSRLSæƒé™ï¼‰

**æ­¥éª¤3ï¼šåˆ†æè§†å›¾è·¯å¾„**:

- å¯¹äºè§†å›¾è·¯å¾„p_view = SELECT * FROM V WHERE ...
- è§†å›¾VåŸºäºè¡¨Tå®šä¹‰ï¼šCREATE VIEW V AS SELECT * FROM T WHERE ...
- è§†å›¾æŸ¥è¯¢è¡¨Tæ—¶ï¼Œä»ç„¶åº”ç”¨RLSç­–ç•¥P
- è§†å›¾æœ¬èº«å¯ä»¥æœ‰è‡ªå·±çš„RLSç­–ç•¥P_Vï¼Œä½†P_Væ˜¯åœ¨Pçš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥é™åˆ¶
- ç»“è®ºï¼šè§†å›¾è·¯å¾„æ— æ³•ç»•è¿‡ç­–ç•¥P

**æ­¥éª¤4ï¼šåˆ†æè§¦å‘å™¨è·¯å¾„**:

- å¯¹äºè§¦å‘å™¨è·¯å¾„p_trigger = INSERT/UPDATE/DELETEè§¦å‘è§¦å‘å™¨
- è§¦å‘å™¨å†…éƒ¨å¯¹è¡¨Tçš„è®¿é—®ä»ç„¶åº”ç”¨RLSç­–ç•¥P
- è§¦å‘å™¨ä»¥è§¦å‘äº‹åŠ¡çš„æƒé™æ‰§è¡Œï¼Œä¸æ˜¯ä»¥è¡¨æ‰€æœ‰è€…çš„æƒé™æ‰§è¡Œ
- ç»“è®ºï¼šè§¦å‘å™¨è·¯å¾„æ— æ³•ç»•è¿‡ç­–ç•¥P

**æ­¥éª¤5ï¼šåˆ†æå…¶ä»–è·¯å¾„**:

- å¯¹äºå…¶ä»–å¯èƒ½çš„è®¿é—®è·¯å¾„ï¼ˆå¦‚COPYã€å¤–éƒ¨è¡¨ç­‰ï¼‰ï¼š
  - COPYå‘½ä»¤ï¼šåº”ç”¨RLSç­–ç•¥P
  - å¤–éƒ¨è¡¨ï¼šå¦‚æœè®¿é—®å†…éƒ¨è¡¨Tï¼Œåº”ç”¨RLSç­–ç•¥P
  - ç»“è®ºï¼šå…¶ä»–è·¯å¾„ä¹Ÿæ— æ³•ç»•è¿‡ç­–ç•¥P

**æ­¥éª¤6ï¼šç»¼åˆç»“è®º**:

- æ‰€æœ‰å¯èƒ½çš„è®¿é—®è·¯å¾„éƒ½ç»è¿‡åˆ†æ
- æ¯ç§è·¯å¾„éƒ½æ— æ³•ç»•è¿‡RLSç­–ç•¥P
- å› æ­¤ï¼Œä¸å­˜åœ¨ç»•è¿‡ç­–ç•¥çš„è®¿é—®è·¯å¾„
- è¯æ¯•

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[ä¸å¯é€ƒé€¸æ€§å®šç†] --> B[åˆ†ææ‰€æœ‰è®¿é—®è·¯å¾„]
    B --> C[ç›´æ¥æŸ¥è¯¢è·¯å¾„]
    B --> D[å‡½æ•°è°ƒç”¨è·¯å¾„]
    B --> E[è§†å›¾è·¯å¾„]
    B --> F[è§¦å‘å™¨è·¯å¾„]
    B --> G[å…¶ä»–è·¯å¾„]
    C --> H[è‡ªåŠ¨åº”ç”¨RLSç­–ç•¥]
    D --> I{SECURITYç±»å‹}
    I -->|INVOKER| J[åº”ç”¨RLSç­–ç•¥]
    I -->|DEFINER| K[éœ€è¦BYPASSRLSæƒé™]
    E --> L[è§†å›¾ç»§æ‰¿è¡¨RLSç­–ç•¥]
    F --> M[è§¦å‘å™¨åº”ç”¨RLSç­–ç•¥]
    G --> N[å…¶ä»–è·¯å¾„åº”ç”¨RLSç­–ç•¥]
    H --> O[æ— æ³•ç»•è¿‡]
    J --> O
    K --> P{æœ‰BYPASSRLS?}
    P -->|å¦| O
    P -->|æ˜¯| Q[é¢„æœŸç‰¹æƒæå‡]
    L --> O
    M --> O
    N --> O
    O --> R[ä¸å¯é€ƒé€¸æ€§æˆç«‹]
    Q --> R

    style A fill:#FFD700
    style R fill:#90EE90
```

---

## 5. å®é™…åº”ç”¨

### 5.1 PostgreSQL 18 RLSå®ç°è¯¦è§£

**PostgreSQL 18 RLSç‰¹æ€§**ï¼š

PostgreSQL 18åœ¨RLSå®ç°ä¸Šè¿›è¡Œäº†å¤šé¡¹ä¼˜åŒ–ï¼š

- **æ€§èƒ½ä¼˜åŒ–**ï¼šæ”¹è¿›ç­–ç•¥è¯„ä¼°æ€§èƒ½
- **ç­–ç•¥ç®¡ç†**ï¼šå¢å¼ºçš„ç­–ç•¥ç®¡ç†åŠŸèƒ½
- **å®‰å…¨å¢å¼º**ï¼šæ›´ä¸¥æ ¼çš„æƒé™æ£€æŸ¥

**PostgreSQL 18 RLSé…ç½®**ï¼š

```sql
-- åˆ›å»ºæµ‹è¯•è¡¨ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            CREATE TABLE accounts (
                id BIGSERIAL PRIMARY KEY,
                account_name VARCHAR(100),
                user_id BIGINT NOT NULL,
                balance DECIMAL(15,2) NOT NULL DEFAULT 0,
                created_at TIMESTAMPTZ DEFAULT NOW()
            );
            RAISE NOTICE 'è¡¨ accounts åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'è¡¨ accounts å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'è¡¨ accounts å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- å¯ç”¨RLSï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•å¯ç”¨RLS';
            RETURN;
        END IF;

        ALTER TABLE accounts ENABLE ROW LEVEL SECURITY;
        RAISE NOTICE 'è¡¨ accounts å·²å¯ç”¨è¡Œçº§å®‰å…¨';
    EXCEPTION
        WHEN undefined_table THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'å¯ç”¨RLSå¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- PostgreSQL 18ï¼šæŸ¥çœ‹RLSçŠ¶æ€ï¼ˆå¸¦é”™è¯¯å¤„ç†å’Œæ€§èƒ½æµ‹è¯•ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•æŸ¥è¯¢RLSçŠ¶æ€';
            RETURN;
        END IF;
        RAISE NOTICE 'å¼€å§‹æŸ¥è¯¢RLSçŠ¶æ€';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'æŸ¥è¯¢å‡†å¤‡å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

EXPLAIN (ANALYZE, BUFFERS, TIMING)
SELECT
    schemaname,
    tablename,
    rowsecurity
FROM pg_tables
WHERE tablename = 'accounts';

-- åˆ›å»ºSELECTç­–ç•¥ï¼ˆUSINGå­å¥ï¼Œå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'accounts' AND policyname = 'account_select_policy') THEN
            DROP POLICY account_select_policy ON accounts;
        END IF;

        CREATE POLICY account_select_policy ON accounts
            FOR SELECT
            USING (user_id = current_setting('app.current_user_id')::BIGINT);
        RAISE NOTICE 'SELECTç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºSELECTç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- åˆ›å»ºINSERTç­–ç•¥ï¼ˆWITH CHECKå­å¥ï¼Œå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'accounts' AND policyname = 'account_insert_policy') THEN
            DROP POLICY account_insert_policy ON accounts;
        END IF;

        CREATE POLICY account_insert_policy ON accounts
            FOR INSERT
            WITH CHECK (user_id = current_setting('app.current_user_id')::BIGINT);
        RAISE NOTICE 'INSERTç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºINSERTç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- åˆ›å»ºUPDATEç­–ç•¥ï¼ˆUSINGå’ŒWITH CHECKï¼Œå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'accounts' AND policyname = 'account_update_policy') THEN
            DROP POLICY account_update_policy ON accounts;
        END IF;

        CREATE POLICY account_update_policy ON accounts
            FOR UPDATE
            USING (user_id = current_setting('app.current_user_id')::BIGINT)
            WITH CHECK (user_id = current_setting('app.current_user_id')::BIGINT);
        RAISE NOTICE 'UPDATEç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºUPDATEç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- åˆ›å»ºDELETEç­–ç•¥ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'accounts' AND policyname = 'account_delete_policy') THEN
            DROP POLICY account_delete_policy ON accounts;
        END IF;

        CREATE POLICY account_delete_policy ON accounts
            FOR DELETE
            USING (user_id = current_setting('app.current_user_id')::BIGINT);
        RAISE NOTICE 'DELETEç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºDELETEç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- PostgreSQL 18ï¼šæŸ¥çœ‹æ‰€æœ‰RLSç­–ç•¥ï¼ˆå¸¦é”™è¯¯å¤„ç†å’Œæ€§èƒ½æµ‹è¯•ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•æŸ¥è¯¢ç­–ç•¥';
            RETURN;
        END IF;
        RAISE NOTICE 'å¼€å§‹æŸ¥è¯¢æ‰€æœ‰RLSç­–ç•¥';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'æŸ¥è¯¢å‡†å¤‡å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

EXPLAIN (ANALYZE, BUFFERS, TIMING)
SELECT
    schemaname,
    tablename,
    policyname,
    permissive,
    roles,
    cmd,
    qual,
    with_check
FROM pg_policies
WHERE tablename = 'accounts';
```

**PostgreSQL 18 RLSç­–ç•¥ç±»å‹**ï¼š

```sql
-- 1. ç®€å•ç­–ç•¥ï¼ˆå•æ¡ä»¶ï¼‰
CREATE POLICY simple_policy ON accounts
    FOR SELECT
    USING (user_id = 1);

-- 2. ç»„åˆç­–ç•¥ï¼ˆå¤šæ¡ä»¶ORï¼‰
CREATE POLICY manager_policy ON accounts
    FOR ALL
    USING (
        user_id = current_setting('app.current_user_id')::BIGINT OR
        current_setting('app.current_user_role') = 'manager'
    );

-- 3. ç»„åˆç­–ç•¥ï¼ˆå¤šæ¡ä»¶ANDï¼‰
CREATE POLICY strict_policy ON accounts
    FOR SELECT
    USING (
        user_id = current_setting('app.current_user_id')::BIGINT AND
        balance > 0
    );

-- 4. åŸºäºè§’è‰²çš„ç­–ç•¥
CREATE POLICY role_based_policy ON accounts
    FOR ALL
    TO manager_role
    USING (true)  -- ç®¡ç†å‘˜å¯ä»¥è®¿é—®æ‰€æœ‰è¡Œ
    WITH CHECK (true);

-- 5. åŸºäºæ—¶é—´çš„ç­–ç•¥
CREATE POLICY time_based_policy ON accounts
    FOR SELECT
    USING (
        user_id = current_setting('app.current_user_id')::BIGINT AND
        created_at >= NOW() - INTERVAL '1 year'
    );
```

**PostgreSQL 18 RLSæ€§èƒ½ä¼˜åŒ–**ï¼š

```sql
-- 1. åˆ›å»ºç´¢å¼•ä¼˜åŒ–ç­–ç•¥è¯„ä¼°ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç´¢å¼•';
            RETURN;
        END IF;

        IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE schemaname = 'public' AND tablename = 'accounts' AND indexname = 'idx_accounts_user_id') THEN
            CREATE INDEX idx_accounts_user_id ON accounts(user_id);
            RAISE NOTICE 'ç´¢å¼• idx_accounts_user_id åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'ç´¢å¼• idx_accounts_user_id å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN undefined_table THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨';
        WHEN duplicate_table THEN
            RAISE WARNING 'ç´¢å¼• idx_accounts_user_id å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºç´¢å¼•å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 2. ä½¿ç”¨éƒ¨åˆ†ç´¢å¼•ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºéƒ¨åˆ†ç´¢å¼•';
            RETURN;
        END IF;

        IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE schemaname = 'public' AND tablename = 'accounts' AND indexname = 'idx_accounts_active_user') THEN
            CREATE INDEX idx_accounts_active_user ON accounts(user_id)
            WHERE balance > 0;
            RAISE NOTICE 'éƒ¨åˆ†ç´¢å¼• idx_accounts_active_user åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'éƒ¨åˆ†ç´¢å¼• idx_accounts_active_user å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN undefined_table THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨';
        WHEN duplicate_table THEN
            RAISE WARNING 'éƒ¨åˆ†ç´¢å¼• idx_accounts_active_user å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºéƒ¨åˆ†ç´¢å¼•å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- 3. ç›‘æ§RLSç­–ç•¥æ€§èƒ½ï¼ˆå¸¦é”™è¯¯å¤„ç†å’Œæ€§èƒ½æµ‹è¯•ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•æ‰§è¡Œæ€§èƒ½æµ‹è¯•';
            RETURN;
        END IF;
        RAISE NOTICE 'å¼€å§‹ç›‘æ§RLSç­–ç•¥æ€§èƒ½';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'æ€§èƒ½æµ‹è¯•å‡†å¤‡å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

EXPLAIN (ANALYZE, BUFFERS, TIMING)
SELECT * FROM accounts WHERE balance > 1000;
-- æŸ¥çœ‹æ˜¯å¦ä½¿ç”¨äº†ç´¢å¼•ï¼Œç­–ç•¥è¯„ä¼°å¼€é”€

-- 4. PostgreSQL 18ï¼šæŸ¥çœ‹RLSç­–ç•¥ç»Ÿè®¡ï¼ˆå¸¦é”™è¯¯å¤„ç†å’Œæ€§èƒ½æµ‹è¯•ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'accounts') THEN
            RAISE WARNING 'è¡¨ accounts ä¸å­˜åœ¨ï¼Œæ— æ³•æŸ¥è¯¢ç»Ÿè®¡';
            RETURN;
        END IF;
        RAISE NOTICE 'å¼€å§‹æŸ¥è¯¢RLSç­–ç•¥ç»Ÿè®¡';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'æŸ¥è¯¢å‡†å¤‡å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

EXPLAIN (ANALYZE, BUFFERS, TIMING)
SELECT
    schemaname,
    tablename,
    seq_scan,
    idx_scan,
    n_tup_ins,
    n_tup_upd,
    n_tup_del
FROM pg_stat_user_tables
WHERE tablename = 'accounts';
```

### 5.2 SQLite 3.45 å®‰å…¨æœºåˆ¶å¯¹æ¯”

**SQLite 3.45 å®‰å…¨é™åˆ¶**ï¼š

SQLite 3.45**ä¸æ”¯æŒRLS**ï¼Œåªæ”¯æŒåŸºæœ¬çš„è¡¨çº§æƒé™æ§åˆ¶ã€‚

| ç‰¹æ€§ | PostgreSQL 18 RLS | SQLite 3.45 |
|------|------------------|-------------|
| **è¡Œçº§å®‰å…¨** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **ç­–ç•¥æœºåˆ¶** | âœ… æ”¯æŒå¤æ‚ç­–ç•¥ | âŒ ä¸æ”¯æŒ |
| **USINGå­å¥** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **WITH CHECKå­å¥** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **ç­–ç•¥ç»„åˆ** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **è¡¨çº§æƒé™** | âœ… æ”¯æŒ | âš ï¸ æœ‰é™æ”¯æŒ |

**SQLite 3.45æ›¿ä»£æ–¹æ¡ˆ**ï¼š

```sql
-- SQLite 3.45ï¼šä½¿ç”¨è§†å›¾æ¨¡æ‹ŸRLS
-- åˆ›å»ºåŸºç¡€è¡¨
CREATE TABLE accounts (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    account_name TEXT,
    user_id INTEGER NOT NULL,
    balance REAL NOT NULL DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºè§†å›¾ï¼ˆæ¨¡æ‹ŸRLSï¼‰
CREATE VIEW user_accounts AS
SELECT * FROM accounts
WHERE user_id = CAST(julianday('now') AS INTEGER);  -- ç®€åŒ–ç¤ºä¾‹ï¼Œå®é™…éœ€è¦åº”ç”¨å±‚ä¼ å…¥user_id

-- åº”ç”¨å±‚æ§åˆ¶è®¿é—®
-- åªèƒ½é€šè¿‡è§†å›¾è®¿é—®ï¼Œä¸èƒ½ç›´æ¥è®¿é—®è¡¨
-- ä½†è¿™ä¸æ˜¯çœŸæ­£çš„RLSï¼Œå› ä¸ºå¯ä»¥ç»•è¿‡è§†å›¾ç›´æ¥è®¿é—®è¡¨
```

### 5.3 å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹

#### åœºæ™¯1ï¼šå¤šç§Ÿæˆ·SaaSç³»ç»Ÿçš„æ•°æ®éš”ç¦»

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

- å¤šç§Ÿæˆ·SaaSç³»ç»Ÿï¼Œæ¯ä¸ªç§Ÿæˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- éœ€è¦ä¿è¯ç§Ÿæˆ·ä¹‹é—´çš„æ•°æ®å®Œå…¨éš”ç¦»
- é˜²æ­¢ç§Ÿæˆ·Aè®¿é—®ç§Ÿæˆ·Bçš„æ•°æ®

**æŠ€æœ¯æŒ‘æˆ˜**ï¼š

- ä¿è¯æ•°æ®éš”ç¦»çš„å®Œæ•´æ€§
- é˜²æ­¢ç»•è¿‡RLSç­–ç•¥
- ä¼˜åŒ–ç­–ç•¥è¯„ä¼°æ€§èƒ½

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åˆ›å»ºå¤šç§Ÿæˆ·è¡¨ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_orders') THEN
            CREATE TABLE tenant_orders (
                id BIGSERIAL PRIMARY KEY,
                tenant_id BIGINT NOT NULL,
                order_number VARCHAR(50) NOT NULL,
                total_amount DECIMAL(10,2),
                status VARCHAR(20),
                created_at TIMESTAMPTZ DEFAULT NOW()
            );
            RAISE NOTICE 'è¡¨ tenant_orders åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'è¡¨ tenant_orders å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'è¡¨ tenant_orders å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_products') THEN
            CREATE TABLE tenant_products (
                id BIGSERIAL PRIMARY KEY,
                tenant_id BIGINT NOT NULL,
                product_name VARCHAR(200),
                price DECIMAL(10,2),
                stock_quantity INTEGER
            );
            RAISE NOTICE 'è¡¨ tenant_products åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'è¡¨ tenant_products å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'è¡¨ tenant_products å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- åˆ›å»ºç´¢å¼•ä¼˜åŒ–RLSç­–ç•¥ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_orders') THEN
            RAISE WARNING 'è¡¨ tenant_orders ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç´¢å¼•';
        ELSE
            IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE schemaname = 'public' AND tablename = 'tenant_orders' AND indexname = 'idx_orders_tenant') THEN
                CREATE INDEX idx_orders_tenant ON tenant_orders(tenant_id);
                RAISE NOTICE 'ç´¢å¼• idx_orders_tenant åˆ›å»ºæˆåŠŸ';
            END IF;
        END IF;

        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_products') THEN
            RAISE WARNING 'è¡¨ tenant_products ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç´¢å¼•';
        ELSE
            IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE schemaname = 'public' AND tablename = 'tenant_products' AND indexname = 'idx_products_tenant') THEN
                CREATE INDEX idx_products_tenant ON tenant_products(tenant_id);
                RAISE NOTICE 'ç´¢å¼• idx_products_tenant åˆ›å»ºæˆåŠŸ';
            END IF;
        END IF;
    EXCEPTION
        WHEN undefined_table THEN
            RAISE WARNING 'è¡¨ä¸å­˜åœ¨';
        WHEN duplicate_table THEN
            RAISE WARNING 'éƒ¨åˆ†ç´¢å¼•å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºç´¢å¼•å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- å¯ç”¨RLSï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_orders') THEN
            RAISE WARNING 'è¡¨ tenant_orders ä¸å­˜åœ¨ï¼Œæ— æ³•å¯ç”¨RLS';
        ELSE
            ALTER TABLE tenant_orders ENABLE ROW LEVEL SECURITY;
            RAISE NOTICE 'è¡¨ tenant_orders å·²å¯ç”¨è¡Œçº§å®‰å…¨';
        END IF;

        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_products') THEN
            RAISE WARNING 'è¡¨ tenant_products ä¸å­˜åœ¨ï¼Œæ— æ³•å¯ç”¨RLS';
        ELSE
            ALTER TABLE tenant_products ENABLE ROW LEVEL SECURITY;
            RAISE NOTICE 'è¡¨ tenant_products å·²å¯ç”¨è¡Œçº§å®‰å…¨';
        END IF;
    EXCEPTION
        WHEN undefined_table THEN
            RAISE WARNING 'è¡¨ä¸å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'å¯ç”¨RLSå¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- åˆ›å»ºç§Ÿæˆ·éš”ç¦»ç­–ç•¥ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_orders') THEN
            RAISE WARNING 'è¡¨ tenant_orders ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'tenant_orders' AND policyname = 'tenant_orders_policy') THEN
            DROP POLICY tenant_orders_policy ON tenant_orders;
        END IF;

        CREATE POLICY tenant_orders_policy ON tenant_orders
            FOR ALL
            USING (tenant_id = current_setting('app.current_tenant_id')::BIGINT)
            WITH CHECK (tenant_id = current_setting('app.current_tenant_id')::BIGINT);
        RAISE NOTICE 'ç§Ÿæˆ·è®¢å•éš”ç¦»ç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºç§Ÿæˆ·è®¢å•éš”ç¦»ç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_products') THEN
            RAISE WARNING 'è¡¨ tenant_products ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'tenant_products' AND policyname = 'tenant_products_policy') THEN
            DROP POLICY tenant_products_policy ON tenant_products;
        END IF;

        CREATE POLICY tenant_products_policy ON tenant_products
            FOR ALL
            USING (tenant_id = current_setting('app.current_tenant_id')::BIGINT)
            WITH CHECK (tenant_id = current_setting('app.current_tenant_id')::BIGINT);
        RAISE NOTICE 'ç§Ÿæˆ·äº§å“éš”ç¦»ç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºç§Ÿæˆ·äº§å“éš”ç¦»ç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- åœºæ™¯ï¼šç§Ÿæˆ·1è®¿é—®æ•°æ®ï¼ˆå¸¦é”™è¯¯å¤„ç†å’Œæ€§èƒ½æµ‹è¯•ï¼‰
DO $$
BEGIN
    PERFORM set_config('app.current_tenant_id', '1', false);
    RAISE NOTICE 'å½“å‰ç§Ÿæˆ·IDå·²è®¾ç½®ä¸º1';
EXCEPTION
    WHEN OTHERS THEN
        RAISE WARNING 'è®¾ç½®å½“å‰ç§Ÿæˆ·IDå¤±è´¥: %', SQLERRM;
END $$;

DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'tenant_orders') THEN
            RAISE WARNING 'è¡¨ tenant_orders ä¸å­˜åœ¨ï¼Œæ— æ³•æ‰§è¡ŒæŸ¥è¯¢';
            RETURN;
        END IF;
        RAISE NOTICE 'å¼€å§‹æ‰§è¡Œç§Ÿæˆ·æ•°æ®æŸ¥è¯¢';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'æŸ¥è¯¢å‡†å¤‡å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

EXPLAIN (ANALYZE, BUFFERS, TIMING)
SELECT * FROM tenant_orders;
-- ç»“æœï¼šåªè¿”å›tenant_id = 1çš„è®¢å•

-- åœºæ™¯ï¼šç§Ÿæˆ·2è®¿é—®æ•°æ®ï¼ˆæ— æ³•è®¿é—®ç§Ÿæˆ·1çš„æ•°æ®ï¼‰
SET app.current_tenant_id = '2';
SELECT * FROM tenant_orders;
-- ç»“æœï¼šåªè¿”å›tenant_id = 2çš„è®¢å•ï¼Œæ— æ³•çœ‹åˆ°tenant_id = 1çš„è®¢å•

-- éªŒè¯ï¼šå°è¯•ç»•è¿‡RLSï¼ˆå¤±è´¥ï¼‰
SET app.current_tenant_id = '1';
-- å°è¯•ç›´æ¥æŸ¥è¯¢ç§Ÿæˆ·2çš„æ•°æ®
SELECT * FROM tenant_orders WHERE tenant_id = 2;
-- ç»“æœï¼šè¿”å›ç©ºé›†ï¼ˆRLSç­–ç•¥è¿‡æ»¤ï¼‰

-- éªŒè¯ï¼šå°è¯•é€šè¿‡å‡½æ•°ç»•è¿‡ï¼ˆå¤±è´¥ï¼‰
CREATE FUNCTION get_all_orders()
RETURNS TABLE(id BIGINT, tenant_id BIGINT, order_number VARCHAR)
SECURITY INVOKER  -- ä½¿ç”¨è°ƒç”¨è€…æƒé™
AS $$
BEGIN
    RETURN QUERY SELECT * FROM tenant_orders;
END;
$$ LANGUAGE plpgsql;

SET app.current_tenant_id = '1';
SELECT * FROM get_all_orders();
-- ç»“æœï¼šåªè¿”å›tenant_id = 1çš„è®¢å•ï¼ˆå‡½æ•°å†…éƒ¨ä»ç„¶åº”ç”¨RLSç­–ç•¥ï¼‰
```

**æ€§èƒ½æ•°æ®**ï¼š

| æŒ‡æ ‡ | æ— RLS | æœ‰RLS | è¯´æ˜ |
|------|-------|-------|------|
| **æŸ¥è¯¢å»¶è¿Ÿ** | 5ms | 6ms | RLSç­–ç•¥è¯„ä¼°å¼€é”€çº¦1ms |
| **ç´¢å¼•ä½¿ç”¨** | âœ… | âœ… | ç­–ç•¥æ¡ä»¶å¯ä»¥ä½¿ç”¨ç´¢å¼• |
| **æ•°æ®éš”ç¦»** | âŒ | âœ… | RLSä¿è¯æ•°æ®éš”ç¦» |

#### åœºæ™¯2ï¼šåŒ»ç–—ç³»ç»Ÿçš„æ‚£è€…æ•°æ®éšç§ä¿æŠ¤

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

- åŒ»ç–—ç³»ç»Ÿéœ€è¦ä¿æŠ¤æ‚£è€…æ•°æ®éšç§
- åŒ»ç”Ÿåªèƒ½è®¿é—®è‡ªå·±è´Ÿè´£çš„æ‚£è€…æ•°æ®
- éœ€è¦ç¬¦åˆHIPAAç­‰æ³•è§„è¦æ±‚

**æŠ€æœ¯æŒ‘æˆ˜**ï¼š

- ä¿è¯æ‚£è€…æ•°æ®éšç§
- æ”¯æŒå¤æ‚çš„è®¿é—®æ§åˆ¶è§„åˆ™
- å®¡è®¡æ‰€æœ‰æ•°æ®è®¿é—®

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åˆ›å»ºæ‚£è€…è¡¨ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'patients') THEN
            CREATE TABLE patients (
                id BIGSERIAL PRIMARY KEY,
                patient_name VARCHAR(100),
                ssn VARCHAR(20),
                doctor_id BIGINT,
                department_id BIGINT,
                created_at TIMESTAMPTZ DEFAULT NOW()
            );
            RAISE NOTICE 'è¡¨ patients åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'è¡¨ patients å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'è¡¨ patients å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'medical_records') THEN
            IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'patients') THEN
                RAISE WARNING 'è¡¨ patients ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºå¤–é”®çº¦æŸ';
            END IF;

            CREATE TABLE medical_records (
                id BIGSERIAL PRIMARY KEY,
                patient_id BIGINT REFERENCES patients(id),
                doctor_id BIGINT,
                diagnosis TEXT,
                treatment TEXT,
                record_date DATE,
                created_at TIMESTAMPTZ DEFAULT NOW()
            );
            RAISE NOTICE 'è¡¨ medical_records åˆ›å»ºæˆåŠŸ';
        ELSE
            RAISE NOTICE 'è¡¨ medical_records å·²å­˜åœ¨';
        END IF;
    EXCEPTION
        WHEN duplicate_table THEN
            RAISE WARNING 'è¡¨ medical_records å·²å­˜åœ¨';
        WHEN foreign_key_violation THEN
            RAISE WARNING 'å¤–é”®çº¦æŸå¤±è´¥ï¼Œè¯·ç¡®ä¿è¡¨ patients å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºè¡¨å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- åˆ›å»ºç´¢å¼•ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'patients') THEN
            RAISE WARNING 'è¡¨ patients ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç´¢å¼•';
        ELSE
            IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE schemaname = 'public' AND tablename = 'patients' AND indexname = 'idx_patients_doctor') THEN
                CREATE INDEX idx_patients_doctor ON patients(doctor_id);
                RAISE NOTICE 'ç´¢å¼• idx_patients_doctor åˆ›å»ºæˆåŠŸ';
            END IF;
        END IF;

        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'medical_records') THEN
            RAISE WARNING 'è¡¨ medical_records ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç´¢å¼•';
        ELSE
            IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE schemaname = 'public' AND tablename = 'medical_records' AND indexname = 'idx_records_patient') THEN
                CREATE INDEX idx_records_patient ON medical_records(patient_id);
                RAISE NOTICE 'ç´¢å¼• idx_records_patient åˆ›å»ºæˆåŠŸ';
            END IF;
            IF NOT EXISTS (SELECT 1 FROM pg_indexes WHERE schemaname = 'public' AND tablename = 'medical_records' AND indexname = 'idx_records_doctor') THEN
                CREATE INDEX idx_records_doctor ON medical_records(doctor_id);
                RAISE NOTICE 'ç´¢å¼• idx_records_doctor åˆ›å»ºæˆåŠŸ';
            END IF;
        END IF;
    EXCEPTION
        WHEN undefined_table THEN
            RAISE WARNING 'è¡¨ä¸å­˜åœ¨';
        WHEN duplicate_table THEN
            RAISE WARNING 'éƒ¨åˆ†ç´¢å¼•å·²å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºç´¢å¼•å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- å¯ç”¨RLSï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'patients') THEN
            RAISE WARNING 'è¡¨ patients ä¸å­˜åœ¨ï¼Œæ— æ³•å¯ç”¨RLS';
        ELSE
            ALTER TABLE patients ENABLE ROW LEVEL SECURITY;
            RAISE NOTICE 'è¡¨ patients å·²å¯ç”¨è¡Œçº§å®‰å…¨';
        END IF;

        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'medical_records') THEN
            RAISE WARNING 'è¡¨ medical_records ä¸å­˜åœ¨ï¼Œæ— æ³•å¯ç”¨RLS';
        ELSE
            ALTER TABLE medical_records ENABLE ROW LEVEL SECURITY;
            RAISE NOTICE 'è¡¨ medical_records å·²å¯ç”¨è¡Œçº§å®‰å…¨';
        END IF;
    EXCEPTION
        WHEN undefined_table THEN
            RAISE WARNING 'è¡¨ä¸å­˜åœ¨';
        WHEN OTHERS THEN
            RAISE WARNING 'å¯ç”¨RLSå¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

-- åˆ›å»ºåŒ»ç”Ÿè®¿é—®ç­–ç•¥ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰
DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'patients') THEN
            RAISE WARNING 'è¡¨ patients ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'patients' AND policyname = 'doctor_patients_policy') THEN
            DROP POLICY doctor_patients_policy ON patients;
        END IF;

        CREATE POLICY doctor_patients_policy ON patients
            FOR SELECT
            USING (
                doctor_id = current_setting('app.current_doctor_id')::BIGINT OR
                department_id = current_setting('app.current_department_id')::BIGINT
            );
        RAISE NOTICE 'åŒ»ç”Ÿæ‚£è€…è®¿é—®ç­–ç•¥åˆ›å»ºæˆåŠŸ';
    EXCEPTION
        WHEN OTHERS THEN
            RAISE WARNING 'åˆ›å»ºåŒ»ç”Ÿæ‚£è€…è®¿é—®ç­–ç•¥å¤±è´¥: %', SQLERRM;
            RAISE;
    END;
END $$;

DO $$
BEGIN
    BEGIN
        IF NOT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'medical_records') THEN
            RAISE WARNING 'è¡¨ medical_records ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºç­–ç•¥';
            RETURN;
        END IF;

        IF EXISTS (SELECT 1 FROM pg_policies WHERE schemaname = 'public' AND tablename = 'medical_records' AND policyname = 'doctor_records_policy') THEN
            DROP POLICY doctor_records_policy ON medical_records;
        END IF;

        CREATE POLICY doctor_records_policy ON medical_records
            FOR ALL
            USING (
        doctor_id = current_setting('app.current_doctor_id')::BIGINT OR
        patient_id IN (
            SELECT id FROM patients
            WHERE doctor_id = current_setting('app.current_doctor_id')::BIGINT
        )
    )
    WITH CHECK (
        doctor_id = current_setting('app.current_doctor_id')::BIGINT
    );

-- åœºæ™¯ï¼šåŒ»ç”Ÿ1è®¿é—®æ‚£è€…æ•°æ®
SET app.current_doctor_id = '1';
SELECT * FROM patients;
-- ç»“æœï¼šåªè¿”å›doctor_id = 1æˆ–åŒéƒ¨é—¨çš„æ‚£è€…

-- åœºæ™¯ï¼šåŒ»ç”Ÿ1è®¿é—®åŒ»ç–—è®°å½•
SELECT * FROM medical_records;
-- ç»“æœï¼šåªè¿”å›doctor_id = 1æˆ–æ‚£è€…å±äºåŒ»ç”Ÿ1çš„è®°å½•

-- éªŒè¯ï¼šåŒ»ç”Ÿ1æ— æ³•è®¿é—®å…¶ä»–åŒ»ç”Ÿçš„æ‚£è€…
SET app.current_doctor_id = '1';
SELECT * FROM patients WHERE doctor_id = 2;
-- ç»“æœï¼šè¿”å›ç©ºé›†ï¼ˆRLSç­–ç•¥è¿‡æ»¤ï¼‰

-- éªŒè¯ï¼šå®¡è®¡æ—¥å¿—ï¼ˆPostgreSQL 18ï¼‰
-- å¯ç”¨å®¡è®¡æ—¥å¿—
ALTER SYSTEM SET log_statement = 'all';
ALTER SYSTEM SET log_min_duration_statement = 0;

-- æ‰€æœ‰RLSç­–ç•¥è¯„ä¼°éƒ½ä¼šè¢«è®°å½•
```

### 5.4 RLSå®‰å…¨æœ€ä½³å®è·µ

**PostgreSQL 18æœ€ä½³å®è·µ**ï¼š

```sql
-- 1. å§‹ç»ˆå¯ç”¨RLSï¼ˆé»˜è®¤æ‹’ç»ï¼‰
ALTER TABLE sensitive_table ENABLE ROW LEVEL SECURITY;

-- 2. åˆ›å»ºæ˜ç¡®çš„ç­–ç•¥ï¼ˆé¿å…è¿‡äºå®½æ³›çš„ç­–ç•¥ï¼‰
CREATE POLICY explicit_policy ON sensitive_table
    FOR SELECT
    USING (user_id = current_setting('app.current_user_id')::BIGINT);

-- 3. ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–ç­–ç•¥è¯„ä¼°
CREATE INDEX idx_table_user_id ON sensitive_table(user_id);

-- 4. æµ‹è¯•ç­–ç•¥ï¼ˆéªŒè¯ä¸å¯é€ƒé€¸æ€§ï¼‰
-- æµ‹è¯•ç›´æ¥æŸ¥è¯¢
SET app.current_user_id = '1';
SELECT * FROM sensitive_table WHERE user_id = 2;
-- åº”è¯¥è¿”å›ç©ºé›†

-- æµ‹è¯•å‡½æ•°è°ƒç”¨
CREATE FUNCTION test_function()
RETURNS TABLE(id BIGINT, user_id BIGINT)
SECURITY INVOKER
AS $$
BEGIN
    RETURN QUERY SELECT * FROM sensitive_table;
END;
$$ LANGUAGE plpgsql;

SET app.current_user_id = '1';
SELECT * FROM test_function();
-- åº”è¯¥åªè¿”å›user_id = 1çš„è¡Œ

-- 5. ç›‘æ§RLSç­–ç•¥æ€§èƒ½
EXPLAIN (ANALYZE, BUFFERS)
SELECT * FROM sensitive_table;
-- æ£€æŸ¥ç­–ç•¥è¯„ä¼°å¼€é”€
```

### 5.5 æ¨¡å‹é€‰æ‹©å»ºè®®

**é€‰æ‹©PostgreSQL 18 RLSçš„åœºæ™¯**ï¼š

âœ… **æ¨èåœºæ™¯**ï¼š

- å¤šç§Ÿæˆ·ç³»ç»Ÿ
- éœ€è¦è¡Œçº§è®¿é—®æ§åˆ¶
- éœ€è¦ç¬¦åˆæ•°æ®éšç§æ³•è§„
- éœ€è¦ç»†ç²’åº¦æƒé™æ§åˆ¶

âŒ **ä¸æ¨èåœºæ™¯**ï¼š

- å•ç”¨æˆ·åº”ç”¨
- ä¸éœ€è¦è¡Œçº§è®¿é—®æ§åˆ¶
- å¯¹æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯

**é€‰æ‹©SQLite 3.45çš„åœºæ™¯**ï¼š

âœ… **æ¨èåœºæ™¯**ï¼š

- å•æœºåº”ç”¨
- ä¸éœ€è¦è¡Œçº§å®‰å…¨
- ç®€å•çš„æƒé™æ§åˆ¶å³å¯

âŒ **ä¸æ¨èåœºæ™¯**ï¼š

- å¤šç§Ÿæˆ·ç³»ç»Ÿ
- éœ€è¦è¡Œçº§è®¿é—®æ§åˆ¶
- éœ€è¦ç¬¦åˆæ•°æ®éšç§æ³•è§„

---

## 6. ç›¸å…³æ–‡æ¡£

### 6.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [å½¢å¼è¯­è¨€ä¸è¯æ˜ï¼šæ€»è®º](./1.1.25-å½¢å¼è¯­è¨€ä¸è¯æ˜-æ€»è®º.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](./README.md)

---

## 7. å‚è€ƒæ–‡çŒ®

### 7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®

- **Denning, D. E. (1976). "A Lattice Model of Secure Information Flow."**
  - ä¼šè®®: Communications of the ACM 1976
  - **é‡è¦æ€§**: ä¿¡æ¯æµå®‰å…¨çš„ç»å…¸è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†ä¿¡æ¯æµå®‰å…¨çš„ç†è®ºæ¡†æ¶

- **Sabelfeld, A., & Myers, A. C. (2003). "Language-Based Information-Flow Security."**
  - ä¼šè®®: IEEE Journal on Selected Areas in Communications 2003
  - **é‡è¦æ€§**: åŸºäºè¯­è¨€çš„ä¿¡æ¯æµå®‰å…¨ç ”ç©¶
  - **æ ¸å¿ƒè´¡çŒ®**: æä¾›äº†ä¿¡æ¯æµå®‰å…¨çš„å½¢å¼åŒ–æ–¹æ³•

### 7.2 PostgreSQLå®ç°ç›¸å…³

- **[PostgreSQLå®˜æ–¹æ–‡æ¡£ - è¡Œçº§å®‰å…¨](<https://www.postgresql.org/docs/current/ddl-rowsecurity.html>)**
  - PostgreSQL RLSå®ç°è¯´æ˜

- **[PostgreSQLå®˜æ–¹æ–‡æ¡£ - å®‰å…¨](<https://www.postgresql.org/docs/current/security.html>)**
  - PostgreSQLå®‰å…¨æœºåˆ¶è¯´æ˜

### 7.3 ç›¸å…³æ–‡æ¡£

- [ç†è®ºåŸºç¡€å¯¼èˆª](./README.md)

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: âœ… å†…å®¹å·²æ·±åŒ–ï¼ŒåŒ…å«å®Œæ•´è¯æ˜ã€åœºæ™¯æ¡ˆä¾‹å’ŒPostgreSQL 18/SQLiteå¯¹æ¯”
