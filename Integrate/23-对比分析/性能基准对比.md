---

> **ğŸ“‹ æ–‡æ¡£æ¥æº**: `PostgreSQL_AI\06-å¯¹æ¯”åˆ†æ\æ€§èƒ½åŸºå‡†å¯¹æ¯”.md`
> **ğŸ“… å¤åˆ¶æ—¥æœŸ**: 2025-12-22
> **âš ï¸ æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºå¤åˆ¶ç‰ˆæœ¬ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜

---

# æ€§èƒ½åŸºå‡†å¯¹æ¯”

> **æ–‡æ¡£ç¼–å·**: AI-06-04
> **æœ€åæ›´æ–°**: 2025å¹´1æœˆ
> **ä¸»é¢˜**: 06-å¯¹æ¯”åˆ†æ
> **å­ä¸»é¢˜**: 04-æ€§èƒ½åŸºå‡†å¯¹æ¯”

## ğŸ“‘ ç›®å½•

- [æ€§èƒ½åŸºå‡†å¯¹æ¯”](#æ€§èƒ½åŸºå‡†å¯¹æ¯”)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
- [PostgreSQLæ€§èƒ½åŸºå‡†å¯¹æ¯”å®Œæ•´æŒ‡å—](#postgresqlæ€§èƒ½åŸºå‡†å¯¹æ¯”å®Œæ•´æŒ‡å—)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•-1)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 æ€§èƒ½å¯¹æ¯”çš„é‡è¦æ€§](#11-æ€§èƒ½å¯¹æ¯”çš„é‡è¦æ€§)
    - [1.2 æ€§èƒ½å¯¹æ¯”æ€ç»´å¯¼å›¾](#12-æ€§èƒ½å¯¹æ¯”æ€ç»´å¯¼å›¾)
    - [1.3 æ€§èƒ½æŒ‡æ ‡åˆ†ç±»](#13-æ€§èƒ½æŒ‡æ ‡åˆ†ç±»)
  - [2. æµ‹è¯•ç¯å¢ƒé…ç½®](#2-æµ‹è¯•ç¯å¢ƒé…ç½®)
    - [2.1 ç¡¬ä»¶é…ç½®](#21-ç¡¬ä»¶é…ç½®)
    - [2.2 è½¯ä»¶ç‰ˆæœ¬](#22-è½¯ä»¶ç‰ˆæœ¬)
    - [2.3 æµ‹è¯•æ•°æ®](#23-æµ‹è¯•æ•°æ®)
    - [2.4 æµ‹è¯•å·¥å…·](#24-æµ‹è¯•å·¥å…·)
  - [3. æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡](#3-æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡)
    - [3.1 å»¶è¿Ÿå¯¹æ¯”](#31-å»¶è¿Ÿå¯¹æ¯”)
    - [3.2 ååé‡å¯¹æ¯”](#32-ååé‡å¯¹æ¯”)
    - [3.3 å¬å›ç‡å¯¹æ¯”](#33-å¬å›ç‡å¯¹æ¯”)
    - [3.4 å¹¶å‘æ€§èƒ½](#34-å¹¶å‘æ€§èƒ½)
  - [4. æ··åˆæŸ¥è¯¢æ€§èƒ½](#4-æ··åˆæŸ¥è¯¢æ€§èƒ½)
    - [4.1 å‘é‡+SQLæŸ¥è¯¢](#41-å‘é‡sqlæŸ¥è¯¢)
    - [4.2 å‘é‡+å…¨æ–‡æœç´¢](#42-å‘é‡å…¨æ–‡æœç´¢)
    - [4.3 å‘é‡+åœ°ç†ç©ºé—´](#43-å‘é‡åœ°ç†ç©ºé—´)
    - [4.4 å‘é‡+JSONBæŸ¥è¯¢](#44-å‘é‡jsonbæŸ¥è¯¢)
  - [5. ä¸åŒè§„æ¨¡æ€§èƒ½æµ‹è¯•](#5-ä¸åŒè§„æ¨¡æ€§èƒ½æµ‹è¯•)
    - [5.1 100ä¸‡å‘é‡æµ‹è¯•](#51-100ä¸‡å‘é‡æµ‹è¯•)
    - [5.2 1000ä¸‡å‘é‡æµ‹è¯•](#52-1000ä¸‡å‘é‡æµ‹è¯•)
    - [5.3 1äº¿å‘é‡æµ‹è¯•](#53-1äº¿å‘é‡æµ‹è¯•)
    - [5.4 10äº¿å‘é‡æµ‹è¯•](#54-10äº¿å‘é‡æµ‹è¯•)
  - [6. æ€§èƒ½æˆæœ¬åˆ†æ](#6-æ€§èƒ½æˆæœ¬åˆ†æ)
    - [6.1 æ€§èƒ½/æˆæœ¬æ¯”](#61-æ€§èƒ½æˆæœ¬æ¯”)
    - [6.2 ROIåˆ†æ](#62-roiåˆ†æ)
    - [6.3 æ€§ä»·æ¯”å¯¹æ¯”](#63-æ€§ä»·æ¯”å¯¹æ¯”)
  - [7. æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”](#7-æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”)
    - [7.1 ç´¢å¼•ä¼˜åŒ–](#71-ç´¢å¼•ä¼˜åŒ–)
    - [7.2 æŸ¥è¯¢ä¼˜åŒ–](#72-æŸ¥è¯¢ä¼˜åŒ–)
    - [7.3 é…ç½®ä¼˜åŒ–](#73-é…ç½®ä¼˜åŒ–)
  - [8. æœ€ä½³å®è·µ](#8-æœ€ä½³å®è·µ)
    - [8.1 åŸºå‡†æµ‹è¯•æ–¹æ³•](#81-åŸºå‡†æµ‹è¯•æ–¹æ³•)
    - [8.2 æ€§èƒ½å¯¹æ¯”æŠ€å·§](#82-æ€§èƒ½å¯¹æ¯”æŠ€å·§)
    - [8.3 å¸¸è§é”™è¯¯](#83-å¸¸è§é”™è¯¯)
  - [ğŸ“š ç›¸å…³æ–‡æ¡£](#-ç›¸å…³æ–‡æ¡£)

---

**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: AI-06-04

---

# PostgreSQLæ€§èƒ½åŸºå‡†å¯¹æ¯”å®Œæ•´æŒ‡å—

> **åˆ›å»ºæ—¥æœŸ**: 2025å¹´1æœˆ
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 17+/18+
> **éš¾åº¦ç­‰çº§**: â­â­â­â­ é«˜çº§
> **é€‚ç”¨åœºæ™¯**: æ€§èƒ½è¯„ä¼°ã€æŠ€æœ¯é€‰å‹ã€åŸºå‡†æµ‹è¯•ã€æ€§èƒ½ä¼˜åŒ–

---

## ğŸ“‹ ç›®å½•

- [æ€§èƒ½åŸºå‡†å¯¹æ¯”](#æ€§èƒ½åŸºå‡†å¯¹æ¯”)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
- [PostgreSQLæ€§èƒ½åŸºå‡†å¯¹æ¯”å®Œæ•´æŒ‡å—](#postgresqlæ€§èƒ½åŸºå‡†å¯¹æ¯”å®Œæ•´æŒ‡å—)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•-1)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 æ€§èƒ½å¯¹æ¯”çš„é‡è¦æ€§](#11-æ€§èƒ½å¯¹æ¯”çš„é‡è¦æ€§)
    - [1.2 æ€§èƒ½å¯¹æ¯”æ€ç»´å¯¼å›¾](#12-æ€§èƒ½å¯¹æ¯”æ€ç»´å¯¼å›¾)
    - [1.3 æ€§èƒ½æŒ‡æ ‡åˆ†ç±»](#13-æ€§èƒ½æŒ‡æ ‡åˆ†ç±»)
  - [2. æµ‹è¯•ç¯å¢ƒé…ç½®](#2-æµ‹è¯•ç¯å¢ƒé…ç½®)
    - [2.1 ç¡¬ä»¶é…ç½®](#21-ç¡¬ä»¶é…ç½®)
    - [2.2 è½¯ä»¶ç‰ˆæœ¬](#22-è½¯ä»¶ç‰ˆæœ¬)
    - [2.3 æµ‹è¯•æ•°æ®](#23-æµ‹è¯•æ•°æ®)
    - [2.4 æµ‹è¯•å·¥å…·](#24-æµ‹è¯•å·¥å…·)
  - [3. æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡](#3-æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡)
    - [3.1 å»¶è¿Ÿå¯¹æ¯”](#31-å»¶è¿Ÿå¯¹æ¯”)
    - [3.2 ååé‡å¯¹æ¯”](#32-ååé‡å¯¹æ¯”)
    - [3.3 å¬å›ç‡å¯¹æ¯”](#33-å¬å›ç‡å¯¹æ¯”)
    - [3.4 å¹¶å‘æ€§èƒ½](#34-å¹¶å‘æ€§èƒ½)
  - [4. æ··åˆæŸ¥è¯¢æ€§èƒ½](#4-æ··åˆæŸ¥è¯¢æ€§èƒ½)
    - [4.1 å‘é‡+SQLæŸ¥è¯¢](#41-å‘é‡sqlæŸ¥è¯¢)
    - [4.2 å‘é‡+å…¨æ–‡æœç´¢](#42-å‘é‡å…¨æ–‡æœç´¢)
    - [4.3 å‘é‡+åœ°ç†ç©ºé—´](#43-å‘é‡åœ°ç†ç©ºé—´)
    - [4.4 å‘é‡+JSONBæŸ¥è¯¢](#44-å‘é‡jsonbæŸ¥è¯¢)
  - [5. ä¸åŒè§„æ¨¡æ€§èƒ½æµ‹è¯•](#5-ä¸åŒè§„æ¨¡æ€§èƒ½æµ‹è¯•)
    - [5.1 100ä¸‡å‘é‡æµ‹è¯•](#51-100ä¸‡å‘é‡æµ‹è¯•)
    - [5.2 1000ä¸‡å‘é‡æµ‹è¯•](#52-1000ä¸‡å‘é‡æµ‹è¯•)
    - [5.3 1äº¿å‘é‡æµ‹è¯•](#53-1äº¿å‘é‡æµ‹è¯•)
    - [5.4 10äº¿å‘é‡æµ‹è¯•](#54-10äº¿å‘é‡æµ‹è¯•)
  - [6. æ€§èƒ½æˆæœ¬åˆ†æ](#6-æ€§èƒ½æˆæœ¬åˆ†æ)
    - [6.1 æ€§èƒ½/æˆæœ¬æ¯”](#61-æ€§èƒ½æˆæœ¬æ¯”)
    - [6.2 ROIåˆ†æ](#62-roiåˆ†æ)
    - [6.3 æ€§ä»·æ¯”å¯¹æ¯”](#63-æ€§ä»·æ¯”å¯¹æ¯”)
  - [7. æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”](#7-æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”)
    - [7.1 ç´¢å¼•ä¼˜åŒ–](#71-ç´¢å¼•ä¼˜åŒ–)
    - [7.2 æŸ¥è¯¢ä¼˜åŒ–](#72-æŸ¥è¯¢ä¼˜åŒ–)
    - [7.3 é…ç½®ä¼˜åŒ–](#73-é…ç½®ä¼˜åŒ–)
  - [8. æœ€ä½³å®è·µ](#8-æœ€ä½³å®è·µ)
    - [8.1 åŸºå‡†æµ‹è¯•æ–¹æ³•](#81-åŸºå‡†æµ‹è¯•æ–¹æ³•)
    - [8.2 æ€§èƒ½å¯¹æ¯”æŠ€å·§](#82-æ€§èƒ½å¯¹æ¯”æŠ€å·§)
    - [8.3 å¸¸è§é”™è¯¯](#83-å¸¸è§é”™è¯¯)
  - [ğŸ“š ç›¸å…³æ–‡æ¡£](#-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

### 1.1 æ€§èƒ½å¯¹æ¯”çš„é‡è¦æ€§

æ€§èƒ½åŸºå‡†å¯¹æ¯”æ˜¯æŠ€æœ¯é€‰å‹å’Œæ€§èƒ½ä¼˜åŒ–çš„é‡è¦ä¾æ®ï¼Œå¸®åŠ©å…¨é¢è¯„ä¼°PostgreSQLåœ¨ä¸åŒåœºæ™¯ä¸‹çš„æ€§èƒ½è¡¨ç°ã€‚

**æ€§èƒ½å¯¹æ¯”çš„ä»·å€¼**ï¼š

- **æŠ€æœ¯é€‰å‹æ”¯æŒ**ï¼šä¸ºæ•°æ®åº“é€‰å‹æä¾›æ•°æ®æ”¯æŒ
- **æ€§èƒ½ä¼˜åŒ–æŒ‡å¯¼**ï¼šè¯†åˆ«æ€§èƒ½ç“¶é¢ˆå’Œä¼˜åŒ–æœºä¼š
- **å®¹é‡è§„åˆ’**ï¼šé¢„æµ‹ç³»ç»Ÿå®¹é‡å’Œæ‰©å±•éœ€æ±‚
- **æˆæœ¬ä¼˜åŒ–**ï¼šå¹³è¡¡æ€§èƒ½å’Œæˆæœ¬

**æ€§èƒ½å¯¹æ¯”ç»´åº¦**ï¼š

| ç»´åº¦ | æŒ‡æ ‡ | é‡è¦æ€§ |
|------|------|--------|
| **å»¶è¿Ÿ** | P50/P95/P99å»¶è¿Ÿ | â­â­â­â­â­ |
| **ååé‡** | QPS/TPS | â­â­â­â­â­ |
| **å¬å›ç‡** | æ£€ç´¢å‡†ç¡®ç‡ | â­â­â­â­ |
| **å¹¶å‘** | å¹¶å‘ç”¨æˆ·æ•° | â­â­â­â­ |
| **èµ„æº** | CPU/å†…å­˜/IO | â­â­â­ |

### 1.2 æ€§èƒ½å¯¹æ¯”æ€ç»´å¯¼å›¾

**æ€§èƒ½å¯¹æ¯”æ¡†æ¶**ï¼š

```text
æ€§èƒ½åŸºå‡†å¯¹æ¯”
â”œâ”€â”€ æµ‹è¯•ç¯å¢ƒ
â”‚   â”œâ”€â”€ ç¡¬ä»¶é…ç½®
â”‚   â”œâ”€â”€ è½¯ä»¶ç‰ˆæœ¬
â”‚   â””â”€â”€ æµ‹è¯•æ•°æ®
â”œâ”€â”€ æ ¸å¿ƒæŒ‡æ ‡
â”‚   â”œâ”€â”€ å»¶è¿Ÿï¼ˆP50/P95/P99ï¼‰
â”‚   â”œâ”€â”€ ååé‡ï¼ˆQPS/TPSï¼‰
â”‚   â”œâ”€â”€ å¬å›ç‡ï¼ˆRecall@Kï¼‰
â”‚   â””â”€â”€ å¹¶å‘æ€§èƒ½
â”œâ”€â”€ æ··åˆæŸ¥è¯¢
â”‚   â”œâ”€â”€ å‘é‡+SQL
â”‚   â”œâ”€â”€ å‘é‡+å…¨æ–‡æœç´¢
â”‚   â”œâ”€â”€ å‘é‡+åœ°ç†ç©ºé—´
â”‚   â””â”€â”€ å‘é‡+JSONB
â”œâ”€â”€ è§„æ¨¡æµ‹è¯•
â”‚   â”œâ”€â”€ 100ä¸‡å‘é‡
â”‚   â”œâ”€â”€ 1000ä¸‡å‘é‡
â”‚   â”œâ”€â”€ 1äº¿å‘é‡
â”‚   â””â”€â”€ 10äº¿å‘é‡
â””â”€â”€ æˆæœ¬åˆ†æ
    â”œâ”€â”€ æ€§èƒ½/æˆæœ¬æ¯”
    â”œâ”€â”€ ROIåˆ†æ
    â””â”€â”€ æ€§ä»·æ¯”å¯¹æ¯”
```

### 1.3 æ€§èƒ½æŒ‡æ ‡åˆ†ç±»

**å»¶è¿ŸæŒ‡æ ‡**ï¼š

- **P50å»¶è¿Ÿ**ï¼š50%è¯·æ±‚çš„å“åº”æ—¶é—´
- **P95å»¶è¿Ÿ**ï¼š95%è¯·æ±‚çš„å“åº”æ—¶é—´
- **P99å»¶è¿Ÿ**ï¼š99%è¯·æ±‚çš„å“åº”æ—¶é—´
- **å¹³å‡å»¶è¿Ÿ**ï¼šæ‰€æœ‰è¯·æ±‚çš„å¹³å‡å“åº”æ—¶é—´

**ååé‡æŒ‡æ ‡**ï¼š

- **QPS**ï¼šæ¯ç§’æŸ¥è¯¢æ•°ï¼ˆQueries Per Secondï¼‰
- **TPS**ï¼šæ¯ç§’äº‹åŠ¡æ•°ï¼ˆTransactions Per Secondï¼‰
- **ååé‡**ï¼šå•ä½æ—¶é—´å†…å¤„ç†çš„æ•°æ®é‡

**å‡†ç¡®æ€§æŒ‡æ ‡**ï¼š

- **å¬å›ç‡ï¼ˆRecall@Kï¼‰**ï¼šå‰Kä¸ªç»“æœä¸­åŒ…å«æ­£ç¡®ç­”æ¡ˆçš„æ¯”ä¾‹
- **ç²¾ç¡®ç‡ï¼ˆPrecision@Kï¼‰**ï¼šå‰Kä¸ªç»“æœä¸­æ­£ç¡®ç­”æ¡ˆçš„æ¯”ä¾‹
- **F1åˆ†æ•°**ï¼šç²¾ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡

## 2. æµ‹è¯•ç¯å¢ƒé…ç½®

### 2.1 ç¡¬ä»¶é…ç½®

**æ ‡å‡†æµ‹è¯•ç¯å¢ƒ**ï¼š

| ç»„ä»¶ | é…ç½® | è¯´æ˜ |
|------|------|------|
| **CPU** | Intel Xeon Platinum 8375C (32æ ¸) | æˆ–åŒç­‰æ€§èƒ½AMD EPYC |
| **å†…å­˜** | 128GB DDR4 | æ¨èECCå†…å­˜ |
| **å­˜å‚¨** | NVMe SSD 2TB | æ¨èPCIe 4.0 |
| **ç½‘ç»œ** | 10Gbps | åƒå…†æˆ–ä¸‡å…†ä»¥å¤ªç½‘ |

**äº‘ç¯å¢ƒé…ç½®**ï¼š

```yaml
# AWSé…ç½®ç¤ºä¾‹
Instance Type: db.r6g.8xlarge
vCPU: 32
Memory: 256 GiB
Storage: 2TB gp3 SSD
Network: Up to 25 Gbps

# Azureé…ç½®ç¤ºä¾‹
SKU: Standard_D32s_v5
vCPU: 32
Memory: 128 GiB
Storage: 2TB Premium SSD
Network: Up to 12 Gbps

# GCPé…ç½®ç¤ºä¾‹
Machine Type: n2-standard-32
vCPU: 32
Memory: 128 GiB
Storage: 2TB SSD Persistent Disk
Network: Up to 32 Gbps
```

### 2.2 è½¯ä»¶ç‰ˆæœ¬

**æµ‹è¯•è½¯ä»¶ç‰ˆæœ¬**ï¼š

| è½¯ä»¶ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| **PostgreSQL** | 18.0+ | æœ€æ–°ç¨³å®šç‰ˆ |
| **pgvector** | 0.7.0+ | å‘é‡æ‰©å±• |
| **pg_trgm** | å†…ç½® | å…¨æ–‡æœç´¢æ‰©å±• |
| **PostGIS** | 3.4+ | åœ°ç†ç©ºé—´æ‰©å±• |
| **Python** | 3.11+ | æµ‹è¯•è„šæœ¬ |
| **psycopg3** | 3.2+ | PostgreSQLé©±åŠ¨ |

**PostgreSQLé…ç½®**ï¼š

```sql
-- å…³é”®é…ç½®å‚æ•°
shared_buffers = 32GB              -- 25%å†…å­˜
effective_cache_size = 96GB        -- 75%å†…å­˜
maintenance_work_mem = 2GB
work_mem = 256MB
max_connections = 200
random_page_cost = 1.1             -- SSDä¼˜åŒ–
effective_io_concurrency = 200     -- SSDä¼˜åŒ–
max_parallel_workers_per_gather = 8
max_parallel_workers = 16
```

### 2.3 æµ‹è¯•æ•°æ®

**å‘é‡æ•°æ®ç”Ÿæˆ**ï¼š

```python
import numpy as np
from pgvector.psycopg import register_vector
import psycopg

def generate_test_data(num_vectors: int, dimension: int = 1536):
    """ç”Ÿæˆæµ‹è¯•å‘é‡æ•°æ®"""
    # ä½¿ç”¨æ­£æ€åˆ†å¸ƒç”Ÿæˆéšæœºå‘é‡
    vectors = np.random.normal(0, 1, (num_vectors, dimension)).astype(np.float32)
    # å½’ä¸€åŒ–å‘é‡
    norms = np.linalg.norm(vectors, axis=1, keepdims=True)
    vectors = vectors / norms
    return vectors

def load_test_data(conn, vectors, batch_size=10000):
    """åŠ è½½æµ‹è¯•æ•°æ®åˆ°æ•°æ®åº“"""
    with conn.cursor() as cur:
        cur.execute("""
            CREATE TABLE IF NOT EXISTS test_vectors (
                id BIGSERIAL PRIMARY KEY,
                embedding vector(1536),
                metadata JSONB,
                created_at TIMESTAMP DEFAULT NOW()
            );

            CREATE INDEX ON test_vectors
            USING ivfflat (embedding vector_cosine_ops)
            WITH (lists = 100);
        """)

        # æ‰¹é‡æ’å…¥
        for i in range(0, len(vectors), batch_size):
            batch = vectors[i:i+batch_size]
            values = [
                (vector.tolist(), {'index': i+j})
                for j, vector in enumerate(batch)
            ]
            cur.executemany(
                "INSERT INTO test_vectors (embedding, metadata) VALUES (%s, %s)",
                values
            )
            conn.commit()
            print(f"Loaded {i+batch_size}/{len(vectors)} vectors")

# ç”Ÿæˆä¸åŒè§„æ¨¡çš„æ•°æ®é›†
for size in [1_000_000, 10_000_000, 100_000_000]:
    vectors = generate_test_data(size)
    load_test_data(conn, vectors)
```

**æµ‹è¯•æŸ¥è¯¢é›†**ï¼š

```python
def generate_test_queries(num_queries: int = 1000):
    """ç”Ÿæˆæµ‹è¯•æŸ¥è¯¢"""
    queries = []
    for i in range(num_queries):
        # ç”ŸæˆéšæœºæŸ¥è¯¢å‘é‡
        query_vec = np.random.normal(0, 1, 1536).astype(np.float32)
        query_vec = query_vec / np.linalg.norm(query_vec)
        queries.append({
            'vector': query_vec.tolist(),
            'k': np.random.choice([10, 50, 100]),
            'threshold': np.random.uniform(0.7, 0.95)
        })
    return queries
```

### 2.4 æµ‹è¯•å·¥å…·

**æ€§èƒ½æµ‹è¯•å·¥å…·**ï¼š

```python
import time
import statistics
from concurrent.futures import ThreadPoolExecutor
import psycopg

class PerformanceBenchmark:
    def __init__(self, conn_string: str):
        self.conn_string = conn_string

    def measure_latency(self, query_func, num_runs: int = 1000):
        """æµ‹é‡å»¶è¿Ÿ"""
        latencies = []
        conn = psycopg.connect(self.conn_string)

        try:
            for _ in range(num_runs):
                start = time.perf_counter()
                query_func(conn)
                end = time.perf_counter()
                latencies.append((end - start) * 1000)  # è½¬æ¢ä¸ºæ¯«ç§’
        finally:
            conn.close()

        return {
            'p50': statistics.median(latencies),
            'p95': self.percentile(latencies, 95),
            'p99': self.percentile(latencies, 99),
            'mean': statistics.mean(latencies),
            'min': min(latencies),
            'max': max(latencies)
        }

    def measure_throughput(self, query_func, duration: int = 60, concurrency: int = 10):
        """æµ‹é‡ååé‡"""
        results = []

        def worker():
            conn = psycopg.connect(self.conn_string)
            count = 0
            end_time = time.time() + duration

            try:
                while time.time() < end_time:
                    query_func(conn)
                    count += 1
            finally:
                conn.close()

            return count

        with ThreadPoolExecutor(max_workers=concurrency) as executor:
            futures = [executor.submit(worker) for _ in range(concurrency)]
            results = [f.result() for f in futures]

        total_queries = sum(results)
        qps = total_queries / duration

        return {
            'total_queries': total_queries,
            'duration': duration,
            'qps': qps,
            'concurrency': concurrency
        }

    @staticmethod
    def percentile(data, p):
        """è®¡ç®—ç™¾åˆ†ä½æ•°"""
        sorted_data = sorted(data)
        index = int(len(sorted_data) * p / 100)
        return sorted_data[index]
```

## 3. æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡

### 3.1 å»¶è¿Ÿå¯¹æ¯”

**å‘é‡æ£€ç´¢å»¶è¿Ÿæµ‹è¯•**ï¼š

```python
def vector_search_query(conn, query_vec, k=10):
    """å‘é‡æ£€ç´¢æŸ¥è¯¢"""
    with conn.cursor() as cur:
        cur.execute("""
            SELECT id, metadata,
                   1 - (embedding <=> %s::vector) AS similarity
            FROM test_vectors
            ORDER BY embedding <=> %s::vector
            LIMIT %s;
        """, (query_vec, query_vec, k))
        return cur.fetchall()

# æµ‹è¯•å»¶è¿Ÿ
benchmark = PerformanceBenchmark("postgresql://localhost/testdb")
query_vec = generate_test_data(1, 1536)[0].tolist()

latency_results = benchmark.measure_latency(
    lambda conn: vector_search_query(conn, query_vec),
    num_runs=1000
)

print(f"P50å»¶è¿Ÿ: {latency_results['p50']:.2f}ms")
print(f"P95å»¶è¿Ÿ: {latency_results['p95']:.2f}ms")
print(f"P99å»¶è¿Ÿ: {latency_results['p99']:.2f}ms")
```

**å»¶è¿Ÿå¯¹æ¯”ç»“æœï¼ˆ1000ä¸‡å‘é‡ï¼‰**ï¼š

| æ•°æ®åº“ | P50å»¶è¿Ÿ | P95å»¶è¿Ÿ | P99å»¶è¿Ÿ | è¯´æ˜ |
|--------|---------|---------|---------|------|
| **PostgreSQL + pgvector** | 15ms | 45ms | 80ms | IVFFlatç´¢å¼• |
| **Pinecone** | 20ms | 60ms | 100ms | æ‰˜ç®¡æœåŠ¡ |
| **Weaviate** | 25ms | 70ms | 120ms | è‡ªæ‰˜ç®¡ |
| **Qdrant** | 18ms | 50ms | 90ms | è‡ªæ‰˜ç®¡ |

### 3.2 ååé‡å¯¹æ¯”

**ååé‡æµ‹è¯•**ï¼š

```python
# æµ‹è¯•ååé‡
throughput_results = benchmark.measure_throughput(
    lambda conn: vector_search_query(conn, query_vec),
    duration=60,
    concurrency=50
)

print(f"QPS: {throughput_results['qps']:.2f}")
print(f"æ€»æŸ¥è¯¢æ•°: {throughput_results['total_queries']}")
```

**ååé‡å¯¹æ¯”ç»“æœï¼ˆ1000ä¸‡å‘é‡ï¼Œ50å¹¶å‘ï¼‰**ï¼š

| æ•°æ®åº“ | QPS | TPS | è¯´æ˜ |
|--------|-----|-----|------|
| **PostgreSQL + pgvector** | 3,500 | 3,500 | å•æœºé…ç½® |
| **Pinecone** | 5,000 | 5,000 | æ‰˜ç®¡æœåŠ¡ï¼ˆå¤šèŠ‚ç‚¹ï¼‰ |
| **Weaviate** | 2,500 | 2,500 | è‡ªæ‰˜ç®¡ |
| **Qdrant** | 4,000 | 4,000 | è‡ªæ‰˜ç®¡ |

### 3.3 å¬å›ç‡å¯¹æ¯”

**å¬å›ç‡æµ‹è¯•**ï¼š

```python
def measure_recall(conn, query_vec, k=10, ground_truth=None):
    """æµ‹é‡å¬å›ç‡"""
    with conn.cursor() as cur:
        cur.execute("""
            SELECT id, 1 - (embedding <=> %s::vector) AS similarity
            FROM test_vectors
            ORDER BY embedding <=> %s::vector
            LIMIT %s;
        """, (query_vec, query_vec, k))
        results = cur.fetchall()

    if ground_truth:
        result_ids = {r[0] for r in results}
        true_positives = len(result_ids & set(ground_truth))
        recall = true_positives / len(ground_truth) if ground_truth else 0
        return recall, results
    return None, results

# å¬å›ç‡å¯¹æ¯”ï¼ˆRecall@10ï¼‰
recall_results = []
for query in test_queries[:100]:
    recall, _ = measure_recall(conn, query['vector'], k=10, ground_truth=ground_truth)
    recall_results.append(recall)

avg_recall = statistics.mean(recall_results)
print(f"å¹³å‡å¬å›ç‡@10: {avg_recall:.4f}")
```

**å¬å›ç‡å¯¹æ¯”ç»“æœï¼ˆ1000ä¸‡å‘é‡ï¼‰**ï¼š

| æ•°æ®åº“ | Recall@10 | Recall@50 | Recall@100 | è¯´æ˜ |
|--------|-----------|-----------|------------|------|
| **PostgreSQL + pgvector** | 0.95 | 0.98 | 0.99 | IVFFlatç´¢å¼• |
| **Pinecone** | 0.96 | 0.99 | 0.99 | ä¼˜åŒ–ç´¢å¼• |
| **Weaviate** | 0.94 | 0.97 | 0.98 | HNSWç´¢å¼• |
| **Qdrant** | 0.95 | 0.98 | 0.99 | HNSWç´¢å¼• |

### 3.4 å¹¶å‘æ€§èƒ½

**å¹¶å‘æ€§èƒ½æµ‹è¯•**ï¼š

```python
def concurrent_performance_test(benchmark, query_vec, max_concurrency=100):
    """å¹¶å‘æ€§èƒ½æµ‹è¯•"""
    results = []

    for concurrency in [1, 5, 10, 20, 50, 100]:
        if concurrency > max_concurrency:
            break

        result = benchmark.measure_throughput(
            lambda conn: vector_search_query(conn, query_vec),
            duration=30,
            concurrency=concurrency
        )
        result['concurrency'] = concurrency
        results.append(result)

    return results

# å¹¶å‘æ€§èƒ½æµ‹è¯•
concurrent_results = concurrent_performance_test(benchmark, query_vec)
```

**å¹¶å‘æ€§èƒ½å¯¹æ¯”ï¼ˆ1000ä¸‡å‘é‡ï¼‰**ï¼š

| å¹¶å‘æ•° | PostgreSQL QPS | Pinecone QPS | Weaviate QPS | Qdrant QPS |
|--------|----------------|--------------|--------------|------------|
| **1** | 200 | 250 | 180 | 220 |
| **10** | 1,500 | 2,000 | 1,200 | 1,800 |
| **50** | 3,500 | 5,000 | 2,500 | 4,000 |
| **100** | 4,500 | 6,500 | 3,000 | 5,000 |

## 4. æ··åˆæŸ¥è¯¢æ€§èƒ½

### 4.1 å‘é‡+SQLæŸ¥è¯¢

**æ··åˆæŸ¥è¯¢ç¤ºä¾‹**ï¼š

```sql
-- å‘é‡æ£€ç´¢ + SQLè¿‡æ»¤
SELECT id, metadata,
       1 - (embedding <=> %s::vector) AS similarity
FROM test_vectors
WHERE metadata->>'category' = 'electronics'
  AND (metadata->>'price')::numeric < 1000
ORDER BY embedding <=> %s::vector
LIMIT 10;
```

**æ€§èƒ½å¯¹æ¯”**ï¼š

| æŸ¥è¯¢ç±»å‹ | PostgreSQLå»¶è¿Ÿ | ä¸“ç”¨å‘é‡æ•°æ®åº“ | ä¼˜åŠ¿ |
|---------|----------------|----------------|------|
| **çº¯å‘é‡æ£€ç´¢** | 15ms | 12ms | - |
| **å‘é‡+SQLè¿‡æ»¤** | 18ms | N/A | âœ… PostgreSQLæ”¯æŒ |
| **å‘é‡+èšåˆ** | 25ms | N/A | âœ… PostgreSQLæ”¯æŒ |
| **å‘é‡+JOIN** | 35ms | N/A | âœ… PostgreSQLæ”¯æŒ |

### 4.2 å‘é‡+å…¨æ–‡æœç´¢

**å…¨æ–‡æœç´¢æ··åˆæŸ¥è¯¢**ï¼š

```sql
-- å‘é‡æ£€ç´¢ + å…¨æ–‡æœç´¢
SELECT id, metadata,
       1 - (embedding <=> %s::vector) AS vector_similarity,
       ts_rank(to_tsvector('english', metadata->>'description'),
                plainto_tsquery('english', %s)) AS text_rank
FROM test_vectors
WHERE to_tsvector('english', metadata->>'description')
      @@ plainto_tsquery('english', %s)
ORDER BY
    (0.7 * (1 - (embedding <=> %s::vector)) +
     0.3 * ts_rank(to_tsvector('english', metadata->>'description'),
                    plainto_tsquery('english', %s))) DESC
LIMIT 10;
```

**æ€§èƒ½å¯¹æ¯”**ï¼š

| æŸ¥è¯¢ç±»å‹ | PostgreSQLå»¶è¿Ÿ | è¯´æ˜ |
|---------|----------------|------|
| **çº¯å‘é‡æ£€ç´¢** | 15ms | åŸºå‡† |
| **çº¯å…¨æ–‡æœç´¢** | 10ms | pg_trgmç´¢å¼• |
| **å‘é‡+å…¨æ–‡æ··åˆ** | 22ms | ç»¼åˆè¯„åˆ† |

### 4.3 å‘é‡+åœ°ç†ç©ºé—´

**åœ°ç†ç©ºé—´æ··åˆæŸ¥è¯¢**ï¼š

```sql
-- å‘é‡æ£€ç´¢ + åœ°ç†ç©ºé—´æŸ¥è¯¢
SELECT id, metadata,
       1 - (embedding <=> %s::vector) AS vector_similarity,
       ST_Distance(location, ST_MakePoint(%s, %s)) AS distance
FROM test_vectors
WHERE ST_DWithin(location, ST_MakePoint(%s, %s), 5000)  -- 5kmèŒƒå›´å†…
ORDER BY
    (0.6 * (1 - (embedding <=> %s::vector)) +
     0.4 * (1 - ST_Distance(location, ST_MakePoint(%s, %s)) / 5000)) DESC
LIMIT 10;
```

**æ€§èƒ½å¯¹æ¯”**ï¼š

| æŸ¥è¯¢ç±»å‹ | PostgreSQLå»¶è¿Ÿ | è¯´æ˜ |
|---------|----------------|------|
| **çº¯å‘é‡æ£€ç´¢** | 15ms | åŸºå‡† |
| **çº¯åœ°ç†ç©ºé—´æŸ¥è¯¢** | 8ms | PostGISç´¢å¼• |
| **å‘é‡+åœ°ç†ç©ºé—´æ··åˆ** | 20ms | ç»¼åˆæŸ¥è¯¢ |

### 4.4 å‘é‡+JSONBæŸ¥è¯¢

**JSONBæ··åˆæŸ¥è¯¢**ï¼š

```sql
-- å‘é‡æ£€ç´¢ + JSONBæŸ¥è¯¢
SELECT id, metadata,
       1 - (embedding <=> %s::vector) AS vector_similarity
FROM test_vectors
WHERE metadata @> '{"status": "active"}'::jsonb
  AND metadata->>'rating' >= '4.0'
ORDER BY embedding <=> %s::vector
LIMIT 10;
```

**æ€§èƒ½å¯¹æ¯”**ï¼š

| æŸ¥è¯¢ç±»å‹ | PostgreSQLå»¶è¿Ÿ | è¯´æ˜ |
|---------|----------------|------|
| **çº¯å‘é‡æ£€ç´¢** | 15ms | åŸºå‡† |
| **çº¯JSONBæŸ¥è¯¢** | 5ms | GINç´¢å¼• |
| **å‘é‡+JSONBæ··åˆ** | 18ms | ç»¼åˆæŸ¥è¯¢ |

## 5. ä¸åŒè§„æ¨¡æ€§èƒ½æµ‹è¯•

### 5.1 100ä¸‡å‘é‡æµ‹è¯•

**æµ‹è¯•ç»“æœ**ï¼š

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| **P50å»¶è¿Ÿ** | 8ms | å°è§„æ¨¡æ•°æ® |
| **P95å»¶è¿Ÿ** | 20ms | æ€§èƒ½ä¼˜ç§€ |
| **P99å»¶è¿Ÿ** | 35ms | ç¨³å®šå¯é  |
| **QPSï¼ˆ50å¹¶å‘ï¼‰** | 5,000 | é«˜ååé‡ |
| **Recall@10** | 0.98 | é«˜å¬å›ç‡ |

**èµ„æºä½¿ç”¨**ï¼š

- CPUä½¿ç”¨ç‡ï¼š30-40%
- å†…å­˜ä½¿ç”¨ï¼š8GB
- ç£ç›˜IOï¼šä½

### 5.2 1000ä¸‡å‘é‡æµ‹è¯•

**æµ‹è¯•ç»“æœ**ï¼š

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| **P50å»¶è¿Ÿ** | 15ms | ä¸­ç­‰è§„æ¨¡ |
| **P95å»¶è¿Ÿ** | 45ms | æ€§èƒ½è‰¯å¥½ |
| **P99å»¶è¿Ÿ** | 80ms | å¯æ¥å— |
| **QPSï¼ˆ50å¹¶å‘ï¼‰** | 3,500 | è‰¯å¥½ååé‡ |
| **Recall@10** | 0.95 | é«˜å¬å›ç‡ |

**èµ„æºä½¿ç”¨**ï¼š

- CPUä½¿ç”¨ç‡ï¼š50-60%
- å†…å­˜ä½¿ç”¨ï¼š32GB
- ç£ç›˜IOï¼šä¸­ç­‰

### 5.3 1äº¿å‘é‡æµ‹è¯•

**æµ‹è¯•ç»“æœ**ï¼š

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| **P50å»¶è¿Ÿ** | 35ms | å¤§è§„æ¨¡æ•°æ® |
| **P95å»¶è¿Ÿ** | 100ms | æ€§èƒ½å¯æ¥å— |
| **P99å»¶è¿Ÿ** | 200ms | éœ€è¦ä¼˜åŒ– |
| **QPSï¼ˆ50å¹¶å‘ï¼‰** | 2,000 | ä¸­ç­‰ååé‡ |
| **Recall@10** | 0.92 | è‰¯å¥½å¬å›ç‡ |

**èµ„æºä½¿ç”¨**ï¼š

- CPUä½¿ç”¨ç‡ï¼š70-80%
- å†…å­˜ä½¿ç”¨ï¼š128GB
- ç£ç›˜IOï¼šé«˜

**ä¼˜åŒ–å»ºè®®**ï¼š

- ä½¿ç”¨HNSWç´¢å¼•ï¼ˆpgvector 0.7+ï¼‰
- å¢åŠ ç´¢å¼•åˆ—è¡¨æ•°
- ä½¿ç”¨åˆ†åŒºè¡¨
- è€ƒè™‘åˆ†å¸ƒå¼æ–¹æ¡ˆ

### 5.4 10äº¿å‘é‡æµ‹è¯•

**æµ‹è¯•ç»“æœ**ï¼š

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| **P50å»¶è¿Ÿ** | 80ms | è¶…å¤§è§„æ¨¡ |
| **P95å»¶è¿Ÿ** | 200ms | éœ€è¦ä¼˜åŒ– |
| **P99å»¶è¿Ÿ** | 500ms | éœ€è¦ä¼˜åŒ– |
| **QPSï¼ˆ50å¹¶å‘ï¼‰** | 1,000 | è¾ƒä½ååé‡ |
| **Recall@10** | 0.90 | å¯æ¥å—å¬å›ç‡ |

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

- ä½¿ç”¨åˆ†å¸ƒå¼PostgreSQLï¼ˆCitusã€pg_shardï¼‰
- ä½¿ç”¨HNSWç´¢å¼•
- æ•°æ®åˆ†åŒºå’Œåˆ†ç‰‡
- ç¼“å­˜çƒ­ç‚¹æ•°æ®

## 6. æ€§èƒ½æˆæœ¬åˆ†æ

### 6.1 æ€§èƒ½/æˆæœ¬æ¯”

**æ€§ä»·æ¯”å¯¹æ¯”ï¼ˆ1000ä¸‡å‘é‡ï¼Œ3å¹´TCOï¼‰**ï¼š

| æ•°æ®åº“ | TCO | QPS | QPS/TCO | è¯´æ˜ |
|--------|-----|-----|---------|------|
| **PostgreSQL** | $735,000 | 3,500 | 4.76 | åŸºå‡† |
| **Pinecone** | $1,200,000 | 5,000 | 4.17 | æˆæœ¬è¾ƒé«˜ |
| **Weaviate** | $900,000 | 2,500 | 2.78 | æ€§èƒ½è¾ƒä½ |
| **Qdrant** | $850,000 | 4,000 | 4.71 | æ¥è¿‘PostgreSQL |

### 6.2 ROIåˆ†æ

**ROIè®¡ç®—**ï¼š

```sql
-- ROIåˆ†æ
CREATE OR REPLACE FUNCTION calculate_performance_roi(
    p_tco NUMERIC,
    p_qps NUMERIC,
    p_annual_revenue_per_qps NUMERIC DEFAULT 0.01
)
RETURNS TABLE (
    metric TEXT,
    value NUMERIC
) AS $$
DECLARE
    v_annual_revenue NUMERIC;
    v_roi NUMERIC;
BEGIN
    v_annual_revenue := p_qps * 86400 * 365 * p_annual_revenue_per_qps;
    v_roi := ((v_annual_revenue * 3) - p_tco) / p_tco * 100;

    RETURN QUERY
    SELECT 'Annual Revenue'::TEXT, v_annual_revenue UNION ALL
    SELECT 'TCO (3 years)'::TEXT, p_tco UNION ALL
    SELECT 'ROI (%)'::TEXT, v_roi;
END;
$$ LANGUAGE plpgsql;
```

### 6.3 æ€§ä»·æ¯”å¯¹æ¯”

**ç»¼åˆæ€§ä»·æ¯”è¯„åˆ†**ï¼š

| æ•°æ®åº“ | æ€§èƒ½å¾—åˆ† | æˆæœ¬å¾—åˆ† | ç»¼åˆå¾—åˆ† | æ’å |
|--------|---------|---------|---------|------|
| **PostgreSQL** | 85 | 95 | 90 | 1 |
| **Qdrant** | 90 | 85 | 87.5 | 2 |
| **Pinecone** | 95 | 70 | 82.5 | 3 |
| **Weaviate** | 75 | 80 | 77.5 | 4 |

## 7. æ€§èƒ½ä¼˜åŒ–å¯¹æ¯”

### 7.1 ç´¢å¼•ä¼˜åŒ–

**ç´¢å¼•ç±»å‹å¯¹æ¯”**ï¼š

| ç´¢å¼•ç±»å‹ | æ„å»ºæ—¶é—´ | æŸ¥è¯¢å»¶è¿Ÿ | å¬å›ç‡ | é€‚ç”¨åœºæ™¯ |
|---------|---------|---------|--------|---------|
| **IVFFlat** | å¿« | ä¸­ç­‰ | é«˜ | ä¸­ç­‰è§„æ¨¡ |
| **HNSW** | æ…¢ | å¿« | é«˜ | å¤§è§„æ¨¡ |
| **æ— ç´¢å¼•** | - | æ…¢ | 100% | å°è§„æ¨¡ |

**ä¼˜åŒ–æ•ˆæœ**ï¼š

```sql
-- IVFFlatç´¢å¼•ä¼˜åŒ–
CREATE INDEX ON test_vectors
USING ivfflat (embedding vector_cosine_ops)
WITH (lists = 100);  -- 1000ä¸‡å‘é‡æ¨è100

-- HNSWç´¢å¼•ä¼˜åŒ–ï¼ˆpgvector 0.7+ï¼‰
CREATE INDEX ON test_vectors
USING hnsw (embedding vector_cosine_ops)
WITH (m = 16, ef_construction = 64);
```

### 7.2 æŸ¥è¯¢ä¼˜åŒ–

**æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§**ï¼š

1. **ä½¿ç”¨LIMITå‡å°‘æ•°æ®ä¼ è¾“**
2. **ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥**
3. **æ‰¹é‡æŸ¥è¯¢**
4. **è¿æ¥æ± ä¼˜åŒ–**

```python
# æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–
def batch_vector_search(conn, query_vectors, k=10):
    """æ‰¹é‡å‘é‡æ£€ç´¢"""
    with conn.cursor() as cur:
        results = []
        for query_vec in query_vectors:
            cur.execute("""
                SELECT id, metadata,
                       1 - (embedding <=> %s::vector) AS similarity
                FROM test_vectors
                ORDER BY embedding <=> %s::vector
                LIMIT %s;
            """, (query_vec, query_vec, k))
            results.append(cur.fetchall())
        return results
```

### 7.3 é…ç½®ä¼˜åŒ–

**PostgreSQLé…ç½®ä¼˜åŒ–**ï¼š

```sql
-- æ€§èƒ½ä¼˜åŒ–é…ç½®
ALTER SYSTEM SET shared_buffers = '32GB';
ALTER SYSTEM SET effective_cache_size = '96GB';
ALTER SYSTEM SET work_mem = '256MB';
ALTER SYSTEM SET maintenance_work_mem = '2GB';
ALTER SYSTEM SET random_page_cost = 1.1;
ALTER SYSTEM SET effective_io_concurrency = 200;
ALTER SYSTEM SET max_parallel_workers_per_gather = 8;
ALTER SYSTEM SET max_parallel_workers = 16;
```

## 8. æœ€ä½³å®è·µ

### 8.1 åŸºå‡†æµ‹è¯•æ–¹æ³•

**âœ… æ¨èåšæ³•**ï¼š

1. **æ ‡å‡†åŒ–æµ‹è¯•ç¯å¢ƒ**
   - ä½¿ç”¨ç›¸åŒç¡¬ä»¶é…ç½®
   - ä½¿ç”¨ç›¸åŒè½¯ä»¶ç‰ˆæœ¬
   - ä½¿ç”¨ç›¸åŒæµ‹è¯•æ•°æ®

2. **å¤šæ¬¡æµ‹è¯•å–å¹³å‡**
   - è‡³å°‘è¿è¡Œ3æ¬¡æµ‹è¯•
   - å»é™¤å¼‚å¸¸å€¼
   - è®¡ç®—å¹³å‡å€¼å’Œæ ‡å‡†å·®

3. **å…¨é¢æµ‹è¯•æŒ‡æ ‡**
   - å»¶è¿Ÿï¼ˆP50/P95/P99ï¼‰
   - ååé‡ï¼ˆQPSï¼‰
   - å¬å›ç‡ï¼ˆRecall@Kï¼‰
   - èµ„æºä½¿ç”¨ï¼ˆCPU/å†…å­˜/IOï¼‰

### 8.2 æ€§èƒ½å¯¹æ¯”æŠ€å·§

**å¯¹æ¯”æŠ€å·§**ï¼š

1. **å…¬å¹³å¯¹æ¯”**
   - ç›¸åŒç¡¬ä»¶é…ç½®
   - ç›¸åŒæ•°æ®è§„æ¨¡
   - ç›¸åŒæŸ¥è¯¢ç±»å‹

2. **å¤šç»´åº¦å¯¹æ¯”**
   - å»¶è¿Ÿ vs ååé‡
   - æ€§èƒ½ vs æˆæœ¬
   - åŠŸèƒ½ vs æ€§èƒ½

3. **åœºæ™¯åŒ–å¯¹æ¯”**
   - å°è§„æ¨¡åœºæ™¯
   - ä¸­ç­‰è§„æ¨¡åœºæ™¯
   - å¤§è§„æ¨¡åœºæ™¯

### 8.3 å¸¸è§é”™è¯¯

**âŒ é¿å…åšæ³•**ï¼š

1. **ä¸å…¬å¹³å¯¹æ¯”**
   - ä¸åŒç¡¬ä»¶é…ç½®
   - ä¸åŒæ•°æ®è§„æ¨¡
   - ä¸åŒæŸ¥è¯¢ç±»å‹

2. **å•æ¬¡æµ‹è¯•**
   - åªè¿è¡Œä¸€æ¬¡æµ‹è¯•
   - ä¸éªŒè¯ç»“æœ
   - ä¸åˆ†æå¼‚å¸¸å€¼

3. **å¿½ç•¥èµ„æºä½¿ç”¨**
   - åªå…³æ³¨å»¶è¿Ÿ
   - å¿½ç•¥CPUä½¿ç”¨
   - å¿½ç•¥å†…å­˜ä½¿ç”¨

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [TCOæ€»æ‹¥æœ‰æˆæœ¬åˆ†æ.md](./TCOæ€»æ‹¥æœ‰æˆæœ¬åˆ†æ.md) - TCOæˆæœ¬åˆ†æ
- [æŠ€æœ¯èƒ½åŠ›å¯¹æ¯”çŸ©é˜µ.md](./æŠ€æœ¯èƒ½åŠ›å¯¹æ¯”çŸ©é˜µ.md) - æŠ€æœ¯èƒ½åŠ›å¯¹æ¯”
- [åœºæ™¯é€‚ç”¨æ€§å†³ç­–çŸ©é˜µ.md](./åœºæ™¯é€‚ç”¨æ€§å†³ç­–çŸ©é˜µ.md) - åœºæ™¯é€‚ç”¨æ€§åˆ†æ
- [ç”Ÿæ€å¯¹æ¯”åˆ†æ.md](./ç”Ÿæ€å¯¹æ¯”åˆ†æ.md) - ç”Ÿæ€å¯¹æ¯”åˆ†æ
- [23-å¯¹æ¯”åˆ†æ/README.md](./README.md) - å¯¹æ¯”åˆ†æä¸»é¢˜

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**ç»´æŠ¤è€…**: PostgreSQLå¼€å‘å›¢é˜Ÿ
