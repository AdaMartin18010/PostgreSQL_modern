# PostgreSQLç´¢å¼•è°ƒä¼˜æŒ‡å—

> **åˆ›å»ºæ—¥æœŸ**: 2025å¹´1æœˆ
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 17+/18+
> **éš¾åº¦ç­‰çº§**: â­â­â­â­ é«˜çº§

---

## ğŸ“‹ ç›®å½•

- [PostgreSQLç´¢å¼•è°ƒä¼˜æŒ‡å—](#postgresqlç´¢å¼•è°ƒä¼˜æŒ‡å—)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
  - [2. ç´¢å¼•ç±»å‹é€‰æ‹©](#2-ç´¢å¼•ç±»å‹é€‰æ‹©)
    - [2.1 B-treeç´¢å¼•](#21-b-treeç´¢å¼•)
    - [2.2 GINç´¢å¼•](#22-ginç´¢å¼•)
  - [3. ç´¢å¼•è®¾è®¡](#3-ç´¢å¼•è®¾è®¡)
    - [3.1 å¤åˆç´¢å¼•](#31-å¤åˆç´¢å¼•)
    - [3.2 éƒ¨åˆ†ç´¢å¼•](#32-éƒ¨åˆ†ç´¢å¼•)
  - [4. ç´¢å¼•ç»´æŠ¤](#4-ç´¢å¼•ç»´æŠ¤)
    - [4.1 ç´¢å¼•é‡å»º](#41-ç´¢å¼•é‡å»º)
    - [4.2 ç´¢å¼•ç›‘æ§](#42-ç´¢å¼•ç›‘æ§)
  - [5. ç´¢å¼•ç›‘æ§](#5-ç´¢å¼•ç›‘æ§)
    - [5.1 æœªä½¿ç”¨ç´¢å¼•](#51-æœªä½¿ç”¨ç´¢å¼•)
    - [5.2 ç´¢å¼•å¤§å°](#52-ç´¢å¼•å¤§å°)
  - [ğŸ“š ç›¸å…³æ–‡æ¡£](#-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

ç´¢å¼•è°ƒä¼˜æ˜¯æé«˜æŸ¥è¯¢æ€§èƒ½çš„å…³é”®æ‰‹æ®µã€‚

**è°ƒä¼˜ç›®æ ‡**:

- é€‰æ‹©åˆé€‚çš„ç´¢å¼•ç±»å‹
- ä¼˜åŒ–ç´¢å¼•è®¾è®¡
- æé«˜ç´¢å¼•ä½¿ç”¨æ•ˆç‡

---

## 2. ç´¢å¼•ç±»å‹é€‰æ‹©

### 2.1 B-treeç´¢å¼•

```sql
-- é»˜è®¤ç´¢å¼•ç±»å‹ï¼Œé€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯
CREATE INDEX idx_orders_date ON orders(order_date);

-- é€‚ç”¨åœºæ™¯
-- - ç­‰å€¼æŸ¥è¯¢
-- - èŒƒå›´æŸ¥è¯¢
-- - æ’åºæŸ¥è¯¢
```

### 2.2 GINç´¢å¼•

```sql
-- é€‚ç”¨äºæ•°ç»„ã€å…¨æ–‡æœç´¢
CREATE INDEX idx_products_tags ON products USING GIN(tags);

-- é€‚ç”¨åœºæ™¯
-- - æ•°ç»„æŸ¥è¯¢
-- - å…¨æ–‡æœç´¢
-- - JSONBæŸ¥è¯¢
```

---

## 3. ç´¢å¼•è®¾è®¡

### 3.1 å¤åˆç´¢å¼•

```sql
-- åˆ›å»ºå¤åˆç´¢å¼•
CREATE INDEX idx_orders_customer_date
ON orders(customer_id, order_date);

-- æŸ¥è¯¢å¯ä»¥ä½¿ç”¨ç´¢å¼•
SELECT * FROM orders
WHERE customer_id = 100 AND order_date > '2024-01-01';
```

### 3.2 éƒ¨åˆ†ç´¢å¼•

```sql
-- åªç´¢å¼•éƒ¨åˆ†æ•°æ®
CREATE INDEX idx_orders_active
ON orders(customer_id)
WHERE status = 'active';
```

---

## 4. ç´¢å¼•ç»´æŠ¤

### 4.1 ç´¢å¼•é‡å»º

```sql
-- é‡å»ºç´¢å¼•
REINDEX INDEX idx_orders_date;

-- é‡å»ºè¡¨çš„æ‰€æœ‰ç´¢å¼•
REINDEX TABLE orders;
```

### 4.2 ç´¢å¼•ç›‘æ§

```sql
-- æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SELECT
    schemaname,
    tablename,
    indexname,
    idx_scan,
    idx_tup_read,
    idx_tup_fetch
FROM pg_stat_user_indexes
WHERE schemaname = 'public';
```

---

## 5. ç´¢å¼•ç›‘æ§

### 5.1 æœªä½¿ç”¨ç´¢å¼•

```sql
-- æŸ¥æ‰¾æœªä½¿ç”¨çš„ç´¢å¼•
SELECT
    schemaname,
    tablename,
    indexname,
    idx_scan
FROM pg_stat_user_indexes
WHERE idx_scan = 0
ORDER BY pg_relation_size(indexrelid) DESC;
```

### 5.2 ç´¢å¼•å¤§å°

```sql
-- æŸ¥çœ‹ç´¢å¼•å¤§å°
SELECT
    indexname,
    pg_size_pretty(pg_relation_size(indexname::regclass)) AS size
FROM pg_indexes
WHERE schemaname = 'public'
ORDER BY pg_relation_size(indexname::regclass) DESC;
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [PostgreSQLæ€§èƒ½è°ƒä¼˜å®Œæ•´æŒ‡å—.md](./PostgreSQLæ€§èƒ½è°ƒä¼˜å®Œæ•´æŒ‡å—.md) - æ€§èƒ½è°ƒä¼˜å®Œæ•´æŒ‡å—
- [æŸ¥è¯¢çº§è°ƒä¼˜.md](./æŸ¥è¯¢çº§è°ƒä¼˜.md) - æŸ¥è¯¢çº§è°ƒä¼˜è¯¦è§£
- [30-æ€§èƒ½è°ƒä¼˜/README.md](./README.md) - æ€§èƒ½è°ƒä¼˜ä¸»é¢˜

---

**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
