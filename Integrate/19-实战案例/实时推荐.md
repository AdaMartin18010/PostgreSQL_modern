---

> **ğŸ“‹ æ–‡æ¡£æ¥æº**: `PostgreSQL\cases\å®æ—¶æ¨è.md`
> **ğŸ“… å¤åˆ¶æ—¥æœŸ**: 2025-12-22
> **âš ï¸ æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºå¤åˆ¶ç‰ˆæœ¬ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜

---

# æ¡ˆä¾‹ï¼šå®æ—¶æ¨èï¼ˆå ä½ï¼‰

## æ¶æ„

- æµå¼ ETLï¼ˆKafka/CDCï¼‰â†’ PostgreSQL â†’ ç‰©åŒ–è§†å›¾/å¢é‡èšåˆ

## å…³é”®ç‚¹

- å»é‡ä¸çª—å£èšåˆã€çƒ­ç‚¹å†™å…¥ã€ç‰©åŒ–è§†å›¾åˆ·æ–°ç­–ç•¥

## éªŒè¯

- å»¶è¿Ÿã€ååã€èµ„æºå ç”¨ã€æ¨èå‡†ç¡®åº¦è¿‘ä¼¼æŒ‡æ ‡

## æœ€å°å¯å¤ç°ï¼ˆå ä½ï¼‰

```sql
CREATE TABLE events(user_id bigint, item_id bigint, ts timestamptz, score numeric);
CREATE MATERIALIZED VIEW mv_topk AS
SELECT item_id, count(*) AS cnt
FROM events WHERE ts > now() - interval '5 minutes'
GROUP BY item_id ORDER BY cnt DESC LIMIT 100;
-- åˆ·æ–°ç­–ç•¥ï¼šCONCURRENTLY + å®šæ—¶ä»»åŠ¡ï¼ˆç¤ºæ„ï¼‰
```
