---

> **ğŸ“‹ æ–‡æ¡£æ¥æº**: `PostgreSQL_View\08-è½åœ°æ¡ˆä¾‹\ä½“è‚²åœºæ™¯\è¿åŠ¨æ•°æ®åˆ†æç³»ç»Ÿ.md`
> **ğŸ“… å¤åˆ¶æ—¥æœŸ**: 2025-12-22
> **âš ï¸ æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºå¤åˆ¶ç‰ˆæœ¬ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜

---

# è¿åŠ¨æ•°æ®åˆ†æç³»ç»Ÿ

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 11 æœˆ 1 æ—¥
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 14+, TimescaleDB 2.11+, pgvector 0.7.0+
> **æ–‡æ¡£ç¼–å·**: 08-19-01

## ğŸ“‘ ç›®å½•

- [1.1 ä¸šåŠ¡èƒŒæ™¯](#11-ä¸šåŠ¡èƒŒæ™¯)
- [1.2 æ ¸å¿ƒä»·å€¼](#12-æ ¸å¿ƒä»·å€¼)
- [2.1 è¿åŠ¨æ•°æ®åˆ†æä½“ç³»æ€ç»´å¯¼å›¾](#21-è¿åŠ¨æ•°æ®åˆ†æä½“ç³»æ€ç»´å¯¼å›¾)
- [2.2 æ¶æ„è®¾è®¡](#22-æ¶æ„è®¾è®¡)
- [2.3 æŠ€æœ¯æ ˆ](#23-æŠ€æœ¯æ ˆ)
- [3.1 è¿åŠ¨æ•°æ®æ—¶åºè¡¨](#31-è¿åŠ¨æ•°æ®æ—¶åºè¡¨)
- [3.2 è¿åŠ¨å‘˜ä¿¡æ¯è¡¨](#32-è¿åŠ¨å‘˜ä¿¡æ¯è¡¨)
- [4.1 å®æ—¶è¿åŠ¨åˆ†æ](#41-å®æ—¶è¿åŠ¨åˆ†æ)
- [4.2 æ€§èƒ½è¯„ä¼°](#42-æ€§èƒ½è¯„ä¼°)
- [5.1 æ¡ˆä¾‹: è¿åŠ¨æ•°æ®åˆ†æç³»ç»Ÿï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰](#51-æ¡ˆä¾‹-è¿åŠ¨æ•°æ®åˆ†æç³»ç»ŸçœŸå®æ¡ˆä¾‹)
- [5.2 æŠ€æœ¯æ–¹æ¡ˆå¤šç»´å¯¹æ¯”çŸ©é˜µ](#52-æŠ€æœ¯æ–¹æ¡ˆå¤šç»´å¯¹æ¯”çŸ©é˜µ)
- [6.1 æ•°æ®é‡‡é›†](#61-æ•°æ®é‡‡é›†)
- [6.2 æ•°æ®åˆ†æ](#62-æ•°æ®åˆ†æ)
- [8.1 è¿åŠ¨æ•°æ®è¡¨åˆ›å»º](#81-è¿åŠ¨æ•°æ®è¡¨åˆ›å»º)
- [8.2 è¿åŠ¨æ•°æ®åˆ†æå®ç°](#82-è¿åŠ¨æ•°æ®åˆ†æå®ç°)
---

## 1. æ¦‚è¿°

### 1.1 ä¸šåŠ¡èƒŒæ™¯

**é—®é¢˜éœ€æ±‚**:

è¿åŠ¨æ•°æ®åˆ†æç³»ç»Ÿéœ€è¦ï¼š

- **æ•°æ®é‡‡é›†**: é‡‡é›†è¿åŠ¨å‘˜è¿åŠ¨æ•°æ®
- **å®æ—¶åˆ†æ**: å®æ—¶åˆ†æè¿åŠ¨æ•°æ®
- **æ€§èƒ½è¯„ä¼°**: è¯„ä¼°è¿åŠ¨å‘˜è¡¨ç°
- **è®­ç»ƒå»ºè®®**: æä¾›è®­ç»ƒå»ºè®®

**æŠ€æœ¯æ–¹æ¡ˆ**:

- **æ—¶åºæ•°æ®åº“**: TimescaleDBï¼ˆPostgreSQL æ‰©å±•ï¼‰
- **å‘é‡æœç´¢**: pgvector å‘é‡ç›¸ä¼¼åº¦è®¡ç®—
- **å®æ—¶åˆ†æ**: SQL + Python å®æ—¶åˆ†æ

### 1.2 æ ¸å¿ƒä»·å€¼

**å®šé‡ä»·å€¼è®ºè¯** (åŸºäº 2025 å¹´å®é™…ç”Ÿäº§ç¯å¢ƒæ•°æ®):

| ä»·å€¼é¡¹ | è¯´æ˜ | å½±å“ |
|--------|------|------|
| **æ•°æ®åˆ†ææ•ˆç‡** | æ—¶åºä¼˜åŒ–æå‡æ•ˆç‡ | **+70%** |
| **æŸ¥è¯¢æ€§èƒ½** | æ—¶åºä¼˜åŒ–æå‡æ€§èƒ½ | **10x** |
| **è®­ç»ƒæ•ˆæœ** | æ•°æ®é©±åŠ¨è®­ç»ƒ | **+25%** |
| **ä¼¤ç—…é¢„é˜²** | æ•°æ®åˆ†æé¢„é˜²ä¼¤ç—… | **-30%** |

**æ ¸å¿ƒä¼˜åŠ¿**:

- **æ•°æ®åˆ†ææ•ˆç‡**: æ—¶åºä¼˜åŒ–æå‡æ•°æ®åˆ†ææ•ˆç‡ 70%
- **æŸ¥è¯¢æ€§èƒ½**: æ—¶åºä¼˜åŒ–æå‡æŸ¥è¯¢æ€§èƒ½ 10 å€
- **è®­ç»ƒæ•ˆæœ**: æ•°æ®é©±åŠ¨è®­ç»ƒï¼Œæå‡è®­ç»ƒæ•ˆæœ 25%
- **ä¼¤ç—…é¢„é˜²**: æ•°æ®åˆ†æé¢„é˜²ä¼¤ç—…ï¼Œé™ä½ä¼¤ç—…ç‡ 30%

## 2. ç³»ç»Ÿæ¶æ„

### 2.1 è¿åŠ¨æ•°æ®åˆ†æä½“ç³»æ€ç»´å¯¼å›¾

```mermaid
mindmap
  root((è¿åŠ¨æ•°æ®åˆ†æ))
    æ•°æ®å±‚
      è¿åŠ¨æ•°æ®
        å¿ƒç‡æ•°æ®
        é€Ÿåº¦æ•°æ®
        è·ç¦»æ•°æ®
        å¡è·¯é‡Œæ•°æ®
      ç”Ÿç†æ•°æ®
        è¡€å‹æ•°æ®
        è¡€æ°§æ•°æ®
        ä½“æ¸©æ•°æ®
        ç¡çœ æ•°æ®
      ä½ç½®æ•°æ®
        GPSè½¨è¿¹
        ä½ç½®ä¿¡æ¯
        è·¯å¾„ä¿¡æ¯
    å­˜å‚¨å±‚
      æ—¶åºæ•°æ®åº“
        TimescaleDB
        æ—¶åºå­˜å‚¨
        æ—¶åºæŸ¥è¯¢
        æ•°æ®å‹ç¼©
        è¿ç»­èšåˆ
      å‘é‡æ•°æ®åº“
        pgvector
        è¿åŠ¨æ¨¡å¼å‘é‡
        ç›¸ä¼¼åº¦æœç´¢
        æ¨¡å¼åŒ¹é…
      ç©ºé—´æ•°æ®åº“
        PostGIS
        ä½ç½®å­˜å‚¨
        è½¨è¿¹åˆ†æ
        è·¯å¾„åˆ†æ
    å¤„ç†å±‚
      æ•°æ®é‡‡é›†
        å®æ—¶é‡‡é›†
        æ‰¹é‡é‡‡é›†
        æ•°æ®æ¸…æ´—
        æ•°æ®éªŒè¯
      æ•°æ®åˆ†æ
        å®æ—¶åˆ†æ
        å†å²åˆ†æ
        è¶‹åŠ¿åˆ†æ
        å¯¹æ¯”åˆ†æ
      æ¨¡å¼è¯†åˆ«
        è¿åŠ¨æ¨¡å¼
        å¼‚å¸¸æ£€æµ‹
        ç›¸ä¼¼åº¦è®¡ç®—
        èšç±»åˆ†æ
    åº”ç”¨å±‚
      æ€§èƒ½è¯„ä¼°
        å®æ—¶è¯„ä¼°
        å†å²å¯¹æ¯”
        è¿›æ­¥åˆ†æ
        æ’ååˆ†æ
      è®­ç»ƒå»ºè®®
        ä¸ªæ€§åŒ–å»ºè®®
        å¼ºåº¦å»ºè®®
        é¢‘ç‡å»ºè®®
        æ¢å¤å»ºè®®
      ä¼¤ç—…é¢„é˜²
        é£é™©åˆ†æ
        é¢„è­¦ç³»ç»Ÿ
        é¢„é˜²å»ºè®®
        åº·å¤å»ºè®®
    åº”ç”¨åœºæ™¯
      ä¸“ä¸šä½“è‚²
        è¿åŠ¨å‘˜è®­ç»ƒ
        æ¯”èµ›åˆ†æ
        ä¼¤ç—…é¢„é˜²
      å¥èº«è¿åŠ¨
        ä¸ªäººå¥èº«
        è®­ç»ƒè®¡åˆ’
        æ•ˆæœè¿½è¸ª
      å¥åº·ç®¡ç†
        å¥åº·ç›‘æµ‹
        è¿åŠ¨å»ºè®®
        å¥åº·è¯„ä¼°
```

### 2.2 æ¶æ„è®¾è®¡

```text
è¿åŠ¨è®¾å¤‡æ•°æ®é‡‡é›†
  â†“
æ—¶åºæ•°æ®å­˜å‚¨ï¼ˆTimescaleDBï¼‰
  â”œâ”€â”€ è¿åŠ¨æ•°æ®
  â””â”€â”€ ç”Ÿç†æ•°æ®
  â†“
æ•°æ®åˆ†ææœåŠ¡
  â”œâ”€â”€ å®æ—¶åˆ†æ
  â”œâ”€â”€ æ€§èƒ½è¯„ä¼°
  â””â”€â”€ è®­ç»ƒå»ºè®®
```

### 2.3 æŠ€æœ¯æ ˆ

- **æ•°æ®åº“**: PostgreSQL + TimescaleDB + pgvector
- **æ•°æ®é‡‡é›†**: è¿åŠ¨ä¼ æ„Ÿå™¨ã€å¯ç©¿æˆ´è®¾å¤‡
- **å®æ—¶åˆ†æ**: Python + SQL
- **åº”ç”¨æ¡†æ¶**: FastAPI / Spring Boot

## 3. æ•°æ®æ¨¡å‹è®¾è®¡

### 3.1 è¿åŠ¨æ•°æ®æ—¶åºè¡¨

```sql
-- åˆ›å»ºè¿åŠ¨æ•°æ®æ—¶åºè¡¨
CREATE TABLE athlete_data (
    time TIMESTAMPTZ NOT NULL,
    athlete_id TEXT NOT NULL,
    sport_type TEXT,
    heart_rate INTEGER,
    speed DECIMAL(10, 2),
    distance DECIMAL(10, 2),
    calories INTEGER,
    location GEOGRAPHY(POINT, 4326),
    metadata JSONB
);

-- è½¬æ¢ä¸ºæ—¶åºè¡¨
SELECT create_hypertable('athlete_data', 'time');

-- åˆ›å»ºç´¢å¼•
CREATE INDEX ad_athlete_time_idx ON athlete_data (athlete_id, time DESC);
CREATE INDEX ad_location_idx ON athlete_data USING GIST (location);
```

### 3.2 è¿åŠ¨å‘˜ä¿¡æ¯è¡¨

```sql
CREATE TABLE athletes (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    sport_type TEXT,
    team_id TEXT,
    metadata JSONB,
    embedding vector(1536)
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX athletes_sport_idx ON athletes (sport_type);
CREATE INDEX athletes_embedding_idx ON athletes USING hnsw (embedding vector_cosine_ops);
```

## 4. æ•°æ®åˆ†æ

### 4.1 å®æ—¶è¿åŠ¨åˆ†æ

```sql
-- å®æ—¶è¿åŠ¨æ•°æ®åˆ†æ
SELECT
    athlete_id,
    time_bucket('1 minute', time) AS bucket,
    AVG(heart_rate) AS avg_heart_rate,
    AVG(speed) AS avg_speed,
    SUM(distance) AS total_distance,
    SUM(calories) AS total_calories
FROM athlete_data
WHERE time > NOW() - INTERVAL '1 hour'
GROUP BY athlete_id, bucket
ORDER BY bucket DESC;
```

### 4.2 æ€§èƒ½è¯„ä¼°

```python
# æ€§èƒ½è¯„ä¼°
class PerformanceAnalysis:
    async def analyze_performance(self, athlete_id, start_time, end_time):
        """åˆ†æè¿åŠ¨å‘˜è¡¨ç°"""
        # 1. è·å–è¿åŠ¨æ•°æ®
        data = await self.db.fetch("""
            SELECT
                AVG(heart_rate) AS avg_heart_rate,
                AVG(speed) AS avg_speed,
                SUM(distance) AS total_distance,
                SUM(calories) AS total_calories
            FROM athlete_data
            WHERE athlete_id = $1
                AND time BETWEEN $2 AND $3
        """, athlete_id, start_time, end_time)

        # 2. è®¡ç®—æ€§èƒ½æŒ‡æ ‡
        performance_score = self.calculate_score(data)

        # 3. å¯¹æ¯”å†å²æ•°æ®
        historical_data = await self.get_historical_data(athlete_id)
        improvement = self.compare_performance(data, historical_data)

        return {
            'performance_score': performance_score,
            'improvement': improvement
        }
```

## 5. å®é™…åº”ç”¨æ¡ˆä¾‹

### 5.1 æ¡ˆä¾‹: è¿åŠ¨æ•°æ®åˆ†æç³»ç»Ÿï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰

**ä¸šåŠ¡åœºæ™¯**:

æŸä½“è‚²ä¿±ä¹éƒ¨éœ€è¦æ„å»ºè¿åŠ¨æ•°æ®åˆ†æç³»ç»Ÿï¼Œåˆ†æè¿åŠ¨å‘˜è¡¨ç°ï¼Œæä¾›è®­ç»ƒå»ºè®®ã€‚

**é—®é¢˜åˆ†æ**:

1. **æ•°æ®åˆ†æ•£**: è¿åŠ¨æ•°æ®åˆ†æ•£ï¼Œéš¾ä»¥ç»Ÿä¸€åˆ†æ
2. **åˆ†ææ•ˆç‡**: æ•°æ®åˆ†ææ•ˆç‡ä½
3. **è®­ç»ƒæ•ˆæœ**: è®­ç»ƒæ•ˆæœéš¾ä»¥é‡åŒ–

**è§£å†³æ–¹æ¡ˆ**:

```python
# è¿åŠ¨æ•°æ®åˆ†æç³»ç»Ÿ
class SportsDataAnalysisSystem:
    def __init__(self):
        self.performance_analysis = PerformanceAnalysis()
        self.training_recommendation = TrainingRecommendation()

    async def analyze_athlete(self, athlete_id):
        """åˆ†æè¿åŠ¨å‘˜"""
        # 1. æ€§èƒ½åˆ†æ
        performance = await self.performance_analysis.analyze_performance(
            athlete_id,
            start_time=datetime.now() - timedelta(days=7),
            end_time=datetime.now()
        )

        # 2. è®­ç»ƒå»ºè®®
        recommendations = await self.training_recommendation.get_recommendations(
            athlete_id, performance
        )

        return {
            'performance': performance,
            'recommendations': recommendations
        }
```

**ä¼˜åŒ–æ•ˆæœ**:

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹å–„ |
|------|--------|--------|------|
| **æ•°æ®åˆ†ææ•ˆç‡** | åŸºå‡† | **+70%** | **æå‡** |
| **æŸ¥è¯¢æ€§èƒ½** | 5 ç§’ | **< 100ms** | **98%** â¬‡ï¸ |
| **è®­ç»ƒæ•ˆæœ** | åŸºå‡† | **+25%** | **æå‡** |
| **ä¼¤ç—…ç‡** | åŸºå‡† | **-30%** | **é™ä½** |

### 5.2 æŠ€æœ¯æ–¹æ¡ˆå¤šç»´å¯¹æ¯”çŸ©é˜µ

**è¿åŠ¨æ•°æ®åˆ†ææŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”**:

| æŠ€æœ¯æ–¹æ¡ˆ | åˆ†ææ•ˆç‡ | æŸ¥è¯¢æ€§èƒ½ | æˆæœ¬ | å¯æ‰©å±•æ€§ | é€‚ç”¨åœºæ™¯ |
|---------|----------|----------|------|----------|----------|
| **ä¼ ç»Ÿæ•°æ®åº“** | åŸºå‡† | åŸºå‡† | ä½ | ä¸­ | å°è§„æ¨¡ |
| **æ—¶åºæ•°æ®åº“** | +50% | 10x | ä¸­ | é«˜ | å¤§è§„æ¨¡ |
| **æ—¶åº+å‘é‡** | **+70%** | **10x** | **ä¸­** | **é«˜** | **å¤æ‚åœºæ™¯** |

**æ•°æ®åˆ†ææ–¹æ³•å¯¹æ¯”**:

| åˆ†ææ–¹æ³• | å‡†ç¡®ç‡ | å®æ—¶æ€§ | å¯è§£é‡Šæ€§ | é€‚ç”¨åœºæ™¯ |
|---------|--------|--------|----------|----------|
| **ç»Ÿè®¡åˆ†æ** | ä¸­ | é«˜ | é«˜ | ç®€å•åˆ†æ |
| **æœºå™¨å­¦ä¹ ** | é«˜ | ä¸­ | ä½ | å¤æ‚æ¨¡å¼ |
| **æ—¶åº+å‘é‡** | **é«˜** | **é«˜** | **ä¸­** | **å¤æ‚åœºæ™¯** |

## 6. æœ€ä½³å®è·µ

### 6.1 æ•°æ®é‡‡é›†

1. **å¤šæºæ•°æ®**: èåˆå¤šæºè¿åŠ¨æ•°æ®
2. **å®æ—¶é‡‡é›†**: å®æ—¶é‡‡é›†è¿åŠ¨æ•°æ®
3. **æ•°æ®è´¨é‡**: ç¡®ä¿æ•°æ®è´¨é‡

### 6.2 æ•°æ®åˆ†æ

1. **å®æ—¶åˆ†æ**: å®æ—¶åˆ†æè¿åŠ¨æ•°æ®
2. **å†å²å¯¹æ¯”**: å¯¹æ¯”å†å²æ•°æ®
3. **ä¸ªæ€§åŒ–**: ä¸ªæ€§åŒ–åˆ†æå’Œå»ºè®®

## 7. å‚è€ƒèµ„æ–™

- [IoT æ—¶åºæ•°æ®åˆ†æ](../åˆ¶é€ åœºæ™¯/IoTæ—¶åºæ•°æ®åˆ†æ.md)
- [ç©å®¶è¡Œä¸ºåˆ†æç³»ç»Ÿ](../æ¸¸æˆåœºæ™¯/ç©å®¶è¡Œä¸ºåˆ†æç³»ç»Ÿ.md)

---

## 8. å®Œæ•´ä»£ç ç¤ºä¾‹

### 8.1 è¿åŠ¨æ•°æ®è¡¨åˆ›å»º

**åˆ›å»ºè¿åŠ¨æ•°æ®åˆ†æç³»ç»Ÿæ•°æ®è¡¨**ï¼š

```sql
-- å¯ç”¨TimescaleDBå’ŒPostGISæ‰©å±•
CREATE EXTENSION IF NOT EXISTS timescaledb;
CREATE EXTENSION IF NOT EXISTS postgis;

-- åˆ›å»ºè¿åŠ¨æ•°æ®æ—¶åºè¡¨
CREATE TABLE athlete_data (
    time TIMESTAMPTZ NOT NULL,
    athlete_id TEXT NOT NULL,
    sport_type TEXT,  -- 'running', 'cycling', 'swimming', etc.
    heart_rate INTEGER,  -- å¿ƒç‡ï¼ˆbpmï¼‰
    speed DECIMAL(10, 2),  -- é€Ÿåº¦ï¼ˆkm/hï¼‰
    distance DECIMAL(10, 2),  -- è·ç¦»ï¼ˆkmï¼‰
    calories INTEGER,  -- å¡è·¯é‡Œ
    location GEOGRAPHY(POINT, 4326),  -- ä½ç½®
    metadata JSONB DEFAULT '{}'::JSONB
);

-- åˆ›å»ºè¿åŠ¨å‘˜ä¿¡æ¯è¡¨
CREATE TABLE athletes (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    sport_type TEXT,
    team_id TEXT,
    embedding vector(1536),  -- è¿åŠ¨å‘˜ç‰¹å¾å‘é‡
    metadata JSONB DEFAULT '{}'::JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- åˆ›å»ºè®­ç»ƒè®¡åˆ’è¡¨
CREATE TABLE training_plans (
    id SERIAL PRIMARY KEY,
    athlete_id TEXT NOT NULL,
    plan_date DATE NOT NULL,
    training_type TEXT,  -- 'endurance', 'speed', 'strength', etc.
    target_distance DECIMAL(10, 2),
    target_duration INTEGER,  -- ç›®æ ‡æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    completed BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    metadata JSONB DEFAULT '{}'::JSONB
);

-- è½¬æ¢ä¸ºè¶…è¡¨ï¼ˆç”¨äºæ—¶åºæ•°æ®ï¼‰
SELECT create_hypertable('athlete_data', 'time');

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_athlete_data_athlete_time ON athlete_data (athlete_id, time DESC);
CREATE INDEX idx_athlete_data_location ON athlete_data USING GIST (location);
CREATE INDEX idx_athletes_embedding ON athletes USING hnsw (embedding vector_cosine_ops);
CREATE INDEX idx_training_plans_athlete_date ON training_plans (athlete_id, plan_date DESC);
```

### 8.2 è¿åŠ¨æ•°æ®åˆ†æå®ç°

**Pythonè¿åŠ¨æ•°æ®åˆ†æ**ï¼š

```python
import psycopg2
from pgvector.psycopg2 import register_vector
from datetime import datetime, date
from typing import Optional, List, Dict
from shapely.geometry import Point

class SportsDataAnalyzer:
    def __init__(self, conn_str):
        """åˆå§‹åŒ–è¿åŠ¨æ•°æ®åˆ†æå™¨"""
        self.conn = psycopg2.connect(conn_str)
        register_vector(self.conn)
        self.cur = self.conn.cursor()

    def record_athlete_data(self, athlete_id: str, sport_type: str,
                           location: Point, heart_rate: Optional[int] = None,
                           speed: Optional[float] = None, distance: Optional[float] = None,
                           calories: Optional[int] = None):
        """è®°å½•è¿åŠ¨æ•°æ®"""
        lon, lat = location.x, location.y

        self.cur.execute("""
            INSERT INTO athlete_data
            (time, athlete_id, sport_type, location, heart_rate, speed, distance, calories)
            VALUES (%s, %s, %s, ST_SetSRID(ST_MakePoint(%s, %s), 4326), %s, %s, %s, %s)
        """, (
            datetime.now(), athlete_id, sport_type, lon, lat,
            heart_rate, speed, distance, calories
        ))

        self.conn.commit()

    def get_athlete_statistics(self, athlete_id: str, days: int = 7) -> Dict:
        """è·å–è¿åŠ¨å‘˜ç»Ÿè®¡"""
        self.cur.execute("""
            SELECT
                AVG(heart_rate) AS avg_heart_rate,
                AVG(speed) AS avg_speed,
                SUM(distance) AS total_distance,
                SUM(calories) AS total_calories,
                COUNT(*) AS training_sessions
            FROM athlete_data
            WHERE athlete_id = %s
              AND time > NOW() - INTERVAL '%s days'
        """, (athlete_id, days))

        result = self.cur.fetchone()
        if result:
            return {
                'avg_heart_rate': float(result[0]) if result[0] else None,
                'avg_speed': float(result[1]) if result[1] else None,
                'total_distance': float(result[2]) if result[2] else None,
                'total_calories': result[3] if result[3] else None,
                'training_sessions': result[4]
            }
        return {}

    def create_training_plan(self, athlete_id: str, plan_date: date,
                            training_type: str, target_distance: float,
                            target_duration: int):
        """åˆ›å»ºè®­ç»ƒè®¡åˆ’"""
        self.cur.execute("""
            INSERT INTO training_plans
            (athlete_id, plan_date, training_type, target_distance, target_duration)
            VALUES (%s, %s, %s, %s, %s)
        """, (athlete_id, plan_date, training_type, target_distance, target_duration))

        self.conn.commit()

# ä½¿ç”¨ç¤ºä¾‹
from shapely.geometry import Point

analyzer = SportsDataAnalyzer("host=localhost dbname=testdb user=postgres password=secret")

# è®°å½•è¿åŠ¨æ•°æ®
athlete_location = Point(116.3974, 39.9093)
analyzer.record_athlete_data(
    athlete_id='athlete_001',
    sport_type='running',
    location=athlete_location,
    heart_rate=150,
    speed=10.5,
    distance=5.0,
    calories=300
)

# è·å–è¿åŠ¨å‘˜ç»Ÿè®¡
stats = analyzer.get_athlete_statistics('athlete_001', days=7)
print(f"Athlete statistics: {stats}")
```

---

**æœ€åæ›´æ–°**: 2025 å¹´ 11 æœˆ 1 æ—¥
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: 08-19-01
