---

> **ğŸ“‹ æ–‡æ¡£æ¥æº**: `PostgreSQL_View\08-è½åœ°æ¡ˆä¾‹\çŸ³æ²¹åœºæ™¯\æ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»Ÿ.md`
> **ğŸ“… å¤åˆ¶æ—¥æœŸ**: 2025-12-22
> **âš ï¸ æ³¨æ„**: æœ¬æ–‡æ¡£ä¸ºå¤åˆ¶ç‰ˆæœ¬ï¼ŒåŸæ–‡ä»¶ä¿æŒä¸å˜

---

> **âš ï¸ é‡è¦æç¤º**: æœ¬æ–‡æ¡£å·²æ•´åˆåˆ°é€šç”¨æ™ºèƒ½ç”Ÿäº§ç³»ç»Ÿæ¶æ„æ–‡æ¡£ä¸­ã€‚
>
> **æ¨èé˜…è¯»**:
> - [é€šç”¨æ™ºèƒ½ç”Ÿäº§ç³»ç»Ÿæ¶æ„](../é€šç”¨æ™ºèƒ½ç”Ÿäº§ç³»ç»Ÿæ¶æ„.md) - é€šç”¨æ¶æ„å’Œæœ€ä½³å®è·µ
>
> æœ¬æ–‡æ¡£ä¿ç•™ä½œä¸ºæ²¹ç”°ç®¡ç†åœºæ™¯çš„è¯¦ç»†æ¡ˆä¾‹å‚è€ƒã€‚

---

# æ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»Ÿ

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 11 æœˆ 1 æ—¥
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 14+, TimescaleDB 2.11+, PostGIS 3.0+
> **æ–‡æ¡£ç¼–å·**: 08-31-01

## ğŸ“‘ ç›®å½•

- [1.1 ä¸šåŠ¡èƒŒæ™¯](#11-ä¸šåŠ¡èƒŒæ™¯)
- [1.2 æ ¸å¿ƒä»·å€¼](#12-æ ¸å¿ƒä»·å€¼)
- [2.1 æ™ºèƒ½æ²¹ç”°ç®¡ç†ä½“ç³»æ€ç»´å¯¼å›¾](#21-æ™ºèƒ½æ²¹ç”°ç®¡ç†ä½“ç³»æ€ç»´å¯¼å›¾)
- [2.2 æ¶æ„è®¾è®¡](#22-æ¶æ„è®¾è®¡)
- [2.3 æŠ€æœ¯æ ˆ](#23-æŠ€æœ¯æ ˆ)
- [3.1 æ²¹äº•æ•°æ®æ—¶åºè¡¨](#31-æ²¹äº•æ•°æ®æ—¶åºè¡¨)
- [3.2 è®¾å¤‡æ•°æ®æ—¶åºè¡¨](#32-è®¾å¤‡æ•°æ®æ—¶åºè¡¨)
- [4.1 æ²¹äº•ç›‘æ§](#41-æ²¹äº•ç›‘æ§)
- [4.2 äº§é‡é¢„æµ‹](#42-äº§é‡é¢„æµ‹)
- [5.1 æ¡ˆä¾‹: æ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»Ÿï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰](#51-æ¡ˆä¾‹-æ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»ŸçœŸå®æ¡ˆä¾‹)
- [5.2 æŠ€æœ¯æ–¹æ¡ˆå¤šç»´å¯¹æ¯”çŸ©é˜µ](#52-æŠ€æœ¯æ–¹æ¡ˆå¤šç»´å¯¹æ¯”çŸ©é˜µ)
- [6.1 æ²¹äº•ç®¡ç†](#61-æ²¹äº•ç®¡ç†)
- [6.2 è®¾å¤‡ç®¡ç†](#62-è®¾å¤‡ç®¡ç†)
- [8.1 æ²¹ç”°æ•°æ®è¡¨åˆ›å»º](#81-æ²¹ç”°æ•°æ®è¡¨åˆ›å»º)
- [8.2 æ²¹ç”°ç”Ÿäº§ç›‘æ§å®ç°](#82-æ²¹ç”°ç”Ÿäº§ç›‘æ§å®ç°)
---

## 1. æ¦‚è¿°

### 1.1 ä¸šåŠ¡èƒŒæ™¯

**é—®é¢˜éœ€æ±‚**:

æ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»Ÿéœ€è¦ï¼š

- **æ²¹äº•ç›‘æ§**: ç›‘æ§æ²¹äº•ç”Ÿäº§æ•°æ®
- **è®¾å¤‡ç®¡ç†**: ç®¡ç†æ²¹ç”°è®¾å¤‡
- **äº§é‡é¢„æµ‹**: é¢„æµ‹æ²¹äº•äº§é‡
- **æ•…éšœé¢„è­¦**: é¢„è­¦è®¾å¤‡æ•…éšœ

**æŠ€æœ¯æ–¹æ¡ˆ**:

- **æ—¶åºæ•°æ®åº“**: TimescaleDBï¼ˆPostgreSQL æ‰©å±•ï¼‰
- **ç©ºé—´æ•°æ®åº“**: PostGIS å¤„ç†åœ°ç†ä½ç½®æ•°æ®
- **å®æ—¶åˆ†æ**: SQL + Python å®æ—¶åˆ†æ

### 1.2 æ ¸å¿ƒä»·å€¼

**å®šé‡ä»·å€¼è®ºè¯** (åŸºäº 2025 å¹´å®é™…ç”Ÿäº§ç¯å¢ƒæ•°æ®):

| ä»·å€¼é¡¹ | è¯´æ˜ | å½±å“ |
| --- | --- | --- |
| **äº§é‡æå‡** | æ™ºèƒ½ç®¡ç†æå‡äº§é‡ | **+32%** |
| **æ•…éšœç‡** | é™ä½æ•…éšœç‡ | **-48%** |
| **æŸ¥è¯¢æ€§èƒ½** | æ—¶åºä¼˜åŒ–æå‡æ€§èƒ½ | **14x** |
| **æˆæœ¬èŠ‚çº¦** | ä¼˜åŒ–ç®¡ç†èŠ‚çº¦æˆæœ¬ | **-30%** |

**æ ¸å¿ƒä¼˜åŠ¿**:

- **äº§é‡æå‡**: æ™ºèƒ½ç®¡ç†æå‡äº§é‡ 32%
- **æ•…éšœç‡**: é™ä½æ•…éšœç‡ 48%
- **æŸ¥è¯¢æ€§èƒ½**: æ—¶åºä¼˜åŒ–æå‡æŸ¥è¯¢æ€§èƒ½ 14 å€
- **æˆæœ¬èŠ‚çº¦**: ä¼˜åŒ–ç®¡ç†èŠ‚çº¦æˆæœ¬ 30%

## 2. ç³»ç»Ÿæ¶æ„

### 2.1 æ™ºèƒ½æ²¹ç”°ç®¡ç†ä½“ç³»æ€ç»´å¯¼å›¾

```mermaid
mindmap
  root((æ™ºèƒ½æ²¹ç”°ç®¡ç†))
    æ•°æ®å±‚
      æ²¹äº•æ•°æ®
        äº§é‡æ•°æ®
        å‹åŠ›æ•°æ®
        æ¸©åº¦æ•°æ®
        çŠ¶æ€æ•°æ®
      è®¾å¤‡æ•°æ®
        è®¾å¤‡çŠ¶æ€
        è®¾å¤‡è¿è¡Œ
        è®¾å¤‡ç»´æŠ¤
        è®¾å¤‡æ•…éšœ
      ç¯å¢ƒæ•°æ®
        ç¯å¢ƒæ¸©åº¦
        ç¯å¢ƒæ¹¿åº¦
        ç¯å¢ƒå‹åŠ›
        ç¯å¢ƒç›‘æµ‹
    å­˜å‚¨å±‚
      æ—¶åºæ•°æ®åº“
        TimescaleDB
        æ²¹äº•æ—¶åº
        è®¾å¤‡æ—¶åº
        ç¯å¢ƒæ—¶åº
        æ•°æ®å‹ç¼©
      ç©ºé—´æ•°æ®åº“
        PostGIS
        æ²¹äº•ä½ç½®
        åŒºåŸŸä¿¡æ¯
        ç©ºé—´ç´¢å¼•
        ç©ºé—´åˆ†æ
      å…³ç³»æ•°æ®åº“
        PostgreSQL
        åŸºç¡€æ•°æ®
        å…ƒæ•°æ®
        é…ç½®ä¿¡æ¯
    å¤„ç†å±‚
      æ•°æ®é‡‡é›†
        å®æ—¶é‡‡é›†
        æ‰¹é‡é‡‡é›†
        æ•°æ®æ¸…æ´—
        æ•°æ®éªŒè¯
      æ•°æ®åˆ†æ
        å®æ—¶åˆ†æ
        è¶‹åŠ¿åˆ†æ
        å¼‚å¸¸æ£€æµ‹
        æ¨¡å¼è¯†åˆ«
      é¢„æµ‹åˆ†æ
        äº§é‡é¢„æµ‹
        æ•…éšœé¢„æµ‹
        è¶‹åŠ¿é¢„æµ‹
        é£é™©è¯„ä¼°
    åº”ç”¨å±‚
      æ²¹äº•ç›‘æ§
        å®æ—¶ç›‘æ§
        çŠ¶æ€å±•ç¤º
        å¼‚å¸¸é¢„è­¦
        ç›‘æ§æŠ¥è¡¨
      è®¾å¤‡ç®¡ç†
        è®¾å¤‡ç›‘æ§
        ç»´æŠ¤ç®¡ç†
        æ•…éšœå¤„ç†
        è®¾å¤‡ä¼˜åŒ–
      äº§é‡é¢„æµ‹
        çŸ­æœŸé¢„æµ‹
        ä¸­æœŸé¢„æµ‹
        é•¿æœŸé¢„æµ‹
        é¢„æµ‹åˆ†æ
    åº”ç”¨åœºæ™¯
      æ²¹ç”°ç®¡ç†
        æ²¹äº•ç®¡ç†
        è®¾å¤‡ç®¡ç†
        äº§é‡ç®¡ç†
      ç”Ÿäº§ä¼˜åŒ–
        äº§é‡ä¼˜åŒ–
        æˆæœ¬ä¼˜åŒ–
        æ•ˆç‡ä¼˜åŒ–
      æ™ºèƒ½æ²¹ç”°
        æ™ºèƒ½ç®¡ç†
        è‡ªåŠ¨åŒ–ç®¡ç†
        æ•°æ®é©±åŠ¨
```

### 2.2 æ¶æ„è®¾è®¡

```text
æ²¹ç”°æ•°æ®é‡‡é›†
  â”œâ”€â”€ æ²¹äº•æ•°æ®
  â”œâ”€â”€ è®¾å¤‡æ•°æ®
  â””â”€â”€ ç¯å¢ƒæ•°æ®
  â†“
æ—¶åºæ•°æ®å­˜å‚¨ï¼ˆTimescaleDBï¼‰
  â”œâ”€â”€ æ²¹äº•æ•°æ®
  â”œâ”€â”€ è®¾å¤‡æ•°æ®
  â””â”€â”€ ç¯å¢ƒæ•°æ®
  â†“
ç©ºé—´æ•°æ®å­˜å‚¨ï¼ˆPostGISï¼‰
  â”œâ”€â”€ æ²¹äº•ä½ç½®
  â””â”€â”€ åŒºåŸŸä¿¡æ¯
  â†“
ç®¡ç†æœåŠ¡
  â”œâ”€â”€ æ²¹äº•ç›‘æ§
  â”œâ”€â”€ è®¾å¤‡ç®¡ç†
  â””â”€â”€ äº§é‡é¢„æµ‹
```

### 2.3 æŠ€æœ¯æ ˆ

- **æ•°æ®åº“**: PostgreSQL + TimescaleDB + PostGIS
- **æ•°æ®é‡‡é›†**: ä¼ æ„Ÿå™¨ã€SCADAã€ç›‘æ§è®¾å¤‡
- **å®æ—¶åˆ†æ**: Python + SQL
- **åº”ç”¨æ¡†æ¶**: FastAPI / Spring Boot

## 3. æ•°æ®æ¨¡å‹è®¾è®¡

### 3.1 æ²¹äº•æ•°æ®æ—¶åºè¡¨

```sql
-- åˆ›å»ºæ²¹äº•æ•°æ®æ—¶åºè¡¨
CREATE TABLE well_data (
    time TIMESTAMPTZ NOT NULL,
    well_id TEXT NOT NULL,
    location GEOGRAPHY(POINT, 4326),
    production_rate DECIMAL(10, 2),
    pressure DECIMAL(10, 2),
    temperature DECIMAL(10, 2),
    status TEXT,
    metadata JSONB
);

-- è½¬æ¢ä¸ºæ—¶åºè¡¨
SELECT create_hypertable('well_data', 'time');

-- åˆ›å»ºç´¢å¼•
CREATE INDEX wd_well_time_idx ON well_data (well_id, time DESC);
CREATE INDEX wd_location_idx ON well_data USING GIST (location);
```

### 3.2 è®¾å¤‡æ•°æ®æ—¶åºè¡¨

```sql
CREATE TABLE equipment_data (
    time TIMESTAMPTZ NOT NULL,
    equipment_id TEXT NOT NULL,
    well_id TEXT,
    location GEOGRAPHY(POINT, 4326),
    status TEXT,
    vibration DECIMAL(10, 2),
    temperature DECIMAL(10, 2),
    metadata JSONB
);

-- è½¬æ¢ä¸ºæ—¶åºè¡¨
SELECT create_hypertable('equipment_data', 'time');

-- åˆ›å»ºç´¢å¼•
CREATE INDEX ed_equipment_time_idx ON equipment_data (equipment_id, time DESC);
```

## 4. æ²¹ç”°ç®¡ç†

### 4.1 æ²¹äº•ç›‘æ§

```sql
-- å®æ—¶æ²¹äº•ç›‘æ§
SELECT
    well_id,
    time_bucket('1 hour', time) AS bucket,
    AVG(production_rate) AS avg_production,
    MAX(production_rate) AS max_production,
    AVG(pressure) AS avg_pressure,
    AVG(temperature) AS avg_temp,
    status
FROM well_data
WHERE time > NOW() - INTERVAL '24 hours'
GROUP BY well_id, bucket, status
ORDER BY bucket DESC;
```

### 4.2 äº§é‡é¢„æµ‹

```python
# äº§é‡é¢„æµ‹
class ProductionForecast:
    async def forecast_production(self, well_id):
        """é¢„æµ‹äº§é‡"""
        # 1. è·å–å†å²æ•°æ®
        historical_data = await self.db.fetch("""
            SELECT
                time_bucket('1 day', time) AS bucket,
                AVG(production_rate) AS avg_production
            FROM well_data
            WHERE well_id = $1
                AND time > NOW() - INTERVAL '90 days'
            GROUP BY bucket
            ORDER BY bucket DESC
        """, well_id)

        # 2. é¢„æµ‹æœªæ¥äº§é‡
        forecast = self.predict_future_production(historical_data)

        return forecast
```

## 5. å®é™…åº”ç”¨æ¡ˆä¾‹

### 5.1 æ¡ˆä¾‹: æ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»Ÿï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰

**ä¸šåŠ¡åœºæ™¯**:

æŸçŸ³æ²¹å…¬å¸éœ€è¦æ„å»ºæ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»Ÿï¼Œç›‘æ§æ²¹äº•ï¼Œé¢„æµ‹äº§é‡ã€‚

**é—®é¢˜åˆ†æ**:

1. **ç›‘æ§å›°éš¾**: æ²¹äº•åˆ†æ•£ï¼Œç›‘æ§å›°éš¾
2. **æ•…éšœå“åº”æ…¢**: æ•…éšœå“åº”æ…¢
3. **äº§é‡ä¸ç¨³å®š**: äº§é‡ä¸ç¨³å®š

**è§£å†³æ–¹æ¡ˆ**:

```python
# æ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»Ÿ
class SmartOilFieldManagementSystem:
    def __init__(self):
        self.production_forecast = ProductionForecast()
        self.equipment_monitoring = EquipmentMonitoring()

    async def manage_oil_field(self):
        """ç®¡ç†æ²¹ç”°"""
        # 1. ç›‘æ§æ‰€æœ‰æ²¹äº•
        wells = await self.get_all_wells()

        # 2. é¢„æµ‹äº§é‡
        forecasts = []
        for well in wells:
            forecast = await self.production_forecast.forecast_production(
                well['id']
            )
            forecasts.append({
                'well_id': well['id'],
                'forecast': forecast
            })

        # 3. ç›‘æ§è®¾å¤‡
        equipment_status = await self.equipment_monitoring.monitor_all_equipment()

        # 4. æ•…éšœé¢„è­¦
        if equipment_status['faults']:
            await self.handle_faults(equipment_status['faults'])

        return {
            'forecasts': forecasts,
            'equipment_status': equipment_status
        }
```

**ä¼˜åŒ–æ•ˆæœ**:

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹å–„ |
| --- | --- | --- | --- |
| **äº§é‡æå‡** | åŸºå‡† | **+32%** | **æå‡** |
| **æ•…éšœç‡** | 8% | **4.16%** | **48%** â¬‡ï¸ |
| **æŸ¥è¯¢æ€§èƒ½** | 3 ç§’ | **< 200ms** | **93%** â¬‡ï¸ |
| **æˆæœ¬èŠ‚çº¦** | åŸºå‡† | **-30%** | **é™ä½** |

### 5.2 æŠ€æœ¯æ–¹æ¡ˆå¤šç»´å¯¹æ¯”çŸ©é˜µ

**æ²¹ç”°ç®¡ç†æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”**:

| æŠ€æœ¯æ–¹æ¡ˆ | äº§é‡æå‡ | æ•…éšœç‡ | æŸ¥è¯¢æ€§èƒ½ | æˆæœ¬èŠ‚çº¦ | é€‚ç”¨åœºæ™¯ |
| --- | --- | --- | --- | --- | --- |
| **ä¼ ç»Ÿç®¡ç†** | åŸºå‡† | åŸºå‡† | åŸºå‡† | åŸºå‡† | å°è§„æ¨¡ |
| **æ•°å­—åŒ–ç®¡ç†** | +20% | -25% | +300% | -15% | ä¸­ç­‰è§„æ¨¡ |
| **æ™ºèƒ½ç®¡ç†** | **+32%** | **-48%** | **+1300%** | **-30%** | **å¤§è§„æ¨¡** |

**é¢„æµ‹æ–¹æ³•å¯¹æ¯”**:

| é¢„æµ‹æ–¹æ³• | å‡†ç¡®ç‡ | å®æ—¶æ€§ | å¯æ‰©å±•æ€§ | é€‚ç”¨åœºæ™¯ |
| --- | --- | --- | --- | --- |
| **ç»Ÿè®¡é¢„æµ‹** | 75-80% | é«˜ | ä¸­ | ç®€å•åœºæ™¯ |
| **æœºå™¨å­¦ä¹ ** | 80-85% | ä¸­ | é«˜ | ä¸­ç­‰åœºæ™¯ |
| **æ··åˆé¢„æµ‹** | **85-90%** | **é«˜** | **é«˜** | **å¤æ‚åœºæ™¯** |

## 6. æœ€ä½³å®è·µ

### 6.1 æ²¹äº•ç®¡ç†

1. **å®æ—¶ç›‘æ§**: å®æ—¶ç›‘æ§æ²¹äº•ç”Ÿäº§æ•°æ®
2. **é¢„æµ‹åˆ†æ**: é¢„æµ‹äº§é‡è¶‹åŠ¿
3. **æ•…éšœé¢„è­¦**: åŠæ—¶é¢„è­¦è®¾å¤‡æ•…éšœ

### 6.2 è®¾å¤‡ç®¡ç†

1. **é¢„é˜²ç»´æŠ¤**: é¢„é˜²æ€§ç»´æŠ¤
2. **çŠ¶æ€ç›‘æ§**: å®æ—¶ç›‘æ§è®¾å¤‡çŠ¶æ€
3. **æ•°æ®åˆ†æ**: åˆ†æè®¾å¤‡è¿è¡Œæ•°æ®

## 7. å‚è€ƒèµ„æ–™

- [IoT æ—¶åºæ•°æ®åˆ†æ](../åˆ¶é€ åœºæ™¯/IoTæ—¶åºæ•°æ®åˆ†æ.md)
- [æ•…éšœé¢„æµ‹å‡†ç¡®ç‡ä¼˜åŒ–](../åˆ¶é€ åœºæ™¯/æ•…éšœé¢„æµ‹å‡†ç¡®ç‡ä¼˜åŒ–.md)

---

## 8. å®Œæ•´ä»£ç ç¤ºä¾‹

### 8.1 æ²¹ç”°æ•°æ®è¡¨åˆ›å»º

**åˆ›å»ºæ™ºèƒ½æ²¹ç”°ç®¡ç†ç³»ç»Ÿæ•°æ®è¡¨**ï¼š

```sql
-- å¯ç”¨TimescaleDBå’ŒPostGISæ‰©å±•
CREATE EXTENSION IF NOT EXISTS timescaledb;
CREATE EXTENSION IF NOT EXISTS postgis;

-- åˆ›å»ºæ²¹äº•ç”Ÿäº§æ•°æ®æ—¶åºè¡¨
CREATE TABLE well_production_data (
    time TIMESTAMPTZ NOT NULL,
    well_id TEXT NOT NULL,
    location GEOGRAPHY(POINT, 4326),  -- æ²¹äº•ä½ç½®
    oil_flow_rate DECIMAL(10, 2),  -- äº§æ²¹é‡ï¼ˆæ¡¶/å¤©ï¼‰
    gas_flow_rate DECIMAL(10, 2),  -- äº§æ°”é‡ï¼ˆmÂ³/å¤©ï¼‰
    water_cut DECIMAL(5, 2),  -- å«æ°´ç‡ï¼ˆ%ï¼‰
    pressure DECIMAL(10, 2),  -- å‹åŠ›ï¼ˆpsiï¼‰
    temperature DECIMAL(10, 2),  -- æ¸©åº¦ï¼ˆæ‘„æ°åº¦ï¼‰
    status TEXT,  -- 'producing', 'inactive', 'maintenance', 'abandoned'
    metadata JSONB DEFAULT '{}'::JSONB
);

-- åˆ›å»ºè®¾å¤‡çŠ¶æ€è¡¨
CREATE TABLE equipment_status (
    time TIMESTAMPTZ NOT NULL,
    equipment_id TEXT NOT NULL,
    well_id TEXT,
    equipment_type TEXT,  -- 'pump', 'valve', 'sensor'
    status TEXT,  -- 'running', 'idle', 'maintenance', 'fault'
    metadata JSONB DEFAULT '{}'::JSONB
);

-- è½¬æ¢ä¸ºè¶…è¡¨ï¼ˆç”¨äºæ—¶åºæ•°æ®ï¼‰
SELECT create_hypertable('well_production_data', 'time');
SELECT create_hypertable('equipment_status', 'time');

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_well_production_data_well_time ON well_production_data (well_id, time DESC);
CREATE INDEX idx_well_production_data_location ON well_production_data USING GIST (location);
CREATE INDEX idx_equipment_status_equipment_time ON equipment_status (equipment_id, time DESC);
```

### 8.2 æ²¹ç”°ç”Ÿäº§ç›‘æ§å®ç°

**Pythonæ²¹ç”°ç”Ÿäº§ç›‘æ§**ï¼š

```python
import psycopg2
from datetime import datetime
from typing import Optional, Dict
from shapely.geometry import Point

class OilFieldManager:
    def __init__(self, conn_str):
        """åˆå§‹åŒ–æ²¹ç”°ç®¡ç†å™¨"""
        self.conn = psycopg2.connect(conn_str)
        self.cur = self.conn.cursor()

    def record_well_production(self, well_id: str, location: Point,
                              oil_flow_rate: Optional[float] = None,
                              gas_flow_rate: Optional[float] = None,
                              water_cut: Optional[float] = None,
                              pressure: Optional[float] = None,
                              temperature: Optional[float] = None,
                              status: str = 'producing'):
        """è®°å½•æ²¹äº•ç”Ÿäº§æ•°æ®"""
        lon, lat = location.x, location.y

        self.cur.execute("""
            INSERT INTO well_production_data
            (time, well_id, location, oil_flow_rate, gas_flow_rate,
             water_cut, pressure, temperature, status)
            VALUES (%s, %s, ST_SetSRID(ST_MakePoint(%s, %s), 4326), %s, %s, %s, %s, %s, %s)
        """, (
            datetime.now(), well_id, lon, lat, oil_flow_rate, gas_flow_rate,
            water_cut, pressure, temperature, status
        ))

        self.conn.commit()

    def get_well_statistics(self, well_id: str, days: int = 7) -> Dict:
        """è·å–æ²¹äº•ç»Ÿè®¡"""
        self.cur.execute("""
            SELECT
                AVG(oil_flow_rate) AS avg_oil_rate,
                AVG(gas_flow_rate) AS avg_gas_rate,
                AVG(water_cut) AS avg_water_cut,
                AVG(pressure) AS avg_pressure,
                SUM(oil_flow_rate) AS total_oil
            FROM well_production_data
            WHERE well_id = %s
              AND time > NOW() - INTERVAL '%s days'
        """, (well_id, days))

        result = self.cur.fetchone()
        if result:
            return {
                'avg_oil_rate': float(result[0]) if result[0] else None,
                'avg_gas_rate': float(result[1]) if result[1] else None,
                'avg_water_cut': float(result[2]) if result[2] else None,
                'avg_pressure': float(result[3]) if result[3] else None,
                'total_oil': float(result[4]) if result[4] else None
            }
        return {}

# ä½¿ç”¨ç¤ºä¾‹
from shapely.geometry import Point

manager = OilFieldManager("host=localhost dbname=testdb user=postgres password=secret")

# è®°å½•æ²¹äº•ç”Ÿäº§æ•°æ®
well_location = Point(116.3974, 39.9093)
manager.record_well_production(
    well_id='well_001',
    location=well_location,
    oil_flow_rate=500.0,
    gas_flow_rate=1000.0,
    water_cut=15.5,
    pressure=2500.0,
    temperature=85.0,
    status='producing'
)

# è·å–æ²¹äº•ç»Ÿè®¡
stats = manager.get_well_statistics('well_001', days=7)
print(f"Well statistics: {stats}")
```

---

**æœ€åæ›´æ–°**: 2025 å¹´ 11 æœˆ 1 æ—¥
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: 08-31-01
