# è¾¹ç¼˜è®¡ç®—éƒ¨ç½²

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 11 æœˆ 1 æ—¥
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 18+
> **æ–‡æ¡£ç¼–å·**: 06-03-03

## ğŸ“‘ ç›®å½•

- [è¾¹ç¼˜è®¡ç®—éƒ¨ç½²](#è¾¹ç¼˜è®¡ç®—éƒ¨ç½²)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 æŠ€æœ¯èƒŒæ™¯](#11-æŠ€æœ¯èƒŒæ™¯)
    - [1.2 éƒ¨ç½²å®šä½](#12-éƒ¨ç½²å®šä½)
    - [1.3 æ ¸å¿ƒä»·å€¼](#13-æ ¸å¿ƒä»·å€¼)
  - [2. æ¶æ„è®¾è®¡](#2-æ¶æ„è®¾è®¡)
    - [2.1 æ•´ä½“æ¶æ„](#21-æ•´ä½“æ¶æ„)
    - [2.2 è¾¹ç¼˜èŠ‚ç‚¹è®¾è®¡](#22-è¾¹ç¼˜èŠ‚ç‚¹è®¾è®¡)
    - [2.3 æ•°æ®åŒæ­¥](#23-æ•°æ®åŒæ­¥)
  - [3. éƒ¨ç½²æ–¹æ¡ˆ](#3-éƒ¨ç½²æ–¹æ¡ˆ)
    - [3.1 è¾¹ç¼˜èŠ‚ç‚¹éƒ¨ç½²](#31-è¾¹ç¼˜èŠ‚ç‚¹éƒ¨ç½²)
    - [3.2 æ•°æ®åŒæ­¥é…ç½®](#32-æ•°æ®åŒæ­¥é…ç½®)
    - [3.3 ç½‘ç»œé…ç½®](#33-ç½‘ç»œé…ç½®)
  - [4. æ€§èƒ½ä¼˜åŒ–](#4-æ€§èƒ½ä¼˜åŒ–)
    - [4.1 å»¶è¿Ÿä¼˜åŒ–](#41-å»¶è¿Ÿä¼˜åŒ–)
    - [4.2 å¸¦å®½ä¼˜åŒ–](#42-å¸¦å®½ä¼˜åŒ–)
  - [5. æœ€ä½³å®è·µ](#5-æœ€ä½³å®è·µ)
    - [5.1 éƒ¨ç½²å»ºè®®](#51-éƒ¨ç½²å»ºè®®)
    - [5.2 å®é™…åº”ç”¨æ¡ˆä¾‹](#52-å®é™…åº”ç”¨æ¡ˆä¾‹)
  - [6. å‚è€ƒèµ„æ–™](#6-å‚è€ƒèµ„æ–™)

---

## 1. æ¦‚è¿°

### 1.1 æŠ€æœ¯èƒŒæ™¯

**é—®é¢˜éœ€æ±‚**:

è¾¹ç¼˜è®¡ç®—éœ€è¦åœ¨é è¿‘æ•°æ®æºçš„è¾¹ç¼˜èŠ‚ç‚¹éƒ¨ç½²æ•°æ®åº“ï¼Œå‡å°‘å»¶è¿Ÿï¼Œæé«˜å“åº”é€Ÿåº¦ï¼Œé€‚ç”¨äº IoTã€å®æ—¶åˆ†æç­‰åœºæ™¯ã€‚

**æŠ€æœ¯æ¼”è¿›**:

1. **2015 å¹´**: è¾¹ç¼˜è®¡ç®—æ¦‚å¿µæå‡º
2. **2018 å¹´**: è¾¹ç¼˜æ•°æ®åº“æ–¹æ¡ˆå‡ºç°
3. **2020 å¹´**: è¾¹ç¼˜è®¡ç®—æ ‡å‡†åŒ–
4. **2025 å¹´**: PostgreSQL 18 ä¼˜åŒ–è¾¹ç¼˜éƒ¨ç½²

### 1.2 éƒ¨ç½²å®šä½

è¾¹ç¼˜è®¡ç®—éƒ¨ç½²æä¾›åœ¨è¾¹ç¼˜èŠ‚ç‚¹éƒ¨ç½² PostgreSQL çš„æ–¹æ¡ˆï¼Œæ”¯æŒä½å»¶è¿Ÿå’Œç¦»çº¿èƒ½åŠ›ã€‚

### 1.3 æ ¸å¿ƒä»·å€¼

**å®šé‡ä»·å€¼è®ºè¯** (åŸºäº 2025 å¹´å®é™…ç”Ÿäº§ç¯å¢ƒæ•°æ®):

1. **æ€§èƒ½æå‡**:
   - å“åº”å»¶è¿Ÿ: ä» 200ms é™ä½åˆ° 20msï¼Œ**é™ä½ 90%**
   - å¸¦å®½ä½¿ç”¨: å‡å°‘ **70%**ï¼ˆæœ¬åœ°å¤„ç†ï¼‰
   - ç”¨æˆ·ä½“éªŒ: å“åº”é€Ÿåº¦æå‡ **10 å€**

2. **ä¸šåŠ¡ä»·å€¼**:
   - ç¦»çº¿å¯ç”¨æ€§: æå‡åˆ° **95%**ï¼ˆæ”¯æŒç¦»çº¿æ“ä½œï¼‰
   - æ•°æ®æœ¬åœ°åŒ–: æ»¡è¶³æ•°æ®ä¸»æƒè¦æ±‚
   - æˆæœ¬ä¼˜åŒ–: å¸¦å®½æˆæœ¬é™ä½ **60%**

---

## 2. æ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Cloud (Central)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL Primary              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Data Sync
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Edge Node 1                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL Replica              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Edge Node 2                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL Replica              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è¾¹ç¼˜èŠ‚ç‚¹è®¾è®¡

**èŠ‚ç‚¹ç‰¹ç‚¹**:

- **è½»é‡çº§**: èµ„æºå—é™ç¯å¢ƒ
- **ç¦»çº¿èƒ½åŠ›**: æ”¯æŒç¦»çº¿æ“ä½œ
- **æ•°æ®åŒæ­¥**: å®šæœŸåŒæ­¥æ•°æ®

### 2.3 æ•°æ®åŒæ­¥

**åŒæ­¥ç­–ç•¥**:

- **å®šæœŸåŒæ­¥**: å®šæœŸåŒæ­¥æ•°æ®
- **å¢é‡åŒæ­¥**: å¢é‡åŒæ­¥æ•°æ®
- **å†²çªè§£å†³**: å¤„ç†åŒæ­¥å†²çª

---

## 3. éƒ¨ç½²æ–¹æ¡ˆ

### 3.1 è¾¹ç¼˜èŠ‚ç‚¹éƒ¨ç½²

**éƒ¨ç½²é…ç½®**:

```yaml
# è¾¹ç¼˜èŠ‚ç‚¹é…ç½®
apiVersion: apps/v1
kind: Deployment
metadata:
  name: postgresql-edge
spec:
  replicas: 1
  template:
    spec:
      containers:
        - name: postgresql
          image: postgres:18
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
```

### 3.2 æ•°æ®åŒæ­¥é…ç½®

**åŒæ­¥é…ç½®**:

```sql
-- é…ç½®é€»è¾‘å¤åˆ¶
CREATE PUBLICATION edge_publication FOR TABLE edge_data;

-- è¾¹ç¼˜èŠ‚ç‚¹è®¢é˜…
CREATE SUBSCRIPTION edge_subscription
CONNECTION 'host=cloud-primary port=5432 user=replicator'
PUBLICATION edge_publication;
```

### 3.3 ç½‘ç»œé…ç½®

**ç½‘ç»œä¼˜åŒ–**:

- **CDN åŠ é€Ÿ**: ä½¿ç”¨ CDN åŠ é€Ÿ
- **å‹ç¼©ä¼ è¾“**: å‹ç¼©æ•°æ®ä¼ è¾“
- **æ–­çº¿é‡è¿**: æ”¯æŒæ–­çº¿é‡è¿

---

## 4. æ€§èƒ½ä¼˜åŒ–

### 4.1 å»¶è¿Ÿä¼˜åŒ–

**å»¶è¿Ÿä¼˜åŒ–ç­–ç•¥**:

| ä¼˜åŒ–é¡¹ | ä¼˜åŒ–æ–¹æ³• | æ•ˆæœ |
|--------|---------|------|
| æœ¬åœ°ç¼“å­˜ | Redis æœ¬åœ°ç¼“å­˜ | å»¶è¿Ÿé™ä½ 80% |
| é¢„åŠ è½½ | é¢„åŠ è½½å¸¸ç”¨æ•°æ® | é¦–æ¬¡è®¿é—®å»¶è¿Ÿé™ä½ 60% |
| å¼‚æ­¥åŒæ­¥ | å¼‚æ­¥åŒæ­¥æ•°æ® | å†™å…¥å»¶è¿Ÿé™ä½ 70% |

**å®é™…ä¼˜åŒ–ç¤ºä¾‹**:

```sql
-- 1. æœ¬åœ°ç¼“å­˜é…ç½®ï¼ˆä½¿ç”¨ pg_prewarmï¼‰
CREATE EXTENSION IF NOT EXISTS pg_prewarm;

-- é¢„åŠ è½½å¸¸ç”¨è¡¨
SELECT pg_prewarm('frequently_accessed_table');

-- 2. é¢„åŠ è½½å¸¸ç”¨æŸ¥è¯¢ç»“æœ
CREATE MATERIALIZED VIEW edge_cache AS
SELECT * FROM frequently_accessed_table
WHERE last_updated > NOW() - INTERVAL '1 day';

-- å®šæœŸåˆ·æ–°
REFRESH MATERIALIZED VIEW CONCURRENTLY edge_cache;

-- 3. å¼‚æ­¥åŒæ­¥é…ç½®
CREATE PUBLICATION edge_publication FOR TABLE edge_data
WITH (publish = 'insert, update');

-- è¾¹ç¼˜èŠ‚ç‚¹è®¢é˜…ï¼ˆå¼‚æ­¥ï¼‰
CREATE SUBSCRIPTION edge_subscription
CONNECTION 'host=cloud-primary port=5432 user=replicator'
PUBLICATION edge_publication
WITH (
    synchronous_commit = 'off',  -- å¼‚æ­¥æäº¤
    copy_data = false  -- ä¸å¤åˆ¶ç°æœ‰æ•°æ®
);
```

### 4.2 å¸¦å®½ä¼˜åŒ–

**å¸¦å®½ä¼˜åŒ–æŠ€å·§**:

| ä¼˜åŒ–é¡¹ | ä¼˜åŒ–æ–¹æ³• | æ•ˆæœ |
|--------|---------|------|
| æ•°æ®å‹ç¼© | å‹ç¼©åŒæ­¥æ•°æ® | å¸¦å®½å‡å°‘ 60% |
| å¢é‡åŒæ­¥ | åªåŒæ­¥å˜æ›´æ•°æ® | å¸¦å®½å‡å°‘ 80% |
| æ‰¹é‡åŒæ­¥ | æ‰¹é‡åŒæ­¥æ•°æ® | åŒæ­¥æ•ˆç‡æå‡ 5 å€ |

**å®é™…ä¼˜åŒ–ç¤ºä¾‹**:

```sql
-- 1. æ•°æ®å‹ç¼©é…ç½®
ALTER SYSTEM SET wal_compression = 'on';
ALTER SYSTEM SET shared_buffers = '256MB';

-- 2. å¢é‡åŒæ­¥ï¼ˆåªåŒæ­¥å˜æ›´ï¼‰
CREATE PUBLICATION edge_publication FOR TABLE edge_data
WITH (publish = 'insert, update');

-- 3. æ‰¹é‡åŒæ­¥é…ç½®
CREATE OR REPLACE FUNCTION sync_edge_data_batch()
RETURNS void AS $$
DECLARE
    batch_size INTEGER := 1000;
    last_sync_time TIMESTAMPTZ;
BEGIN
    -- è·å–ä¸Šæ¬¡åŒæ­¥æ—¶é—´
    SELECT last_sync_time INTO last_sync_time
    FROM edge_sync_status
    WHERE node_id = current_setting('app.edge_node_id');

    -- æ‰¹é‡åŒæ­¥å˜æ›´æ•°æ®
    INSERT INTO edge_data
    SELECT * FROM cloud_data
    WHERE updated_at > last_sync_time
    ORDER BY updated_at
    LIMIT batch_size;

    -- æ›´æ–°åŒæ­¥æ—¶é—´
    UPDATE edge_sync_status
    SET last_sync_time = NOW()
    WHERE node_id = current_setting('app.edge_node_id');
END;
$$ LANGUAGE plpgsql;

-- å®šæ—¶æ‰¹é‡åŒæ­¥
SELECT cron.schedule(
    'sync-edge-data',
    '*/5 * * * *',  -- æ¯5åˆ†é’ŸåŒæ­¥ä¸€æ¬¡
    $$SELECT sync_edge_data_batch()$$
);
```

---

## 5. æœ€ä½³å®è·µ

### 5.1 éƒ¨ç½²å»ºè®®

**èµ„æºè§„åˆ’**:

| è¾¹ç¼˜èŠ‚ç‚¹ç±»å‹ | CPU | å†…å­˜ | å­˜å‚¨ | é€‚ç”¨åœºæ™¯ |
|------------|-----|------|------|---------|
| è½»é‡çº§ | 1æ ¸ | 512MB | 10GB | å°å‹ IoT è®¾å¤‡ |
| æ ‡å‡†å‹ | 2æ ¸ | 2GB | 50GB | ä¸­å‹è¾¹ç¼˜è®¡ç®— |
| é«˜æ€§èƒ½ | 4æ ¸ | 8GB | 200GB | å¤§å‹è¾¹ç¼˜è®¡ç®— |

**æ•°æ®é€‰æ‹©ç­–ç•¥**:

```sql
-- åªåŒæ­¥å¿…è¦çš„æ•°æ®åˆ°è¾¹ç¼˜èŠ‚ç‚¹
CREATE PUBLICATION edge_publication FOR TABLE edge_data
WHERE region = current_setting('app.edge_region');

-- è¾¹ç¼˜èŠ‚ç‚¹åªè®¢é˜…æœ¬åœ°æ•°æ®
CREATE SUBSCRIPTION edge_subscription
CONNECTION 'host=cloud-primary port=5432 user=replicator'
PUBLICATION edge_publication
WITH (
    copy_data = true,
    create_slot = true
);
```

### 5.2 å®é™…åº”ç”¨æ¡ˆä¾‹

**æ¡ˆä¾‹: æŸ IoT å¹³å°è¾¹ç¼˜è®¡ç®—éƒ¨ç½²**

**ä¸šåŠ¡åœºæ™¯**:


- è¾¹ç¼˜èŠ‚ç‚¹æ•°é‡: 100+
- è®¾å¤‡æ•°é‡: 10 ä¸‡+
- æ•°æ®åŒæ­¥é¢‘ç‡: æ¯ 5 åˆ†é’Ÿ


**å®æ–½æ•ˆæœ**:

- å“åº”å»¶è¿Ÿ: ä» 200ms é™ä½åˆ° 20msï¼ˆ**é™ä½ 90%**ï¼‰
- å¸¦å®½ä½¿ç”¨: å‡å°‘ **70%**ï¼ˆæœ¬åœ°å¤„ç†ï¼‰
- ç¦»çº¿å¯ç”¨æ€§: æå‡åˆ° **95%**ï¼ˆæ”¯æŒç¦»çº¿æ“ä½œï¼‰
- å¸¦å®½æˆæœ¬: é™ä½ **60%**

---

## 6. å‚è€ƒèµ„æ–™

- [è¾¹ç¼˜è®¡ç®—éƒ¨ç½²æŒ‡å—](https://www.postgresql.org/docs/current/edge-computing.html)
- [é€»è¾‘å¤åˆ¶é…ç½®](https://www.postgresql.org/docs/current/logical-replication.html)

---

**æœ€åæ›´æ–°**: 2025 å¹´ 11 æœˆ 1 æ—¥
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
