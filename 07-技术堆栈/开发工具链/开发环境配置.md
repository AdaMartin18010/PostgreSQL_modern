# PostgreSQL å‘é‡æœç´¢å¼€å‘ç¯å¢ƒé…ç½®

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 11 æœˆ 1 æ—¥
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 14+, pgvector 0.7.0+
> **æ–‡æ¡£ç¼–å·**: 07-01-03

## ğŸ“‘ ç›®å½•

- [PostgreSQL å‘é‡æœç´¢å¼€å‘ç¯å¢ƒé…ç½®](#postgresql-å‘é‡æœç´¢å¼€å‘ç¯å¢ƒé…ç½®)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 ç¯å¢ƒè¦æ±‚](#11-ç¯å¢ƒè¦æ±‚)
    - [1.2 å¼€å‘å·¥å…·](#12-å¼€å‘å·¥å…·)
  - [2. æœ¬åœ°å¼€å‘ç¯å¢ƒ](#2-æœ¬åœ°å¼€å‘ç¯å¢ƒ)
    - [2.1 PostgreSQL å®‰è£…](#21-postgresql-å®‰è£…)
    - [2.2 æ•°æ®åº“é…ç½®](#22-æ•°æ®åº“é…ç½®)
    - [2.3 Python ç¯å¢ƒé…ç½®](#23-python-ç¯å¢ƒé…ç½®)
    - [2.4 Node.js ç¯å¢ƒé…ç½®](#24-nodejs-ç¯å¢ƒé…ç½®)
  - [3. Docker å¼€å‘ç¯å¢ƒ](#3-docker-å¼€å‘ç¯å¢ƒ)
    - [3.1 Docker Compose é…ç½®](#31-docker-compose-é…ç½®)
    - [3.2 å¯åŠ¨æœåŠ¡](#32-å¯åŠ¨æœåŠ¡)
  - [4. IDE é…ç½®](#4-ide-é…ç½®)
    - [4.1 VS Code é…ç½®](#41-vs-code-é…ç½®)
    - [4.2 PyCharm é…ç½®](#42-pycharm-é…ç½®)
  - [5. æµ‹è¯•ç¯å¢ƒé…ç½®](#5-æµ‹è¯•ç¯å¢ƒé…ç½®)
    - [5.1 å•å…ƒæµ‹è¯•é…ç½®](#51-å•å…ƒæµ‹è¯•é…ç½®)
    - [5.2 é›†æˆæµ‹è¯•é…ç½®](#52-é›†æˆæµ‹è¯•é…ç½®)
  - [6. å‚è€ƒèµ„æ–™](#6-å‚è€ƒèµ„æ–™)

---

## 1. æ¦‚è¿°

### 1.1 ç¯å¢ƒè¦æ±‚

- **PostgreSQL**: 14+ ç‰ˆæœ¬
- **pgvector**: 0.7.0+ ç‰ˆæœ¬
- **Python**: 3.8+ æˆ– Node.js 18+
- **Docker**: å¯é€‰ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²

### 1.2 å¼€å‘å·¥å…·

- **æ•°æ®åº“å®¢æˆ·ç«¯**: pgAdminã€DBeaverã€psql
- **IDE**: VS Codeã€PyCharmã€IntelliJ IDEA
- **ç‰ˆæœ¬æ§åˆ¶**: Git

## 2. æœ¬åœ°å¼€å‘ç¯å¢ƒ

### 2.1 PostgreSQL å®‰è£…

**Ubuntu/Debian**:

```bash
# å®‰è£… PostgreSQL
sudo apt-get update
sudo apt-get install postgresql-14 postgresql-contrib-14

# å®‰è£… pgvector
sudo apt-get install postgresql-14-pgvector

# å¯åŠ¨æœåŠ¡
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

**macOS**:

```bash
# ä½¿ç”¨ Homebrew
brew install postgresql@14
brew install pgvector

# å¯åŠ¨æœåŠ¡
brew services start postgresql@14
```

**Windows**:

```powershell
# ä¸‹è½½ PostgreSQL å®‰è£…åŒ…
# https://www.postgresql.org/download/windows/

# å®‰è£… pgvector
# ä¸‹è½½é¢„ç¼–è¯‘ç‰ˆæœ¬æˆ–ä»æºç ç¼–è¯‘
```

### 2.2 æ•°æ®åº“é…ç½®

```bash
# åˆ›å»ºæ•°æ®åº“
createdb vectordb

# è¿æ¥åˆ°æ•°æ®åº“
psql vectordb

# å¯ç”¨ pgvector æ‰©å±•
CREATE EXTENSION IF NOT EXISTS vector;
```

### 2.3 Python ç¯å¢ƒé…ç½®

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/macOS
# æˆ–
venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install psycopg2-binary asyncpg numpy openai
```

### 2.4 Node.js ç¯å¢ƒé…ç½®

```bash
# åˆå§‹åŒ–é¡¹ç›®
npm init -y

# å®‰è£…ä¾èµ–
npm install pg pgvector dotenv
```

## 3. Docker å¼€å‘ç¯å¢ƒ

### 3.1 Docker Compose é…ç½®

```yaml
# docker-compose.yml
version: '3.8'

services:
  postgres:
    image: pgvector/pgvector:pg16
    environment:
      POSTGRES_DB: vectordb
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5

volumes:
  postgres_data:
```

### 3.2 å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f postgres

# åœæ­¢æœåŠ¡
docker-compose down
```

## 4. IDE é…ç½®

### 4.1 VS Code é…ç½®

**æ‰©å±•æ¨è**:

- PostgreSQL
- Python
- Docker

**settings.json**:

```json
{
  "python.defaultInterpreterPath": "./venv/bin/python",
  "python.linting.enabled": true,
  "python.formatting.provider": "black"
}
```

### 4.2 PyCharm é…ç½®

1. **é…ç½®æ•°æ®åº“è¿æ¥**:
   - Database â†’ Data Source â†’ PostgreSQL
   - Host: localhost
   - Port: 5432
   - Database: vectordb

2. **é…ç½® Python è§£é‡Šå™¨**:
   - Settings â†’ Project â†’ Python Interpreter
   - é€‰æ‹©è™šæ‹Ÿç¯å¢ƒ

## 5. æµ‹è¯•ç¯å¢ƒé…ç½®

### 5.1 å•å…ƒæµ‹è¯•é…ç½®

```python
# pytest.ini
[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# conftest.py
import pytest
import asyncpg

@pytest.fixture
async def db_pool():
    pool = await asyncpg.create_pool(
        'postgresql://postgres:password@localhost/vectordb_test'
    )
    yield pool
    await pool.close()
```

### 5.2 é›†æˆæµ‹è¯•é…ç½®

```python
# tests/integration/test_vector_search.py
import pytest

@pytest.mark.asyncio
async def test_vector_search(db_pool):
    async with db_pool.acquire() as conn:
        result = await conn.fetch("""
            SELECT id FROM vectors
            ORDER BY embedding <=> $1::vector
            LIMIT 10
        """, query_vector)

        assert len(result) == 10
```

## 6. å‚è€ƒèµ„æ–™

- [ç¯å¢ƒæ­å»ºæŒ‡å—](../../09-å®è·µæŒ‡å—/å¿«é€Ÿå¼€å§‹/ç¯å¢ƒæ­å»ºæŒ‡å—.md)
- [å¿«é€Ÿå¼€å§‹æŒ‡å—](../../01-å‘é‡ä¸æ··åˆæœç´¢/æœ€ä½³å®è·µ/å¿«é€Ÿå¼€å§‹æŒ‡å—.md)

---

**æœ€åæ›´æ–°**: 2025 å¹´ 11 æœˆ 1 æ—¥
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: 07-01-03
