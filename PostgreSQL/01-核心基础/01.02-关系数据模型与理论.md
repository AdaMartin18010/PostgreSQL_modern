# PostgreSQL å…³ç³»æ•°æ®æ¨¡å‹ä¸ç†è®º

> **æ–‡æ¡£ç‰ˆæœ¬**: v2.0
> **æœ€åæ›´æ–°**: 2025-11-12
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: âœ… å·²æ›´æ–°
> ğŸ†• **PostgreSQL 18æ”¹è¿›**: å…³ç³»æ¨¡å‹å®ç°æ›´å®Œå–„ï¼Œæ”¯æŒæ›´å¤æ‚çš„çº¦æŸã€ç»§æ‰¿å’Œåˆ†åŒºç­–ç•¥ã€è™šæ‹Ÿç”Ÿæˆåˆ—

---

## ğŸ“‹ ç›®å½•

- [PostgreSQL å…³ç³»æ•°æ®æ¨¡å‹ä¸ç†è®º](#postgresql-å…³ç³»æ•°æ®æ¨¡å‹ä¸ç†è®º)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. å®šä¹‰ä¸å½¢å¼åŒ–](#1-å®šä¹‰ä¸å½¢å¼åŒ–)
    - [1.1 æ¦‚å¿µå®šä¹‰](#11-æ¦‚å¿µå®šä¹‰)
    - [1.2 å½¢å¼åŒ–å®šä¹‰](#12-å½¢å¼åŒ–å®šä¹‰)
    - [1.3 æ ¸å¿ƒå±æ€§](#13-æ ¸å¿ƒå±æ€§)
  - [2. ç†è®ºåŸºç¡€](#2-ç†è®ºåŸºç¡€)
    - [2.1 å…³ç³»ä»£æ•°](#21-å…³ç³»ä»£æ•°)
    - [2.2 å‡½æ•°ä¾èµ–ç†è®º](#22-å‡½æ•°ä¾èµ–ç†è®º)
    - [2.3 èŒƒå¼ç†è®º](#23-èŒƒå¼ç†è®º)
  - [3. PostgreSQLå®ç°](#3-postgresqlå®ç°)
    - [3.1 æ•°æ®ç±»å‹ç³»ç»Ÿ](#31-æ•°æ®ç±»å‹ç³»ç»Ÿ)
    - [3.2 çº¦æŸç³»ç»Ÿ](#32-çº¦æŸç³»ç»Ÿ)
    - [3.3 å…³ç³»æ“ä½œå®ç°](#33-å…³ç³»æ“ä½œå®ç°)
  - [4. é«˜çº§ç‰¹æ€§](#4-é«˜çº§ç‰¹æ€§)
    - [4.1 è§†å›¾ç³»ç»Ÿ](#41-è§†å›¾ç³»ç»Ÿ)
    - [4.2 ç»§æ‰¿ç³»ç»Ÿ](#42-ç»§æ‰¿ç³»ç»Ÿ)
    - [4.3 åˆ†åŒºè¡¨](#43-åˆ†åŒºè¡¨)
  - [5. æ€§èƒ½ä¼˜åŒ–](#5-æ€§èƒ½ä¼˜åŒ–)
    - [5.1 ç´¢å¼•ä¼˜åŒ–](#51-ç´¢å¼•ä¼˜åŒ–)
    - [5.2 æŸ¥è¯¢ä¼˜åŒ–](#52-æŸ¥è¯¢ä¼˜åŒ–)
  - [6. å®é™…åº”ç”¨æ¡ˆä¾‹](#6-å®é™…åº”ç”¨æ¡ˆä¾‹)
    - [6.1 ç”µå•†ç³»ç»Ÿè®¾è®¡](#61-ç”µå•†ç³»ç»Ÿè®¾è®¡)
    - [6.2 é‡‘èç³»ç»Ÿè®¾è®¡](#62-é‡‘èç³»ç»Ÿè®¾è®¡)
  - [7. ç›¸å…³æ¦‚å¿µ](#7-ç›¸å…³æ¦‚å¿µ)
    - [7.1 ä¸Šä½æ¦‚å¿µ](#71-ä¸Šä½æ¦‚å¿µ)
    - [7.2 ä¸‹ä½æ¦‚å¿µ](#72-ä¸‹ä½æ¦‚å¿µ)
    - [7.3 å¹³è¡Œæ¦‚å¿µ](#73-å¹³è¡Œæ¦‚å¿µ)
  - [8. ç›¸å…³æ–‡æ¡£](#8-ç›¸å…³æ–‡æ¡£)
  - [9. å‚è€ƒæ–‡çŒ®](#9-å‚è€ƒæ–‡çŒ®)
  - [10. Wikidataå¯¹é½](#10-wikidataå¯¹é½)

---

## 1. å®šä¹‰ä¸å½¢å¼åŒ–

### 1.1 æ¦‚å¿µå®šä¹‰

**ä¸­æ–‡å®šä¹‰**: å…³ç³»æ•°æ®æ¨¡å‹æ˜¯åŸºäºæ•°å­¦é›†åˆè®ºçš„æ•°æ®æ¨¡å‹ï¼Œå°†æ•°æ®ç»„ç»‡ä¸ºäºŒç»´è¡¨æ ¼ï¼ˆå…³ç³»ï¼‰ï¼Œé€šè¿‡å…³ç³»ä»£æ•°å’Œå…³ç³»æ¼”ç®—è¿›è¡Œæ•°æ®æ“ä½œã€‚PostgreSQLå®Œå…¨å®ç°äº†å…³ç³»æ•°æ®æ¨¡å‹ï¼Œæ”¯æŒå®Œæ•´çš„SQLæ ‡å‡†ã€‚

**English Definition**: The relational data model is a data model based on mathematical set theory that organizes data as two-dimensional tables (relations), with data manipulation performed through relational algebra and relational calculus. PostgreSQL fully implements the relational data model and supports complete SQL standards.

### 1.2 å½¢å¼åŒ–å®šä¹‰

```latex
% æ•°å­¦ç¬¦å·å®šä¹‰
\newcommand{\rel}{\mathcal{R}}
\newcommand{\attr}{\mathcal{A}}
\newcommand{\tuple}{\mathcal{T}}
\newcommand{\domain}{\mathcal{D}}
\newcommand{\schema}{\mathcal{S}}

% å…³ç³»çš„å½¢å¼åŒ–å®šä¹‰
\rel = \{t_1, t_2, \ldots, t_n\}

å…¶ä¸­æ¯ä¸ªå…ƒç»„ t_i = (a_1, a_2, \ldots, a_m) \in \domain_1 \times \domain_2 \times \ldots \times \domain_m

% å…³ç³»æ¨¡å¼å®šä¹‰
\schema = (\rel, \attr, \domain)
```

### 1.3 æ ¸å¿ƒå±æ€§

- **åŸå­æ€§**: æ¯ä¸ªå±æ€§å€¼éƒ½æ˜¯åŸå­çš„ï¼Œä¸å¯å†åˆ†
- **å”¯ä¸€æ€§**: å…³ç³»ä¸­ä¸å­˜åœ¨é‡å¤çš„å…ƒç»„
- **æ— åºæ€§**: å…ƒç»„å’Œå±æ€§çš„é¡ºåºæ— å…³ç´§è¦
- **å®Œæ•´æ€§**: æ”¯æŒå®ä½“å®Œæ•´æ€§ã€å‚ç…§å®Œæ•´æ€§å’ŒåŸŸå®Œæ•´æ€§çº¦æŸ

## 2. ç†è®ºåŸºç¡€

### 2.1 å…³ç³»ä»£æ•°

```latex
\begin{theorem}[å…³ç³»ä»£æ•°å®Œå¤‡æ€§]
å…³ç³»ä»£æ•°åŒ…å«ä»¥ä¸‹åŸºæœ¬è¿ç®—ï¼š
1. é€‰æ‹©è¿ç®— \sigma_p(R) = \{t | t \in R \land p(t)\}
2. æŠ•å½±è¿ç®— \pi_A(R) = \{t[A] | t \in R\}
3. å¹¶è¿ç®— R \cup S = \{t | t \in R \lor t \in S\}
4. å·®è¿ç®— R - S = \{t | t \in R \land t \notin S\}
5. ç¬›å¡å°”ç§¯ R \times S = \{(r,s) | r \in R \land s \in S\}
6. è¿æ¥è¿ç®— R \bowtie_p S = \sigma_p(R \times S)
\end{theorem}
```

### 2.2 å‡½æ•°ä¾èµ–ç†è®º

```latex
\begin{theorem}[Armstrongå…¬ç†]
å‡½æ•°ä¾èµ–æ»¡è¶³ä»¥ä¸‹å…¬ç†ï¼š
1. è‡ªåæ€§ï¼šå¦‚æœ Y \subseteq Xï¼Œåˆ™ X \rightarrow Y
2. å¢å¹¿æ€§ï¼šå¦‚æœ X \rightarrow Yï¼Œåˆ™ XZ \rightarrow YZ
3. ä¼ é€’æ€§ï¼šå¦‚æœ X \rightarrow Y ä¸” Y \rightarrow Zï¼Œåˆ™ X \rightarrow Z
\end{theorem}

\begin{proof}
åŸºäºé›†åˆè®ºå’Œé€»è¾‘æ¨ç†ï¼Œå¯ä»¥è¯æ˜è¿™äº›å…¬ç†çš„æ­£ç¡®æ€§ã€‚
\end{proof}
```

### 2.3 èŒƒå¼ç†è®º

```latex
\begin{theorem}[èŒƒå¼å±‚æ¬¡]
å…³ç³»èŒƒå¼æ»¡è¶³ä»¥ä¸‹å±‚æ¬¡ç»“æ„ï¼š
1. 1NF: æ¯ä¸ªå±æ€§éƒ½æ˜¯åŸå­çš„
2. 2NF: æ»¡è¶³1NFä¸”æ¯ä¸ªéä¸»å±æ€§å®Œå…¨å‡½æ•°ä¾èµ–äºä¸»é”®
3. 3NF: æ»¡è¶³2NFä¸”æ¯ä¸ªéä¸»å±æ€§ä¸ä¼ é€’ä¾èµ–äºä¸»é”®
4. BCNF: æ»¡è¶³3NFä¸”æ¯ä¸ªå‡½æ•°ä¾èµ–çš„å†³å®šå› ç´ éƒ½æ˜¯è¶…é”®
\end{theorem}
```

## 3. PostgreSQLå®ç°

### 3.1 æ•°æ®ç±»å‹ç³»ç»Ÿ

```sql
-- åŸºæœ¬æ•°æ®ç±»å‹
CREATE TABLE example_table (
    id INTEGER PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    salary DECIMAL(10,2),
    hire_date DATE,
    active BOOLEAN DEFAULT TRUE,
    profile JSONB,
    tags TEXT[]
);

-- è‡ªå®šä¹‰æ•°æ®ç±»å‹
CREATE TYPE employee_status AS ENUM ('active', 'inactive', 'terminated');
CREATE TYPE address AS (
    street VARCHAR(100),
    city VARCHAR(50),
    postal_code VARCHAR(10)
);
```

### 3.2 çº¦æŸç³»ç»Ÿ

```sql
-- å®ä½“å®Œæ•´æ€§çº¦æŸ
CREATE TABLE employees (
    emp_id INTEGER PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE,
    dept_id INTEGER REFERENCES departments(dept_id),
    salary DECIMAL(10,2) CHECK (salary > 0),
    CONSTRAINT emp_salary_check CHECK (salary >= 0 AND salary <= 1000000)
);

-- å‚ç…§å®Œæ•´æ€§çº¦æŸ
CREATE TABLE departments (
    dept_id INTEGER PRIMARY KEY,
    dept_name VARCHAR(50) NOT NULL,
    manager_id INTEGER REFERENCES employees(emp_id)
);
```

### 3.3 å…³ç³»æ“ä½œå®ç°

```sql
-- é€‰æ‹©æ“ä½œ
SELECT * FROM employees WHERE salary > 50000;

-- æŠ•å½±æ“ä½œ
SELECT name, dept_id FROM employees;

-- è¿æ¥æ“ä½œ
SELECT e.name, d.dept_name
FROM employees e
JOIN departments d ON e.dept_id = d.dept_id;

-- å¹¶æ“ä½œ
SELECT name FROM employees_2023
UNION
SELECT name FROM employees_2024;

-- å·®æ“ä½œ
SELECT name FROM employees_2023
EXCEPT
SELECT name FROM employees_2024;
```

## 4. é«˜çº§ç‰¹æ€§

### 4.1 è§†å›¾ç³»ç»Ÿ

```sql
-- ç®€å•è§†å›¾
CREATE VIEW emp_summary AS
SELECT
    dept_id,
    COUNT(*) as emp_count,
    AVG(salary) as avg_salary,
    MAX(salary) as max_salary
FROM employees
GROUP BY dept_id;

-- å¯æ›´æ–°è§†å›¾
CREATE VIEW emp_public AS
SELECT emp_id, name, dept_id
FROM employees
WHERE active = true;

-- ç‰©åŒ–è§†å›¾
CREATE MATERIALIZED VIEW emp_stats AS
SELECT
    dept_id,
    COUNT(*) as emp_count,
    AVG(salary) as avg_salary
FROM employees
GROUP BY dept_id;
```

### 4.2 ç»§æ‰¿ç³»ç»Ÿ

```sql
-- è¡¨ç»§æ‰¿
CREATE TABLE person (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50),
    birth_date DATE
);

CREATE TABLE employee (
    salary DECIMAL(10,2),
    hire_date DATE
) INHERITS (person);

CREATE TABLE customer (
    credit_limit DECIMAL(10,2),
    registration_date DATE
) INHERITS (person);
```

### 4.3 åˆ†åŒºè¡¨

```sql
-- èŒƒå›´åˆ†åŒº
CREATE TABLE sales (
    id SERIAL,
    sale_date DATE,
    amount DECIMAL(10,2)
) PARTITION BY RANGE (sale_date);

CREATE TABLE sales_2023 PARTITION OF sales
FOR VALUES FROM ('2023-01-01') TO ('2024-01-01');

CREATE TABLE sales_2024 PARTITION OF sales
FOR VALUES FROM ('2024-01-01') TO ('2025-01-01');

-- åˆ—è¡¨åˆ†åŒº
CREATE TABLE products (
    id SERIAL,
    category VARCHAR(50),
    name VARCHAR(100)
) PARTITION BY LIST (category);

CREATE TABLE electronics PARTITION OF products
FOR VALUES IN ('laptop', 'phone', 'tablet');
```

## 5. æ€§èƒ½ä¼˜åŒ–

### 5.1 ç´¢å¼•ä¼˜åŒ–

```sql
-- B+æ ‘ç´¢å¼•
CREATE INDEX idx_emp_salary ON employees (salary);

-- å¤åˆç´¢å¼•
CREATE INDEX idx_emp_dept_salary ON employees (dept_id, salary);

-- éƒ¨åˆ†ç´¢å¼•
CREATE INDEX idx_high_salary ON employees (salary) WHERE salary > 100000;

-- è¡¨è¾¾å¼ç´¢å¼•
CREATE INDEX idx_name_lower ON employees (LOWER(name));
```

### 5.2 æŸ¥è¯¢ä¼˜åŒ–

```sql
-- ä½¿ç”¨EXPLAINåˆ†ææŸ¥è¯¢è®¡åˆ’
EXPLAIN (ANALYZE, BUFFERS)
SELECT e.name, d.dept_name
FROM employees e
JOIN departments d ON e.dept_id = d.dept_id
WHERE e.salary > 50000;

-- ç»Ÿè®¡ä¿¡æ¯æ›´æ–°
ANALYZE employees;

-- æŸ¥è¯¢é‡å†™
SELECT name, salary
FROM employees
WHERE dept_id IN (
    SELECT dept_id FROM departments WHERE budget > 1000000
);
```

## 6. å®é™…åº”ç”¨æ¡ˆä¾‹

### 6.1 ç”µå•†ç³»ç»Ÿè®¾è®¡

```sql
-- å•†å“è¡¨
CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    price DECIMAL(10,2) NOT NULL,
    category_id INTEGER REFERENCES categories(category_id),
    stock_quantity INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW()
);

-- è®¢å•è¡¨
CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    customer_id INTEGER REFERENCES customers(customer_id),
    order_date TIMESTAMP DEFAULT NOW(),
    total_amount DECIMAL(10,2),
    status VARCHAR(20) DEFAULT 'pending'
);

-- è®¢å•è¯¦æƒ…è¡¨
CREATE TABLE order_items (
    order_id INTEGER REFERENCES orders(order_id),
    product_id INTEGER REFERENCES products(product_id),
    quantity INTEGER NOT NULL,
    unit_price DECIMAL(10,2) NOT NULL,
    PRIMARY KEY (order_id, product_id)
);
```

### 6.2 é‡‘èç³»ç»Ÿè®¾è®¡

```sql
-- è´¦æˆ·è¡¨
CREATE TABLE accounts (
    account_id SERIAL PRIMARY KEY,
    customer_id INTEGER REFERENCES customers(customer_id),
    account_type VARCHAR(20) NOT NULL,
    balance DECIMAL(15,2) DEFAULT 0,
    currency VARCHAR(3) DEFAULT 'USD',
    created_at TIMESTAMP DEFAULT NOW()
);

-- äº¤æ˜“è¡¨
CREATE TABLE transactions (
    transaction_id SERIAL PRIMARY KEY,
    from_account_id INTEGER REFERENCES accounts(account_id),
    to_account_id INTEGER REFERENCES accounts(account_id),
    amount DECIMAL(15,2) NOT NULL,
    transaction_type VARCHAR(20) NOT NULL,
    transaction_date TIMESTAMP DEFAULT NOW(),
    status VARCHAR(20) DEFAULT 'pending'
);
```

## 7. ç›¸å…³æ¦‚å¿µ

### 7.1 ä¸Šä½æ¦‚å¿µ

- **æ•°æ®æ¨¡å‹**: æ›´å¹¿æ³›çš„æ•°æ®ç»„ç»‡æ–¹å¼
- **æ•°æ®åº“ç†è®º**: æ•°æ®åº“ç³»ç»Ÿçš„ç†è®ºåŸºç¡€
- **é›†åˆè®º**: æ•°å­¦åŸºç¡€ç†è®º

### 7.2 ä¸‹ä½æ¦‚å¿µ

- **å…³ç³»**: äºŒç»´è¡¨æ ¼ç»“æ„
- **å…ƒç»„**: è¡¨ä¸­çš„è¡Œ
- **å±æ€§**: è¡¨ä¸­çš„åˆ—
- **åŸŸ**: å±æ€§çš„å–å€¼èŒƒå›´

### 7.3 å¹³è¡Œæ¦‚å¿µ

- **å±‚æ¬¡æ•°æ®æ¨¡å‹**: æ ‘å½¢ç»“æ„æ•°æ®æ¨¡å‹
- **ç½‘çŠ¶æ•°æ®æ¨¡å‹**: å›¾ç»“æ„æ•°æ®æ¨¡å‹
- **å¯¹è±¡æ•°æ®æ¨¡å‹**: é¢å‘å¯¹è±¡æ•°æ®æ¨¡å‹

## 8. ç›¸å…³æ–‡æ¡£

- [å­˜å‚¨ç®¡ç†ä¸æ•°æ®æŒä¹…åŒ–](./01.06-å­˜å‚¨ç®¡ç†ä¸æ•°æ®æŒä¹…åŒ–.md) - å…³ç³»æ¨¡å‹çš„ç‰©ç†å®ç°ï¼ˆè¡Œå­˜å‚¨ã€åˆ—å­˜å‚¨ï¼‰ğŸ†•
- [SQLè¯­è¨€è§„èŒƒä¸æ ‡å‡†](./01.03-SQLè¯­è¨€è§„èŒƒä¸æ ‡å‡†.md) - å…³ç³»æ¨¡å‹çš„æ“ä½œè¯­è¨€
- [ç³»ç»Ÿæ¶æ„ä¸è®¾è®¡åŸç†](./01.01-ç³»ç»Ÿæ¶æ„ä¸è®¾è®¡åŸç†.md) - å…³ç³»æ¨¡å‹åœ¨PostgreSQLä¸­çš„å®ç°
- [æ•°æ®å»ºæ¨¡å®Œæ•´æŒ‡å—](../09-åº”ç”¨è®¾è®¡/æ•°æ®æ¨¡å‹è®¾è®¡/09.02-æ•°æ®å»ºæ¨¡å®Œæ•´æŒ‡å—.md) - å…³ç³»æ¨¡å‹çš„å®é™…åº”ç”¨

## 9. å‚è€ƒæ–‡çŒ®

1. Codd, E. F. (1970). A relational model of data for large shared data banks. Communications of the ACM, 13(6), 377-387.
2. Date, C. J. (2003). An Introduction to Database Systems (8th ed.). Addison-Wesley.
3. PostgreSQL Global Development Group. (2025). PostgreSQL 18 Documentation. <https://www.postgresql.org/docs/18/>
4. Silberschatz, A., Galvin, P. B., & Gagne, G. (2018). Operating System Concepts (10th ed.). John Wiley & Sons.
5. PostgreSQL Global Development Group. (2024). PostgreSQL 17 Documentation. <https://www.postgresql.org/docs/17/>

## 10. Wikidataå¯¹é½

- **Wikidata ID**: Q192490
- **ç›¸å…³å±æ€§**:
  - P31: Q176165 (instance of: database management system)
  - P178: Q9366 (developer: PostgreSQL Global Development Group)
  - P277: Q193321 (programmed in: C)
  - P348: 18.0 (software version)
- **å¤–éƒ¨é“¾æ¥**:
  - <https://www.postgresql.org/docs/current/ddl.html>
  - <https://www.postgresql.org/docs/current/dml.html>
