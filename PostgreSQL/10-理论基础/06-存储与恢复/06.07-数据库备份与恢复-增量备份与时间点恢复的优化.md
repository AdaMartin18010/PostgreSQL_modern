# æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤-å¢é‡å¤‡ä»½ä¸æ—¶é—´ç‚¹æ¢å¤çš„ä¼˜åŒ–

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: ğŸŸ¡ æ¡†æ¶å·²åˆ›å»ºï¼Œå†…å®¹å¾…å®Œå–„

---

## ğŸ“‹ ç›®å½•

- [æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤-å¢é‡å¤‡ä»½ä¸æ—¶é—´ç‚¹æ¢å¤çš„ä¼˜åŒ–](#æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤-å¢é‡å¤‡ä»½ä¸æ—¶é—´ç‚¹æ¢å¤çš„ä¼˜åŒ–)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤å·¥ä½œåŸç†æ¦‚è¿°](#10-æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤å·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 å¤‡ä»½ç±»å‹](#21-å¤‡ä»½ç±»å‹)
    - [2.2 æ—¶é—´ç‚¹æ¢å¤](#22-æ—¶é—´ç‚¹æ¢å¤)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 å¤‡ä»½å½¢å¼åŒ–](#31-å¤‡ä»½å½¢å¼åŒ–)
  - [4. å®é™…åº”ç”¨](#4-å®é™…åº”ç”¨)
    - [4.1 PostgreSQLå¤‡ä»½](#41-postgresqlå¤‡ä»½)
  - [5. ç›¸å…³æ–‡æ¡£](#5-ç›¸å…³æ–‡æ¡£)
    - [5.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#51-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [6. å‚è€ƒæ–‡çŒ®](#6-å‚è€ƒæ–‡çŒ®)

---

## 1. æ¦‚è¿°

### 1.0 æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤å·¥ä½œåŸç†æ¦‚è¿°

**å¤‡ä»½ç­–ç•¥**ï¼š

æ•°æ®åº“å¤‡ä»½ä½¿ç”¨å…¨é‡å¤‡ä»½å’Œå¢é‡å¤‡ä»½çš„ç»„åˆï¼Œæ”¯æŒæ—¶é—´ç‚¹æ¢å¤ï¼ˆPITRï¼‰æ¥æœ€å°åŒ–æ•°æ®ä¸¢å¤±ã€‚

**å¤‡ä»½ç­–ç•¥æ€ç»´å¯¼å›¾**ï¼š

```mermaid
mindmap
  root((å¤‡ä»½ç­–ç•¥))
    å¤‡ä»½ç±»å‹
      å…¨é‡å¤‡ä»½
      å¢é‡å¤‡ä»½
      å·®å¼‚å¤‡ä»½
    æ¢å¤ç­–ç•¥
      æ—¶é—´ç‚¹æ¢å¤
      å®Œæ•´æ¢å¤
      éƒ¨åˆ†æ¢å¤
    ä¼˜åŒ–
      å‹ç¼©å¤‡ä»½
      å¹¶è¡Œå¤‡ä»½
      å¢é‡å¤‡ä»½
```

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **å¤‡ä»½ç­–ç•¥**ï¼šå…¨é‡ã€å¢é‡ã€å·®å¼‚å¤‡ä»½
- **æ—¶é—´ç‚¹æ¢å¤**ï¼šPITRçš„å®ç°å’Œä¼˜åŒ–
- **å®é™…åº”ç”¨**ï¼šPostgreSQLå¤‡ä»½æ¢å¤å®ç°

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 å¤‡ä»½ç±»å‹

**å¤‡ä»½ç±»å‹å¯¹æ¯”**ï¼š

| ç±»å‹ | å†…å®¹ | å¤§å° | æ¢å¤æ—¶é—´ | é€‚ç”¨åœºæ™¯ |
|------|------|------|---------|---------|
| **å…¨é‡å¤‡ä»½** | å®Œæ•´æ•°æ® | å¤§ | å¿« | å®šæœŸå¤‡ä»½ |
| **å¢é‡å¤‡ä»½** | å˜æ›´æ•°æ® | å° | æ…¢ | é¢‘ç¹å¤‡ä»½ |
| **å·®å¼‚å¤‡ä»½** | ä¸Šæ¬¡å…¨é‡åçš„å˜æ›´ | ä¸­ | ä¸­ | å¹³è¡¡åœºæ™¯ |

### 2.2 æ—¶é—´ç‚¹æ¢å¤

**PITRæµç¨‹**ï¼š

```mermaid
flowchart TD
    A[æ•…éšœå‘ç”Ÿ] --> B[æ‰¾åˆ°æœ€è¿‘å…¨é‡å¤‡ä»½]
    B --> C[åº”ç”¨å¢é‡å¤‡ä»½]
    C --> D[åº”ç”¨WALæ—¥å¿—]
    D --> E[æ¢å¤åˆ°ç›®æ ‡æ—¶é—´ç‚¹]

    style A fill:#FFD700
    style E fill:#90EE90
```

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 å¤‡ä»½å½¢å¼åŒ–

**å¤‡ä»½**ï¼š

```haskell
-- å¤‡ä»½å½¢å¼åŒ–
Backup = (type, timestamp, data, wal)
where
    type = Full | Incremental | Differential
```

---

## 4. å®é™…åº”ç”¨

### 4.1 PostgreSQLå¤‡ä»½

**pg_basebackup**ï¼š

```bash
# å…¨é‡å¤‡ä»½
pg_basebackup -D /backup/base -Ft -z -P

# å¢é‡å¤‡ä»½ï¼ˆä½¿ç”¨WALå½’æ¡£ï¼‰
# é…ç½®WALå½’æ¡£
archive_mode = on
archive_command = 'cp %p /backup/wal/%f'
```

**æ—¶é—´ç‚¹æ¢å¤**ï¼š

```bash
# æ¢å¤é…ç½®
restore_command = 'cp /backup/wal/%f %p'
recovery_target_time = '2025-01-16 12:00:00'
```

---

## 5. ç›¸å…³æ–‡æ¡£

### 5.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [å½¢å¼è¯­è¨€ä¸è¯æ˜ï¼šæ€»è®º](./1.1.25-å½¢å¼è¯­è¨€ä¸è¯æ˜-æ€»è®º.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](./README.md)

---

## 6. å‚è€ƒæ–‡çŒ®

[å¾…è¡¥å……]

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: ğŸŸ¡ æ¡†æ¶å·²åˆ›å»ºï¼Œå†…å®¹å¾…å®Œå–„
