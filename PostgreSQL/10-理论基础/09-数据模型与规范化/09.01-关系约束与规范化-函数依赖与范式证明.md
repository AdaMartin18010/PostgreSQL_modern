# å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–-å‡½æ•°ä¾èµ–ä¸èŒƒå¼è¯æ˜

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: âœ… å†…å®¹å·²å®Œæˆ

---

## ğŸ“‹ ç›®å½•

- [å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–-å‡½æ•°ä¾èµ–ä¸èŒƒå¼è¯æ˜](#å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–-å‡½æ•°ä¾èµ–ä¸èŒƒå¼è¯æ˜)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–å·¥ä½œåŸç†æ¦‚è¿°](#10-å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–å·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 å‡½æ•°ä¾èµ–å®šä¹‰](#21-å‡½æ•°ä¾èµ–å®šä¹‰)
    - [2.2 Armstrongå…¬ç†](#22-armstrongå…¬ç†)
    - [2.3 èŒƒå¼å±‚æ¬¡](#23-èŒƒå¼å±‚æ¬¡)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 å‡½æ•°ä¾èµ–å½¢å¼åŒ–](#31-å‡½æ•°ä¾èµ–å½¢å¼åŒ–)
    - [3.2 é—­åŒ…å½¢å¼åŒ–](#32-é—­åŒ…å½¢å¼åŒ–)
    - [3.3 èŒƒå¼å½¢å¼åŒ–](#33-èŒƒå¼å½¢å¼åŒ–)
  - [4. å®šç†ä¸è¯æ˜](#4-å®šç†ä¸è¯æ˜)
    - [4.1 Armstrongå…¬ç†å®Œå¤‡æ€§å®šç†](#41-armstrongå…¬ç†å®Œå¤‡æ€§å®šç†)
    - [4.2 èŒƒå¼åŒ…å«å…³ç³»å®šç†](#42-èŒƒå¼åŒ…å«å…³ç³»å®šç†)
  - [5. å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 PostgreSQL 18å‡½æ•°ä¾èµ–ä¸è§„èŒƒåŒ–å®ç°](#51-postgresql-18å‡½æ•°ä¾èµ–ä¸è§„èŒƒåŒ–å®ç°)
      - [5.1.1 å‡½æ•°ä¾èµ–æ£€æµ‹](#511-å‡½æ•°ä¾èµ–æ£€æµ‹)
    - [5.2 å®é™…åº”ç”¨åœºæ™¯](#52-å®é™…åº”ç”¨åœºæ™¯)
      - [åœºæ™¯1ï¼šå­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿçš„è§„èŒƒåŒ–è®¾è®¡](#åœºæ™¯1å­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿçš„è§„èŒƒåŒ–è®¾è®¡)
      - [åœºæ™¯2ï¼šè®¢å•ç³»ç»Ÿçš„èŒƒå¼åˆ†è§£](#åœºæ™¯2è®¢å•ç³»ç»Ÿçš„èŒƒå¼åˆ†è§£)
  - [6. ç›¸å…³æ–‡æ¡£](#6-ç›¸å…³æ–‡æ¡£)
    - [6.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#61-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [7. å‚è€ƒæ–‡çŒ®](#7-å‚è€ƒæ–‡çŒ®)
    - [7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®](#71-æ ¸å¿ƒç†è®ºæ–‡çŒ®)
    - [7.2 è§„èŒƒåŒ–ç›¸å…³](#72-è§„èŒƒåŒ–ç›¸å…³)
    - [7.3 ç›¸å…³æ–‡æ¡£](#73-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

### 1.0 å…³ç³»çº¦æŸä¸è§„èŒƒåŒ–å·¥ä½œåŸç†æ¦‚è¿°

**å‡½æ•°ä¾èµ–ç†è®º**ï¼š

å‡½æ•°ä¾èµ–æ˜¯å…³ç³»æ•°æ®åº“è§„èŒƒåŒ–çš„åŸºç¡€ï¼Œç”¨äºæè¿°å±æ€§ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚æœ¬æ–‡æ¡£æä¾›å‡½æ•°ä¾èµ–çš„å½¢å¼åŒ–å®šä¹‰å’ŒèŒƒå¼è¯æ˜ã€‚

**å‡½æ•°ä¾èµ–æ€ç»´å¯¼å›¾**ï¼š

```mermaid
mindmap
  root((å‡½æ•°ä¾èµ–))
    åŸºæœ¬æ¦‚å¿µ
      å‡½æ•°ä¾èµ–å®šä¹‰
      å¹³å‡¡ä¾èµ–
      éå¹³å‡¡ä¾èµ–
      å®Œå…¨ä¾èµ–
      éƒ¨åˆ†ä¾èµ–
      ä¼ é€’ä¾èµ–
    é—­åŒ…è¿ç®—
      Armstrongå…¬ç†
      è‡ªåå¾‹
      å¢å¹¿å¾‹
      ä¼ é€’å¾‹
      é—­åŒ…è®¡ç®—
      å±æ€§é—­åŒ…
    èŒƒå¼å±‚æ¬¡
      1NF
      2NF
      3NF
      BCNF
      4NF
      5NF
```

**å‡½æ•°ä¾èµ–ç±»å‹å¯¹æ¯”çŸ©é˜µ**ï¼š

| ä¾èµ–ç±»å‹ | å®šä¹‰ | ç¤ºä¾‹ | é—®é¢˜ |
|---------|------|------|------|
| **å®Œå…¨ä¾èµ–** | Yå®Œå…¨ä¾èµ–äºX | {å­¦å·,è¯¾ç¨‹}â†’æˆç»© | æ—  |
| **éƒ¨åˆ†ä¾èµ–** | Yéƒ¨åˆ†ä¾èµ–äºX | {å­¦å·,è¯¾ç¨‹}â†’å§“å | å†—ä½™ |
| **ä¼ é€’ä¾èµ–** | Xâ†’Y, Yâ†’Z, Xâ†’Z | å­¦å·â†’ç³»å·â†’ç³»å | å†—ä½™ |
| **å¤šå€¼ä¾èµ–** | Xâ†’â†’Y | è¯¾ç¨‹â†’â†’æ•™å¸ˆ | å†—ä½™ |

**èŒƒå¼åˆ¤å®šå†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[å…³ç³»R] --> B{æ˜¯å¦1NF?}
    B -->|å¦| C[è½¬æ¢ä¸º1NF]
    B -->|æ˜¯| D{æ˜¯å¦2NF?}
    C --> D
    D -->|å¦| E[æ¶ˆé™¤éƒ¨åˆ†ä¾èµ–]
    D -->|æ˜¯| F{æ˜¯å¦3NF?}
    E --> F
    F -->|å¦| G[æ¶ˆé™¤ä¼ é€’ä¾èµ–]
    F -->|æ˜¯| H{æ˜¯å¦BCNF?}
    G --> H
    H -->|å¦| I[æ¶ˆé™¤ä¸»å±æ€§ä¾èµ–]
    H -->|æ˜¯| J[BCNFå®Œæˆ]
    I --> J

    style A fill:#FFD700
    style J fill:#90EE90
    style C fill:#FF6B6B
    style E fill:#FF6B6B
    style G fill:#FF6B6B
    style I fill:#FF6B6B
```

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **å‡½æ•°ä¾èµ–**ï¼šå‡½æ•°ä¾èµ–çš„å½¢å¼åŒ–å®šä¹‰å’Œæ€§è´¨
- **Armstrongå…¬ç†**ï¼šå‡½æ•°ä¾èµ–æ¨ç†çš„å…¬ç†ç³»ç»Ÿ
- **èŒƒå¼ç†è®º**ï¼š1NFåˆ°BCNFçš„èŒƒå¼å®šä¹‰å’Œè¯æ˜
- **å®é™…åº”ç”¨**ï¼šå‡½æ•°ä¾èµ–åœ¨æ•°æ®åº“è®¾è®¡ä¸­çš„åº”ç”¨

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 å‡½æ•°ä¾èµ–å®šä¹‰

**å‡½æ•°ä¾èµ–å½¢å¼åŒ–**ï¼š

```haskell
-- å‡½æ•°ä¾èµ–
type FunctionalDependency = (AttributeSet, AttributeSet)

-- å‡½æ•°ä¾èµ–æ»¡è¶³
satisfies :: Relation -> FunctionalDependency -> Bool
satisfies R (X, Y) =
    forall t1, t2 in R:
      if t1[X] = t2[X] then t1[Y] = t2[Y]
```

**å‡½æ•°ä¾èµ–ç±»å‹**ï¼š

```mermaid
graph LR
    A[å‡½æ•°ä¾èµ–] --> B[å¹³å‡¡ä¾èµ–]
    A --> C[éå¹³å‡¡ä¾èµ–]
    A --> D[å®Œå…¨ä¾èµ–]
    A --> E[éƒ¨åˆ†ä¾èµ–]
    A --> F[ä¼ é€’ä¾èµ–]

    B --> G[Xâ†’Y, YâŠ†X]
    C --> H[Xâ†’Y, YâŠˆX]
    D --> I[Yå®Œå…¨ä¾èµ–äºX]
    E --> J[Yéƒ¨åˆ†ä¾èµ–äºX]
    F --> K[Xâ†’Yâ†’Z, Xâ†’Z]

    style A fill:#FFD700
    style G fill:#90EE90
    style H fill:#FF6B6B
```

### 2.2 Armstrongå…¬ç†

**Armstrongå…¬ç†ç³»ç»Ÿ**ï¼š

```haskell
-- Armstrongå…¬ç†
data ArmstrongAxiom =
    Reflexivity AttributeSet AttributeSet      -- è‡ªåå¾‹
  | Augmentation FunctionalDependency AttributeSet  -- å¢å¹¿å¾‹
  | Transitivity FunctionalDependency FunctionalDependency  -- ä¼ é€’å¾‹

-- è‡ªåå¾‹: å¦‚æœY âŠ† Xï¼Œåˆ™X â†’ Y
reflexivity :: AttributeSet -> AttributeSet -> FunctionalDependency
reflexivity X Y = (X, Y) where Y âŠ† X

-- å¢å¹¿å¾‹: å¦‚æœX â†’ Yï¼Œåˆ™XZ â†’ YZ
augmentation :: FunctionalDependency -> AttributeSet -> FunctionalDependency
augmentation (X, Y) Z = (X âˆª Z, Y âˆª Z)

-- ä¼ é€’å¾‹: å¦‚æœX â†’ Yä¸”Y â†’ Zï¼Œåˆ™X â†’ Z
transitivity :: FunctionalDependency -> FunctionalDependency -> FunctionalDependency
transitivity (X, Y) (Y', Z) = (X, Z) where Y = Y'
```

**å…¬ç†æ¨å¯¼è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[FDé›†åˆF] --> B[åº”ç”¨è‡ªåå¾‹]
    A --> C[åº”ç”¨å¢å¹¿å¾‹]
    A --> D[åº”ç”¨ä¼ é€’å¾‹]
    B --> E[ç”Ÿæˆæ–°FD]
    C --> E
    D --> E
    E --> F{æ˜¯å¦è¿˜æœ‰æ–°FD?}
    F -->|æ˜¯| B
    F -->|å¦| G[é—­åŒ…F+]

    style A fill:#FFD700
    style G fill:#90EE90
```

### 2.3 èŒƒå¼å±‚æ¬¡

**èŒƒå¼å±‚æ¬¡å›¾**ï¼š

```mermaid
graph TD
    A[æœªè§„èŒƒåŒ–] --> B[1NF]
    B --> C[2NF]
    C --> D[3NF]
    D --> E[BCNF]
    E --> F[4NF]
    F --> G[5NF]

    B --> B1[åŸå­æ€§]
    C --> C1[æ¶ˆé™¤éƒ¨åˆ†ä¾èµ–]
    D --> D1[æ¶ˆé™¤ä¼ é€’ä¾èµ–]
    E --> E1[æ¶ˆé™¤ä¸»å±æ€§ä¾èµ–]
    F --> F1[æ¶ˆé™¤å¤šå€¼ä¾èµ–]
    G --> G1[æ¶ˆé™¤è¿æ¥ä¾èµ–]

    style A fill:#FF6B6B
    style B fill:#FFD700
    style C fill:#FFD700
    style D fill:#90EE90
    style E fill:#90EE90
    style F fill:#87CEEB
    style G fill:#87CEEB
```

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 å‡½æ•°ä¾èµ–å½¢å¼åŒ–

**å‡½æ•°ä¾èµ–è¯­ä¹‰**ï¼š

```haskell
-- å‡½æ•°ä¾èµ–è¯­ä¹‰
R âŠ¨ X â†’ Y  iff
    forall t1, t2 âˆˆ R:
      if t1[X] = t2[X] then t1[Y] = t2[Y]
```

### 3.2 é—­åŒ…å½¢å¼åŒ–

**å‡½æ•°ä¾èµ–é—­åŒ…**ï¼š

```haskell
-- å‡½æ•°ä¾èµ–é—­åŒ…
F+ = {X â†’ Y | F âŠ¢ X â†’ Y}

-- å±æ€§é—­åŒ…
X+ = {A | F âŠ¢ X â†’ A}
```

### 3.3 èŒƒå¼å½¢å¼åŒ–

**1NFå®šä¹‰**ï¼š

```haskell
-- 1NF: æ‰€æœ‰å±æ€§éƒ½æ˜¯åŸå­çš„
is1NF R = forall attr in attributes(R): isAtomic(attr)
```

**2NFå®šä¹‰**ï¼š

```haskell
-- 2NF: 1NF + æ¶ˆé™¤éƒ¨åˆ†ä¾èµ–
is2NF R FDs =
    is1NF R &&
    forall (X â†’ A) in FDs:
      if A is non-prime then X is not proper subset of key
```

**3NFå®šä¹‰**ï¼š

```haskell
-- 3NF: 2NF + æ¶ˆé™¤ä¼ é€’ä¾èµ–
is3NF R FDs =
    is2NF R FDs &&
    forall (X â†’ A) in FDs:
      if A is non-prime then X is superkey or A is prime
```

---

## 4. å®šç†ä¸è¯æ˜

### 4.1 Armstrongå…¬ç†å®Œå¤‡æ€§å®šç†

**å®šç†1ï¼ˆArmstrongå…¬ç†å®Œå¤‡æ€§ï¼‰**ï¼š

Armstrongå…¬ç†ç³»ç»Ÿæ˜¯å®Œå¤‡çš„ï¼Œå³æ‰€æœ‰ä»å‡½æ•°ä¾èµ–é›†åˆFé€»è¾‘æ¨å¯¼å‡ºçš„å‡½æ•°ä¾èµ–éƒ½å¯ä»¥é€šè¿‡Armstrongå…¬ç†æ¨å¯¼ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾å‡½æ•°ä¾èµ–é›†åˆFï¼Œå‡½æ•°ä¾èµ–X â†’ Yã€‚å¦‚æœF âŠ¨ X â†’ Yï¼ˆè¯­ä¹‰è•´å«ï¼‰ï¼Œåˆ™F âŠ¢ X â†’ Yï¼ˆArmstrongå…¬ç†æ¨å¯¼ï¼‰ã€‚

**è¯æ˜**ï¼š

**æ­¥éª¤1ï¼šå±æ€§é—­åŒ…å¼•ç†**ï¼š

- è®¾å±æ€§é›†åˆXåœ¨Fä¸‹çš„é—­åŒ…ä¸ºXâº = {A | F âŠ¢ X â†’ A}
- å¼•ç†ï¼šå¯¹äºä»»æ„å±æ€§Aï¼ŒF âŠ¢ X â†’ Aå½“ä¸”ä»…å½“A âˆˆ Xâº
- è¯æ˜ï¼šé€šè¿‡å±æ€§é—­åŒ…ç®—æ³•ï¼ŒXâºåŒ…å«æ‰€æœ‰å¯ä»¥é€šè¿‡Armstrongå…¬ç†ä»Xæ¨å¯¼å‡ºçš„å±æ€§

**æ­¥éª¤2ï¼šå‡½æ•°ä¾èµ–ç­‰ä»·æ€§**ï¼š

- å¼•ç†ï¼šF âŠ¢ X â†’ Yå½“ä¸”ä»…å½“Y âŠ† Xâº
- è¯æ˜ï¼š
  - å¦‚æœF âŠ¢ X â†’ Yï¼Œåˆ™å¯¹äºæ¯ä¸ªA âˆˆ Yï¼ŒF âŠ¢ X â†’ Aï¼Œå› æ­¤A âˆˆ Xâºï¼Œå³Y âŠ† Xâº
  - å¦‚æœY âŠ† Xâºï¼Œåˆ™å¯¹äºæ¯ä¸ªA âˆˆ Yï¼ŒF âŠ¢ X â†’ Aï¼Œé€šè¿‡å¢å¹¿å¾‹ï¼ŒF âŠ¢ X â†’ Y

**æ­¥éª¤3ï¼šåè¯æ³•**ï¼š

- å‡è®¾å­˜åœ¨å‡½æ•°ä¾èµ–X â†’ Yï¼Œä½¿å¾—F âŠ¨ X â†’ Yä½†F âŠ¬ X â†’ Y
- æ ¹æ®æ­¥éª¤2ï¼ŒY âŠˆ Xâº
- å­˜åœ¨å±æ€§A âˆˆ Yä½†A âˆ‰ Xâº

**æ­¥éª¤4ï¼šæ„é€ åä¾‹å…³ç³»**ï¼š

- æ„é€ å…³ç³»RåŒ…å«ä¸¤ä¸ªå…ƒç»„tâ‚å’Œtâ‚‚ï¼š
  - tâ‚[Xâº] = å…¨0ï¼Œtâ‚[å…¶ä»–å±æ€§] = å…¨0
  - tâ‚‚[Xâº] = å…¨0ï¼Œtâ‚‚[å…¶ä»–å±æ€§] = å…¨1
- ç”±äºA âˆ‰ Xâºï¼Œtâ‚[A] = 0, tâ‚‚[A] = 1
- ç”±äºtâ‚[X] = tâ‚‚[X]ï¼ˆéƒ½æ˜¯å…¨0ï¼‰ï¼Œä½†tâ‚[A] â‰  tâ‚‚[A]
- å› æ­¤Rä¸æ»¡è¶³X â†’ A

**æ­¥éª¤5ï¼šéªŒè¯Ræ»¡è¶³F**ï¼š

- å¯¹äºFä¸­çš„æ¯ä¸ªå‡½æ•°ä¾èµ–U â†’ Vï¼š
  - å¦‚æœV âŠ† Uâºï¼ˆåœ¨Fä¸‹ï¼‰ï¼Œåˆ™Ræ»¡è¶³U â†’ V
  - å¦‚æœV âŠˆ Uâºï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æ
- é€šè¿‡æ„é€ ï¼ŒRæ»¡è¶³Fä¸­çš„æ‰€æœ‰å‡½æ•°ä¾èµ–

**æ­¥éª¤6ï¼šçŸ›ç›¾**ï¼š

- Ræ»¡è¶³Fï¼Œä½†ä¸æ»¡è¶³X â†’ Aï¼ˆå› ä¸ºA âˆˆ Yä¸”Y âŠˆ Xâºï¼‰
- è¿™ä¸F âŠ¨ X â†’ YçŸ›ç›¾ï¼ˆå› ä¸ºå¦‚æœF âŠ¨ X â†’ Yï¼Œåˆ™æ‰€æœ‰æ»¡è¶³Fçš„å…³ç³»éƒ½æ»¡è¶³X â†’ Yï¼‰
- å› æ­¤å‡è®¾é”™è¯¯ï¼ŒF âŠ¢ X â†’ Y

**æ­¥éª¤7ï¼šç»“è®º**ï¼š

- Armstrongå…¬ç†ç³»ç»Ÿæ˜¯å®Œå¤‡çš„
- å®šç†å¾—è¯

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[Armstrongå…¬ç†å®Œå¤‡æ€§å®šç†] --> B[å±æ€§é—­åŒ…å¼•ç†]
    A --> C[å‡½æ•°ä¾èµ–ç­‰ä»·æ€§]
    B --> D[Y âŠ† Xâº âŸº F âŠ¢ X â†’ Y]
    C --> D
    D --> E[åè¯æ³•å‡è®¾]
    E --> F[æ„é€ åä¾‹å…³ç³»R]
    F --> G[Ræ»¡è¶³Fä½†ä¸æ»¡è¶³X â†’ Y]
    G --> H[çŸ›ç›¾]
    H --> I[å®šç†å¾—è¯]

    style A fill:#FFD700
    style I fill:#90EE90
```

### 4.2 èŒƒå¼åŒ…å«å…³ç³»å®šç†

**å®šç†2ï¼ˆèŒƒå¼åŒ…å«å…³ç³»ï¼‰**ï¼š

èŒƒå¼ä¹‹é—´å­˜åœ¨ä¸¥æ ¼çš„åŒ…å«å…³ç³»ï¼šBCNF âŠ† 3NF âŠ† 2NF âŠ† 1NFã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

å¯¹äºä»»æ„å…³ç³»Rå’Œå‡½æ•°ä¾èµ–é›†åˆFï¼š

- å¦‚æœRæ»¡è¶³BCNFï¼Œåˆ™Ræ»¡è¶³3NF
- å¦‚æœRæ»¡è¶³3NFï¼Œåˆ™Ræ»¡è¶³2NF
- å¦‚æœRæ»¡è¶³2NFï¼Œåˆ™Ræ»¡è¶³1NF

**è¯æ˜**ï¼š

**æ­¥éª¤1ï¼šBCNF âŠ† 3NF**ï¼š

- **BCNFå®šä¹‰**ï¼šå¯¹äºä»»æ„å‡½æ•°ä¾èµ–X â†’ Y âˆˆ Fâºï¼Œå¦‚æœY âŠˆ Xï¼Œåˆ™Xæ˜¯è¶…é”®
- **3NFå®šä¹‰**ï¼šå¯¹äºä»»æ„å‡½æ•°ä¾èµ–X â†’ Y âˆˆ Fâºï¼Œå¦‚æœYæ˜¯éä¸»å±æ€§ä¸”Y âŠˆ Xï¼Œåˆ™Xæ˜¯è¶…é”®æˆ–Yæ˜¯ä¸»å±æ€§
- å¦‚æœRæ»¡è¶³BCNFï¼š
  - å¯¹äºä»»æ„X â†’ Y âˆˆ Fâºï¼Œå¦‚æœY âŠˆ Xï¼Œåˆ™Xæ˜¯è¶…é”®ï¼ˆBCNFè¦æ±‚ï¼‰
  - å¦‚æœXæ˜¯è¶…é”®ï¼Œåˆ™æ»¡è¶³3NFæ¡ä»¶ï¼ˆXæ˜¯è¶…é”®ï¼‰
  - å› æ­¤Ræ»¡è¶³3NF
- BCNF âŠ† 3NFå¾—è¯

**æ­¥éª¤2ï¼š3NF âŠ† 2NF**ï¼š

- **2NFå®šä¹‰**ï¼šå¯¹äºä»»æ„å‡½æ•°ä¾èµ–X â†’ Y âˆˆ Fâºï¼Œå¦‚æœYæ˜¯éä¸»å±æ€§ä¸”Y âŠˆ Xï¼Œåˆ™Xä¸æ˜¯ä¸»é”®çš„çœŸå­é›†
- **3NFå®šä¹‰**ï¼šå¯¹äºä»»æ„å‡½æ•°ä¾èµ–X â†’ Y âˆˆ Fâºï¼Œå¦‚æœYæ˜¯éä¸»å±æ€§ä¸”Y âŠˆ Xï¼Œåˆ™Xæ˜¯è¶…é”®æˆ–Yæ˜¯ä¸»å±æ€§
- å¦‚æœRæ»¡è¶³3NFï¼š
  - å¯¹äºä»»æ„X â†’ Y âˆˆ Fâºï¼Œå¦‚æœYæ˜¯éä¸»å±æ€§ä¸”Y âŠˆ Xï¼š
    - å¦‚æœXæ˜¯è¶…é”®ï¼Œåˆ™Xä¸æ˜¯ä¸»é”®çš„çœŸå­é›†ï¼ˆè¶…é”®åŒ…å«ä¸»é”®ï¼‰ï¼Œæ»¡è¶³2NF
    - å¦‚æœYæ˜¯ä¸»å±æ€§ï¼Œåˆ™Y âˆˆ Xï¼ˆå› ä¸ºXæ˜¯ä¸»é”®ï¼‰ï¼Œä¸Y âŠˆ XçŸ›ç›¾ï¼Œè¿™ç§æƒ…å†µä¸å­˜åœ¨
  - å› æ­¤Ræ»¡è¶³2NF
- 3NF âŠ† 2NFå¾—è¯

**æ­¥éª¤3ï¼š2NF âŠ† 1NF**ï¼š

- **1NFå®šä¹‰**ï¼šæ‰€æœ‰å±æ€§éƒ½æ˜¯åŸå­çš„ï¼ˆä¸å¯å†åˆ†ï¼‰
- **2NFå®šä¹‰**ï¼š1NF + æ¶ˆé™¤éƒ¨åˆ†ä¾èµ–
- å¦‚æœRæ»¡è¶³2NFï¼š
  - æ ¹æ®å®šä¹‰ï¼Œ2NFè¦æ±‚Ré¦–å…ˆæ»¡è¶³1NF
  - å› æ­¤Ræ»¡è¶³1NF
- 2NF âŠ† 1NFå¾—è¯

**æ­¥éª¤4ï¼šç»“è®º**ï¼š

- BCNF âŠ† 3NF âŠ† 2NF âŠ† 1NF
- å®šç†å¾—è¯

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[èŒƒå¼åŒ…å«å…³ç³»å®šç†] --> B[BCNF âŠ† 3NF]
    A --> C[3NF âŠ† 2NF]
    A --> D[2NF âŠ† 1NF]
    B --> E[BCNFè¦æ±‚Xæ˜¯è¶…é”®]
    E --> F[æ»¡è¶³3NFæ¡ä»¶]
    C --> G[3NFè¦æ±‚Xæ˜¯è¶…é”®æˆ–Yæ˜¯ä¸»å±æ€§]
    G --> H[æ»¡è¶³2NFæ¡ä»¶]
    D --> I[2NFè¦æ±‚1NFåŸºç¡€]
    I --> J[æ»¡è¶³1NFæ¡ä»¶]
    F --> K[å®šç†å¾—è¯]
    H --> K
    J --> K

    style A fill:#FFD700
    style K fill:#90EE90
```

---

## 5. å®é™…åº”ç”¨

### 5.1 PostgreSQL 18å‡½æ•°ä¾èµ–ä¸è§„èŒƒåŒ–å®ç°

#### 5.1.1 å‡½æ•°ä¾èµ–æ£€æµ‹

**PostgreSQL 18å‡½æ•°ä¾èµ–æ”¯æŒ**ï¼š

PostgreSQL 18é€šè¿‡ç»Ÿè®¡ä¿¡æ¯å’Œçº¦æŸæ¥æ£€æµ‹å’Œä¿è¯å‡½æ•°ä¾èµ–ã€‚

**å‡½æ•°ä¾èµ–æ£€æµ‹å‡½æ•°**ï¼š

```sql
-- PostgreSQL 18ï¼šå‡½æ•°ä¾èµ–æ£€æµ‹å‡½æ•°
CREATE OR REPLACE FUNCTION check_functional_dependency(
    p_table_name TEXT,
    p_determinant_attrs TEXT[],
    p_dependent_attrs TEXT[]
)
RETURNS TABLE (
    is_valid BOOLEAN,
    violation_count BIGINT,
    violations JSONB
) AS $$
DECLARE
    v_sql TEXT;
    v_violations JSONB;
BEGIN
    -- æ£€æŸ¥å‡½æ•°ä¾èµ–æ˜¯å¦æ»¡è¶³
    v_sql := format('
        WITH grouped AS (
            SELECT
                %s as determinant,
                COUNT(DISTINCT (%s)) as distinct_dependent
            FROM %I
            GROUP BY %s
        )
        SELECT
            COUNT(*) FILTER (WHERE distinct_dependent > 1) as violation_count,
            jsonb_agg(
                jsonb_build_object(
                    ''determinant'', determinant,
                    ''distinct_count'', distinct_dependent
                )
            ) FILTER (WHERE distinct_dependent > 1) as violations
        FROM grouped
    ',
        array_to_string(p_determinant_attrs, ', '),
        array_to_string(p_dependent_attrs, ', '),
        p_table_name,
        array_to_string(p_determinant_attrs, ', ')
    );

    EXECUTE v_sql INTO v_violations;

    RETURN QUERY
    SELECT
        (v_violations->>'violation_count')::BIGINT = 0 as is_valid,
        (v_violations->>'violation_count')::BIGINT as violation_count,
        v_violations->'violations' as violations;
END;
$$ LANGUAGE plpgsql;
```

### 5.2 å®é™…åº”ç”¨åœºæ™¯

#### åœºæ™¯1ï¼šå­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿçš„è§„èŒƒåŒ–è®¾è®¡

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

å­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿéœ€è¦è®¾è®¡æ•°æ®åº“è¡¨ç»“æ„ï¼Œé¿å…æ•°æ®å†—ä½™å’Œæ›´æ–°å¼‚å¸¸ã€‚

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åœºæ™¯ï¼šå­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿè§„èŒƒåŒ–
-- 1. æœªè§„èŒƒåŒ–è®¾è®¡ï¼ˆè¿å2NFå’Œ3NFï¼‰
CREATE TABLE student_courses_bad (
    student_id BIGINT,
    student_name VARCHAR(100),
    dept_id INT,
    dept_name VARCHAR(100),
    course_id INT,
    course_name VARCHAR(100),
    grade CHAR(1)
);
-- é—®é¢˜ï¼š
-- - éƒ¨åˆ†ä¾èµ–ï¼š{student_id, course_id} â†’ grade, {student_id} â†’ student_name
-- - ä¼ é€’ä¾èµ–ï¼šstudent_id â†’ dept_id â†’ dept_name

-- 2. è§„èŒƒåŒ–è®¾è®¡ï¼ˆæ»¡è¶³BCNFï¼‰
-- å­¦ç”Ÿè¡¨
CREATE TABLE students (
    student_id BIGSERIAL PRIMARY KEY,
    student_name VARCHAR(100) NOT NULL,
    dept_id INT NOT NULL
);

-- ç³»è¡¨
CREATE TABLE departments (
    dept_id SERIAL PRIMARY KEY,
    dept_name VARCHAR(100) NOT NULL UNIQUE
);

-- è¯¾ç¨‹è¡¨
CREATE TABLE courses (
    course_id SERIAL PRIMARY KEY,
    course_name VARCHAR(100) NOT NULL
);

-- é€‰è¯¾è¡¨
CREATE TABLE enrollments (
    student_id BIGINT NOT NULL REFERENCES students(student_id),
    course_id INT NOT NULL REFERENCES courses(course_id),
    grade CHAR(1),
    PRIMARY KEY (student_id, course_id)
);

-- 3. éªŒè¯å‡½æ•°ä¾èµ–
-- æ£€æŸ¥ï¼šdept_id â†’ dept_name
SELECT * FROM check_functional_dependency(
    'departments',
    ARRAY['dept_id'],
    ARRAY['dept_name']
);
-- ç»“æœï¼šis_valid = trueï¼ˆé€šè¿‡å”¯ä¸€çº¦æŸä¿è¯ï¼‰

-- 4. éªŒè¯èŒƒå¼
-- æ£€æŸ¥æ˜¯å¦æ»¡è¶³BCNF
-- æ‰€æœ‰å‡½æ•°ä¾èµ–çš„å†³å®šå› å­éƒ½æ˜¯å€™é€‰é”®
-- students: student_idæ˜¯ä¸»é”®
-- departments: dept_idæ˜¯ä¸»é”®
-- courses: course_idæ˜¯ä¸»é”®
-- enrollments: (student_id, course_id)æ˜¯ä¸»é”®

-- æ€§èƒ½æ•°æ®
-- å­¦ç”Ÿæ•°é‡ï¼š10,000
-- è¯¾ç¨‹æ•°é‡ï¼š1,000
-- é€‰è¯¾è®°å½•ï¼š50,000
-- æŸ¥è¯¢æ€§èƒ½ï¼šè§„èŒƒåŒ–åJOINæŸ¥è¯¢ <100ms
```

#### åœºæ™¯2ï¼šè®¢å•ç³»ç»Ÿçš„èŒƒå¼åˆ†è§£

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

è®¢å•ç³»ç»Ÿéœ€è¦è®¾è®¡è¡¨ç»“æ„ï¼Œæ”¯æŒè®¢å•ã€è®¢å•é¡¹ã€äº§å“ã€å®¢æˆ·ç­‰å®ä½“ã€‚

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åœºæ™¯ï¼šè®¢å•ç³»ç»ŸèŒƒå¼åˆ†è§£
-- 1. åˆå§‹è®¾è®¡ï¼ˆå¯èƒ½è¿åèŒƒå¼ï¼‰
CREATE TABLE order_details_bad (
    order_id BIGINT,
    order_date DATE,
    customer_id BIGINT,
    customer_name VARCHAR(100),
    item_id INT,
    item_name VARCHAR(100),
    quantity INT,
    price DECIMAL(10,2),
    total DECIMAL(10,2)
);
-- é—®é¢˜ï¼šåŒ…å«éƒ¨åˆ†ä¾èµ–å’Œä¼ é€’ä¾èµ–

-- 2. BCNFåˆ†è§£
-- è®¢å•è¡¨
CREATE TABLE orders (
    order_id BIGSERIAL PRIMARY KEY,
    order_date DATE NOT NULL,
    customer_id BIGINT NOT NULL
);

-- å®¢æˆ·è¡¨
CREATE TABLE customers (
    customer_id BIGSERIAL PRIMARY KEY,
    customer_name VARCHAR(100) NOT NULL
);

-- äº§å“è¡¨
CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    product_name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL
);

-- è®¢å•é¡¹è¡¨
CREATE TABLE order_items (
    order_id BIGINT NOT NULL REFERENCES orders(order_id),
    item_id INT NOT NULL REFERENCES products(product_id),
    quantity INT NOT NULL,
    PRIMARY KEY (order_id, item_id)
);

-- 3. éªŒè¯BCNF
-- æ‰€æœ‰å‡½æ•°ä¾èµ–çš„å†³å®šå› å­éƒ½æ˜¯å€™é€‰é”®
-- æ»¡è¶³BCNF

-- 4. æŸ¥è¯¢ç¤ºä¾‹ï¼ˆéœ€è¦JOINï¼‰
SELECT
    o.order_id,
    o.order_date,
    c.customer_name,
    p.product_name,
    oi.quantity,
    p.price,
    oi.quantity * p.price as total
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
JOIN products p ON oi.item_id = p.product_id
WHERE o.order_date >= '2025-01-01';
```

---

## 6. ç›¸å…³æ–‡æ¡£

### 6.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [å½¢å¼è¯­è¨€ä¸è¯æ˜ï¼šæ€»è®º](./1.1.25-å½¢å¼è¯­è¨€ä¸è¯æ˜-æ€»è®º.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](./README.md)

---

## 7. å‚è€ƒæ–‡çŒ®

### 7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®

- **Codd, E. F. (1970). "A Relational Model of Data for Large Shared Data Banks."**
  - ä¼šè®®: Communications of the ACM 1970
  - **é‡è¦æ€§**: å…³ç³»æ¨¡å‹çš„å¥ åŸºæ€§è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†å…³ç³»æ¨¡å‹å’Œè§„èŒƒåŒ–ç†è®º

- **Armstrong, W. W. (1974). "Dependency Structures of Data Base Relationships."**
  - ä¼šè®®: IFIP Congress 1974
  - **é‡è¦æ€§**: å‡½æ•°ä¾èµ–ç†è®ºçš„ç»å…¸è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†Armstrongå…¬ç†ç³»ç»Ÿ

### 7.2 è§„èŒƒåŒ–ç›¸å…³

- **Maier, D. (1983). "The Theory of Relational Databases."**
  - å‡ºç‰ˆç¤¾: Computer Science Press
  - **é‡è¦æ€§**: å…³ç³»æ•°æ®åº“ç†è®ºçš„ç»å…¸æ•™æ
  - **æ ¸å¿ƒè´¡çŒ®**: ç³»ç»Ÿé˜è¿°äº†è§„èŒƒåŒ–ç†è®º

### 7.3 ç›¸å…³æ–‡æ¡£

- [BCNFä¸3NF-å®Œæ•´è¯æ˜ç¨¿](./09.02-BCNFä¸3NF-å®Œæ•´è¯æ˜ç¨¿.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: âœ… å†…å®¹å·²å®Œæˆ
