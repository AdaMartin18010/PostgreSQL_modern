# æ•°æ®åº“æœºå™¨å­¦ä¹ é›†æˆ-æ¨¡å‹ç®¡ç†ä¸æ¨ç†ä¼˜åŒ–çš„å½¢å¼åŒ–

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: ğŸŸ¡ æ¡†æ¶å·²åˆ›å»ºï¼Œå†…å®¹å¾…å®Œå–„

---

## ğŸ“‹ ç›®å½•

- [æ•°æ®åº“æœºå™¨å­¦ä¹ é›†æˆ-æ¨¡å‹ç®¡ç†ä¸æ¨ç†ä¼˜åŒ–çš„å½¢å¼åŒ–](#æ•°æ®åº“æœºå™¨å­¦ä¹ é›†æˆ-æ¨¡å‹ç®¡ç†ä¸æ¨ç†ä¼˜åŒ–çš„å½¢å¼åŒ–)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 æ•°æ®åº“æœºå™¨å­¦ä¹ é›†æˆå·¥ä½œåŸç†æ¦‚è¿°](#10-æ•°æ®åº“æœºå™¨å­¦ä¹ é›†æˆå·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 æ¨¡å‹ç®¡ç†](#21-æ¨¡å‹ç®¡ç†)
    - [2.2 æ¨¡å‹è®­ç»ƒ](#22-æ¨¡å‹è®­ç»ƒ)
    - [2.3 æ¨¡å‹æ¨ç†](#23-æ¨¡å‹æ¨ç†)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 æ¨¡å‹å½¢å¼åŒ–](#31-æ¨¡å‹å½¢å¼åŒ–)
    - [3.2 è®­ç»ƒå½¢å¼åŒ–](#32-è®­ç»ƒå½¢å¼åŒ–)
    - [3.3 æ¨ç†å½¢å¼åŒ–](#33-æ¨ç†å½¢å¼åŒ–)
  - [4. å®é™…åº”ç”¨](#4-å®é™…åº”ç”¨)
    - [4.1 PostgreSQL MLæ‰©å±•](#41-postgresql-mlæ‰©å±•)
    - [4.2 æ¨¡å‹ç®¡ç†](#42-æ¨¡å‹ç®¡ç†)
    - [4.3 æ¨ç†ä¼˜åŒ–](#43-æ¨ç†ä¼˜åŒ–)
  - [5. ç›¸å…³æ–‡æ¡£](#5-ç›¸å…³æ–‡æ¡£)
    - [5.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#51-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [6. å‚è€ƒæ–‡çŒ®](#6-å‚è€ƒæ–‡çŒ®)
    - [6.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®](#61-æ ¸å¿ƒç†è®ºæ–‡çŒ®)
    - [6.2 æ¨ç†ä¼˜åŒ–ç›¸å…³](#62-æ¨ç†ä¼˜åŒ–ç›¸å…³)
    - [6.3 PostgreSQLå®ç°ç›¸å…³](#63-postgresqlå®ç°ç›¸å…³)
    - [6.4 ç›¸å…³æ–‡æ¡£](#64-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

### 1.0 æ•°æ®åº“æœºå™¨å­¦ä¹ é›†æˆå·¥ä½œåŸç†æ¦‚è¿°

**MLé›†æˆæ¶æ„**ï¼š

æ•°æ®åº“ä¸æœºå™¨å­¦ä¹ çš„é›†æˆä½¿å¾—å¯ä»¥åœ¨æ•°æ®åº“å†…éƒ¨è¿›è¡Œæ¨¡å‹è®­ç»ƒã€æ¨ç†å’Œä¼˜åŒ–ã€‚æœ¬æ–‡æ¡£æä¾›æ•°æ®åº“MLé›†æˆçš„å½¢å¼åŒ–æ¨¡å‹ã€‚

**MLé›†æˆå±‚æ¬¡æ€ç»´å¯¼å›¾**ï¼š

```mermaid
mindmap
  root((æ•°æ®åº“MLé›†æˆ))
    æ¨¡å‹ç®¡ç†
      æ¨¡å‹å­˜å‚¨
      æ¨¡å‹ç‰ˆæœ¬æ§åˆ¶
      æ¨¡å‹å…ƒæ•°æ®
      æ¨¡å‹æ³¨å†Œè¡¨
    æ¨¡å‹è®­ç»ƒ
      åœ¨çº¿è®­ç»ƒ
      å¢é‡è®­ç»ƒ
      åˆ†å¸ƒå¼è®­ç»ƒ
      è¶…å‚æ•°ä¼˜åŒ–
    æ¨¡å‹æ¨ç†
      åœ¨çº¿æ¨ç†
      æ‰¹é‡æ¨ç†
      å‘é‡åŒ–æ¨ç†
      æ¨ç†ä¼˜åŒ–
    æ¨¡å‹ä¼˜åŒ–
      æ¨¡å‹å‹ç¼©
      é‡åŒ–
      å‰ªæ
      çŸ¥è¯†è’¸é¦
```

**MLç”Ÿå‘½å‘¨æœŸå†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[æ•°æ®å‡†å¤‡] --> B[æ¨¡å‹è®­ç»ƒ]
    B --> C{è®­ç»ƒæˆåŠŸ?}
    C -->|æ˜¯| D[æ¨¡å‹è¯„ä¼°]
    C -->|å¦| E[è°ƒæ•´è¶…å‚æ•°]
    E --> B
    D --> F{æ€§èƒ½æ»¡è¶³?}
    F -->|æ˜¯| G[æ¨¡å‹éƒ¨ç½²]
    F -->|å¦| H[æ¨¡å‹ä¼˜åŒ–]
    H --> B
    G --> I[åœ¨çº¿æ¨ç†]
    I --> J[ç›‘æ§æ€§èƒ½]
    J --> K{æ€§èƒ½ä¸‹é™?}
    K -->|æ˜¯| L[æ¨¡å‹æ›´æ–°]
    K -->|å¦| I
    L --> B

    style A fill:#FFD700
    style G fill:#90EE90
    style K fill:#FF6B6B
```

**MLé›†æˆæ–¹å¼å¯¹æ¯”çŸ©é˜µ**ï¼š

| é›†æˆæ–¹å¼ | ä¼˜åŠ¿ | åŠ£åŠ¿ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| **æ•°æ®åº“å†…ML** | ä½å»¶è¿Ÿã€æ•°æ®æœ¬åœ°æ€§ | èµ„æºé™åˆ¶ | å®æ—¶æ¨ç† |
| **å¤–éƒ¨MLæœåŠ¡** | çµæ´»æ€§é«˜ã€èµ„æºä¸°å¯Œ | ç½‘ç»œå»¶è¿Ÿ | å¤æ‚æ¨¡å‹ |
| **æ··åˆæ–¹å¼** | å¹³è¡¡æ€§èƒ½ä¸çµæ´»æ€§ | å¤æ‚åº¦é«˜ | ç”Ÿäº§ç¯å¢ƒ |

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **æ¨¡å‹ç®¡ç†**ï¼šæ¨¡å‹å­˜å‚¨ã€ç‰ˆæœ¬æ§åˆ¶ã€å…ƒæ•°æ®ç®¡ç†
- **æ¨¡å‹è®­ç»ƒ**ï¼šåœ¨çº¿è®­ç»ƒã€å¢é‡è®­ç»ƒçš„å½¢å¼åŒ–
- **æ¨¡å‹æ¨ç†**ï¼šæ¨ç†ä¼˜åŒ–å’Œå‘é‡åŒ–æ¨ç†
- **å®é™…åº”ç”¨**ï¼šPostgreSQL MLæ‰©å±•çš„åº”ç”¨

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 æ¨¡å‹ç®¡ç†

**æ¨¡å‹å…ƒæ•°æ®**ï¼š

```haskell
-- æ¨¡å‹å…ƒæ•°æ®
data ModelMetadata = ModelMetadata {
    modelId :: ModelID,
    modelName :: String,
    modelType :: ModelType,
    version :: Version,
    trainingData :: DataSet,
    hyperparameters :: Map String Value,
    metrics :: Map String Double,
    createdAt :: Timestamp
}

-- æ¨¡å‹ç±»å‹
data ModelType =
    LinearRegression
  | LogisticRegression
  | NeuralNetwork
  | RandomForest
  | SVM
```

**æ¨¡å‹ç®¡ç†æµç¨‹**ï¼š

```mermaid
graph TD
    A[æ¨¡å‹è®­ç»ƒ] --> B[æ¨¡å‹è¯„ä¼°]
    B --> C[æ¨¡å‹æ³¨å†Œ]
    C --> D[æ¨¡å‹å­˜å‚¨]
    D --> E[ç‰ˆæœ¬æ§åˆ¶]
    E --> F[æ¨¡å‹éƒ¨ç½²]
    F --> G[æ€§èƒ½ç›‘æ§]
    G --> H{éœ€è¦æ›´æ–°?}
    H -->|æ˜¯| I[æ¨¡å‹ç‰ˆæœ¬åŒ–]
    H -->|å¦| F
    I --> C

    style A fill:#FFD700
    style F fill:#90EE90
    style H fill:#FF6B6B
```

### 2.2 æ¨¡å‹è®­ç»ƒ

**åœ¨çº¿è®­ç»ƒå½¢å¼åŒ–**ï¼š

```haskell
-- åœ¨çº¿è®­ç»ƒ
onlineTrain :: Model -> DataPoint -> Model
onlineTrain model point =
    updateWeights model (gradient model point)

-- å¢é‡è®­ç»ƒ
incrementalTrain :: Model -> DataSet -> Model
incrementalTrain model newData =
    foldl onlineTrain model newData
```

**è®­ç»ƒä¼˜åŒ–å†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[å¼€å§‹è®­ç»ƒ] --> B[é€‰æ‹©ä¼˜åŒ–å™¨]
    B --> C{ä¼˜åŒ–å™¨ç±»å‹}
    C -->|SGD| D[éšæœºæ¢¯åº¦ä¸‹é™]
    C -->|Adam| E[è‡ªé€‚åº”çŸ©ä¼°è®¡]
    C -->|RMSprop| F[å‡æ–¹æ ¹ä¼ æ’­]
    D --> G[è®¡ç®—æ¢¯åº¦]
    E --> G
    F --> G
    G --> H[æ›´æ–°æƒé‡]
    H --> I{æ”¶æ•›?}
    I -->|å¦| G
    I -->|æ˜¯| J[ä¿å­˜æ¨¡å‹]

    style A fill:#FFD700
    style J fill:#90EE90
```

### 2.3 æ¨¡å‹æ¨ç†

**æ¨ç†ä¼˜åŒ–**ï¼š

```haskell
-- æ‰¹é‡æ¨ç†
batchInference :: Model -> [DataPoint] -> [Prediction]
batchInference model points =
    map (inference model) points

-- å‘é‡åŒ–æ¨ç†
vectorizedInference :: Model -> Matrix -> Matrix
vectorizedInference model data =
    matrixMultiply (weights model) data
```

**æ¨ç†ä¼˜åŒ–ç­–ç•¥å¯¹æ¯”çŸ©é˜µ**ï¼š

| ä¼˜åŒ–ç­–ç•¥ | æ–¹æ³• | æ€§èƒ½æå‡ | é€‚ç”¨åœºæ™¯ |
|---------|------|---------|---------|
| **å‘é‡åŒ–** | æ‰¹é‡å¤„ç† | 10-100x | æ‰¹é‡æ¨ç† |
| **æ¨¡å‹å‹ç¼©** | é‡åŒ–/å‰ªæ | 2-5x | èµ„æºå—é™ |
| **ç¼“å­˜** | ç»“æœç¼“å­˜ | 100-1000x | é‡å¤æŸ¥è¯¢ |
| **å¹¶è¡ŒåŒ–** | å¤šçº¿ç¨‹/GPU | 4-100x | å¤§è§„æ¨¡æ¨ç† |

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 æ¨¡å‹å½¢å¼åŒ–

**æ¨¡å‹å®šä¹‰**ï¼š

```haskell
-- æ¨¡å‹
Model = (Weights, Architecture, Hyperparameters)

-- æ¨ç†å‡½æ•°
inference : Model Ã— DataPoint â†’ Prediction

-- è®­ç»ƒå‡½æ•°
train : Model Ã— DataSet â†’ Model
```

### 3.2 è®­ç»ƒå½¢å¼åŒ–

**æŸå¤±å‡½æ•°**ï¼š

```haskell
-- æŸå¤±å‡½æ•°
loss : Model Ã— DataPoint â†’ Real

-- æ¢¯åº¦
gradient : Model Ã— DataPoint â†’ Weights

-- æƒé‡æ›´æ–°
update : Model Ã— Weights â†’ Model
```

### 3.3 æ¨ç†å½¢å¼åŒ–

**æ¨ç†è¯­ä¹‰**ï¼š

```haskell
-- æ¨ç†è¯­ä¹‰
âŸ¦inferenceâŸ§(model, point) =
    forward(model.weights, point)

-- æ‰¹é‡æ¨ç†
âŸ¦batchInferenceâŸ§(model, points) =
    [âŸ¦inferenceâŸ§(model, p) | p â† points]
```

---

## 4. å®é™…åº”ç”¨

### 4.1 PostgreSQL MLæ‰©å±•

**pgmlæ‰©å±•**ï¼š

```sql
-- å®‰è£…pgmlæ‰©å±•
CREATE EXTENSION pgml;

-- è®­ç»ƒæ¨¡å‹
SELECT pgml.train(
    'regression',
    'SELECT price, bedrooms, bathrooms FROM houses',
    'price',
    algorithm => 'linear_regression'
);

-- åœ¨çº¿æ¨ç†
SELECT
    bedrooms,
    bathrooms,
    pgml.predict('house_price_model',
        ARRAY[bedrooms, bathrooms]) as predicted_price
FROM houses;
```

### 4.2 æ¨¡å‹ç®¡ç†

**æ¨¡å‹ç‰ˆæœ¬æ§åˆ¶**ï¼š

```sql
-- åˆ›å»ºæ¨¡å‹è¡¨
CREATE TABLE ml_models (
    model_id SERIAL PRIMARY KEY,
    model_name VARCHAR(100),
    version INT,
    model_data BYTEA,
    metrics JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- æ³¨å†Œæ¨¡å‹
INSERT INTO ml_models (model_name, version, model_data, metrics)
VALUES (
    'house_price_predictor',
    1,
    model_bytes,
    '{"r2": 0.85, "rmse": 50000}'::jsonb
);
```

### 4.3 æ¨ç†ä¼˜åŒ–

**æ‰¹é‡æ¨ç†ä¼˜åŒ–**ï¼š

```sql
-- ä½¿ç”¨å‘é‡åŒ–æ¨ç†
WITH predictions AS (
    SELECT
        id,
        pgml.predict_batch(
            'house_price_model',
            ARRAY[bedrooms, bathrooms, sqft]
        ) as price
    FROM houses
    WHERE price IS NULL
)
UPDATE houses h
SET predicted_price = p.price
FROM predictions p
WHERE h.id = p.id;
```

**ç¼“å­˜ä¼˜åŒ–**ï¼š

```sql
-- åˆ›å»ºæ¨ç†ç»“æœç¼“å­˜
CREATE MATERIALIZED VIEW prediction_cache AS
SELECT
    bedrooms,
    bathrooms,
    sqft,
    pgml.predict('house_price_model',
        ARRAY[bedrooms, bathrooms, sqft]) as price
FROM (
    SELECT DISTINCT bedrooms, bathrooms, sqft
    FROM houses
) unique_combinations;

-- ä½¿ç”¨ç¼“å­˜
SELECT h.*, pc.price
FROM houses h
JOIN prediction_cache pc
    ON h.bedrooms = pc.bedrooms
    AND h.bathrooms = pc.bathrooms
    AND h.sqft = pc.sqft;
```

---

## 5. ç›¸å…³æ–‡æ¡£

### 5.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [å‘é‡æ£€ç´¢ä¸Top-k-æ•°å­¦æ¨¡å‹ä¸å¯è¿‘ä¼¼æ€§è¯æ˜](./11.01-å‘é‡æ£€ç´¢ä¸Top-k-æ•°å­¦æ¨¡å‹ä¸å¯è¿‘ä¼¼æ€§è¯æ˜.md)
- [å½¢å¼è¯­è¨€ä¸è¯æ˜ï¼šæ€»è®º](../01-å½¢å¼åŒ–æ–¹æ³•ä¸åŸºç¡€ç†è®º/01.05-å½¢å¼è¯­è¨€ä¸è¯æ˜-æ€»è®º.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)

---

## 6. å‚è€ƒæ–‡çŒ®

### 6.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®

- **Hellerstein, J. M., et al. (2012). "The MADlib Analytics Library: Or MAD Skills, the SQL."**
  - ä¼šè®®: VLDB 2012
  - **é‡è¦æ€§**: æ•°æ®åº“å†…æœºå™¨å­¦ä¹ çš„ç»å…¸è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†åœ¨æ•°æ®åº“ä¸­é›†æˆMLçš„æ¡†æ¶

- **Kumar, A., et al. (2015). "Model Selection Management Systems: The Next Frontier of Advanced Analytics."**
  - ä¼šè®®: SIGMOD 2015
  - **é‡è¦æ€§**: æ¨¡å‹ç®¡ç†ç³»ç»Ÿçš„ç ”ç©¶
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†æ¨¡å‹ç®¡ç†ç³»ç»Ÿæ¶æ„

### 6.2 æ¨ç†ä¼˜åŒ–ç›¸å…³

- **Park, Y., et al. (2018). "Deep Learning Inference Serving."**
  - ä¼šè®®: VLDB 2018
  - **é‡è¦æ€§**: æ·±åº¦å­¦ä¹ æ¨ç†ä¼˜åŒ–çš„ç ”ç©¶
  - **æ ¸å¿ƒè´¡çŒ®**: æä¾›äº†æ¨ç†ä¼˜åŒ–çš„æ–¹æ³•

### 6.3 PostgreSQLå®ç°ç›¸å…³

- **[pgmlæ–‡æ¡£](<https://github.com/postgresml/postgresml>)**
  - PostgreSQL MLæ‰©å±•æ–‡æ¡£

### 6.4 ç›¸å…³æ–‡æ¡£

- [å‘é‡æ£€ç´¢ä¸Top-k-æ•°å­¦æ¨¡å‹ä¸å¯è¿‘ä¼¼æ€§è¯æ˜](./11.01-å‘é‡æ£€ç´¢ä¸Top-k-æ•°å­¦æ¨¡å‹ä¸å¯è¿‘ä¼¼æ€§è¯æ˜.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: ğŸŸ¡ æ¡†æ¶å·²åˆ›å»ºï¼Œå†…å®¹å¾…å®Œå–„
