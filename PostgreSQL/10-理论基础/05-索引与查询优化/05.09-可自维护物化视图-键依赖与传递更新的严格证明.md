# å¯è‡ªç»´æŠ¤ç‰©åŒ–è§†å›¾-é”®ä¾èµ–ä¸ä¼ é€’æ›´æ–°çš„ä¸¥æ ¼è¯æ˜

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: ğŸŸ¡ æ¡†æ¶å·²åˆ›å»ºï¼Œå†…å®¹å¾…å®Œå–„

---

## ğŸ“‹ ç›®å½•

- [å¯è‡ªç»´æŠ¤ç‰©åŒ–è§†å›¾-é”®ä¾èµ–ä¸ä¼ é€’æ›´æ–°çš„ä¸¥æ ¼è¯æ˜](#å¯è‡ªç»´æŠ¤ç‰©åŒ–è§†å›¾-é”®ä¾èµ–ä¸ä¼ é€’æ›´æ–°çš„ä¸¥æ ¼è¯æ˜)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 å¯è‡ªç»´æŠ¤ç‰©åŒ–è§†å›¾å·¥ä½œåŸç†æ¦‚è¿°](#10-å¯è‡ªç»´æŠ¤ç‰©åŒ–è§†å›¾å·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 é”®ä¾èµ–](#21-é”®ä¾èµ–)
    - [2.2 ä¼ é€’æ›´æ–°](#22-ä¼ é€’æ›´æ–°)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 å¯è‡ªç»´æŠ¤æ€§å½¢å¼åŒ–](#31-å¯è‡ªç»´æŠ¤æ€§å½¢å¼åŒ–)
  - [4. å®šç†ä¸è¯æ˜](#4-å®šç†ä¸è¯æ˜)
    - [4.1 å¯è‡ªç»´æŠ¤æ€§å®šç†](#41-å¯è‡ªç»´æŠ¤æ€§å®šç†)
  - [5. å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 PostgreSQLç‰©åŒ–è§†å›¾](#51-postgresqlç‰©åŒ–è§†å›¾)
  - [6. ç›¸å…³æ–‡æ¡£](#6-ç›¸å…³æ–‡æ¡£)
    - [6.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#61-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [7. å‚è€ƒæ–‡çŒ®](#7-å‚è€ƒæ–‡çŒ®)

---

## 1. æ¦‚è¿°

### 1.0 å¯è‡ªç»´æŠ¤ç‰©åŒ–è§†å›¾å·¥ä½œåŸç†æ¦‚è¿°

**å¯è‡ªç»´æŠ¤ç‰©åŒ–è§†å›¾**ï¼š

å¯è‡ªç»´æŠ¤ç‰©åŒ–è§†å›¾å¯ä»¥é€šè¿‡é”®ä¾èµ–å’Œä¼ é€’æ›´æ–°æ¥ç»´æŠ¤ï¼Œæ— éœ€è®¿é—®åŸºè¡¨ã€‚

**å¯ç»´æŠ¤æ€§æ€ç»´å¯¼å›¾**ï¼š

```mermaid
mindmap
  root((å¯è‡ªç»´æŠ¤))
    é”®ä¾èµ–
      ä¸»é”®ä¾èµ–
      å¤–é”®ä¾èµ–
      å‡½æ•°ä¾èµ–
    ä¼ é€’æ›´æ–°
      ç›´æ¥æ›´æ–°
      é—´æ¥æ›´æ–°
      çº§è”æ›´æ–°
    ç»´æŠ¤ç­–ç•¥
      å¢é‡ç»´æŠ¤
      å…¨é‡ç»´æŠ¤
      å»¶è¿Ÿç»´æŠ¤
```

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **é”®ä¾èµ–**ï¼šä¸»é”®ã€å¤–é”®ã€å‡½æ•°ä¾èµ–
- **ä¼ é€’æ›´æ–°**ï¼šæ›´æ–°ä¼ æ’­æœºåˆ¶
- **å¯ç»´æŠ¤æ€§è¯æ˜**ï¼šä¸¥æ ¼è¯æ˜å¯è‡ªç»´æŠ¤æ€§
- **å®é™…åº”ç”¨**ï¼šPostgreSQLç‰©åŒ–è§†å›¾

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 é”®ä¾èµ–

**é”®ä¾èµ–ç±»å‹**ï¼š

| ç±»å‹ | å®šä¹‰ | å¯ç»´æŠ¤æ€§ | ç¤ºä¾‹ |
|------|------|---------|------|
| **ä¸»é”®ä¾èµ–** | è§†å›¾åŒ…å«ä¸»é”® | é«˜ | SELECT id, name FROM users |
| **å¤–é”®ä¾èµ–** | è§†å›¾åŒ…å«å¤–é”® | ä¸­ | SELECT u.id, o.amount FROM users u JOIN orders o |
| **å‡½æ•°ä¾èµ–** | è§†å›¾ä¾èµ–å‡½æ•° | ä½ | SELECT id, COUNT(*) FROM orders GROUP BY id |

### 2.2 ä¼ é€’æ›´æ–°

**æ›´æ–°ä¼ æ’­**ï¼š

```haskell
-- ä¼ é€’æ›´æ–°
propagateUpdate :: Update -> MaterializedView -> MaterializedView
propagateUpdate update view =
    if canMaintain(view, update) then
        applyUpdate(view, update)
    else
        refreshView(view)
```

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 å¯è‡ªç»´æŠ¤æ€§å½¢å¼åŒ–

**å¯è‡ªç»´æŠ¤æ€§**ï¼š

```haskell
-- å¯è‡ªç»´æŠ¤æ€§å½¢å¼åŒ–
selfMaintainable(view) =
    forall update u:
        if keyDependent(view, u) then
            canUpdate(view, u) without accessing base tables
```

---

## 4. å®šç†ä¸è¯æ˜

### 4.1 å¯è‡ªç»´æŠ¤æ€§å®šç†

**å®šç†**ï¼šå¦‚æœç‰©åŒ–è§†å›¾åŒ…å«æ‰€æœ‰åŸºè¡¨çš„ä¸»é”®ï¼Œåˆ™è§†å›¾å¯è‡ªç»´æŠ¤ã€‚

**è¯æ˜**ï¼š

1. ä¸»é”®å”¯ä¸€æ ‡è¯†è¡Œ
2. æ›´æ–°æ“ä½œåŸºäºä¸»é”®å®šä½è¡Œ
3. è§†å›¾åŒ…å«ä¸»é”®ï¼Œå¯ç›´æ¥å®šä½è§†å›¾è¡Œ
4. å› æ­¤å¯è‡ªç»´æŠ¤

---

## 5. å®é™…åº”ç”¨

### 5.1 PostgreSQLç‰©åŒ–è§†å›¾

**åˆ›å»ºç‰©åŒ–è§†å›¾**ï¼š

```sql
-- åˆ›å»ºç‰©åŒ–è§†å›¾
CREATE MATERIALIZED VIEW mv_account_summary AS
SELECT
    account_id,
    SUM(amount) AS total_amount,
    COUNT(*) AS transaction_count
FROM transactions
GROUP BY account_id;

-- åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼ˆåŒ…å«ä¸»é”®ï¼‰
CREATE UNIQUE INDEX ON mv_account_summary (account_id);

-- å¢é‡åˆ·æ–°
REFRESH MATERIALIZED VIEW CONCURRENTLY mv_account_summary;
```

---

## 6. ç›¸å…³æ–‡æ¡£

### 6.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [å½¢å¼è¯­è¨€ä¸è¯æ˜ï¼šæ€»è®º](./1.1.25-å½¢å¼è¯­è¨€ä¸è¯æ˜-æ€»è®º.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](./README.md)

---

## 7. å‚è€ƒæ–‡çŒ®

[å¾…è¡¥å……]

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: ğŸŸ¡ æ¡†æ¶å·²åˆ›å»ºï¼Œå†…å®¹å¾…å®Œå–„
