# 9.1.1 ç¯å¢ƒæ­å»ºæŒ‡å—

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 11 æœˆ 1 æ—¥  
> **æ–‡æ¡£ç¼–å·**: 09-01-01

## ğŸ“‘ ç›®å½•

- [9.1.1 ç¯å¢ƒæ­å»ºæŒ‡å—](#911-ç¯å¢ƒæ­å»ºæŒ‡å—)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 æŒ‡å—ç›®æ ‡](#11-æŒ‡å—ç›®æ ‡)
    - [1.2 ç¯å¢ƒè¦æ±‚](#12-ç¯å¢ƒè¦æ±‚)
    - [1.3 æŠ€æœ¯æ ˆ](#13-æŠ€æœ¯æ ˆ)
  - [2. å‰ç½®è¦æ±‚](#2-å‰ç½®è¦æ±‚)
    - [2.1 ç³»ç»Ÿè¦æ±‚](#21-ç³»ç»Ÿè¦æ±‚)
    - [2.2 è½¯ä»¶è¦æ±‚](#22-è½¯ä»¶è¦æ±‚)
    - [2.3 ç½‘ç»œè¦æ±‚](#23-ç½‘ç»œè¦æ±‚)
  - [3. å¿«é€Ÿå®‰è£…](#3-å¿«é€Ÿå®‰è£…)
    - [3.1 Docker å®‰è£…ï¼ˆæ¨èï¼‰](#31-docker-å®‰è£…æ¨è)
      - [3.1.1 å®‰è£…æ­¥éª¤](#311-å®‰è£…æ­¥éª¤)
      - [3.1.2 éªŒè¯å®‰è£…](#312-éªŒè¯å®‰è£…)
      - [3.1.3 å¸¸è§é—®é¢˜](#313-å¸¸è§é—®é¢˜)
    - [3.2 æœ¬åœ°å®‰è£…](#32-æœ¬åœ°å®‰è£…)
      - [3.2.1 Ubuntu/Debian å®‰è£…](#321-ubuntudebian-å®‰è£…)
      - [3.2.2 macOS å®‰è£…](#322-macos-å®‰è£…)
      - [3.2.3 Windows å®‰è£…](#323-windows-å®‰è£…)
  - [4. æ‰©å±•å®‰è£…](#4-æ‰©å±•å®‰è£…)
    - [4.1 pgvector å®‰è£…](#41-pgvector-å®‰è£…)
      - [4.1.1 å®‰è£…æ­¥éª¤](#411-å®‰è£…æ­¥éª¤)
      - [4.1.2 éªŒè¯å®‰è£…](#412-éªŒè¯å®‰è£…)
    - [4.2 TimescaleDB å®‰è£…](#42-timescaledb-å®‰è£…)
      - [4.2.1 å®‰è£…æ­¥éª¤](#421-å®‰è£…æ­¥éª¤)
      - [4.2.2 é…ç½®ä¼˜åŒ–](#422-é…ç½®ä¼˜åŒ–)
    - [4.3 Apache AGE å®‰è£…](#43-apache-age-å®‰è£…)
      - [4.3.1 å®‰è£…æ­¥éª¤](#431-å®‰è£…æ­¥éª¤)
      - [4.3.2 éªŒè¯å®‰è£…](#432-éªŒè¯å®‰è£…)
    - [4.4 å…¶ä»–æ‰©å±•å®‰è£…](#44-å…¶ä»–æ‰©å±•å®‰è£…)
  - [5. å¼€å‘ç¯å¢ƒé…ç½®](#5-å¼€å‘ç¯å¢ƒé…ç½®)
    - [5.1 Python ç¯å¢ƒ](#51-python-ç¯å¢ƒ)
      - [5.1.1 ç¯å¢ƒé…ç½®](#511-ç¯å¢ƒé…ç½®)
      - [5.1.2 ä¾èµ–å®‰è£…](#512-ä¾èµ–å®‰è£…)
    - [5.2 Node.js ç¯å¢ƒ](#52-nodejs-ç¯å¢ƒ)
      - [5.2.1 ç¯å¢ƒé…ç½®](#521-ç¯å¢ƒé…ç½®)
      - [5.2.2 ä¾èµ–å®‰è£…](#522-ä¾èµ–å®‰è£…)
    - [5.3 ç¯å¢ƒå˜é‡é…ç½®](#53-ç¯å¢ƒå˜é‡é…ç½®)
  - [6. éªŒè¯å®‰è£…](#6-éªŒè¯å®‰è£…)
    - [6.1 å®Œæ•´æµ‹è¯•è„šæœ¬](#61-å®Œæ•´æµ‹è¯•è„šæœ¬)
    - [6.2 æµ‹è¯•ç»“æœéªŒè¯](#62-æµ‹è¯•ç»“æœéªŒè¯)
  - [7. å¸¸è§é—®é¢˜](#7-å¸¸è§é—®é¢˜)
    - [7.1 å®‰è£…é—®é¢˜](#71-å®‰è£…é—®é¢˜)
    - [7.2 é…ç½®é—®é¢˜](#72-é…ç½®é—®é¢˜)
    - [7.3 æƒé™é—®é¢˜](#73-æƒé™é—®é¢˜)
  - [8. ä¸‹ä¸€æ­¥](#8-ä¸‹ä¸€æ­¥)
  - [9. å‚è€ƒèµ„æ–™](#9-å‚è€ƒèµ„æ–™)
    - [9.1 å®˜æ–¹æ–‡æ¡£](#91-å®˜æ–¹æ–‡æ¡£)
    - [9.2 å®‰è£…æŒ‡å—](#92-å®‰è£…æŒ‡å—)
    - [9.3 ç›¸å…³èµ„æº](#93-ç›¸å…³èµ„æº)

---

## 1. æ¦‚è¿°

### 1.1 æŒ‡å—ç›®æ ‡

**æ ¸å¿ƒç›®æ ‡**:

æœ¬æŒ‡å—å¸®åŠ©æ‚¨å¿«é€Ÿæ­å»º PostgreSQL AI æ—¶ä»£çš„å®Œæ•´å¼€å‘ç¯å¢ƒï¼ŒåŒ…æ‹¬
PostgreSQLã€pgvectorã€TimescaleDBã€Apache AGE ç­‰æ‰©å±•ã€‚

**å­¦ä¹ ç›®æ ‡**:

1. **ç¯å¢ƒæ­å»º**: å­¦ä¼šå®‰è£…å’Œé…ç½® PostgreSQL åŠå…¶æ‰©å±•
2. **å¼€å‘ç¯å¢ƒ**: é…ç½® Python æˆ– Node.js å¼€å‘ç¯å¢ƒ
3. **åŠŸèƒ½éªŒè¯**: éªŒè¯æ‰€æœ‰æ‰©å±•æ˜¯å¦æ­£ç¡®å®‰è£…å’Œé…ç½®
4. **é—®é¢˜æ’æŸ¥**: æŒæ¡å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ³•

**æ—¶é—´è§„åˆ’**:

| é˜¶æ®µ            | æ—¶é—´        | å†…å®¹                              |
| --------------- | ----------- | --------------------------------- |
| **Docker å®‰è£…** | 5 åˆ†é’Ÿ      | Docker å®‰è£…ã€å®¹å™¨å¯åŠ¨             |
| **æ‰©å±•å®‰è£…**    | 10 åˆ†é’Ÿ     | pgvectorã€TimescaleDBã€Apache AGE |
| **å¼€å‘ç¯å¢ƒ**    | 5 åˆ†é’Ÿ      | Python/Node.js ç¯å¢ƒé…ç½®           |
| **éªŒè¯æµ‹è¯•**    | 5 åˆ†é’Ÿ      | åŠŸèƒ½éªŒè¯å’Œæµ‹è¯•                    |
| **æ€»è®¡**        | **25 åˆ†é’Ÿ** | å®Œæˆå®Œæ•´ç¯å¢ƒæ­å»º                  |

### 1.2 ç¯å¢ƒè¦æ±‚

**ç³»ç»Ÿè¦æ±‚**:

| èµ„æº         | æœ€ä½è¦æ±‚            | æ¨èé…ç½®      |
| ------------ | ------------------- | ------------- |
| **æ“ä½œç³»ç»Ÿ** | Linux/macOS/Windows | Linux/macOS   |
| **å†…å­˜**     | 8GB RAM             | 16GB RAM      |
| **ç£ç›˜**     | 20GB å¯ç”¨ç©ºé—´       | 50GB å¯ç”¨ç©ºé—´ |
| **CPU**      | 2 æ ¸å¿ƒ              | 4+ æ ¸å¿ƒ       |

**è½¯ä»¶è¦æ±‚**:

1. **Docker Desktop**: >= 20.10ï¼ˆæ¨èæ–¹å¼ï¼‰
2. **PostgreSQL**: >= 15ï¼ˆæœ¬åœ°å®‰è£…ï¼‰
3. **Python**: >= 3.8ï¼ˆPython å¼€å‘ï¼‰
4. **Node.js**: >= 16ï¼ˆNode.js å¼€å‘ï¼‰

### 1.3 æŠ€æœ¯æ ˆ

**æ ¸å¿ƒæŠ€æœ¯æ ˆ**:

1. **PostgreSQL**: ä¸»æ•°æ®åº“ï¼ˆç‰ˆæœ¬ >= 15ï¼‰
2. **pgvector**: å‘é‡æœç´¢æ‰©å±•ï¼ˆç‰ˆæœ¬ >= 0.5.0ï¼‰
3. **TimescaleDB**: æ—¶åºæ•°æ®æ‰©å±•ï¼ˆç‰ˆæœ¬ >= 2.10ï¼‰
4. **Apache AGE**: å›¾æ•°æ®åº“æ‰©å±•ï¼ˆç‰ˆæœ¬ >= 1.3.0ï¼‰

**å¼€å‘å·¥å…·**:

1. **Python**: psycopg2-binary, pgvector, openai, langchain
2. **Node.js**: pg, @supabase/supabase-js, openai
3. **å…¶ä»–**: Docker, Git, æ–‡æœ¬ç¼–è¾‘å™¨

## 2. å‰ç½®è¦æ±‚

### 2.1 ç³»ç»Ÿè¦æ±‚

**æ“ä½œç³»ç»Ÿæ”¯æŒ**:

1. **Linux**: Ubuntu 20.04+, Debian 11+, CentOS 8+
2. **macOS**: macOS 11+ (Big Sur)
3. **Windows**: Windows 10/11ï¼ˆæ¨èä½¿ç”¨ WSL2ï¼‰

**èµ„æºè¦æ±‚è¯¦è§£**:

| èµ„æºé¡¹   | æœ€ä½è¦æ±‚ | æ¨èé…ç½® | è¯´æ˜                       |
| -------- | -------- | -------- | -------------------------- |
| **å†…å­˜** | 8GB      | 16GB     | ç”¨äºè¿è¡Œ PostgreSQL å’Œæ‰©å±• |
| **ç£ç›˜** | 20GB     | 50GB     | æ•°æ®åº“æ–‡ä»¶å’Œç´¢å¼•           |
| **CPU**  | 2 æ ¸å¿ƒ   | 4+ æ ¸å¿ƒ  | å‘é‡è®¡ç®—å’ŒæŸ¥è¯¢ä¼˜åŒ–         |
| **ç½‘ç»œ** | 10 Mbps  | 100 Mbps | ä¸‹è½½æ‰©å±•å’Œä¾èµ–             |

### 2.2 è½¯ä»¶è¦æ±‚

**å¿…éœ€è½¯ä»¶**:

1. **Docker Desktop** (æ¨è):

   - ç‰ˆæœ¬: >= 20.10
   - ä¸‹è½½: <https://www.docker.com/products/docker-desktop>
   - ç”¨é€”: å®¹å™¨åŒ–éƒ¨ç½²ï¼Œç®€åŒ–å®‰è£…æµç¨‹

2. **PostgreSQL** (æœ¬åœ°å®‰è£…):

   - ç‰ˆæœ¬: >= 15
   - ä¸‹è½½: <https://www.postgresql.org/download/>
   - ç”¨é€”: ä¸»æ•°æ®åº“

3. **Git**:
   - ç‰ˆæœ¬: >= 2.30
   - ä¸‹è½½: <https://git-scm.com/downloads>
   - ç”¨é€”: å…‹éš†æ‰©å±•æºç 

**å¯é€‰è½¯ä»¶**:

1. **Python**: >= 3.8ï¼ˆPython å¼€å‘ï¼‰
2. **Node.js**: >= 16ï¼ˆNode.js å¼€å‘ï¼‰
3. **psql**: PostgreSQL å®¢æˆ·ç«¯ï¼ˆé€šå¸¸éš PostgreSQL å®‰è£…ï¼‰

### 2.3 ç½‘ç»œè¦æ±‚

**ç½‘ç»œè®¿é—®è¦æ±‚**:

1. **GitHub**: è®¿é—® GitHub ä»“åº“ï¼ˆæ‰©å±•æºç ï¼‰
2. **åŒ…ç®¡ç†å™¨**: è®¿é—®åŒ…ç®¡ç†å™¨ï¼ˆapt, brew, npm, pipï¼‰
3. **Docker Hub**: è®¿é—® Docker Hubï¼ˆé•œåƒä¸‹è½½ï¼‰

**ç½‘ç»œé…ç½®**:

å¦‚æœä½¿ç”¨ä»£ç†ï¼Œéœ€è¦é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```bash
# HTTP ä»£ç†
export HTTP_PROXY=http://proxy.example.com:8080
export HTTPS_PROXY=http://proxy.example.com:8080

# Docker ä»£ç†é…ç½®
mkdir -p ~/.docker
cat > ~/.docker/config.json <<EOF
{
  "proxies": {
    "default": {
      "httpProxy": "http://proxy.example.com:8080",
      "httpsProxy": "http://proxy.example.com:8080"
    }
  }
}
EOF
```

## 3. å¿«é€Ÿå®‰è£…

### 3.1 Docker å®‰è£…ï¼ˆæ¨èï¼‰

#### 3.1.1 å®‰è£…æ­¥éª¤

**Docker å®‰è£…æ­¥éª¤**:

ä½¿ç”¨ Docker æ˜¯æœ€ç®€å•å¿«æ·çš„å®‰è£…æ–¹å¼ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–è¯‘å’Œé…ç½®ã€‚

**æ­¥éª¤ 1: æ‹‰å–é•œåƒ**:

```bash
# æ‹‰å– PostgreSQL + pgvector é•œåƒ
docker pull pgvector/pgvector:pg16

# éªŒè¯é•œåƒ
docker images | grep pgvector
```

**æ­¥éª¤ 2: å¯åŠ¨å®¹å™¨**:

```bash
# å¯åŠ¨ PostgreSQL + pgvector å®¹å™¨
docker run -d \
  --name postgres-ai \
  -e POSTGRES_PASSWORD=postgres \
  -e POSTGRES_DB=ai_demo \
  -p 5432:5432 \
  -v pgvector_data:/var/lib/postgresql/data \
  pgvector/pgvector:pg16

# å‚æ•°è¯´æ˜ï¼š
# --name: å®¹å™¨åç§°
# -e POSTGRES_PASSWORD: æ•°æ®åº“å¯†ç 
# -e POSTGRES_DB: é»˜è®¤æ•°æ®åº“
# -p: ç«¯å£æ˜ å°„ï¼ˆä¸»æœº:å®¹å™¨ï¼‰
# -v: æ•°æ®å·æŒ‚è½½ï¼ˆæŒä¹…åŒ–æ•°æ®ï¼‰
```

**æ­¥éª¤ 3: éªŒè¯å®¹å™¨çŠ¶æ€**:

```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps | grep postgres-ai

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs postgres-ai

# é¢„æœŸè¾“å‡ºï¼šæ•°æ®åº“å¯åŠ¨æˆåŠŸ
```

**æ­¥éª¤ 4: è¿æ¥åˆ°æ•°æ®åº“**:

```bash
# è¿æ¥åˆ°æ•°æ®åº“
docker exec -it postgres-ai psql -U postgres -d ai_demo

# éªŒè¯è¿æ¥
SELECT version();
```

#### 3.1.2 éªŒè¯å®‰è£…

**éªŒè¯ pgvector æ‰©å±•**:

```sql
-- è¿æ¥åˆ°æ•°æ®åº“
\c ai_demo

-- æ£€æŸ¥ pgvector æ˜¯å¦å¯ç”¨
SELECT * FROM pg_available_extensions WHERE name = 'vector';

-- å¯ç”¨ pgvector æ‰©å±•
CREATE EXTENSION IF NOT EXISTS vector;

-- éªŒè¯æ‰©å±•å®‰è£…
SELECT * FROM pg_extension WHERE extname = 'vector';

-- é¢„æœŸè¾“å‡ºï¼š
-- extname | extversion | nspname | extrelocatable | extconfig
-- ---------+------------+---------+----------------+----------
-- vector  | 0.5.1      | public  | t              |
```

**éªŒè¯å‘é‡åŠŸèƒ½**:

```sql
-- åˆ›å»ºæµ‹è¯•è¡¨
CREATE TABLE test_vectors (
    id SERIAL PRIMARY KEY,
    embedding vector(3)
);

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO test_vectors (embedding) VALUES
    ('[1,2,3]'::vector),
    ('[4,5,6]'::vector);

-- æµ‹è¯•å‘é‡æœç´¢
SELECT id, embedding <=> '[1,2,3]'::vector as distance
FROM test_vectors
ORDER BY distance;

-- é¢„æœŸè¾“å‡ºï¼šè·ç¦»è®¡ç®—æ­£å¸¸
```

#### 3.1.3 å¸¸è§é—®é¢˜

**é—®é¢˜ 1: å®¹å™¨å¯åŠ¨å¤±è´¥**:

```bash
# æ£€æŸ¥é”™è¯¯æ—¥å¿—
docker logs postgres-ai

# å¸¸è§åŸå› ï¼šç«¯å£è¢«å ç”¨
# è§£å†³æ–¹æ¡ˆï¼šæ›´æ”¹ç«¯å£æ˜ å°„
docker run -d \
  --name postgres-ai \
  -p 5433:5432 \  # æ›´æ”¹ä¸»æœºç«¯å£
  pgvector/pgvector:pg16
```

**é—®é¢˜ 2: æ•°æ®å·æƒé™é—®é¢˜**:

```bash
# æ£€æŸ¥æ•°æ®å·æƒé™
docker volume inspect pgvector_data

# è§£å†³æ–¹æ¡ˆï¼šé‡æ–°åˆ›å»ºæ•°æ®å·
docker volume rm pgvector_data
docker run -d \
  --name postgres-ai \
  -v pgvector_data:/var/lib/postgresql/data \
  pgvector/pgvector:pg16
```

### 3.2 æœ¬åœ°å®‰è£…

#### 3.2.1 Ubuntu/Debian å®‰è£…

**Ubuntu/Debian å®‰è£…æ­¥éª¤**:

**æ­¥éª¤ 1: æ·»åŠ  PostgreSQL å®˜æ–¹ä»“åº“**:

```bash
# æ·»åŠ  PostgreSQL å®˜æ–¹ä»“åº“
sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'

# æ·»åŠ  GPG å¯†é’¥
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -

# æ›´æ–°åŒ…åˆ—è¡¨
sudo apt-get update
```

**æ­¥éª¤ 2: å®‰è£… PostgreSQL 18**:

```bash
# å®‰è£… PostgreSQL 18
sudo apt-get install -y postgresql-18 postgresql-18-dev

# å¯åŠ¨ PostgreSQL æœåŠ¡
sudo systemctl start postgresql
sudo systemctl enable postgresql

# éªŒè¯å®‰è£…
psql --version
```

**æ­¥éª¤ 3: å®‰è£… pgvector**:

```bash
# æ–¹æ³• 1: ä½¿ç”¨ apt å®‰è£…ï¼ˆå¦‚æœå¯ç”¨ï¼‰
sudo apt-get install -y postgresql-18-pgvector

# æ–¹æ³• 2: ä»æºç å®‰è£…
git clone --branch v0.5.1 https://github.com/pgvector/pgvector.git
cd pgvector
make
sudo make install
```

**æ­¥éª¤ 4: å®‰è£… TimescaleDB**:

```bash
# æ·»åŠ  TimescaleDB ä»“åº“
sudo sh -c "echo 'deb https://packagecloud.io/timescale/timescaledb/ubuntu/ $(lsb_release -c -s) main' > /etc/apt/sources.list.d/timescaledb.list"

# æ·»åŠ  GPG å¯†é’¥
wget --quiet -O - https://packagecloud.io/timescale/timescaledb/gpgkey | sudo apt-key add -

# æ›´æ–°åŒ…åˆ—è¡¨
sudo apt-get update

# å®‰è£… TimescaleDB
sudo apt-get install -y timescaledb-2-postgresql-18

# é…ç½® TimescaleDB
sudo timescaledb-tune --quiet --yes

# é‡å¯ PostgreSQL
sudo systemctl restart postgresql
```

#### 3.2.2 macOS å®‰è£…

**macOS å®‰è£…æ­¥éª¤**:

**æ­¥éª¤ 1: å®‰è£… Homebrew**:

```bash
# å¦‚æœæ²¡æœ‰å®‰è£… Homebrew
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

**æ­¥éª¤ 2: å®‰è£… PostgreSQL**:

```bash
# å®‰è£… PostgreSQL 18
brew install postgresql@18

# å¯åŠ¨ PostgreSQL æœåŠ¡
brew services start postgresql@18

# æ·»åŠ åˆ° PATHï¼ˆå¯é€‰ï¼‰
echo 'export PATH="/opt/homebrew/opt/postgresql@18/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

**æ­¥éª¤ 3: å®‰è£… pgvector**:

```bash
# å®‰è£… pgvector
brew install pgvector

# éªŒè¯å®‰è£…
psql -U postgres -c "CREATE EXTENSION vector;"
```

**æ­¥éª¤ 4: å®‰è£… TimescaleDB**:

```bash
# æ·»åŠ  TimescaleDB tap
brew tap timescale/tap

# å®‰è£… TimescaleDB
brew install timescaledb

# é…ç½® TimescaleDB
timescaledb-tune
```

#### 3.2.3 Windows å®‰è£…

**Windows å®‰è£…æ­¥éª¤**:

**æ¨èä½¿ç”¨ WSL2**:

```bash
# 1. å®‰è£… WSL2
wsl --install

# 2. åœ¨ WSL2 ä¸­å®‰è£… PostgreSQLï¼ˆå‚è€ƒ Ubuntu å®‰è£…æ­¥éª¤ï¼‰
# 3. æˆ–è€…ä½¿ç”¨ Docker Desktopï¼ˆæ¨èï¼‰
```

**æœ¬åœ°å®‰è£… PostgreSQL**:

1. ä¸‹è½½ PostgreSQL å®‰è£…ç¨‹åº: <https://www.postgresql.org/download/windows/>
2. è¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰æ‹© PostgreSQL 18
3. å®‰è£…å®Œæˆåï¼Œä½¿ç”¨ pgAdmin æˆ– psql è¿æ¥

**æ³¨æ„**: Windows æœ¬åœ°å®‰è£…å¯èƒ½éœ€è¦æ‰‹åŠ¨ç¼–è¯‘æ‰©å±•ï¼Œå»ºè®®ä½¿ç”¨ Docker æˆ– WSL2ã€‚

## 4. æ‰©å±•å®‰è£…

### 4.1 pgvector å®‰è£…

#### 4.1.1 å®‰è£…æ­¥éª¤

**å¯ç”¨ pgvector æ‰©å±•**:

```sql
-- è¿æ¥åˆ°æ•°æ®åº“
\c ai_demo

-- å¯ç”¨ pgvector æ‰©å±•
CREATE EXTENSION IF NOT EXISTS vector;

-- éªŒè¯å®‰è£…
SELECT extname, extversion
FROM pg_extension
WHERE extname = 'vector';

-- é¢„æœŸè¾“å‡ºï¼š
-- extname | extversion
-- ---------+------------
-- vector  | 0.5.1
```

**æµ‹è¯•å‘é‡åŠŸèƒ½**:

```sql
-- åˆ›å»ºæµ‹è¯•è¡¨
CREATE TABLE test_vectors (
    id SERIAL PRIMARY KEY,
    embedding vector(1536)  -- OpenAI å‘é‡ç»´åº¦
);

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO test_vectors (embedding) VALUES
    ('[0.1, 0.2, 0.3]'::vector(1536));  -- ç¤ºä¾‹å‘é‡

-- åˆ›å»ºç´¢å¼•
CREATE INDEX test_vectors_idx ON test_vectors
USING hnsw (embedding vector_cosine_ops);

-- æµ‹è¯•å‘é‡æœç´¢
SELECT id, embedding <=> '[0.1, 0.2, 0.3]'::vector(1536) as distance
FROM test_vectors
ORDER BY distance
LIMIT 5;
```

#### 4.1.2 éªŒè¯å®‰è£…

**åŠŸèƒ½éªŒè¯**:

```sql
-- 1. éªŒè¯å‘é‡æ•°æ®ç±»å‹
SELECT '[1,2,3]'::vector;

-- 2. éªŒè¯è·ç¦»è®¡ç®—
SELECT '[1,2,3]'::vector <=> '[4,5,6]'::vector as cosine_distance;

-- 3. éªŒè¯ç´¢å¼•ç±»å‹
SELECT indexname, indexdef
FROM pg_indexes
WHERE tablename = 'test_vectors';

-- é¢„æœŸè¾“å‡ºï¼šHNSW æˆ– IVFFlat ç´¢å¼•
```

### 4.2 TimescaleDB å®‰è£…

#### 4.2.1 å®‰è£…æ­¥éª¤

**å¯ç”¨ TimescaleDB æ‰©å±•**:

```sql
-- è¿æ¥åˆ°æ•°æ®åº“
\c ai_demo

-- å¯ç”¨ TimescaleDB æ‰©å±•
CREATE EXTENSION IF NOT EXISTS timescaledb;

-- éªŒè¯å®‰è£…
SELECT default_version, installed_version
FROM pg_available_extensions
WHERE name = 'timescaledb';

-- é¢„æœŸè¾“å‡ºï¼š
-- default_version | installed_version
-- ----------------+------------------
-- 2.11.0          | 2.11.0
```

**åˆ›å»ºè¶…è¡¨ï¼ˆHypertableï¼‰**:

```sql
-- åˆ›å»ºæ—¶åºè¡¨
CREATE TABLE test_metrics (
    time TIMESTAMPTZ NOT NULL,
    device_id TEXT,
    value NUMERIC
);

-- è½¬æ¢ä¸ºè¶…è¡¨
SELECT create_hypertable('test_metrics', 'time');

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO test_metrics VALUES
    (NOW(), 'device1', 100),
    (NOW() - INTERVAL '1 hour', 'device1', 200);

-- æŸ¥è¯¢æ•°æ®
SELECT * FROM test_metrics
ORDER BY time DESC;
```

#### 4.2.2 é…ç½®ä¼˜åŒ–

**TimescaleDB é…ç½®ä¼˜åŒ–**:

```bash
# è¿è¡Œé…ç½®å·¥å…·
sudo timescaledb-tune --quiet --yes

# æ‰‹åŠ¨é…ç½®ï¼ˆå¯é€‰ï¼‰
# ç¼–è¾‘ postgresql.conf
shared_preload_libraries = 'timescaledb'
```

**æ€§èƒ½ä¼˜åŒ–**:

```sql
-- é…ç½®å‹ç¼©ç­–ç•¥
ALTER TABLE test_metrics SET (
    timescaledb.compress,
    timescaledb.compress_segmentby = 'device_id'
);

-- å¯ç”¨è‡ªåŠ¨å‹ç¼©ï¼ˆä¿ç•™ç­–ç•¥ï¼‰
SELECT add_compression_policy('test_metrics', INTERVAL '7 days');
```

### 4.3 Apache AGE å®‰è£…

#### 4.3.1 å®‰è£…æ­¥éª¤

**ä»æºç å®‰è£… Apache AGE**:

```bash
# å…‹éš† AGE ä»“åº“
git clone https://github.com/apache/age.git
cd age

# å®‰è£…ä¾èµ–ï¼ˆUbuntu/Debianï¼‰
sudo apt-get install -y build-essential libreadline-dev zlib1g-dev

# ç¼–è¯‘å®‰è£…
make install

# éªŒè¯å®‰è£…
psql -U postgres -d ai_demo -c "LOAD 'age';"
```

**åœ¨ PostgreSQL ä¸­å¯ç”¨ AGE**:

```sql
-- è¿æ¥åˆ°æ•°æ®åº“
\c ai_demo

-- åŠ è½½ AGE
LOAD 'age';

-- è®¾ç½®æœç´¢è·¯å¾„
SET search_path = ag_catalog, "$user", public;

-- éªŒè¯å®‰è£…
SELECT * FROM ag_catalog.ag_graph;

-- é¢„æœŸè¾“å‡ºï¼šç©ºè¡¨ï¼ˆæ–°å®‰è£…ï¼‰
```

#### 4.3.2 éªŒè¯å®‰è£…

**åˆ›å»ºæµ‹è¯•å›¾**:

```sql
-- åˆ›å»ºå›¾
SELECT * FROM ag_catalog.create_graph('test_graph');

-- åˆ›å»ºèŠ‚ç‚¹
SELECT * FROM ag_catalog.create_vlabel('test_graph', 'Person');
SELECT * FROM ag_catalog.create_vlabel('test_graph', 'Company');

-- åˆ›å»ºè¾¹
SELECT * FROM ag_catalog.create_elabel('test_graph', 'WORKS_FOR');

-- æ’å…¥èŠ‚ç‚¹
SELECT * FROM cypher('test_graph', $$
    CREATE (p:Person {name: 'Alice', age: 30}),
           (c:Company {name: 'Acme Corp'})
$$) AS (result agtype);

-- åˆ›å»ºå…³ç³»
SELECT * FROM cypher('test_graph', $$
    MATCH (p:Person {name: 'Alice'}), (c:Company {name: 'Acme Corp'})
    CREATE (p)-[:WORKS_FOR]->(c)
    RETURN p, c
$$) AS (result agtype);
```

### 4.4 å…¶ä»–æ‰©å±•å®‰è£…

**å®‰è£…å…¶ä»–å¸¸ç”¨æ‰©å±•**:

```sql
-- è¿æ¥åˆ°æ•°æ®åº“
\c ai_demo

-- UUID ç”Ÿæˆ
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- æ–‡æœ¬ç›¸ä¼¼åº¦
CREATE EXTENSION IF NOT EXISTS pg_trgm;

-- æ€§èƒ½ç›‘æ§
CREATE EXTENSION IF NOT EXISTS pg_stat_statements;

-- éªŒè¯å®‰è£…
SELECT extname, extversion
FROM pg_extension
WHERE extname IN ('uuid-ossp', 'pg_trgm', 'pg_stat_statements');

-- é¢„æœŸè¾“å‡ºï¼šä¸‰ä¸ªæ‰©å±•åŠå…¶ç‰ˆæœ¬
```

## 5. å¼€å‘ç¯å¢ƒé…ç½®

### 5.1 Python ç¯å¢ƒ

#### 5.1.1 ç¯å¢ƒé…ç½®

**åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒ**:

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆLinux/macOSï¼‰
source venv/bin/activate

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆWindowsï¼‰
venv\Scripts\activate

# éªŒè¯æ¿€æ´»
which python  # Linux/macOS
# æˆ–
where python  # Windows
```

#### 5.1.2 ä¾èµ–å®‰è£…

**å®‰è£… Python ä¾èµ–**:

```bash
# å®‰è£…åŸºç¡€ä¾èµ–
pip install psycopg2-binary pgvector openai langchain

# å®‰è£…å¼€å‘ä¾èµ–ï¼ˆå¯é€‰ï¼‰
pip install jupyter ipython pytest black flake8

# éªŒè¯å®‰è£…
python -c "import psycopg2; print('psycopg2 installed')"
python -c "import pgvector; print('pgvector installed')"
python -c "import openai; print('openai installed')"
```

**ä¾èµ–ç‰ˆæœ¬è¦æ±‚**:

| åŒ…å              | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜                 |
| ----------------- | -------- | -------------------- |
| `psycopg2-binary` | >= 2.9.0 | PostgreSQL é©±åŠ¨      |
| `pgvector`        | >= 0.2.0 | pgvector Python æ”¯æŒ |
| `openai`          | >= 1.0.0 | OpenAI API å®¢æˆ·ç«¯    |
| `langchain`       | >= 0.1.0 | LangChain é›†æˆ       |

### 5.2 Node.js ç¯å¢ƒ

#### 5.2.1 ç¯å¢ƒé…ç½®

**åˆ›å»º Node.js é¡¹ç›®**:

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir vector-search-demo
cd vector-search-demo

# åˆå§‹åŒ–é¡¹ç›®
npm init -y

# åˆ›å»º .gitignore
echo "node_modules/
.env
*.log" > .gitignore
```

#### 5.2.2 ä¾èµ–å®‰è£…

**å®‰è£… Node.js ä¾èµ–**:

```bash
# å®‰è£…åŸºç¡€ä¾èµ–
npm install pg @supabase/supabase-js openai

# å®‰è£…å¼€å‘ä¾èµ–ï¼ˆå¯é€‰ï¼‰
npm install --save-dev typescript @types/node @types/pg

# éªŒè¯å®‰è£…
node -e "console.log(require('pg').version)"
node -e "console.log(require('openai').version)"
```

**ä¾èµ–ç‰ˆæœ¬è¦æ±‚**:

| åŒ…å                    | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜              |
| ----------------------- | -------- | ----------------- |
| `pg`                    | >= 8.0.0 | PostgreSQL é©±åŠ¨   |
| `@supabase/supabase-js` | >= 2.0.0 | Supabase å®¢æˆ·ç«¯   |
| `openai`                | >= 4.0.0 | OpenAI API å®¢æˆ·ç«¯ |

### 5.3 ç¯å¢ƒå˜é‡é…ç½®

**åˆ›å»º `.env` æ–‡ä»¶**:

```bash
# .env æ–‡ä»¶
# PostgreSQL é…ç½®
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=ai_demo

# OpenAI é…ç½®
OPENAI_API_KEY=your_openai_api_key_here

# Supabase é…ç½®ï¼ˆå¯é€‰ï¼‰
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your_supabase_key
```

**åŠ è½½ç¯å¢ƒå˜é‡**:

**Python**:

```python
from dotenv import load_dotenv
import os

load_dotenv()

POSTGRES_HOST = os.getenv("POSTGRES_HOST")
POSTGRES_PORT = os.getenv("POSTGRES_PORT")
# ...
```

**Node.js**:

```javascript
require("dotenv").config();

const POSTGRES_HOST = process.env.POSTGRES_HOST;
const POSTGRES_PORT = process.env.POSTGRES_PORT;
// ...
```

## 6. éªŒè¯å®‰è£…

### 6.1 å®Œæ•´æµ‹è¯•è„šæœ¬

**å®Œæ•´æµ‹è¯•è„šæœ¬**:

```sql
-- test_setup.sql
-- 1. æµ‹è¯• pgvector
CREATE TABLE IF NOT EXISTS test_vectors (
    id SERIAL PRIMARY KEY,
    embedding vector(3)
);

INSERT INTO test_vectors (embedding) VALUES
    ('[1,2,3]'::vector),
    ('[4,5,6]'::vector)
ON CONFLICT DO NOTHING;

SELECT id, embedding <=> '[1,2,3]'::vector as distance
FROM test_vectors
ORDER BY distance;

-- 2. æµ‹è¯• TimescaleDB
CREATE TABLE IF NOT EXISTS test_metrics (
    time TIMESTAMPTZ NOT NULL,
    value NUMERIC
);

-- è½¬æ¢ä¸ºè¶…è¡¨ï¼ˆå¦‚æœè¿˜ä¸æ˜¯ï¼‰
SELECT create_hypertable('test_metrics', 'time', if_not_exists => true);

INSERT INTO test_metrics VALUES
    (NOW(), 100),
    (NOW() - INTERVAL '1 hour', 200)
ON CONFLICT DO NOTHING;

SELECT * FROM test_metrics
ORDER BY time DESC;

-- 3. æµ‹è¯•å…¨æ–‡æœç´¢
CREATE TABLE IF NOT EXISTS test_docs (
    id SERIAL PRIMARY KEY,
    content TEXT
);

CREATE INDEX IF NOT EXISTS test_docs_content_idx
ON test_docs
USING GIN (to_tsvector('english', content));

INSERT INTO test_docs (content) VALUES
    ('PostgreSQL is great'),
    ('AI database is the future')
ON CONFLICT DO NOTHING;

SELECT * FROM test_docs
WHERE to_tsvector('english', content) @@
      to_tsquery('english', 'PostgreSQL | AI');
```

**è¿è¡Œæµ‹è¯•**:

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
psql -U postgres -d ai_demo -f test_setup.sql

# é¢„æœŸè¾“å‡ºï¼šæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œæ²¡æœ‰é”™è¯¯
```

### 6.2 æµ‹è¯•ç»“æœéªŒè¯

**éªŒè¯æµ‹è¯•ç»“æœ**:

```sql
-- éªŒè¯ pgvector
SELECT COUNT(*) as vector_count FROM test_vectors;
-- é¢„æœŸï¼š2

-- éªŒè¯ TimescaleDB
SELECT COUNT(*) as metrics_count FROM test_metrics;
-- é¢„æœŸï¼š2

-- éªŒè¯å…¨æ–‡æœç´¢
SELECT COUNT(*) as docs_count FROM test_docs;
-- é¢„æœŸï¼š2
```

**åŠŸèƒ½éªŒè¯**:

```bash
# Python æµ‹è¯•
python -c "
import psycopg2
conn = psycopg2.connect('postgresql://postgres:postgres@localhost:5432/ai_demo')
cur = conn.cursor()
cur.execute('SELECT version()')
print('PostgreSQL:', cur.fetchone()[0])
conn.close()
print('âœ… Python è¿æ¥æˆåŠŸ')
"

# Node.js æµ‹è¯•
node -e "
const { Pool } = require('pg');
const pool = new Pool({
  host: 'localhost',
  port: 5432,
  user: 'postgres',
  password: 'postgres',
  database: 'ai_demo'
});
pool.query('SELECT version()', (err, res) => {
  if (err) throw err;
  console.log('PostgreSQL:', res.rows[0].version);
  console.log('âœ… Node.js è¿æ¥æˆåŠŸ');
  pool.end();
});
"
```

## 7. å¸¸è§é—®é¢˜

### 7.1 å®‰è£…é—®é¢˜

**é—®é¢˜ 1: pgvector å®‰è£…å¤±è´¥**:

**é”™è¯¯ä¿¡æ¯**:

```text
ERROR: could not open extension control file
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# ä»æºç å®‰è£…
git clone --branch v0.5.1 https://github.com/pgvector/pgvector.git
cd pgvector
make
sudo make install

# åœ¨ PostgreSQL ä¸­å¯ç”¨
psql -U postgres -d ai_demo -c "CREATE EXTENSION vector;"
```

**é—®é¢˜ 2: TimescaleDB é…ç½®é”™è¯¯**:

**é”™è¯¯ä¿¡æ¯**:

```text
ERROR: could not access file "$libdir/timescaledb-2.11"
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# é‡æ–°é…ç½® TimescaleDB
sudo timescaledb-tune --quiet --yes

# é‡å¯ PostgreSQL
sudo systemctl restart postgresql

# éªŒè¯é…ç½®
psql -U postgres -d ai_demo -c "SHOW shared_preload_libraries;"
```

### 7.2 é…ç½®é—®é¢˜

**é—®é¢˜ 1: æ‰©å±•æœªåŠ è½½**:

**é”™è¯¯ä¿¡æ¯**:

```text
ERROR: extension "vector" does not exist
```

**è§£å†³æ–¹æ¡ˆ**:

```sql
-- æ£€æŸ¥æ‰©å±•æ˜¯å¦å¯ç”¨
SELECT * FROM pg_available_extensions WHERE name = 'vector';

-- å¦‚æœæœªæ‰¾åˆ°ï¼Œæ£€æŸ¥å®‰è£…è·¯å¾„
SHOW sharedir;

-- æ‰‹åŠ¨æŒ‡å®šæ‰©å±•è·¯å¾„ï¼ˆå¦‚æœéœ€è¦ï¼‰
SET shared_preload_libraries = 'vector';
```

**é—®é¢˜ 2: æƒé™ä¸è¶³**:

**é”™è¯¯ä¿¡æ¯**:

```text
ERROR: permission denied to create extension
```

**è§£å†³æ–¹æ¡ˆ**:

```sql
-- ä½¿ç”¨ superuser æƒé™
sudo -u postgres psql -d ai_demo

-- æˆ–è€…æˆäºˆæƒé™
GRANT CREATE ON DATABASE ai_demo TO your_user;
```

### 7.3 æƒé™é—®é¢˜

**é—®é¢˜ 1: æ•°æ®åº“è¿æ¥å¤±è´¥**:

**é”™è¯¯ä¿¡æ¯**:

```text
FATAL: password authentication failed
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# é‡ç½® PostgreSQL å¯†ç 
sudo -u postgres psql

ALTER USER postgres PASSWORD 'new_password';

# æ›´æ–° .env æ–‡ä»¶ä¸­çš„å¯†ç 
```

**é—®é¢˜ 2: æ–‡ä»¶æƒé™é—®é¢˜**:

**é”™è¯¯ä¿¡æ¯**:

```text
ERROR: could not read file
```

**è§£å†³æ–¹æ¡ˆ**:

```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -l /usr/share/postgresql/18/extension/vector*

# ä¿®å¤æƒé™ï¼ˆå¦‚æœéœ€è¦ï¼‰
sudo chmod 644 /usr/share/postgresql/18/extension/vector*
sudo chown postgres:postgres /usr/share/postgresql/18/extension/vector*
```

## 8. ä¸‹ä¸€æ­¥

**ç»§ç»­å­¦ä¹ **:

1. **ç¬¬ä¸€ä¸ªå‘é‡æœç´¢åº”ç”¨**: æŸ¥çœ‹[ç¬¬ä¸€ä¸ªå‘é‡æœç´¢åº”ç”¨](./ç¬¬ä¸€ä¸ªå‘é‡æœç´¢åº”ç”¨.md)

   - ä½¿ç”¨ Python æˆ– Node.js æ„å»ºç¬¬ä¸€ä¸ªå‘é‡æœç´¢åº”ç”¨
   - å­¦ä¹ å‘é‡æ•°æ®æ’å…¥ã€æŸ¥è¯¢å’Œç´¢å¼•åˆ›å»º

2. **å¿«é€Ÿå¼€å§‹æŒ‡å—**: æŸ¥çœ‹[å¿«é€Ÿå¼€å§‹æŒ‡å—](../../01-å‘é‡ä¸æ··åˆæœç´¢/æœ€ä½³å®è·µ/å¿«é€Ÿå¼€å§‹æŒ‡å—.md)

   - 5 åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹ pgvector
   - å­¦ä¹ åŸºç¡€å‘é‡æœç´¢æ“ä½œ

3. **æ··åˆæœç´¢**: æŸ¥çœ‹[æ··åˆæœç´¢ RRF ç®—æ³•](../../01-å‘é‡ä¸æ··åˆæœç´¢/æŠ€æœ¯åŸç†/æ··åˆæœç´¢RRFç®—æ³•.md)
   - å‘é‡æœç´¢ + å…¨æ–‡æœç´¢
   - RRF èåˆç®—æ³•å®ç°

**è¿›é˜¶å­¦ä¹ **:

1. **æ¶æ„è®¾è®¡**: æŸ¥çœ‹[ä¼ä¸šçº§æ¶æ„è®¾è®¡](../../06-æ¶æ„è®¾è®¡/ç³»ç»Ÿæ¶æ„/ä¼ä¸šçº§æ¶æ„è®¾è®¡.md)
2. **è½åœ°æ¡ˆä¾‹**: æŸ¥çœ‹[å•†å“æ··åˆæœç´¢æ¡ˆä¾‹](../../08-è½åœ°æ¡ˆä¾‹/ç”µå•†åœºæ™¯/å•†å“æ··åˆæœç´¢æ¡ˆä¾‹.md)
3. **æ€§èƒ½ä¼˜åŒ–**: æŸ¥çœ‹[æ€§èƒ½è°ƒä¼˜æŠ€å·§](../../01-å‘é‡ä¸æ··åˆæœç´¢/æœ€ä½³å®è·µ/æ€§èƒ½è°ƒä¼˜æŠ€å·§.md)

## 9. å‚è€ƒèµ„æ–™

### 9.1 å®˜æ–¹æ–‡æ¡£

- [PostgreSQL å®˜æ–¹æ–‡æ¡£](https://www.postgresql.org/docs/) - PostgreSQL Documentation
- [pgvector GitHub](https://github.com/pgvector/pgvector) - pgvector Repository
- [TimescaleDB å®˜æ–¹æ–‡æ¡£](https://docs.timescale.com/) - TimescaleDB Documentation
- [Apache AGE å®˜æ–¹æ–‡æ¡£](https://age.apache.org/) - Apache AGE Documentation

### 9.2 å®‰è£…æŒ‡å—

- [PostgreSQL å®‰è£…æŒ‡å—](https://www.postgresql.org/download/) - Installation Guide
- [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/) - Docker Documentation
- [Homebrew å®˜æ–¹æ–‡æ¡£](https://brew.sh/) - Homebrew Documentation

### 9.3 ç›¸å…³èµ„æº

- [PostgreSQL AI ç”Ÿæ€ç³»ç»Ÿ](https://www.postgresql.org/docs/current/ai-ecosystem.html) - AI Ecosystem
- [å‘é‡æ•°æ®åº“å¯¹æ¯”](https://www.postgresql.org/docs/current/vector-database-comparison.html) - Vector
  Database Comparison

---

**æœ€åæ›´æ–°**: 2025 å¹´ 11 æœˆ 1 æ—¥  
**ç»´æŠ¤è€…**: PostgreSQL Modern Team  
**æ–‡æ¡£ç¼–å·**: 09-01-01
