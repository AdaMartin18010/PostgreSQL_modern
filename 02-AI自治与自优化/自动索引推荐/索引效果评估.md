# ç´¢å¼•æ•ˆæœè¯„ä¼°

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 11 æœˆ 1 æ—¥  
> **æŠ€æœ¯ç‰ˆæœ¬**: pg_autoindex 1.0  
> **æ–‡æ¡£ç¼–å·**: 02-03-03

## ğŸ“‘ ç›®å½•

- [ç´¢å¼•æ•ˆæœè¯„ä¼°](#ç´¢å¼•æ•ˆæœè¯„ä¼°)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
  - [2. è¯„ä¼°æŒ‡æ ‡](#2-è¯„ä¼°æŒ‡æ ‡)
    - [2.1 æ€§èƒ½æŒ‡æ ‡](#21-æ€§èƒ½æŒ‡æ ‡)
    - [2.2 æˆæœ¬æŒ‡æ ‡](#22-æˆæœ¬æŒ‡æ ‡)
  - [3. è¯„ä¼°æ–¹æ³•](#3-è¯„ä¼°æ–¹æ³•)
    - [3.1 A/B æµ‹è¯•](#31-ab-æµ‹è¯•)
    - [3.2 ä½¿ç”¨ç»Ÿè®¡](#32-ä½¿ç”¨ç»Ÿè®¡)
  - [4. è‡ªåŠ¨åŒ–è¯„ä¼°](#4-è‡ªåŠ¨åŒ–è¯„ä¼°)
  - [5. æœ€ä½³å®è·µ](#5-æœ€ä½³å®è·µ)
  - [6. å‚è€ƒèµ„æ–™](#6-å‚è€ƒèµ„æ–™)

---

## 1. æ¦‚è¿°

ç´¢å¼•æ•ˆæœè¯„ä¼°ç”¨äºè¡¡é‡ç´¢å¼•çš„å®é™…æ•ˆæœï¼ŒæŒ‡å¯¼ç´¢å¼•ä¼˜åŒ–å†³ç­–ã€‚

---

## 2. è¯„ä¼°æŒ‡æ ‡

### 2.1 æ€§èƒ½æŒ‡æ ‡

- **æŸ¥è¯¢å»¶è¿Ÿ**: ç´¢å¼•å¸¦æ¥çš„æŸ¥è¯¢æ€§èƒ½æå‡
- **I/O å‡å°‘**: ç´¢å¼•å‡å°‘çš„ç£ç›˜ I/O
- **CPU ä½¿ç”¨**: ç´¢å¼•å¯¹ CPU ä½¿ç”¨çš„å½±å“

### 2.2 æˆæœ¬æŒ‡æ ‡

- **å­˜å‚¨æˆæœ¬**: ç´¢å¼•å ç”¨çš„å­˜å‚¨ç©ºé—´
- **ç»´æŠ¤æˆæœ¬**: ç´¢å¼•æ›´æ–°å’Œç»´æŠ¤çš„å¼€é”€
- **å†™å…¥å½±å“**: ç´¢å¼•å¯¹å†™å…¥æ€§èƒ½çš„å½±å“

---

## 3. è¯„ä¼°æ–¹æ³•

### 3.1 A/B æµ‹è¯•

```sql
-- åˆ›å»ºæµ‹è¯•ç´¢å¼•
CREATE INDEX test_idx ON table_name (column_name);

-- æµ‹è¯•æŸ¥è¯¢æ€§èƒ½
EXPLAIN ANALYZE
SELECT * FROM table_name WHERE column_name = 'value';

-- åˆ é™¤æµ‹è¯•ç´¢å¼•
DROP INDEX test_idx;

-- å†æ¬¡æµ‹è¯•
EXPLAIN ANALYZE
SELECT * FROM table_name WHERE column_name = 'value';
```

### 3.2 ä½¿ç”¨ç»Ÿè®¡

```sql
-- æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨ç»Ÿè®¡
SELECT
    indexrelname,
    idx_scan,
    idx_tup_read,
    idx_tup_fetch
FROM pg_stat_user_indexes
WHERE schemaname = 'public'
ORDER BY idx_scan DESC;
```

---

## 4. è‡ªåŠ¨åŒ–è¯„ä¼°

```python
class IndexEffectivenessEvaluator:
    def evaluate(self, index_name):
        """è¯„ä¼°ç´¢å¼•æ•ˆæœ"""
        stats = self.get_index_stats(index_name)

        # è®¡ç®—ä½¿ç”¨ç‡
        usage_rate = stats['idx_scan'] / stats['total_queries']

        # è®¡ç®—æ€§èƒ½æå‡
        performance_gain = self.measure_performance_gain(index_name)

        # è®¡ç®—æˆæœ¬
        cost = self.calculate_cost(index_name)

        # ç»¼åˆè¯„ä¼°
        effectiveness = (performance_gain * usage_rate) / cost

        return {
            'usage_rate': usage_rate,
            'performance_gain': performance_gain,
            'cost': cost,
            'effectiveness': effectiveness
        }
```

---

## 5. æœ€ä½³å®è·µ

1. **å®šæœŸè¯„ä¼°**: æ¯æœˆè¯„ä¼°ä¸€æ¬¡ç´¢å¼•æ•ˆæœ
2. **å¤šç»´åº¦è¯„ä¼°**: ç»¼åˆè€ƒè™‘æ€§èƒ½å’Œæˆæœ¬
3. **æŒç»­ä¼˜åŒ–**: æ ¹æ®è¯„ä¼°ç»“æœæŒç»­ä¼˜åŒ–

---

## 6. å‚è€ƒèµ„æ–™

- [ç´¢å¼•æ¨èç®—æ³•](./ç´¢å¼•æ¨èç®—æ³•.md)
- [ç´¢å¼•ç»´æŠ¤ç­–ç•¥](./ç´¢å¼•ç»´æŠ¤ç­–ç•¥.md)

---

**æœ€åæ›´æ–°**: 2025 å¹´ 11 æœˆ 1 æ—¥  
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
