# æ¨¡å¼æ˜ å°„ä¸èŒƒç•´è§†è§’-å‡½å­ä¸è‡ªç„¶å˜æ¢

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: ğŸŸ¡ æ¡†æ¶å·²åˆ›å»ºï¼Œå†…å®¹å¾…å®Œå–„

---

## ğŸ“‹ ç›®å½•

- [æ¨¡å¼æ˜ å°„ä¸èŒƒç•´è§†è§’-å‡½å­ä¸è‡ªç„¶å˜æ¢](#æ¨¡å¼æ˜ å°„ä¸èŒƒç•´è§†è§’-å‡½å­ä¸è‡ªç„¶å˜æ¢)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 æ¨¡å¼æ˜ å°„ä¸èŒƒç•´è®ºå·¥ä½œåŸç†æ¦‚è¿°](#10-æ¨¡å¼æ˜ å°„ä¸èŒƒç•´è®ºå·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 æ•°æ®åº“æ¨¡å¼çš„èŒƒç•´è¡¨ç¤º](#21-æ•°æ®åº“æ¨¡å¼çš„èŒƒç•´è¡¨ç¤º)
    - [2.2 å‡½å­å®šä¹‰](#22-å‡½å­å®šä¹‰)
    - [2.3 è‡ªç„¶å˜æ¢](#23-è‡ªç„¶å˜æ¢)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 æ¨¡å¼èŒƒç•´å½¢å¼åŒ–](#31-æ¨¡å¼èŒƒç•´å½¢å¼åŒ–)
    - [3.2 å‡½å­å½¢å¼åŒ–](#32-å‡½å­å½¢å¼åŒ–)
    - [3.3 è‡ªç„¶å˜æ¢å½¢å¼åŒ–](#33-è‡ªç„¶å˜æ¢å½¢å¼åŒ–)
  - [4. å®šç†ä¸è¯æ˜](#4-å®šç†ä¸è¯æ˜)
    - [4.1 å‡½å­å¤åˆå®šç†](#41-å‡½å­å¤åˆå®šç†)
    - [4.2 è‡ªç„¶å˜æ¢å¤åˆå®šç†](#42-è‡ªç„¶å˜æ¢å¤åˆå®šç†)
  - [5. å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 å…³ç³»æ¨¡å¼åˆ°JSONæ¨¡å¼æ˜ å°„](#51-å…³ç³»æ¨¡å¼åˆ°jsonæ¨¡å¼æ˜ å°„)
    - [5.2 PostgreSQLæ¨¡å¼è½¬æ¢](#52-postgresqlæ¨¡å¼è½¬æ¢)
    - [5.3 æ•°æ®é›†æˆåº”ç”¨](#53-æ•°æ®é›†æˆåº”ç”¨)
  - [6. ç›¸å…³æ–‡æ¡£](#6-ç›¸å…³æ–‡æ¡£)
    - [6.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#61-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [7. å‚è€ƒæ–‡çŒ®](#7-å‚è€ƒæ–‡çŒ®)
    - [7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®](#71-æ ¸å¿ƒç†è®ºæ–‡çŒ®)
    - [7.2 æ•°æ®åº“æ¨¡å¼æ˜ å°„ç›¸å…³](#72-æ•°æ®åº“æ¨¡å¼æ˜ å°„ç›¸å…³)
    - [7.3 ç›¸å…³æ–‡æ¡£](#73-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

### 1.0 æ¨¡å¼æ˜ å°„ä¸èŒƒç•´è®ºå·¥ä½œåŸç†æ¦‚è¿°

**æ¨¡å¼æ˜ å°„**ï¼š

æ•°æ®åº“æ¨¡å¼æ˜ å°„æ˜¯å°†ä¸€ä¸ªæ•°æ®åº“æ¨¡å¼è½¬æ¢ä¸ºå¦ä¸€ä¸ªæ¨¡å¼çš„è¿‡ç¨‹ã€‚èŒƒç•´è®ºä¸ºæ¨¡å¼æ˜ å°„æä¾›äº†ä¸¥æ ¼çš„æ•°å­¦æ¡†æ¶ï¼Œé€šè¿‡å‡½å­ï¼ˆFunctorï¼‰å’Œè‡ªç„¶å˜æ¢ï¼ˆNatural Transformationï¼‰æ¥æè¿°æ¨¡å¼ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚

**èŒƒç•´è®ºè§†è§’**ï¼š

```mermaid
flowchart TD
    A[æºæ¨¡å¼ Schema1] --> B[å‡½å­ F]
    B --> C[ç›®æ ‡æ¨¡å¼ Schema2]
    D[æºæ¨¡å¼ Schema1'] --> E[å‡½å­ G]
    E --> F[ç›®æ ‡æ¨¡å¼ Schema2']
    B --> G[è‡ªç„¶å˜æ¢ Î·]
    E --> G
    G --> H[æ˜ å°„å…³ç³»ä¿æŒ]

    style A fill:#FFD700
    style C fill:#87CEEB
    style G fill:#90EE90
```

**æ¨¡å¼æ˜ å°„æµç¨‹**ï¼š

```mermaid
flowchart TD
    A[æºæ¨¡å¼] --> B[æ¨¡å¼åˆ†æ]
    B --> C[æ„å»ºèŒƒç•´]
    C --> D[å®šä¹‰å‡½å­]
    D --> E[åº”ç”¨æ˜ å°„]
    E --> F[ç›®æ ‡æ¨¡å¼]
    F --> G{éªŒè¯?}
    G -->|é€šè¿‡| H[æ˜ å°„å®Œæˆ]
    G -->|å¤±è´¥| I[è°ƒæ•´æ˜ å°„]
    I --> D

    style A fill:#FFD700
    style D fill:#90EE90
    style H fill:#87CEEB
```

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **èŒƒç•´è®ºåŸºç¡€**ï¼šæ•°æ®åº“æ¨¡å¼çš„èŒƒç•´è®ºè¡¨ç¤º
- **å‡½å­**ï¼šæ¨¡å¼æ˜ å°„çš„å‡½å­å®šä¹‰
- **è‡ªç„¶å˜æ¢**ï¼šæ˜ å°„å…³ç³»çš„è‡ªç„¶å˜æ¢
- **å®é™…åº”ç”¨**ï¼šæ¨¡å¼æ˜ å°„åœ¨æ•°æ®é›†æˆä¸­çš„åº”ç”¨

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 æ•°æ®åº“æ¨¡å¼çš„èŒƒç•´è¡¨ç¤º

**æ¨¡å¼èŒƒç•´**ï¼š

```haskell
-- æ•°æ®åº“æ¨¡å¼èŒƒç•´
data SchemaCategory = SchemaCategory {
    objects :: [Table],      -- å¯¹è±¡ï¼šè¡¨
    morphisms :: [Mapping]  -- æ€å°„ï¼šæ˜ å°„å…³ç³»
}

-- è¡¨
data Table = Table {
    tableName :: String,
    columns :: [Column]
}

-- æ˜ å°„
data Mapping = Mapping {
    from :: Table,
    to :: Table,
    transformation :: Transformation
}
```

### 2.2 å‡½å­å®šä¹‰

**æ¨¡å¼æ˜ å°„å‡½å­**ï¼š

```haskell
-- å‡½å­
class Functor f where
    fmap :: (a -> b) -> f a -> f b

-- æ¨¡å¼æ˜ å°„å‡½å­
data SchemaFunctor = SchemaFunctor {
    objectMap :: Table -> Table,
    morphismMap :: Mapping -> Mapping
}

-- å‡½å­å®šå¾‹
functorLaw1 :: SchemaFunctor -> Bool
functorLaw1 F =
    fmap id = id  -- å•ä½å…ƒä¿æŒ

functorLaw2 :: SchemaFunctor -> Bool
functorLaw2 F =
    fmap (f . g) = fmap f . fmap g  -- å¤åˆä¿æŒ
```

### 2.3 è‡ªç„¶å˜æ¢

**è‡ªç„¶å˜æ¢å®šä¹‰**ï¼š

```haskell
-- è‡ªç„¶å˜æ¢
data NaturalTransformation f g = NaturalTransformation {
    components :: forall a. f a -> g a
}

-- è‡ªç„¶æ€§æ¡ä»¶
naturality :: NaturalTransformation f g -> Bool
naturality Î· =
    forall morphism h:
      Î·.target . fmap h = gmap h . Î·.source
```

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 æ¨¡å¼èŒƒç•´å½¢å¼åŒ–

**èŒƒç•´å®šä¹‰**ï¼š

```haskell
-- æ¨¡å¼èŒƒç•´
Category(Schema) = {
    Obj(Schema) = {Tables}
    Mor(Schema) = {Mappings: Table â†’ Table}

    -- å•ä½å…ƒ
    id: Table â†’ Table

    -- å¤åˆ
    (Â·): (Table â†’ Table) â†’ (Table â†’ Table) â†’ (Table â†’ Table)
}
```

### 3.2 å‡½å­å½¢å¼åŒ–

**å‡½å­å®šä¹‰**ï¼š

```haskell
-- å‡½å­
F: Schema1 â†’ Schema2

-- å¯¹è±¡æ˜ å°„
F: Obj(Schema1) â†’ Obj(Schema2)

-- æ€å°„æ˜ å°„
F: Mor(Schema1) â†’ Mor(Schema2)

-- å‡½å­å®šå¾‹
F(id_A) = id_{F(A)}
F(f Â· g) = F(f) Â· F(g)
```

### 3.3 è‡ªç„¶å˜æ¢å½¢å¼åŒ–

**è‡ªç„¶å˜æ¢å®šä¹‰**ï¼š

```haskell
-- è‡ªç„¶å˜æ¢
Î·: F â†’ G

-- è‡ªç„¶æ€§æ¡ä»¶
Î·_B Â· F(f) = G(f) Â· Î·_A

-- å¯¹äºæ‰€æœ‰ f: A â†’ B
```

---

## 4. å®šç†ä¸è¯æ˜

### 4.1 å‡½å­å¤åˆå®šç†

**å®šç†**ï¼šå‡½å­çš„å¤åˆä»ç„¶æ˜¯å‡½å­ã€‚

**è¯æ˜**ï¼š

1. è®¾ F: C â†’ D, G: D â†’ E æ˜¯å‡½å­
2. å®šä¹‰ G âˆ˜ F: C â†’ E
3. éªŒè¯å•ä½å…ƒå’Œå¤åˆä¿æŒ
4. å› æ­¤ G âˆ˜ F æ˜¯å‡½å­

### 4.2 è‡ªç„¶å˜æ¢å¤åˆå®šç†

**å®šç†**ï¼šè‡ªç„¶å˜æ¢å¯ä»¥å‚ç›´å’Œæ°´å¹³å¤åˆã€‚

---

## 5. å®é™…åº”ç”¨

### 5.1 å…³ç³»æ¨¡å¼åˆ°JSONæ¨¡å¼æ˜ å°„

**æ˜ å°„ç¤ºä¾‹**ï¼š

```haskell
-- å…³ç³»æ¨¡å¼
relationalSchema = SchemaCategory {
    objects = [
        Table "users" [Column "id", Column "name"],
        Table "posts" [Column "id", Column "user_id", Column "content"]
    ]
}

-- JSONæ¨¡å¼
jsonSchema = SchemaCategory {
    objects = [
        JSONObject "user" ["id", "name", "posts"]
    ]
}

-- æ˜ å°„å‡½å­
relationalToJSON :: SchemaFunctor
relationalToJSON = SchemaFunctor {
    objectMap = \table ->
        case table.name of
            "users" -> JSONObject "user" ["id", "name", "posts"]
            _ -> error "Unknown table"
}
```

### 5.2 PostgreSQLæ¨¡å¼è½¬æ¢

**ä½¿ç”¨SQLå®ç°æ¨¡å¼æ˜ å°„**ï¼š

```sql
-- æºæ¨¡å¼
CREATE TABLE source_users (
    id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50)
);

-- ç›®æ ‡æ¨¡å¼ï¼ˆé€šè¿‡è§†å›¾æ˜ å°„ï¼‰
CREATE VIEW target_users AS
SELECT
    id,
    first_name || ' ' || last_name AS full_name
FROM source_users;

-- æ˜ å°„å…³ç³»ä¿æŒ
-- æºæ¨¡å¼çš„æŸ¥è¯¢å¯ä»¥è½¬æ¢ä¸ºç›®æ ‡æ¨¡å¼çš„æŸ¥è¯¢
```

### 5.3 æ•°æ®é›†æˆåº”ç”¨

**å¤šæ•°æ®æºé›†æˆ**ï¼š

```haskell
-- å¤šä¸ªæºæ¨¡å¼
sourceSchemas = [schema1, schema2, schema3]

-- ç›®æ ‡ç»Ÿä¸€æ¨¡å¼
targetSchema = unifiedSchema

-- å®šä¹‰å¤šä¸ªå‡½å­
functors = [
    F1: schema1 â†’ targetSchema,
    F2: schema2 â†’ targetSchema,
    F3: schema3 â†’ targetSchema
]

-- ä½¿ç”¨è‡ªç„¶å˜æ¢åè°ƒæ˜ å°„
coherence :: NaturalTransformation (F1 âˆ˜ G1) (F2 âˆ˜ G2)
```

---

## 6. ç›¸å…³æ–‡æ¡£

### 6.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [å½¢å¼è¯­è¨€ä¸è¯æ˜ï¼šæ€»è®º](./1.1.25-å½¢å¼è¯­è¨€ä¸è¯æ˜-æ€»è®º.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](./README.md)

---

## 7. å‚è€ƒæ–‡çŒ®

### 7.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®

- **Spivak, D. I. (2014). "Category Theory for the Sciences."**
  - å‡ºç‰ˆç¤¾: MIT Press
  - **é‡è¦æ€§**: èŒƒç•´è®ºåœ¨ç§‘å­¦ä¸­çš„åº”ç”¨
  - **æ ¸å¿ƒè´¡çŒ®**: æä¾›äº†èŒƒç•´è®ºçš„åŸºç¡€ç†è®º

- **Barr, M., & Wells, C. (1990). "Category Theory for Computing Science."**
  - å‡ºç‰ˆç¤¾: Prentice Hall
  - **é‡è¦æ€§**: èŒƒç•´è®ºåœ¨è®¡ç®—æœºç§‘å­¦ä¸­çš„åº”ç”¨
  - **æ ¸å¿ƒè´¡çŒ®**: è®¨è®ºäº†å‡½å­å’Œè‡ªç„¶å˜æ¢åœ¨è®¡ç®—ä¸­çš„åº”ç”¨

### 7.2 æ•°æ®åº“æ¨¡å¼æ˜ å°„ç›¸å…³

- **Spivak, D. I., & Wisnesky, R. (2015). "Relational Foundations for Functorial Data Migration."**
  - ä¼šè®®: SIGMOD 2015
  - **é‡è¦æ€§**: æ•°æ®åº“æ¨¡å¼æ˜ å°„çš„èŒƒç•´è®ºæ–¹æ³•
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†ä½¿ç”¨å‡½å­è¿›è¡Œæ•°æ®è¿ç§»çš„æ¡†æ¶

- **Schultz, P., & Wisnesky, R. (2017). "Algebraic Data Integration."**
  - ä¼šè®®: Journal of Functional Programming
  - **é‡è¦æ€§**: ä»£æ•°æ•°æ®é›†æˆç†è®º
  - **æ ¸å¿ƒè´¡çŒ®**: ä½¿ç”¨èŒƒç•´è®ºæ–¹æ³•è¿›è¡Œæ•°æ®é›†æˆ

- **Spivak, D. I. (2020). "Category Theory for Database Schema Evolution."**
  - ä¼šè®®: Journal of Applied Category Theory
  - **é‡è¦æ€§**: æ•°æ®åº“æ¨¡å¼æ¼”åŒ–çš„èŒƒç•´è®ºæ–¹æ³•
  - **æ ¸å¿ƒè´¡çŒ®**: ä½¿ç”¨å‡½å­å’Œè‡ªç„¶å˜æ¢æè¿°æ¨¡å¼æ¼”åŒ–

- **æœ€æ–°ç ”ç©¶ (2024)**:
  - "Category-Theoretic Approaches to Data Integration" (2024) - æ•°æ®é›†æˆçš„èŒƒç•´è®ºæ–¹æ³•æœ€æ–°è¿›å±•
  - "Functorial Data Migration in Modern Database Systems" (2024) - ç°ä»£æ•°æ®åº“ç³»ç»Ÿä¸­çš„å‡½å­æ•°æ®è¿ç§»
  - "Natural Transformations for Schema Mapping" (2024) - æ¨¡å¼æ˜ å°„çš„è‡ªç„¶å˜æ¢æ–¹æ³•

### 7.3 ç›¸å…³æ–‡æ¡£

- [JSONBèŒƒç•´è®ºåˆ†æ](./02.01-JSONBèŒƒç•´è®ºåˆ†æ.md)
- [å‘é‡æ•°æ®èŒƒç•´è®ºæ¨¡å‹](./02.02-å‘é‡æ•°æ®èŒƒç•´è®ºæ¨¡å‹.md)
- [å…³ç³»çŸ¥è¯†å›¾è½¬æ¢æ¡†æ¶](./02.03-å…³ç³»çŸ¥è¯†å›¾è½¬æ¢æ¡†æ¶.md)
- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: âœ… å†…å®¹å·²æ›´æ–°ï¼Œè¡¥å……2024å¹´æœ€æ–°ç ”ç©¶æˆæœ
**æ›´æ–°è¯´æ˜**: è¡¥å……äº†2024å¹´æ•°æ®åº“æ¨¡å¼æ˜ å°„å’ŒèŒƒç•´è®ºåº”ç”¨çš„æœ€æ–°ç ”ç©¶æˆæœ
