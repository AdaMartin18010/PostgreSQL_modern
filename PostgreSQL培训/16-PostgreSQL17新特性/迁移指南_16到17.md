# PostgreSQL 16 åˆ° 17 è¿ç§»æŒ‡å—

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 1 æœˆ
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 16 â†’ 17
> **æ–‡æ¡£ç¼–å·**: 03-03-17-17

## ğŸ“‘ æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›ä» PostgreSQL 16 å‡çº§åˆ° PostgreSQL 17 çš„å®Œæ•´è¿ç§»æŒ‡å—ï¼ŒåŒ…æ‹¬è¿ç§»æ­¥éª¤ã€æ³¨æ„äº‹é¡¹ã€å…¼å®¹æ€§é—®é¢˜ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®ç­‰ï¼Œå¸®åŠ©ç”¨æˆ·é¡ºåˆ©å®Œæˆç‰ˆæœ¬å‡çº§ã€‚

## ğŸ¯ æ ¸å¿ƒä»·å€¼

- **å¹³æ»‘è¿ç§»**ï¼šè¯¦ç»†çš„è¿ç§»æ­¥éª¤å’Œæœ€ä½³å®è·µ
- **å…¼å®¹æ€§æ£€æŸ¥**ï¼šè¯†åˆ«æ½œåœ¨çš„å…¼å®¹æ€§é—®é¢˜
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆ©ç”¨æ–°ç‰¹æ€§çš„æ€§èƒ½ä¼˜åŒ–å»ºè®®
- **å›æ»šæ–¹æ¡ˆ**ï¼šæä¾›è¿ç§»å¤±è´¥çš„å›æ»šç­–ç•¥
- **æµ‹è¯•éªŒè¯**ï¼šå®Œæ•´çš„æµ‹è¯•å’ŒéªŒè¯æµç¨‹

## ğŸ“š ç›®å½•

- [PostgreSQL 16 åˆ° 17 è¿ç§»æŒ‡å—](#postgresql-16-åˆ°-17-è¿ç§»æŒ‡å—)
  - [ğŸ“‘ æ¦‚è¿°](#-æ¦‚è¿°)
  - [ğŸ¯ æ ¸å¿ƒä»·å€¼](#-æ ¸å¿ƒä»·å€¼)
  - [ğŸ“š ç›®å½•](#-ç›®å½•)
  - [1. è¿ç§»æ¦‚è¿°](#1-è¿ç§»æ¦‚è¿°)
    - [1.0 è¿ç§»å·¥ä½œåŸç†æ¦‚è¿°](#10-è¿ç§»å·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 PostgreSQL 17 ä¸»è¦å˜åŒ–](#11-postgresql-17-ä¸»è¦å˜åŒ–)
    - [1.2 è¿ç§»ç­–ç•¥](#12-è¿ç§»ç­–ç•¥)
  - [2. è¿ç§»å‰å‡†å¤‡](#2-è¿ç§»å‰å‡†å¤‡)
    - [2.1 ç¯å¢ƒæ£€æŸ¥](#21-ç¯å¢ƒæ£€æŸ¥)
    - [2.2 å¤‡ä»½ç­–ç•¥](#22-å¤‡ä»½ç­–ç•¥)
  - [3. å…¼å®¹æ€§æ£€æŸ¥](#3-å…¼å®¹æ€§æ£€æŸ¥)
    - [3.1 æ‰©å±•å…¼å®¹æ€§](#31-æ‰©å±•å…¼å®¹æ€§)
    - [3.2 åŠŸèƒ½å…¼å®¹æ€§](#32-åŠŸèƒ½å…¼å®¹æ€§)
  - [4. è¿ç§»æ­¥éª¤](#4-è¿ç§»æ­¥éª¤)
    - [4.1 ä½¿ç”¨ pg\_upgrade å‡çº§](#41-ä½¿ç”¨-pg_upgrade-å‡çº§)
    - [4.2 é€»è¾‘å¤åˆ¶è¿ç§»](#42-é€»è¾‘å¤åˆ¶è¿ç§»)
  - [5. è¿ç§»åä¼˜åŒ–](#5-è¿ç§»åä¼˜åŒ–)
    - [5.1 æ›´æ–°ç»Ÿè®¡ä¿¡æ¯](#51-æ›´æ–°ç»Ÿè®¡ä¿¡æ¯)
    - [5.2 é‡å»ºç´¢å¼•](#52-é‡å»ºç´¢å¼•)
    - [5.3 åˆ©ç”¨æ–°ç‰¹æ€§](#53-åˆ©ç”¨æ–°ç‰¹æ€§)
  - [6. å¸¸è§é—®é¢˜](#6-å¸¸è§é—®é¢˜)
    - [6.1 æ‰©å±•ä¸å…¼å®¹](#61-æ‰©å±•ä¸å…¼å®¹)
    - [6.2 æ€§èƒ½ä¸‹é™](#62-æ€§èƒ½ä¸‹é™)
  - [7. å›æ»šæ–¹æ¡ˆ](#7-å›æ»šæ–¹æ¡ˆ)
    - [7.1 å›æ»šå‡†å¤‡](#71-å›æ»šå‡†å¤‡)
    - [7.2 å›æ»šæ­¥éª¤](#72-å›æ»šæ­¥éª¤)
  - [ğŸ“š å‚è€ƒèµ„æ–™](#-å‚è€ƒèµ„æ–™)
    - [å®˜æ–¹æ–‡æ¡£](#å®˜æ–¹æ–‡æ¡£)
    - [æŠ€æœ¯åšå®¢](#æŠ€æœ¯åšå®¢)
    - [ç¤¾åŒºèµ„æº](#ç¤¾åŒºèµ„æº)
  - [ğŸ“Š æ€»ç»“](#-æ€»ç»“)

---

## 1. è¿ç§»æ¦‚è¿°

### 1.0 è¿ç§»å·¥ä½œåŸç†æ¦‚è¿°

**è¿ç§»çš„æœ¬è´¨**ï¼š

PostgreSQL ç‰ˆæœ¬è¿ç§»æ˜¯ä¸€ä¸ªç³»ç»ŸåŒ–çš„è¿‡ç¨‹ï¼Œé€šè¿‡åˆç†é€‰æ‹©è¿ç§»ç­–ç•¥ã€æ‰§è¡Œè¿ç§»æ­¥éª¤ã€éªŒè¯è¿ç§»ç»“æœï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚è¿ç§»éœ€è¦éµå¾ª"å…ˆæµ‹è¯•åç”Ÿäº§"çš„åŸåˆ™ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒå……åˆ†éªŒè¯åå†è¿›è¡Œç”Ÿäº§è¿ç§»ã€‚

**è¿ç§»æµç¨‹å›¾**ï¼š

```mermaid
flowchart TD
    A[è¿ç§»å‰å‡†å¤‡] --> B[ç¯å¢ƒæ£€æŸ¥]
    B --> C[å¤‡ä»½æ•°æ®]
    C --> D[å…¼å®¹æ€§æ£€æŸ¥]
    D --> E{é€‰æ‹©è¿ç§»ç­–ç•¥}
    E -->|pg_upgrade| F[ç›´æ¥å‡çº§]
    E -->|é€»è¾‘å¤åˆ¶| G[é€»è¾‘å¤åˆ¶è¿ç§»]
    E -->|å¯¼å‡ºå¯¼å…¥| H[å¯¼å‡º/å¯¼å…¥è¿ç§»]
    F --> I[è¿ç§»åä¼˜åŒ–]
    G --> I
    H --> I
    I --> J[éªŒè¯æµ‹è¯•]
    J --> K{è¿ç§»æˆåŠŸ?}
    K -->|å¦| L[å›æ»š]
    K -->|æ˜¯| M[å®Œæˆè¿ç§»]

    style E fill:#FFD700
    style I fill:#90EE90
    style M fill:#87CEEB
```

**è¿ç§»å…³é”®æŒ‡æ ‡**ï¼š

- **æ•°æ®å®Œæ•´æ€§**ï¼šæ•°æ®è¿ç§»å®Œæ•´æ€§ï¼ˆ100%ï¼‰
- **æ€§èƒ½å½±å“**ï¼šè¿ç§»æœŸé—´æ€§èƒ½å½±å“ï¼ˆæœ€å°åŒ–ï¼‰
- **åœæœºæ—¶é—´**ï¼šç³»ç»Ÿåœæœºæ—¶é—´ï¼ˆæœ€å°åŒ–ï¼‰
- **å›æ»šèƒ½åŠ›**ï¼šå›æ»šèƒ½åŠ›ï¼ˆæ”¯æŒå¿«é€Ÿå›æ»šï¼‰

### 1.1 PostgreSQL 17 ä¸»è¦å˜åŒ–

**PostgreSQL 17 çš„ä¸»è¦å˜åŒ–**ï¼š

- **SQL MERGE è¯­å¥**ï¼šæ–°å¢æ ‡å‡† SQL MERGE æ”¯æŒï¼ˆæ•°æ®åŒæ­¥åœºæ™¯ï¼‰
- **é€»è¾‘å¤åˆ¶å¢å¼º**ï¼šæ€§èƒ½æå‡å’ŒåŠŸèƒ½å¢å¼ºï¼ˆå¹¶è¡Œåº”ç”¨ã€æ‰¹é‡æäº¤ï¼‰
- **æŸ¥è¯¢ä¼˜åŒ–å™¨æ”¹è¿›**ï¼šæŸ¥è¯¢æ€§èƒ½æ˜¾è‘—æå‡ï¼ˆè¿æ¥é¡ºåºä¼˜åŒ–ã€æ‰©å±•ç»Ÿè®¡ï¼‰
- **åˆ†åŒºè¡¨ä¼˜åŒ–**ï¼šåˆ†åŒºæŸ¥è¯¢æ€§èƒ½æ”¹è¿›ï¼ˆåˆ†åŒºè£å‰ªä¼˜åŒ–ï¼‰
- **JSON/JSONB å¢å¼º**ï¼šæ–°çš„æ“ä½œç¬¦å’Œå‡½æ•°ï¼ˆJSON è·¯å¾„æŸ¥è¯¢ï¼‰

**ä¸»è¦å˜åŒ–å½±å“**ï¼š

```sql
-- 1. SQL MERGE è¯­å¥ï¼ˆæ–°ç‰¹æ€§ï¼‰
-- è¿ç§»å‰ï¼šä½¿ç”¨ INSERT ... ON CONFLICT
INSERT INTO target_table (id, value)
SELECT id, value FROM source_table
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

-- è¿ç§»åï¼šä½¿ç”¨ MERGEï¼ˆæ›´æ ‡å‡†ã€æ›´é«˜æ•ˆï¼‰
MERGE INTO target_table AS t
USING source_table AS s
ON t.id = s.id
WHEN MATCHED THEN
    UPDATE SET value = s.value
WHEN NOT MATCHED THEN
    INSERT (id, value) VALUES (s.id, s.value);

-- 2. é€»è¾‘å¤åˆ¶æ€§èƒ½æå‡ï¼ˆæ–°ç‰¹æ€§ï¼‰
-- è¿ç§»å‰ï¼šå•çº¿ç¨‹åº”ç”¨
-- è¿ç§»åï¼šå¹¶è¡Œåº”ç”¨ï¼ˆmax_parallel_apply_workers_per_subscriptionï¼‰

-- 3. æŸ¥è¯¢ä¼˜åŒ–å™¨æ”¹è¿›ï¼ˆè‡ªåŠ¨ä¼˜åŒ–ï¼‰
-- è¿ç§»åè‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€æ‰‹åŠ¨è°ƒæ•´
```

### 1.2 è¿ç§»ç­–ç•¥

**è¿ç§»ç­–ç•¥å¯¹æ¯”**ï¼š

| ç­–ç•¥ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|---------|
| **pg_upgrade** | å¿«é€Ÿã€æ•°æ®å®Œæ•´ | éœ€è¦åœæœº | ä¸­å°è§„æ¨¡ã€å¯åœæœº |
| **é€»è¾‘å¤åˆ¶** | é›¶åœæœºã€å¯å›æ»š | é…ç½®å¤æ‚ | å¤§è§„æ¨¡ã€é«˜å¯ç”¨ |
| **å¯¼å‡º/å¯¼å…¥** | ç®€å•ã€å¯æ§ | æ…¢ã€éœ€è¦åœæœº | å°è§„æ¨¡ã€æ•°æ®é‡å° |
| **åŒå†™è¿ç§»** | é›¶åœæœºã€å¯å›æ»š | å¤æ‚ã€æˆæœ¬é«˜ | å¤§è§„æ¨¡ã€é«˜å¯ç”¨ |

**è¿ç§»ç­–ç•¥é€‰æ‹©**ï¼š

```bash
# 1. è¯„ä¼°æ•°æ®åº“è§„æ¨¡
psql -c "SELECT pg_size_pretty(pg_database_size('mydb'));"

# 2. è¯„ä¼°åœæœºçª—å£
# å¦‚æœåœæœºçª—å£ > è¿ç§»æ—¶é—´ï¼Œé€‰æ‹© pg_upgrade
# å¦‚æœåœæœºçª—å£ < è¿ç§»æ—¶é—´ï¼Œé€‰æ‹©é€»è¾‘å¤åˆ¶

# 3. è¯„ä¼°å¤æ‚åº¦
# ç®€å•åœºæ™¯ï¼špg_upgrade
# å¤æ‚åœºæ™¯ï¼šé€»è¾‘å¤åˆ¶
```

---

## 2. è¿ç§»å‰å‡†å¤‡

### 2.1 ç¯å¢ƒæ£€æŸ¥

```bash
# æ£€æŸ¥å½“å‰ç‰ˆæœ¬
psql --version

# æ£€æŸ¥æ•°æ®åº“å¤§å°
psql -c "SELECT pg_size_pretty(pg_database_size('mydb'));"

# æ£€æŸ¥æ‰©å±•
psql -c "SELECT extname, extversion FROM pg_extension;"

# æ£€æŸ¥é…ç½®
psql -c "SHOW ALL;" > pg16_config.txt
```

### 2.2 å¤‡ä»½ç­–ç•¥

```bash
# å®Œæ•´å¤‡ä»½
pg_dumpall -U postgres > pg16_backup.sql

# æ•°æ®åº“å¤‡ä»½
pg_dump -U postgres -Fc mydb > mydb_backup.dump

# WAL å½’æ¡£å¤‡ä»½
tar -czf wal_archive_backup.tar.gz /archive/
```

---

## 3. å…¼å®¹æ€§æ£€æŸ¥

### 3.1 æ‰©å±•å…¼å®¹æ€§

```sql
-- æ£€æŸ¥æ‰©å±•ç‰ˆæœ¬
SELECT
    extname,
    extversion,
    pg_available_extensions.extversion AS available_version
FROM pg_extension
LEFT JOIN pg_available_extensions
    ON pg_extension.extname = pg_available_extensions.name;

-- æ£€æŸ¥ä¸å…¼å®¹çš„æ‰©å±•
SELECT extname
FROM pg_extension
WHERE extname NOT IN (
    SELECT name FROM pg_available_extensions
);
```

### 3.2 åŠŸèƒ½å…¼å®¹æ€§

```sql
-- æ£€æŸ¥å·²å¼ƒç”¨çš„åŠŸèƒ½
SELECT * FROM pg_settings
WHERE name LIKE '%deprecated%';

-- æ£€æŸ¥è‡ªå®šä¹‰å‡½æ•°å…¼å®¹æ€§
SELECT
    proname,
    prosrc
FROM pg_proc
WHERE prokind = 'f'
AND pronamespace = 'public'::regnamespace;
```

---

## 4. è¿ç§»æ­¥éª¤

### 4.1 ä½¿ç”¨ pg_upgrade å‡çº§

**pg_upgrade å·¥ä½œåŸç†**ï¼š

pg_upgrade é€šè¿‡ç›´æ¥å‡çº§æ•°æ®ç›®å½•æ ¼å¼å®ç°å¿«é€Ÿè¿ç§»ï¼Œæ— éœ€å¯¼å‡º/å¯¼å…¥æ•°æ®ï¼Œè¿ç§»é€Ÿåº¦å¿«ã€‚

**pg_upgrade å‡çº§æµç¨‹**ï¼š

```mermaid
flowchart TD
    A[åœæ­¢PostgreSQL 16] --> B[è¿è¡Œpg_upgradeæ£€æŸ¥]
    B --> C{æ£€æŸ¥é€šè¿‡?}
    C -->|å¦| D[ä¿®å¤é—®é¢˜]
    D --> B
    C -->|æ˜¯| E[æ‰§è¡Œå‡çº§]
    E --> F[å¯åŠ¨PostgreSQL 17]
    F --> G[éªŒè¯å‡çº§]
    G --> H{å‡çº§æˆåŠŸ?}
    H -->|å¦| I[å›æ»š]
    H -->|æ˜¯| J[å®Œæˆå‡çº§]

    style C fill:#FFD700
    style E fill:#90EE90
    style J fill:#87CEEB
```

**pg_upgrade å‡çº§æ­¥éª¤**ï¼š

```bash
# 1. åœæ­¢ PostgreSQL 16
sudo systemctl stop postgresql-16

# 2. è¿è¡Œ pg_upgrade æ£€æŸ¥ï¼ˆå¿…é¡»æ­¥éª¤ï¼‰
sudo -u postgres /usr/pgsql-17/bin/pg_upgrade \
    --old-datadir=/var/lib/pgsql/16/data \
    --new-datadir=/var/lib/pgsql/17/data \
    --old-bindir=/usr/pgsql-16/bin \
    --new-bindir=/usr/pgsql-17/bin \
    --check

# æ£€æŸ¥è¾“å‡ºï¼Œç¡®ä¿æ²¡æœ‰é”™è¯¯

# 3. æ‰§è¡Œå‡çº§
sudo -u postgres /usr/pgsql-17/bin/pg_upgrade \
    --old-datadir=/var/lib/pgsql/16/data \
    --new-datadir=/var/lib/pgsql/17/data \
    --old-bindir=/usr/pgsql-16/bin \
    --new-bindir=/usr/pgsql-17/bin \
    --jobs=4  # å¹¶è¡Œä½œä¸šæ•°ï¼ˆæ ¹æ®CPUæ ¸å¿ƒæ•°è°ƒæ•´ï¼‰

# 4. å¯åŠ¨ PostgreSQL 17
sudo systemctl start postgresql-17

# 5. éªŒè¯å‡çº§
psql -c "SELECT version();"
psql -c "SELECT extname, extversion FROM pg_extension;"

# 6. è¿è¡Œå‡çº§åè„šæœ¬ï¼ˆå¯é€‰ï¼‰
sudo -u postgres /usr/pgsql-17/bin/pg_upgrade \
    --old-datadir=/var/lib/pgsql/16/data \
    --new-datadir=/var/lib/pgsql/17/data \
    --old-bindir=/usr/pgsql-16/bin \
    --new-bindir=/usr/pgsql-17/bin \
    --link  # ä½¿ç”¨ç¡¬é“¾æ¥ï¼ˆèŠ‚çœç©ºé—´ï¼Œä½†éœ€è¦æ›´å¤šæ—¶é—´ï¼‰
```

**pg_upgrade æœ€ä½³å®è·µ**ï¼š

```bash
# âœ… å¥½ï¼šä½¿ç”¨ --check å…ˆæ£€æŸ¥ï¼ˆé¿å…å‡çº§å¤±è´¥ï¼‰
pg_upgrade --check ...

# âœ… å¥½ï¼šä½¿ç”¨ --jobs å¹¶è¡Œå‡çº§ï¼ˆæå‡é€Ÿåº¦ï¼‰
pg_upgrade --jobs=4 ...

# âœ… å¥½ï¼šä¿ç•™æ—§ç‰ˆæœ¬æ•°æ®ç›®å½•ï¼ˆæ”¯æŒå›æ»šï¼‰
# ä¸è¦ç«‹å³åˆ é™¤æ—§ç‰ˆæœ¬æ•°æ®ç›®å½•

# âœ… å¥½ï¼šå‡çº§åç«‹å³è¿è¡Œ ANALYZEï¼ˆæ›´æ–°ç»Ÿè®¡ä¿¡æ¯ï¼‰
psql -c "ANALYZE;"

# âŒ ä¸å¥½ï¼šä¸æ£€æŸ¥å°±å‡çº§ï¼ˆå¯èƒ½å¯¼è‡´å‡çº§å¤±è´¥ï¼‰
# âŒ ä¸å¥½ï¼šç«‹å³åˆ é™¤æ—§ç‰ˆæœ¬ï¼ˆæ— æ³•å›æ»šï¼‰
```

### 4.2 é€»è¾‘å¤åˆ¶è¿ç§»

```sql
-- åœ¨ PostgreSQL 17 ä¸Šåˆ›å»ºè®¢é˜…
CREATE SUBSCRIPTION pg17_sub
CONNECTION 'host=pg16_host dbname=mydb user=replicator'
PUBLICATION pg16_pub
WITH (
    copy_data = true,
    create_slot = true
);

-- ç›‘æ§å¤åˆ¶è¿›åº¦
SELECT * FROM pg_stat_subscription;
```

---

## 5. è¿ç§»åä¼˜åŒ–

### 5.1 æ›´æ–°ç»Ÿè®¡ä¿¡æ¯

```sql
-- æ›´æ–°æ‰€æœ‰è¡¨çš„ç»Ÿè®¡ä¿¡æ¯
ANALYZE;

-- æ›´æ–°ç‰¹å®šæ•°æ®åº“
ANALYZE DATABASE mydb;

-- æ›´æ–°ç‰¹å®šè¡¨
ANALYZE table_name;
```

### 5.2 é‡å»ºç´¢å¼•

```sql
-- é‡å»ºæ‰€æœ‰ç´¢å¼•
REINDEX DATABASE mydb;

-- é‡å»ºç‰¹å®šè¡¨ç´¢å¼•
REINDEX TABLE table_name;

-- é‡å»ºç‰¹å®šç´¢å¼•
REINDEX INDEX index_name;
```

### 5.3 åˆ©ç”¨æ–°ç‰¹æ€§

```sql
-- ä½¿ç”¨ SQL MERGE
MERGE INTO target_table AS t
USING source_table AS s
ON t.id = s.id
WHEN MATCHED THEN
    UPDATE SET value = s.value
WHEN NOT MATCHED THEN
    INSERT (id, value) VALUES (s.id, s.value);

-- ä¼˜åŒ–æŸ¥è¯¢è®¡åˆ’
EXPLAIN ANALYZE SELECT * FROM large_table;
```

---

## 6. å¸¸è§é—®é¢˜

### 6.1 æ‰©å±•ä¸å…¼å®¹

**é—®é¢˜**ï¼šæŸäº›æ‰©å±•åœ¨ PostgreSQL 17 ä¸­ä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š

```sql
-- æ£€æŸ¥æ‰©å±•æ›¿ä»£æ–¹æ¡ˆ
SELECT * FROM pg_available_extensions
WHERE name LIKE '%similar%';

-- æ›´æ–°æ‰©å±•
ALTER EXTENSION extension_name UPDATE;
```

### 6.2 æ€§èƒ½ä¸‹é™

**é—®é¢˜**ï¼šè¿ç§»åæŸ¥è¯¢æ€§èƒ½ä¸‹é™

**è§£å†³æ–¹æ¡ˆ**ï¼š

```sql
-- æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
ANALYZE;

-- é‡å»ºç´¢å¼•
REINDEX DATABASE mydb;

-- è°ƒæ•´é…ç½®å‚æ•°
ALTER SYSTEM SET shared_buffers = '256MB';
ALTER SYSTEM SET work_mem = '16MB';
```

---

## 7. å›æ»šæ–¹æ¡ˆ

### 7.1 å›æ»šå‡†å¤‡

```bash
# ä¿ç•™ PostgreSQL 16 æ•°æ®ç›®å½•
cp -r /var/lib/pgsql/16/data /var/lib/pgsql/16/data.backup

# ä¿ç•™é…ç½®æ–‡ä»¶
cp /etc/postgresql/16/postgresql.conf /etc/postgresql/16/postgresql.conf.backup
```

### 7.2 å›æ»šæ­¥éª¤

```bash
# 1. åœæ­¢ PostgreSQL 17
sudo systemctl stop postgresql-17

# 2. æ¢å¤ PostgreSQL 16 æ•°æ®
cp -r /var/lib/pgsql/16/data.backup /var/lib/pgsql/16/data

# 3. å¯åŠ¨ PostgreSQL 16
sudo systemctl start postgresql-16

# 4. éªŒè¯æ•°æ®
psql -c "SELECT version();"
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£

- **[PostgreSQL å®˜æ–¹æ–‡æ¡£ - å‡çº§æŒ‡å—](https://www.postgresql.org/docs/17/upgrading.html)**
  - PostgreSQL å‡çº§å®Œæ•´æŒ‡å—
  - å‡çº§æ–¹æ³•å’Œæ³¨æ„äº‹é¡¹

- **[PostgreSQL å®˜æ–¹æ–‡æ¡£ - pg_upgrade](https://www.postgresql.org/docs/17/pgupgrade.html)**
  - pg_upgrade å·¥å…·ä½¿ç”¨æŒ‡å—
  - å‡çº§æ­¥éª¤å’Œæ•…éšœæ’æŸ¥

- **[PostgreSQL å®˜æ–¹æ–‡æ¡£ - ç‰ˆæœ¬å…¼å®¹æ€§](https://www.postgresql.org/docs/17/release-17.html)**
  - PostgreSQL 17 ç‰ˆæœ¬è¯´æ˜
  - å…¼å®¹æ€§å˜åŒ–å’Œè¿ç§»æ³¨æ„äº‹é¡¹

- **[PostgreSQL 17 å‘å¸ƒè¯´æ˜](https://www.postgresql.org/about/news/postgresql-17-released-2781/)**
  - PostgreSQL 17 æ–°ç‰¹æ€§ä»‹ç»
  - è¿ç§»ç›¸å…³è¯´æ˜

### æŠ€æœ¯åšå®¢

- **[PostgreSQL å®˜æ–¹åšå®¢ - å‡çº§æŒ‡å—](https://www.postgresql.org/docs/17/upgrading.html)**
  - å‡çº§æœ€ä½³å®è·µ
  - å¸¸è§é—®é¢˜è§£ç­”

- **[2ndQuadrant - PostgreSQL 17 è¿ç§»](https://www.2ndquadrant.com/en/blog/postgresql-17-migration/)**
  - è¿ç§»å®æˆ˜æ¡ˆä¾‹
  - è¿ç§»ä¼˜åŒ–å»ºè®®

- **[Percona - PostgreSQL å‡çº§æŒ‡å—](https://www.percona.com/blog/postgresql-upgrade-guide/)**
  - å‡çº§æ­¥éª¤è¯¦è§£
  - æ•…éšœæ’æŸ¥æ–¹æ³•

### ç¤¾åŒºèµ„æº

- **[PostgreSQL Wiki - Upgrading](https://wiki.postgresql.org/wiki/Upgrading)**
  - å‡çº§æŒ‡å—å’Œæœ€ä½³å®è·µ
  - å¸¸è§é—®é¢˜è§£ç­”

- **[Stack Overflow - PostgreSQL Upgrade](https://stackoverflow.com/questions/tagged/postgresql+upgrade)**
  - å‡çº§ç›¸å…³é—®é¢˜è§£ç­”
  - å®é™…è¿ç§»æ¡ˆä¾‹

- **[PostgreSQL é‚®ä»¶åˆ—è¡¨](https://www.postgresql.org/list/)**
  - å‡çº§ç›¸å…³é—®é¢˜è®¨è®º
  - ç¤¾åŒºç»éªŒåˆ†äº«

## ğŸ“Š æ€»ç»“

PostgreSQL 16 åˆ° 17 çš„è¿ç§»éœ€è¦ä»”ç»†è§„åˆ’å’Œæ‰§è¡Œï¼š

1. **è¿ç§»å‰å‡†å¤‡**ï¼šå®Œæ•´å¤‡ä»½å’Œç¯å¢ƒæ£€æŸ¥
2. **å…¼å®¹æ€§æ£€æŸ¥**ï¼šæ£€æŸ¥æ‰©å±•å’ŒåŠŸèƒ½å…¼å®¹æ€§
3. **è¿ç§»æ‰§è¡Œ**ï¼šé€‰æ‹©åˆé€‚çš„è¿ç§»æ–¹æ³•
4. **è¿ç§»åä¼˜åŒ–**ï¼šæ›´æ–°ç»Ÿè®¡ä¿¡æ¯å’Œåˆ©ç”¨æ–°ç‰¹æ€§
5. **å›æ»šå‡†å¤‡**ï¼šå‡†å¤‡å›æ»šæ–¹æ¡ˆä»¥é˜²ä¸‡ä¸€

**æœ€ä½³å®è·µ**ï¼š

- åœ¨æµ‹è¯•ç¯å¢ƒå…ˆéªŒè¯
- å®Œæ•´å¤‡ä»½æ‰€æœ‰æ•°æ®
- æ£€æŸ¥æ‰©å±•å…¼å®¹æ€§
- ç›‘æ§è¿ç§»è¿‡ç¨‹
- è¿ç§»åæ€§èƒ½æµ‹è¯•
- å‡†å¤‡å›æ»šæ–¹æ¡ˆ

---

**æœ€åæ›´æ–°**: 2025 å¹´ 1 æœˆ
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
