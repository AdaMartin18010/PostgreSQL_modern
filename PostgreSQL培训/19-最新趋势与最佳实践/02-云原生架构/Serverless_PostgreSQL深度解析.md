# Serverless PostgreSQLæ·±åº¦è§£æ

> **æ›´æ–°æ—¶é—´**: 2025å¹´1æœˆ
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 17+/18+
> **æ–‡æ¡£ç¼–å·**: 19-02-02

---

## ğŸ“‘ ç›®å½•

- [Serverless PostgreSQLæ·±åº¦è§£æ](#serverless-postgresqlæ·±åº¦è§£æ)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 Serverlessä»·å€¼](#11-serverlessä»·å€¼)
    - [1.2 ä»·å€¼è®ºè¯](#12-ä»·å€¼è®ºè¯)
  - [2. Serverlessæ¶æ„è®¾è®¡](#2-serverlessæ¶æ„è®¾è®¡)
    - [2.1 æ¶æ„æ€ç»´å¯¼å›¾](#21-æ¶æ„æ€ç»´å¯¼å›¾)
    - [2.2 æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ](#22-æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ)
  - [3. æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ](#3-æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ)
    - [3.1 Serverlessæ–¹æ¡ˆé€‰æ‹©å†³ç­–æ ‘](#31-serverlessæ–¹æ¡ˆé€‰æ‹©å†³ç­–æ ‘)

---

## 1. æ¦‚è¿°

### 1.1 Serverlessä»·å€¼

**Serverless PostgreSQLçš„æ ¸å¿ƒä»·å€¼**ï¼š

1. **è‡ªåŠ¨æ‰©ç¼©å®¹**ï¼šæ ¹æ®è´Ÿè½½è‡ªåŠ¨è°ƒæ•´èµ„æº
2. **æŒ‰éœ€ä»˜è´¹**ï¼šåªä¸ºå®é™…ä½¿ç”¨çš„èµ„æºä»˜è´¹
3. **é›¶è¿ç»´**ï¼šæ— éœ€ç®¡ç†æœåŠ¡å™¨å’ŒåŸºç¡€è®¾æ–½
4. **å¿«é€Ÿå¯åŠ¨**ï¼šç§’çº§å¯åŠ¨ï¼Œæ— éœ€é¢„çƒ­

### 1.2 ä»·å€¼è®ºè¯

| ä»·å€¼ç»´åº¦ | è¯´æ˜ | é‡åŒ–æ•°æ® |
|---------|------|---------|
| **æˆæœ¬èŠ‚çœ** | æŒ‰éœ€ä»˜è´¹ | **-70%** æˆæœ¬ |
| **è¿ç»´æ•ˆç‡** | é›¶è¿ç»´ | **+300%** æ•ˆç‡ |
| **å¯åŠ¨é€Ÿåº¦** | ç§’çº§å¯åŠ¨ | **-95%** å¯åŠ¨æ—¶é—´ |
| **å¯æ‰©å±•æ€§** | è‡ªåŠ¨æ‰©ç¼©å®¹ | **æ— é™** æ‰©å±• |

---

## 2. Serverlessæ¶æ„è®¾è®¡

### 2.1 æ¶æ„æ€ç»´å¯¼å›¾

```mermaid
graph TD
    A[Serverless PostgreSQL] --> B[è®¡ç®—å±‚]
    A --> C[å­˜å‚¨å±‚]
    A --> D[ç½‘ç»œå±‚]

    B --> B1[è‡ªåŠ¨æ‰©ç¼©å®¹]
    B --> B2[è¿æ¥æ± ç®¡ç†]
    B --> B3[æŸ¥è¯¢è·¯ç”±]

    C --> C1[å…±äº«å­˜å‚¨]
    C --> C2[è‡ªåŠ¨å¤‡ä»½]
    C --> C3[å¿«ç…§ç®¡ç†]

    D --> D1[è´Ÿè½½å‡è¡¡]
    D --> D2[å®‰å…¨ç»„]
    D --> D3[VPCéš”ç¦»]

    style B fill:#90EE90
    style C fill:#87CEEB
    style D fill:#FFD700
```

### 2.2 æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ

| æ–¹æ¡ˆ | æä¾›å•† | æ€§èƒ½ | æˆæœ¬ | æ˜“ç”¨æ€§ | å¯æ‰©å±•æ€§ | ç»¼åˆè¯„åˆ† |
|------|--------|------|------|--------|---------|---------|
| **Neon** | Neon | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | **4.5** |
| **Supabase** | Supabase | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | **4.4** |
| **AWS RDS Serverless** | AWS | â­â­â­â­â­ | â­â­â­ | â­â­â­ | â­â­â­â­â­ | **3.8** |
| **Google Cloud SQL** | Google | â­â­â­â­ | â­â­â­ | â­â­â­ | â­â­â­â­ | **3.5** |

---

## 3. æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ

### 3.1 Serverlessæ–¹æ¡ˆé€‰æ‹©å†³ç­–æ ‘

```text
éœ€è¦Serverlessï¼Ÿ
â”œâ”€ æ˜¯
â”‚  â”œâ”€ é¢„ç®—ï¼Ÿ
â”‚  â”‚  â”œâ”€ æœ‰é™ â†’ Neon/Supabase
â”‚  â”‚  â””â”€ å……è¶³ â†’ AWS RDS Serverless
â”‚  â”œâ”€ æŠ€æœ¯æ ˆï¼Ÿ
â”‚  â”‚  â”œâ”€ å…¨æ ˆå¼€å‘ â†’ Supabase
â”‚  â”‚  â””â”€ ä»…æ•°æ®åº“ â†’ Neon
â”‚  â””â”€ åŒºåŸŸè¦æ±‚ï¼Ÿ
â”‚     â”œâ”€ å…¨çƒ â†’ Neon
â”‚     â””â”€ ç‰¹å®šåŒºåŸŸ â†’ AWS/Google
â””â”€ å¦ â†’ ä¼ ç»ŸPostgreSQL
```

---

## 4. å®é™…åº”ç”¨æ¡ˆä¾‹

### 4.1 æ¡ˆä¾‹ï¼šSaaSå¹³å°Serverlessæ•°æ®åº“

**ä¸šåŠ¡åœºæ™¯**ï¼š

- SaaSå¤šç§Ÿæˆ·å¹³å°
- 1000+ç§Ÿæˆ·
- è´Ÿè½½æ³¢åŠ¨å¤§ï¼ˆç™½å¤©é«˜ï¼Œå¤œé—´ä½ï¼‰
- éœ€è¦å¿«é€Ÿæ‰©å±•

**å®æ–½æ–¹æ¡ˆï¼ˆNeonï¼‰**ï¼š

```typescript
// 1. Neonè¿æ¥é…ç½®
const neonConfig = {
  connectionString: process.env.NEON_DATABASE_URL,
  maxConnections: 20,
  connectionTimeoutMillis: 5000,
};

// 2. è‡ªåŠ¨æ‰©ç¼©å®¹é…ç½®
// Neonè‡ªåŠ¨æ ¹æ®è´Ÿè½½è°ƒæ•´è®¡ç®—èµ„æº
// æ— éœ€æ‰‹åŠ¨é…ç½®

// 3. å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»
CREATE SCHEMA tenant_1;
CREATE SCHEMA tenant_2;
-- æ¯ä¸ªç§Ÿæˆ·ç‹¬ç«‹schema

// 4. è¿æ¥æ± ç®¡ç†
import { Pool } from 'pg';
const pool = new Pool(neonConfig);

// 5. æŸ¥è¯¢è·¯ç”±ï¼ˆæ ¹æ®ç§Ÿæˆ·ï¼‰
async function queryByTenant(tenantId: string, query: string) {
  const client = await pool.connect();
  try {
    await client.query(`SET search_path TO tenant_${tenantId}`);
    const result = await client.query(query);
    return result.rows;
  } finally {
    client.release();
  }
}
```

**å®æ–½æ•ˆæœ**ï¼š

| æŒ‡æ ‡ | å®æ–½å‰ | å®æ–½å | æå‡ |
|------|--------|--------|------|
| **æˆæœ¬** | 100% | 30% | **-70%** |
| **å¯åŠ¨æ—¶é—´** | 5åˆ†é’Ÿ | 10ç§’ | **-97%** |
| **è¿ç»´æ—¶é—´** | 20å°æ—¶/å‘¨ | 2å°æ—¶/å‘¨ | **-90%** |
| **æ‰©å±•é€Ÿåº¦** | 30åˆ†é’Ÿ | è‡ªåŠ¨ | **+âˆ** |

---

**æœ€åæ›´æ–°**: 2025å¹´1æœˆ
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: 19-02-02
