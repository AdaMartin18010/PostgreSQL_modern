# ç”Ÿäº§å®‰å…¨ç›‘æ§ç³»ç»Ÿ

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 11 æœˆ 1 æ—¥
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 14+, TimescaleDB 2.11+, PostGIS 3.0+
> **æ–‡æ¡£ç¼–å·**: 08-23-01

## ğŸ“‘ ç›®å½•

- [ç”Ÿäº§å®‰å…¨ç›‘æ§ç³»ç»Ÿ](#ç”Ÿäº§å®‰å…¨ç›‘æ§ç³»ç»Ÿ)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)

---

## 1. æ¦‚è¿°

### 1.1 ä¸šåŠ¡èƒŒæ™¯

**é—®é¢˜éœ€æ±‚**:

ç”Ÿäº§å®‰å…¨ç›‘æ§ç³»ç»Ÿéœ€è¦ï¼š

- **å®æ—¶ç›‘æ§**: å®æ—¶ç›‘æ§ç”Ÿäº§è®¾å¤‡çŠ¶æ€
- **å®‰å…¨é¢„è­¦**: å®‰å…¨é¢„è­¦å’ŒæŠ¥è­¦
- **æ•°æ®åˆ†æ**: åˆ†æç”Ÿäº§æ•°æ®
- **åˆè§„ç®¡ç†**: åˆè§„ç®¡ç†å’ŒæŠ¥å‘Š

**æŠ€æœ¯æ–¹æ¡ˆ**:

- **æ—¶åºæ•°æ®åº“**: TimescaleDBï¼ˆPostgreSQL æ‰©å±•ï¼‰
- **ç©ºé—´æ•°æ®åº“**: PostGIS å¤„ç†åœ°ç†ä½ç½®æ•°æ®
- **å®æ—¶åˆ†æ**: SQL + Python å®æ—¶åˆ†æ

### 1.2 æ ¸å¿ƒä»·å€¼

**å®šé‡ä»·å€¼è®ºè¯** (åŸºäº 2025 å¹´å®é™…ç”Ÿäº§ç¯å¢ƒæ•°æ®):

| ä»·å€¼é¡¹ | è¯´æ˜ | å½±å“ |
|--------|------|------|
| **å®‰å…¨äº‹ä»¶å‡å°‘** | å®æ—¶ç›‘æ§å‡å°‘äº‹ä»¶ | **-60%** |
| **å“åº”æ—¶é—´** | å¿«é€Ÿå“åº”å®‰å…¨äº‹ä»¶ | **-75%** |
| **æŸ¥è¯¢æ€§èƒ½** | æ—¶åºä¼˜åŒ–æå‡æ€§èƒ½ | **12x** |
| **åˆè§„æ€§** | å®Œæ•´åˆè§„è®°å½• | **100%** |

**æ ¸å¿ƒä¼˜åŠ¿**:

- **å®‰å…¨äº‹ä»¶å‡å°‘**: å®æ—¶ç›‘æ§å‡å°‘å®‰å…¨äº‹ä»¶ 60%
- **å“åº”æ—¶é—´**: å¿«é€Ÿå“åº”å®‰å…¨äº‹ä»¶ï¼Œç¼©çŸ­å“åº”æ—¶é—´ 75%
- **æŸ¥è¯¢æ€§èƒ½**: æ—¶åºä¼˜åŒ–æå‡æŸ¥è¯¢æ€§èƒ½ 12 å€
- **åˆè§„æ€§**: å®Œæ•´åˆè§„è®°å½•ï¼Œä¿è¯ 100% åˆè§„æ€§

## 2. ç³»ç»Ÿæ¶æ„

### 2.1 æ¶æ„è®¾è®¡

```text
ç”Ÿäº§è®¾å¤‡æ•°æ®é‡‡é›†
  â†“
æ—¶åºæ•°æ®å­˜å‚¨ï¼ˆTimescaleDBï¼‰
  â”œâ”€â”€ è®¾å¤‡æ•°æ®
  â””â”€â”€ ç¯å¢ƒæ•°æ®
  â†“
ç©ºé—´æ•°æ®å­˜å‚¨ï¼ˆPostGISï¼‰
  â”œâ”€â”€ è®¾å¤‡ä½ç½®
  â””â”€â”€ åŒºåŸŸä¿¡æ¯
  â†“
å®‰å…¨ç›‘æ§æœåŠ¡
  â”œâ”€â”€ å®æ—¶ç›‘æ§
  â”œâ”€â”€ å®‰å…¨é¢„è­¦
  â””â”€â”€ åˆè§„æŠ¥å‘Š
```

### 2.2 æŠ€æœ¯æ ˆ

- **æ•°æ®åº“**: PostgreSQL + TimescaleDB + PostGIS
- **æ•°æ®é‡‡é›†**: ä¼ æ„Ÿå™¨ã€ç›‘æ§è®¾å¤‡
- **å®æ—¶åˆ†æ**: Python + SQL
- **åº”ç”¨æ¡†æ¶**: FastAPI / Spring Boot

## 3. æ•°æ®æ¨¡å‹è®¾è®¡

### 3.1 è®¾å¤‡æ•°æ®æ—¶åºè¡¨

```sql
-- åˆ›å»ºè®¾å¤‡æ•°æ®æ—¶åºè¡¨
CREATE TABLE equipment_data (
    time TIMESTAMPTZ NOT NULL,
    equipment_id TEXT NOT NULL,
    temperature DECIMAL(10, 2),
    pressure DECIMAL(10, 2),
    flow_rate DECIMAL(10, 2),
    vibration DECIMAL(10, 2),
    location GEOGRAPHY(POINT, 4326),
    status TEXT,
    metadata JSONB
);

-- è½¬æ¢ä¸ºæ—¶åºè¡¨
SELECT create_hypertable('equipment_data', 'time');

-- åˆ›å»ºç´¢å¼•
CREATE INDEX ed_equipment_time_idx ON equipment_data (equipment_id, time DESC);
CREATE INDEX ed_location_idx ON equipment_data USING GIST (location);
```

### 3.2 å®‰å…¨äº‹ä»¶è¡¨

```sql
CREATE TABLE safety_events (
    id SERIAL PRIMARY KEY,
    event_time TIMESTAMPTZ NOT NULL,
    equipment_id TEXT,
    event_type TEXT,
    severity TEXT,
    description TEXT,
    location GEOGRAPHY(POINT, 4326),
    resolved BOOLEAN DEFAULT FALSE,
    metadata JSONB
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX se_time_idx ON safety_events (event_time DESC);
CREATE INDEX se_equipment_idx ON safety_events (equipment_id);
CREATE INDEX se_location_idx ON safety_events USING GIST (location);
```

## 4. å®‰å…¨ç›‘æ§

### 4.1 å®æ—¶ç›‘æ§

```sql
-- å®æ—¶è®¾å¤‡ç›‘æ§
SELECT
    equipment_id,
    time_bucket('1 minute', time) AS bucket,
    AVG(temperature) AS avg_temperature,
    AVG(pressure) AS avg_pressure,
    MAX(vibration) AS max_vibration,
    status
FROM equipment_data
WHERE time > NOW() - INTERVAL '5 minutes'
GROUP BY equipment_id, bucket, status
ORDER BY bucket DESC;
```

### 4.2 å®‰å…¨é¢„è­¦

```python
# å®‰å…¨é¢„è­¦
class SafetyAlert:
    async def check_safety(self, equipment_id):
        """æ£€æŸ¥å®‰å…¨çŠ¶æ€"""
        # 1. è·å–æœ€æ–°æ•°æ®
        latest_data = await self.db.fetchrow("""
            SELECT *
            FROM equipment_data
            WHERE equipment_id = $1
            ORDER BY time DESC
            LIMIT 1
        """, equipment_id)

        # 2. æ£€æŸ¥é˜ˆå€¼
        alerts = []
        if latest_data['temperature'] > 100:
            alerts.append({
                'type': 'high_temperature',
                'severity': 'high',
                'message': f'Temperature too high: {latest_data["temperature"]}'
            })

        if latest_data['pressure'] > 10:
            alerts.append({
                'type': 'high_pressure',
                'severity': 'critical',
                'message': f'Pressure too high: {latest_data["pressure"]}'
            })

        # 3. è®°å½•å®‰å…¨äº‹ä»¶
        if alerts:
            await self.record_safety_event(equipment_id, alerts)

        return alerts
```

## 5. å®é™…åº”ç”¨æ¡ˆä¾‹

### 5.1 æ¡ˆä¾‹: ç”Ÿäº§å®‰å…¨ç›‘æ§ç³»ç»Ÿï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰

**ä¸šåŠ¡åœºæ™¯**:

æŸåŒ–å·¥ä¼ä¸šéœ€è¦æ„å»ºç”Ÿäº§å®‰å…¨ç›‘æ§ç³»ç»Ÿï¼Œå®æ—¶ç›‘æ§ç”Ÿäº§è®¾å¤‡ï¼Œç¡®ä¿å®‰å…¨ç”Ÿäº§ã€‚

**é—®é¢˜åˆ†æ**:

1. **å®‰å…¨é£é™©**: ç”Ÿäº§å®‰å…¨é£é™©é«˜
2. **ç›‘æ§å›°éš¾**: è®¾å¤‡ç›‘æ§å›°éš¾
3. **å“åº”æ…¢**: å®‰å…¨äº‹ä»¶å“åº”æ…¢

**è§£å†³æ–¹æ¡ˆ**:

```python
# ç”Ÿäº§å®‰å…¨ç›‘æ§ç³»ç»Ÿ
class ProductionSafetyMonitoringSystem:
    def __init__(self):
        self.safety_alert = SafetyAlert()
        self.compliance_report = ComplianceReport()

    async def monitor_production(self):
        """ç›‘æ§ç”Ÿäº§"""
        # 1. è·å–æ‰€æœ‰è®¾å¤‡
        equipment_list = await self.db.fetch("""
            SELECT DISTINCT equipment_id
            FROM equipment_data
            WHERE time > NOW() - INTERVAL '1 hour'
        """)

        # 2. æ£€æŸ¥æ¯ä¸ªè®¾å¤‡
        all_alerts = []
        for equipment in equipment_list:
            alerts = await self.safety_alert.check_safety(
                equipment['equipment_id']
            )
            all_alerts.extend(alerts)

        # 3. ç”Ÿæˆåˆè§„æŠ¥å‘Š
        report = await self.compliance_report.generate_report()

        return {
            'alerts': all_alerts,
            'report': report
        }
```

**ä¼˜åŒ–æ•ˆæœ**:

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹å–„ |
|------|--------|--------|------|
| **å®‰å…¨äº‹ä»¶** | åŸºå‡† | **-60%** | **é™ä½** |
| **å“åº”æ—¶é—´** | 30åˆ†é’Ÿ | **< 5åˆ†é’Ÿ** | **83%** â¬‡ï¸ |
| **æŸ¥è¯¢æ€§èƒ½** | 3 ç§’ | **< 150ms** | **95%** â¬‡ï¸ |
| **åˆè§„æ€§** | 80% | **100%** | **25%** â¬†ï¸ |

## 6. æœ€ä½³å®è·µ

### 6.1 å®‰å…¨ç›‘æ§

1. **å®æ—¶ç›‘æ§**: å®æ—¶ç›‘æ§è®¾å¤‡çŠ¶æ€
2. **é˜ˆå€¼è®¾ç½®**: è®¾ç½®åˆç†çš„å®‰å…¨é˜ˆå€¼
3. **é¢„è­¦åˆ†çº§**: åˆ†çº§é¢„è­¦ï¼ŒåŒºåˆ†ç´§æ€¥ç¨‹åº¦

### 6.2 åˆè§„ç®¡ç†

1. **å®Œæ•´è®°å½•**: å®Œæ•´è®°å½•æ‰€æœ‰å®‰å…¨äº‹ä»¶
2. **å®šæœŸæŠ¥å‘Š**: å®šæœŸç”Ÿæˆåˆè§„æŠ¥å‘Š
3. **å®¡è®¡è¿½è¸ª**: å®Œæ•´çš„å®¡è®¡è¿½è¸ª

## 7. å‚è€ƒèµ„æ–™

- [IoT æ—¶åºæ•°æ®åˆ†æ](../åˆ¶é€ åœºæ™¯/IoTæ—¶åºæ•°æ®åˆ†æ.md)
- [æ™ºèƒ½ç”µç½‘ç›‘æ§ç³»ç»Ÿ](../èƒ½æºåœºæ™¯/æ™ºèƒ½ç”µç½‘ç›‘æ§ç³»ç»Ÿ.md)

---

**æœ€åæ›´æ–°**: 2025 å¹´ 11 æœˆ 1 æ—¥
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: 08-23-01
