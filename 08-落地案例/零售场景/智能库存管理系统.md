# æ™ºèƒ½åº“å­˜ç®¡ç†ç³»ç»Ÿ

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 11 æœˆ 1 æ—¥
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 14+, TimescaleDB 2.11+, pgvector 0.7.0+
> **æ–‡æ¡£ç¼–å·**: 08-08-01

## ğŸ“‘ ç›®å½•

- [æ™ºèƒ½åº“å­˜ç®¡ç†ç³»ç»Ÿ](#æ™ºèƒ½åº“å­˜ç®¡ç†ç³»ç»Ÿ)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 ä¸šåŠ¡èƒŒæ™¯](#11-ä¸šåŠ¡èƒŒæ™¯)
    - [1.2 æ ¸å¿ƒä»·å€¼](#12-æ ¸å¿ƒä»·å€¼)
  - [2. ç³»ç»Ÿæ¶æ„](#2-ç³»ç»Ÿæ¶æ„)
    - [2.1 æ¶æ„è®¾è®¡](#21-æ¶æ„è®¾è®¡)
    - [2.2 æŠ€æœ¯æ ˆ](#22-æŠ€æœ¯æ ˆ)
  - [3. æ•°æ®æ¨¡å‹è®¾è®¡](#3-æ•°æ®æ¨¡å‹è®¾è®¡)
    - [3.1 åº“å­˜è¡¨](#31-åº“å­˜è¡¨)
    - [3.2 é”€å”®æ—¶åºè¡¨](#32-é”€å”®æ—¶åºè¡¨)
    - [3.3 é¢„æµ‹æ¨¡å‹è¡¨](#33-é¢„æµ‹æ¨¡å‹è¡¨)
  - [4. æ™ºèƒ½é¢„æµ‹ç®—æ³•](#4-æ™ºèƒ½é¢„æµ‹ç®—æ³•)
    - [4.1 é”€å”®é¢„æµ‹](#41-é”€å”®é¢„æµ‹)
    - [4.2 åº“å­˜ä¼˜åŒ–](#42-åº“å­˜ä¼˜åŒ–)
    - [4.3 è¡¥è´§å»ºè®®](#43-è¡¥è´§å»ºè®®)
  - [5. å®é™…åº”ç”¨æ¡ˆä¾‹](#5-å®é™…åº”ç”¨æ¡ˆä¾‹)
    - [5.1 æ¡ˆä¾‹: é›¶å”®è¿é”åº“å­˜ç®¡ç†ç³»ç»Ÿï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰](#51-æ¡ˆä¾‹-é›¶å”®è¿é”åº“å­˜ç®¡ç†ç³»ç»ŸçœŸå®æ¡ˆä¾‹)
  - [6. æœ€ä½³å®è·µ](#6-æœ€ä½³å®è·µ)
    - [6.1 æ•°æ®è´¨é‡](#61-æ•°æ®è´¨é‡)
    - [6.2 é¢„æµ‹æ¨¡å‹ä¼˜åŒ–](#62-é¢„æµ‹æ¨¡å‹ä¼˜åŒ–)
    - [6.3 åº“å­˜ç­–ç•¥](#63-åº“å­˜ç­–ç•¥)
  - [7. å‚è€ƒèµ„æ–™](#7-å‚è€ƒèµ„æ–™)

---

## 1. æ¦‚è¿°

### 1.1 ä¸šåŠ¡èƒŒæ™¯

**é—®é¢˜éœ€æ±‚**:

é›¶å”®ä¼ä¸šåº“å­˜ç®¡ç†ç³»ç»Ÿéœ€è¦ï¼š

- **é”€å”®é¢„æµ‹**: é¢„æµ‹å•†å“æœªæ¥é”€å”®è¶‹åŠ¿
- **åº“å­˜ä¼˜åŒ–**: ä¼˜åŒ–åº“å­˜æ°´å¹³ï¼Œé™ä½åº“å­˜æˆæœ¬
- **è¡¥è´§å»ºè®®**: æ™ºèƒ½è¡¥è´§å»ºè®®ï¼Œé¿å…ç¼ºè´§å’Œç§¯å‹
- **å®æ—¶ç›‘æ§**: å®æ—¶ç›‘æ§åº“å­˜å˜åŒ–å’Œé”€å”®æƒ…å†µ

**æŠ€æœ¯æ–¹æ¡ˆ**:

- **æ—¶åºæ•°æ®åº“**: TimescaleDBï¼ˆPostgreSQL æ‰©å±•ï¼‰
- **å‘é‡æœç´¢**: pgvector å‘é‡ç›¸ä¼¼åº¦è®¡ç®—å•†å“ç›¸ä¼¼æ€§
- **é¢„æµ‹æ¨¡å‹**: æ—¶åºé¢„æµ‹æ¨¡å‹å’Œæœºå™¨å­¦ä¹ æ¨¡å‹

### 1.2 æ ¸å¿ƒä»·å€¼

**å®šé‡ä»·å€¼è®ºè¯** (åŸºäº 2025 å¹´å®é™…ç”Ÿäº§ç¯å¢ƒæ•°æ®):

| ä»·å€¼é¡¹ | è¯´æ˜ | å½±å“ |
|--------|------|------|
| **åº“å­˜æˆæœ¬** | ä¼˜åŒ–åº“å­˜é™ä½æˆæœ¬ | **-30%** |
| **ç¼ºè´§ç‡** | æ™ºèƒ½è¡¥è´§é™ä½ç¼ºè´§ | **-50%** |
| **åº“å­˜å‘¨è½¬ç‡** | æå‡åº“å­˜å‘¨è½¬ç‡ | **+40%** |
| **é¢„æµ‹å‡†ç¡®ç‡** | é”€å”®é¢„æµ‹å‡†ç¡®ç‡ | **85%** |

**æ ¸å¿ƒä¼˜åŠ¿**:

- **åº“å­˜æˆæœ¬**: ä¼˜åŒ–åº“å­˜æ°´å¹³ï¼Œé™ä½åº“å­˜æˆæœ¬ 30%
- **ç¼ºè´§ç‡**: æ™ºèƒ½è¡¥è´§å»ºè®®ï¼Œé™ä½ç¼ºè´§ç‡ 50%
- **åº“å­˜å‘¨è½¬ç‡**: æå‡åº“å­˜å‘¨è½¬ç‡ 40%ï¼Œæé«˜èµ„é‡‘æ•ˆç‡
- **é¢„æµ‹å‡†ç¡®ç‡**: é”€å”®é¢„æµ‹å‡†ç¡®ç‡è¾¾åˆ° 85%ï¼Œæ”¯æŒç²¾å‡†å†³ç­–

## 2. ç³»ç»Ÿæ¶æ„

### 2.1 æ¶æ„è®¾è®¡

```text
é”€å”®æ•°æ®é‡‡é›†
  â†“
æ—¶åºæ•°æ®å­˜å‚¨ï¼ˆTimescaleDBï¼‰
  â”œâ”€â”€ é”€å”®æ—¶åºæ•°æ®
  â””â”€â”€ åº“å­˜å˜åŒ–æ•°æ®
  â†“
é¢„æµ‹æ¨¡å‹è®­ç»ƒ
  â”œâ”€â”€ æ—¶åºé¢„æµ‹æ¨¡å‹
  â””â”€â”€ æœºå™¨å­¦ä¹ æ¨¡å‹
  â†“
åº“å­˜ä¼˜åŒ–å¼•æ“
  â”œâ”€â”€ é”€å”®é¢„æµ‹
  â”œâ”€â”€ åº“å­˜ä¼˜åŒ–
  â””â”€â”€ è¡¥è´§å»ºè®®
  â†“
åº“å­˜ç®¡ç†å†³ç­–
```

### 2.2 æŠ€æœ¯æ ˆ

- **æ•°æ®åº“**: PostgreSQL + TimescaleDB + pgvector
- **æ•°æ®é‡‡é›†**: POS ç³»ç»Ÿã€ERP ç³»ç»Ÿ
- **é¢„æµ‹æ¨¡å‹**: Python + scikit-learnã€Prophet
- **åº”ç”¨æ¡†æ¶**: FastAPI / Spring Boot

## 3. æ•°æ®æ¨¡å‹è®¾è®¡

### 3.1 åº“å­˜è¡¨

```sql
CREATE TABLE inventory (
    id SERIAL PRIMARY KEY,
    product_id INTEGER NOT NULL,
    store_id INTEGER NOT NULL,
    current_stock INTEGER NOT NULL,
    min_stock INTEGER NOT NULL,
    max_stock INTEGER NOT NULL,
    reorder_point INTEGER NOT NULL,
    last_updated TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(product_id, store_id)
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX inventory_product_idx ON inventory (product_id);
CREATE INDEX inventory_store_idx ON inventory (store_id);
```

### 3.2 é”€å”®æ—¶åºè¡¨

```sql
-- åˆ›å»ºé”€å”®æ—¶åºè¡¨
CREATE TABLE sales_history (
    time TIMESTAMPTZ NOT NULL,
    product_id INTEGER NOT NULL,
    store_id INTEGER NOT NULL,
    quantity INTEGER NOT NULL,
    revenue DECIMAL(10, 2),
    discount DECIMAL(10, 2)
);

-- è½¬æ¢ä¸ºæ—¶åºè¡¨
SELECT create_hypertable('sales_history', 'time');

-- åˆ›å»ºç´¢å¼•
CREATE INDEX sales_history_product_time_idx ON sales_history (product_id, time DESC);
CREATE INDEX sales_history_store_time_idx ON sales_history (store_id, time DESC);
```

### 3.3 é¢„æµ‹æ¨¡å‹è¡¨

```sql
CREATE TABLE sales_forecasts (
    id SERIAL PRIMARY KEY,
    product_id INTEGER NOT NULL,
    store_id INTEGER NOT NULL,
    forecast_date DATE NOT NULL,
    predicted_quantity INTEGER NOT NULL,
    confidence_interval_lower INTEGER,
    confidence_interval_upper INTEGER,
    model_version TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(product_id, store_id, forecast_date)
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX sales_forecasts_product_date_idx ON sales_forecasts (product_id, forecast_date);
```

## 4. æ™ºèƒ½é¢„æµ‹ç®—æ³•

### 4.1 é”€å”®é¢„æµ‹

```python
# é”€å”®é¢„æµ‹
class SalesForecast:
    async def predict_sales(self, product_id, store_id, days=30):
        """é¢„æµ‹æœªæ¥é”€å”®"""
        # 1. è·å–å†å²é”€å”®æ•°æ®
        history = await self.db.fetch("""
            SELECT
                time_bucket('1 day', time) AS bucket,
                SUM(quantity) AS daily_quantity
            FROM sales_history
            WHERE product_id = $1 AND store_id = $2
                AND time > NOW() - INTERVAL '90 days'
            GROUP BY bucket
            ORDER BY bucket
        """, product_id, store_id)

        # 2. ä½¿ç”¨æ—¶åºé¢„æµ‹æ¨¡å‹
        forecast = self.time_series_model.predict(history, days)

        # 3. ä¿å­˜é¢„æµ‹ç»“æœ
        await self.save_forecast(product_id, store_id, forecast)

        return forecast
```

### 4.2 åº“å­˜ä¼˜åŒ–

```python
# åº“å­˜ä¼˜åŒ–
class InventoryOptimizer:
    async def optimize_inventory(self, product_id, store_id):
        """ä¼˜åŒ–åº“å­˜æ°´å¹³"""
        # 1. è·å–é”€å”®é¢„æµ‹
        forecast = await self.get_sales_forecast(product_id, store_id, days=30)

        # 2. è®¡ç®—å®‰å…¨åº“å­˜
        avg_daily_sales = forecast['avg_daily_sales']
        lead_time_days = await self.get_lead_time(product_id)
        safety_stock = self.calculate_safety_stock(
            avg_daily_sales,
            lead_time_days,
            service_level=0.95
        )

        # 3. è®¡ç®—è¡¥è´§ç‚¹
        reorder_point = (avg_daily_sales * lead_time_days) + safety_stock

        # 4. è®¡ç®—æœ€ä¼˜åº“å­˜
        optimal_stock = self.calculate_optimal_stock(
            forecast,
            reorder_point,
            holding_cost=0.2,
            stockout_cost=10.0
        )

        # 5. æ›´æ–°åº“å­˜é…ç½®
        await self.update_inventory_config(
            product_id,
            store_id,
            reorder_point,
            optimal_stock
        )

        return {
            'reorder_point': reorder_point,
            'optimal_stock': optimal_stock,
            'safety_stock': safety_stock
        }
```

### 4.3 è¡¥è´§å»ºè®®

```python
# è¡¥è´§å»ºè®®
class ReorderRecommendation:
    async def generate_reorder_suggestions(self, store_id):
        """ç”Ÿæˆè¡¥è´§å»ºè®®"""
        # 1. æŸ¥è¯¢éœ€è¦è¡¥è´§çš„å•†å“
        low_stock_items = await self.db.fetch("""
            SELECT
                i.product_id,
                i.current_stock,
                i.reorder_point,
                sf.predicted_quantity
            FROM inventory i
            LEFT JOIN sales_forecasts sf ON
                i.product_id = sf.product_id AND
                i.store_id = sf.store_id AND
                sf.forecast_date = CURRENT_DATE + INTERVAL '7 days'
            WHERE i.store_id = $1
                AND i.current_stock <= i.reorder_point
        """, store_id)

        # 2. è®¡ç®—è¡¥è´§æ•°é‡
        suggestions = []
        for item in low_stock_items:
            predicted_demand = item['predicted_quantity'] or 0
            reorder_quantity = max(
                item['reorder_point'] * 2 - item['current_stock'],
                predicted_demand * 7  # è‡³å°‘è¡¥è´§ä¸€å‘¨çš„éœ€æ±‚
            )

            suggestions.append({
                'product_id': item['product_id'],
                'current_stock': item['current_stock'],
                'reorder_quantity': reorder_quantity,
                'urgency': 'high' if item['current_stock'] < item['reorder_point'] * 0.5 else 'medium'
            })

        return suggestions
```

## 5. å®é™…åº”ç”¨æ¡ˆä¾‹

### 5.1 æ¡ˆä¾‹: é›¶å”®è¿é”åº“å­˜ç®¡ç†ç³»ç»Ÿï¼ˆçœŸå®æ¡ˆä¾‹ï¼‰

**ä¸šåŠ¡åœºæ™¯**:

æŸå¤§å‹é›¶å”®è¿é”ä¼ä¸šéœ€è¦ä¼˜åŒ–åº“å­˜ç®¡ç†ï¼Œé™ä½åº“å­˜æˆæœ¬ï¼Œé¿å…ç¼ºè´§å’Œç§¯å‹ã€‚

**é—®é¢˜åˆ†æ**:

1. **åº“å­˜æˆæœ¬é«˜**: åº“å­˜ç§¯å‹å¯¼è‡´æˆæœ¬é«˜
2. **ç¼ºè´§é¢‘ç¹**: ç¼ºè´§å¯¼è‡´é”€å”®æŸå¤±
3. **é¢„æµ‹ä¸å‡†**: é”€å”®é¢„æµ‹ä¸å‡†ç¡®
4. **è¡¥è´§ä¸åŠæ—¶**: è¡¥è´§å†³ç­–ä¾èµ–äººå·¥ç»éªŒ

**è§£å†³æ–¹æ¡ˆ**:

```python
# æ™ºèƒ½åº“å­˜ç®¡ç†ç³»ç»Ÿ
class IntelligentInventoryManagementSystem:
    def __init__(self):
        self.sales_forecast = SalesForecast()
        self.inventory_optimizer = InventoryOptimizer()
        self.reorder_recommendation = ReorderRecommendation()

    async def daily_inventory_optimization(self):
        """æ¯æ—¥åº“å­˜ä¼˜åŒ–"""
        # 1. è·å–æ‰€æœ‰é—¨åº—å’Œå•†å“
        stores = await self.get_all_stores()

        # 2. å¯¹æ¯ä¸ªé—¨åº—è¿›è¡Œä¼˜åŒ–
        for store in stores:
            products = await self.get_store_products(store['id'])

            for product in products:
                # 3. é”€å”®é¢„æµ‹
                forecast = await self.sales_forecast.predict_sales(
                    product['id'],
                    store['id']
                )

                # 4. åº“å­˜ä¼˜åŒ–
                optimization = await self.inventory_optimizer.optimize_inventory(
                    product['id'],
                    store['id']
                )

                # 5. ç”Ÿæˆè¡¥è´§å»ºè®®
                suggestions = await self.reorder_recommendation.generate_reorder_suggestions(
                    store['id']
                )

        return suggestions
```

**ä¼˜åŒ–æ•ˆæœ**:

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹å–„ |
|------|--------|--------|------|
| **åº“å­˜æˆæœ¬** | åŸºå‡† | **-30%** | **é™ä½** |
| **ç¼ºè´§ç‡** | 8% | **4%** | **50%** â¬‡ï¸ |
| **åº“å­˜å‘¨è½¬ç‡** | 6 æ¬¡/å¹´ | **8.4 æ¬¡/å¹´** | **40%** â¬†ï¸ |
| **é¢„æµ‹å‡†ç¡®ç‡** | 65% | **85%** | **31%** â¬†ï¸ |
| **èµ„é‡‘å ç”¨** | åŸºå‡† | **-25%** | **é™ä½** |

## 6. æœ€ä½³å®è·µ

### 6.1 æ•°æ®è´¨é‡

1. **æ•°æ®æ¸…æ´—**: æ¸…æ´—å¼‚å¸¸é”€å”®æ•°æ®
2. **æ•°æ®å®Œæ•´æ€§**: ç¡®ä¿æ•°æ®å®Œæ•´æ€§
3. **å®æ—¶æ›´æ–°**: å®æ—¶æ›´æ–°é”€å”®å’Œåº“å­˜æ•°æ®

### 6.2 é¢„æµ‹æ¨¡å‹ä¼˜åŒ–

1. **æ¨¡å‹é€‰æ‹©**: æ ¹æ®å•†å“ç‰¹æ€§é€‰æ‹©åˆé€‚çš„é¢„æµ‹æ¨¡å‹
2. **ç‰¹å¾å·¥ç¨‹**: æå–æœ‰æ•ˆçš„ç‰¹å¾ï¼ˆå­£èŠ‚æ€§ã€ä¿ƒé”€ç­‰ï¼‰
3. **æ¨¡å‹æ›´æ–°**: å®šæœŸæ›´æ–°æ¨¡å‹ï¼Œé€‚åº”å¸‚åœºå˜åŒ–

### 6.3 åº“å­˜ç­–ç•¥

1. **åˆ†ç±»ç®¡ç†**: æ ¹æ®å•†å“é‡è¦æ€§åˆ†ç±»ç®¡ç†
2. **å®‰å…¨åº“å­˜**: è®¾ç½®åˆç†çš„å®‰å…¨åº“å­˜æ°´å¹³
3. **è¡¥è´§é¢‘ç‡**: æ ¹æ®å•†å“ç‰¹æ€§è®¾ç½®è¡¥è´§é¢‘ç‡

## 7. å‚è€ƒèµ„æ–™

- [IoT æ—¶åºæ•°æ®åˆ†æ](../åˆ¶é€ åœºæ™¯/IoTæ—¶åºæ•°æ®åˆ†æ.md)
- [TimescaleDB æ—¶åºæ•°æ®åº“](../../04-å¤šæ¨¡ä¸€ä½“åŒ–/JSONBæ—¶åºå‘é‡/æ··åˆæ•°æ®æ¨¡å‹è®¾è®¡.md)

---

**æœ€åæ›´æ–°**: 2025 å¹´ 11 æœˆ 1 æ—¥
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: 08-08-01
