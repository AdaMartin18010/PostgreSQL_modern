# 智能客服系统 - 需求分析

## 元数据
- **案例类型**: RAG + 知识图谱 + LLM
- **难度等级**: ⭐⭐⭐⭐⭐
- **数据规模**: 10万+FAQ、百万级对话
- **技术栈**: PostgreSQL 18 + pgvector + Apache AGE + GPT-4
- **创建日期**: 2025-12-04

---

## 1. 业务背景

某电商平台需要构建**7x24小时智能客服系统**，处理用户咨询。

**业务需求**:
- 自动回答常见问题 (FAQ)
- 复杂问题转人工
- 多轮对话支持
- 知识库实时更新

**业务价值**:
- 人工客服成本降低70%
- 响应速度提升90%
- 用户满意度+35%
- 7x24小时服务

---

## 2. 核心功能

### 2.1 RAG+KG混合检索

```
用户问题: "如何申请退款?"
   ↓
[问题理解]
├─ 意图识别: 退款流程查询
├─ 实体识别: [退款]
└─ 情感分析: 中性
   ↓
[双路检索]
├─ 向量检索 (pgvector) → FAQ相似问题
└─ 图检索 (Apache AGE) → 关联知识点
   ↓
[结果融合]
├─ RRF融合
└─ 相关性排序
   ↓
[答案生成]
├─ LLM生成自然语言答案
├─ 添加操作步骤
└─ 附带相关链接
   ↓
返回: "退款流程：1. 进入订单页面... 2. 点击申请退款..."
```

### 2.2 多轮对话

```python
# 对话状态管理
class DialogueManager:
    def __init__(self):
        self.context = []  # 对话历史

    def process_turn(self, user_input):
        """处理一轮对话"""

        # 1. 结合上下文理解问题
        full_context = self.build_context(user_input)

        # 2. 检索+生成答案
        answer = self.rag_kg_system.answer(full_context)

        # 3. 更新对话状态
        self.context.append({
            'user': user_input,
            'assistant': answer,
            'timestamp': time.time()
        })

        return answer
```

---

## 3. 性能指标

| 指标 | 目标 |
|------|------|
| **问题解决率** | >80% (自动) |
| **响应延迟** | <2秒 (P95) |
| **准确率** | >90% |
| **用户满意度** | >4.5/5.0 |
| **QPS** | 500+ |

---

## 4. 技术架构

```
┌─────────────────────────────────────────┐
│          智能客服系统                    │
├─────────────────────────────────────────┤
│                                          │
│  ┌───────────┐  ┌───────────┐          │
│  │ 问题理解  │→│ RAG+KG    │          │
│  │ (NLU)     │  │ 混合检索  │          │
│  └───────────┘  └─────┬─────┘          │
│                       ↓                  │
│  ┌─────────────────────────────┐       │
│  │     PostgreSQL 18            │       │
│  ├──────────┬──────────┬────────┤      │
│  │ pgvector │ AGE图    │ 关系表 │      │
│  └──────────┴──────────┴────────┘      │
│                       ↓                  │
│  ┌───────────┐  ┌───────────┐          │
│  │ 答案生成  │←│ LLM       │          │
│  │ (GPT-4)   │  │ (缓存)    │          │
│  └───────────┘  └───────────┘          │
│                                          │
└─────────────────────────────────────────┘
```

---

**下一步**: [02-架构设计](./02-架构设计.md) | [返回案例库](../README.md)
