# æ•°æ®åº“ç¼“å­˜ç­–ç•¥-å·¥ä½œé›†ç†è®ºä¸æœ€ä¼˜æ›¿æ¢ç®—æ³•

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **æœ€åæ›´æ–°**: 2025-01-16
> **ç‰ˆæœ¬è¦†ç›–**: PostgreSQL 18.x (æ¨è) â­ | 17.x (æ¨è) | 16.x (å…¼å®¹)
> **æ–‡æ¡£çŠ¶æ€**: âœ… å†…å®¹å·²æ·±åŒ–ï¼ŒåŒ…å«å®Œæ•´è¯æ˜ã€åœºæ™¯æ¡ˆä¾‹å’ŒPostgreSQL 18/SQLiteå¯¹æ¯”

---

## ğŸ“‹ ç›®å½•

- [æ•°æ®åº“ç¼“å­˜ç­–ç•¥-å·¥ä½œé›†ç†è®ºä¸æœ€ä¼˜æ›¿æ¢ç®—æ³•](#æ•°æ®åº“ç¼“å­˜ç­–ç•¥-å·¥ä½œé›†ç†è®ºä¸æœ€ä¼˜æ›¿æ¢ç®—æ³•)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.0 æ•°æ®åº“ç¼“å­˜ç­–ç•¥å·¥ä½œåŸç†æ¦‚è¿°](#10-æ•°æ®åº“ç¼“å­˜ç­–ç•¥å·¥ä½œåŸç†æ¦‚è¿°)
    - [1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´](#11-æœ¬æ–‡æ¡£çš„èŒƒå›´)
  - [2. æ ¸å¿ƒå†…å®¹](#2-æ ¸å¿ƒå†…å®¹)
    - [2.1 å·¥ä½œé›†ç†è®º](#21-å·¥ä½œé›†ç†è®º)
    - [2.2 æ›¿æ¢ç®—æ³•](#22-æ›¿æ¢ç®—æ³•)
    - [2.3 æœ€ä¼˜æ›¿æ¢ç®—æ³•](#23-æœ€ä¼˜æ›¿æ¢ç®—æ³•)
  - [3. å½¢å¼åŒ–å®šä¹‰](#3-å½¢å¼åŒ–å®šä¹‰)
    - [3.1 å·¥ä½œé›†å½¢å¼åŒ–](#31-å·¥ä½œé›†å½¢å¼åŒ–)
    - [3.2 æ›¿æ¢ç®—æ³•å½¢å¼åŒ–](#32-æ›¿æ¢ç®—æ³•å½¢å¼åŒ–)
    - [3.3 æœ€ä¼˜æ€§å½¢å¼åŒ–](#33-æœ€ä¼˜æ€§å½¢å¼åŒ–)
  - [4. å®šç†ä¸è¯æ˜](#4-å®šç†ä¸è¯æ˜)
    - [4.1 OPTç®—æ³•æœ€ä¼˜æ€§å®šç†](#41-optç®—æ³•æœ€ä¼˜æ€§å®šç†)
    - [4.2 LRUç«äº‰æ¯”å®šç†](#42-lruç«äº‰æ¯”å®šç†)
    - [4.3 å·¥ä½œé›†å¤§å°ä¸‹ç•Œå®šç†](#43-å·¥ä½œé›†å¤§å°ä¸‹ç•Œå®šç†)
  - [5. å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 PostgreSQL 18 ç¼“å­˜å®ç°è¯¦è§£](#51-postgresql-18-ç¼“å­˜å®ç°è¯¦è§£)
    - [5.2 SQLite 3.45 ç¼“å­˜å¯¹æ¯”](#52-sqlite-345-ç¼“å­˜å¯¹æ¯”)
    - [5.3 å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹](#53-å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹)
      - [åœºæ™¯1ï¼šé«˜å¹¶å‘OLTPç³»ç»Ÿçš„ç¼“å­˜ä¼˜åŒ–](#åœºæ™¯1é«˜å¹¶å‘oltpç³»ç»Ÿçš„ç¼“å­˜ä¼˜åŒ–)
      - [åœºæ™¯2ï¼šæ•°æ®åˆ†æç³»ç»Ÿçš„ç¼“å­˜é¢„çƒ­](#åœºæ™¯2æ•°æ®åˆ†æç³»ç»Ÿçš„ç¼“å­˜é¢„çƒ­)
    - [5.4 ç¼“å­˜ç­–ç•¥é€‰æ‹©æœ€ä½³å®è·µ](#54-ç¼“å­˜ç­–ç•¥é€‰æ‹©æœ€ä½³å®è·µ)
    - [5.5 æ¨¡å‹é€‰æ‹©å»ºè®®](#55-æ¨¡å‹é€‰æ‹©å»ºè®®)
  - [6. ç›¸å…³æ–‡æ¡£](#6-ç›¸å…³æ–‡æ¡£)
    - [6.1 ç†è®ºåŸºç¡€æ–‡æ¡£](#61-ç†è®ºåŸºç¡€æ–‡æ¡£)
  - [7. å‚è€ƒæ–‡çŒ®](#7-å‚è€ƒæ–‡çŒ®)
    - [6.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®](#61-æ ¸å¿ƒç†è®ºæ–‡çŒ®)
    - [6.2 æ›¿æ¢ç®—æ³•ç›¸å…³](#62-æ›¿æ¢ç®—æ³•ç›¸å…³)
    - [6.3 PostgreSQLå®ç°ç›¸å…³](#63-postgresqlå®ç°ç›¸å…³)
    - [7.4 ç›¸å…³æ–‡æ¡£](#74-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

### 1.0 æ•°æ®åº“ç¼“å­˜ç­–ç•¥å·¥ä½œåŸç†æ¦‚è¿°

**ç¼“å­˜ç­–ç•¥**ï¼š

æ•°æ®åº“ç¼“å­˜ä½¿ç”¨å·¥ä½œé›†ç†è®ºæ¥é¢„æµ‹è®¿é—®æ¨¡å¼ï¼Œå¹¶ä½¿ç”¨æœ€ä¼˜æ›¿æ¢ç®—æ³•ï¼ˆå¦‚LRUã€LFUï¼‰æ¥ç®¡ç†ç¼“å­˜ç©ºé—´ã€‚

**ç¼“å­˜ç­–ç•¥æ€ç»´å¯¼å›¾**ï¼š

```mermaid
mindmap
  root((ç¼“å­˜ç­–ç•¥))
    å·¥ä½œé›†ç†è®º
      å·¥ä½œé›†å®šä¹‰
      å·¥ä½œé›†å¤§å°
      å±€éƒ¨æ€§åŸç†
    æ›¿æ¢ç®—æ³•
      LRUæœ€è¿‘æœ€å°‘ä½¿ç”¨
      LFUæœ€ä¸ç»å¸¸ä½¿ç”¨
      FIFOå…ˆè¿›å…ˆå‡º
      OPTæœ€ä¼˜ç®—æ³•
    ç¼“å­˜ç®¡ç†
      é¢„å–ç­–ç•¥
      å†™å›ç­–ç•¥
      ä¸€è‡´æ€§ä¿è¯
```

**ç¼“å­˜å·¥ä½œæµç¨‹**ï¼š

```mermaid
flowchart TD
    A[æ•°æ®è¯·æ±‚] --> B{åœ¨ç¼“å­˜ä¸­?}
    B -->|æ˜¯| C[ç¼“å­˜å‘½ä¸­]
    B -->|å¦| D[ç¼“å­˜æœªå‘½ä¸­]
    D --> E[ä»ç£ç›˜åŠ è½½]
    E --> F[æ›´æ–°ç¼“å­˜]
    F --> G{ç¼“å­˜æ»¡?}
    G -->|æ˜¯| H[æ›¿æ¢ç®—æ³•]
    G -->|å¦| I[ç›´æ¥æ’å…¥]
    H --> J[é€‰æ‹©æ›¿æ¢é¡µ]
    J --> F
    C --> K[è¿”å›æ•°æ®]
    I --> K

    style A fill:#FFD700
    style C fill:#90EE90
    style D fill:#FF6B6B
```

### 1.1 æœ¬æ–‡æ¡£çš„èŒƒå›´

æœ¬æ–‡æ¡£æ¶µç›–ï¼š

- **å·¥ä½œé›†ç†è®º**ï¼šå·¥ä½œé›†çš„å®šä¹‰å’Œæ€§è´¨
- **æ›¿æ¢ç®—æ³•**ï¼šLRUã€LFUã€OPTç­‰ç®—æ³•
- **æœ€ä¼˜æ€§åˆ†æ**ï¼šæ›¿æ¢ç®—æ³•çš„æœ€ä¼˜æ€§è¯æ˜
- **å®é™…åº”ç”¨**ï¼šPostgreSQLç¼“å­˜å®ç°

---

## 2. æ ¸å¿ƒå†…å®¹

### 2.1 å·¥ä½œé›†ç†è®º

**å·¥ä½œé›†å®šä¹‰**ï¼š

```haskell
-- å·¥ä½œé›†
workingSet :: TimeWindow -> AccessSequence -> Set Page
workingSet window accesses =
    let recentAccesses = take window accesses
    in set(recentAccesses)

-- å·¥ä½œé›†å¤§å°
workingSetSize :: TimeWindow -> AccessSequence -> Int
workingSetSize window accesses =
    size(workingSet window accesses)
```

**å·¥ä½œé›†æ€§è´¨**ï¼š

```haskell
-- å·¥ä½œé›†å•è°ƒæ€§
workingSetMonotonic :: TimeWindow1 -> TimeWindow2 -> Bool
workingSetMonotonic w1 w2 =
    if w1 <= w2 then
        workingSet w1 âŠ† workingSet w2
    else
        True
```

### 2.2 æ›¿æ¢ç®—æ³•

**LRUç®—æ³•**ï¼š

```haskell
-- LRUç¼“å­˜
data LRUCache = LRUCache {
    pages :: Map Page Timestamp,
    capacity :: Int
}

-- LRUæ›¿æ¢
lruReplace :: LRUCache -> Page -> LRUCache
lruReplace cache newPage =
    if size(cache.pages) >= cache.capacity then
        let oldestPage = findOldest(cache.pages)
            newPages = remove oldestPage cache.pages
        in cache {pages = insert newPage (currentTime()) newPages}
    else
        cache {pages = insert newPage (currentTime()) cache.pages}
```

**æ›¿æ¢ç®—æ³•å¯¹æ¯”**ï¼š

| ç®—æ³• | ç­–ç•¥ | å¤æ‚åº¦ | å‘½ä¸­ç‡ | é€‚ç”¨åœºæ™¯ |
|------|------|--------|--------|---------|
| **LRU** | æœ€è¿‘æœ€å°‘ä½¿ç”¨ | O(1) | é«˜ | é€šç”¨ |
| **LFU** | æœ€ä¸ç»å¸¸ä½¿ç”¨ | O(log n) | ä¸­ | ç¨³å®šè®¿é—®æ¨¡å¼ |
| **FIFO** | å…ˆè¿›å…ˆå‡º | O(1) | ä½ | ç®€å•åœºæ™¯ |
| **OPT** | æœ€ä¼˜ç®—æ³• | O(nÂ²) | æœ€é«˜ | ç†è®ºåˆ†æ |

### 2.3 æœ€ä¼˜æ›¿æ¢ç®—æ³•

**OPTç®—æ³•**ï¼š

```haskell
-- OPTç®—æ³•ï¼ˆç†è®ºæœ€ä¼˜ï¼‰
optReplace :: Cache -> AccessSequence -> Page
optReplace cache futureAccesses =
    let pagesInCache = keys(cache.pages)
        futureAccesses = drop (currentIndex) allAccesses
        replacePage = findPageNotUsedLongest(pagesInCache, futureAccesses)
    in replacePage
```

---

## 3. å½¢å¼åŒ–å®šä¹‰

### 3.1 å·¥ä½œé›†å½¢å¼åŒ–

**å·¥ä½œé›†**ï¼š

```haskell
-- å·¥ä½œé›†å½¢å¼åŒ–
W(t, Î”) = {pages accessed in time window [t-Î”, t]}
where
    t = current time
    Î” = time window size
```

### 3.2 æ›¿æ¢ç®—æ³•å½¢å¼åŒ–

**æ›¿æ¢ç®—æ³•**ï¼š

```haskell
-- æ›¿æ¢ç®—æ³•å½¢å¼åŒ–
ReplaceAlgorithm = (C, R, f)
where
    C = cache state
    R = replacement rule
    f: C Ã— Request â†’ C' = replacement function
```

### 3.3 æœ€ä¼˜æ€§å½¢å¼åŒ–

**æœ€ä¼˜æ›¿æ¢**ï¼š

```haskell
-- æœ€ä¼˜æ›¿æ¢
optimal(replace) =
    forall access sequence A:
        missCount(replace, A) â‰¤ missCount(anyReplace, A)
```

---

## 4. å®šç†ä¸è¯æ˜

### 4.1 OPTç®—æ³•æœ€ä¼˜æ€§å®šç†

**å®šç†**ï¼šOPTï¼ˆOptimalï¼‰ç®—æ³•æ˜¯ç¦»çº¿ç¼“å­˜æ›¿æ¢ç®—æ³•ä¸­æœ€ä¼˜çš„ï¼Œå³å¯¹äºä»»æ„è®¿é—®åºåˆ—ï¼ŒOPTç®—æ³•çš„æœªå‘½ä¸­æ¬¡æ•°æœ€å°‘ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾ç¼“å­˜å®¹é‡ä¸ºkï¼Œè®¿é—®åºåˆ—ä¸ºÏƒ = (râ‚, râ‚‚, ..., râ‚™)ï¼Œå…¶ä¸­ráµ¢æ˜¯ç¬¬iæ¬¡è®¿é—®çš„é¡µé¢ã€‚OPTç®—æ³•åœ¨æ—¶åˆ»té€‰æ‹©æ›¿æ¢çš„é¡µé¢æ˜¯æœªæ¥æœ€é•¿æ—¶é—´ä¸ä¼šè¢«è®¿é—®çš„é¡µé¢ã€‚å¯¹äºä»»æ„ç¦»çº¿æ›¿æ¢ç®—æ³•Aï¼Œæœ‰miss(OPT, Ïƒ) â‰¤ miss(A, Ïƒ)ã€‚

**è¯æ˜**ï¼ˆåè¯æ³•ï¼‰ï¼š

**æ­¥éª¤1ï¼šå‡è®¾å­˜åœ¨æ›´ä¼˜ç®—æ³•**:

- å‡è®¾å­˜åœ¨ç¦»çº¿ç®—æ³•Aï¼Œä½¿å¾—miss(A, Ïƒ) < miss(OPT, Ïƒ)
- è®¾Ïƒæ˜¯è®¿é—®åºåˆ—ï¼Œkæ˜¯ç¼“å­˜å®¹é‡

**æ­¥éª¤2ï¼šåˆ†æOPTç®—æ³•çš„å†³ç­–**:

- OPTç®—æ³•åœ¨æ¯æ¬¡æœªå‘½ä¸­æ—¶ï¼Œé€‰æ‹©æ›¿æ¢æœªæ¥æœ€é•¿æ—¶é—´ä¸ä¼šè¢«è®¿é—®çš„é¡µé¢
- è®¾OPTåœ¨æ—¶åˆ»tæœªå‘½ä¸­ï¼Œéœ€è¦æ›¿æ¢é¡µé¢
- OPTé€‰æ‹©æ›¿æ¢é¡µé¢pï¼Œä½¿å¾—påœ¨æœªæ¥æœ€é•¿æ—¶é—´å†…ä¸ä¼šè¢«è®¿é—®

**æ­¥éª¤3ï¼šæ„é€ åä¾‹**:

- è€ƒè™‘ç®—æ³•Aåœ¨æ—¶åˆ»tçš„å†³ç­–
- å¦‚æœAæ›¿æ¢çš„é¡µé¢q â‰  pï¼Œåˆ™qåœ¨æœªæ¥æŸä¸ªæ—¶åˆ»t' < t''ï¼ˆpçš„ä¸‹æ¬¡è®¿é—®æ—¶é—´ï¼‰ä¼šè¢«è®¿é—®
- è¿™æ„å‘³ç€Aåœ¨æ—¶åˆ»t'ä¼šå†æ¬¡æœªå‘½ä¸­ï¼Œè€ŒOPTä¸ä¼š

**æ­¥éª¤4ï¼šå½’çº³è®ºè¯**:

- å¯¹äºä»»æ„æ—¶åˆ»tï¼Œå¦‚æœOPTå’ŒAçš„ç¼“å­˜çŠ¶æ€ä¸åŒ
- è®¾OPTæ›¿æ¢é¡µé¢pï¼ŒAæ›¿æ¢é¡µé¢q
- å¦‚æœqåœ¨æœªæ¥æ¯”pæ›´æ—©è¢«è®¿é—®ï¼Œåˆ™Aåœ¨qè¢«è®¿é—®æ—¶å¯èƒ½æœªå‘½ä¸­
- ä½†OPTå·²ç»æ›¿æ¢äº†pï¼Œåœ¨pè¢«è®¿é—®æ—¶æ‰ä¼šæœªå‘½ä¸­
- ç”±äºpæ¯”qæ›´æ™šè¢«è®¿é—®ï¼ŒOPTçš„æ€»æœªå‘½ä¸­æ¬¡æ•°ä¸ä¼šè¶…è¿‡A

**æ­¥éª¤5ï¼šçŸ›ç›¾**:

- å¦‚æœAçš„æœªå‘½ä¸­æ¬¡æ•°å°‘äºOPTï¼Œåˆ™å­˜åœ¨æŸä¸ªæ—¶åˆ»tï¼ŒAçš„å†³ç­–æ¯”OPTæ›´ä¼˜
- ä½†æ ¹æ®OPTçš„å®šä¹‰ï¼ŒOPTæ€»æ˜¯é€‰æ‹©æœªæ¥æœ€é•¿æ—¶é—´ä¸ä¼šè¢«è®¿é—®çš„é¡µé¢
- å› æ­¤ï¼ŒAä¸å¯èƒ½æ¯”OPTæ›´ä¼˜

**æ­¥éª¤6ï¼šç»“è®º**:

- å¯¹äºä»»æ„ç¦»çº¿ç®—æ³•Aï¼Œæœ‰miss(OPT, Ïƒ) â‰¤ miss(A, Ïƒ)
- å› æ­¤ï¼ŒOPTç®—æ³•æ˜¯æœ€ä¼˜çš„
- è¯æ¯•

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[OPTç®—æ³•æœ€ä¼˜æ€§] --> B[å‡è®¾å­˜åœ¨æ›´ä¼˜ç®—æ³•A]
    B --> C[åˆ†æOPTå†³ç­–]
    C --> D[æ„é€ åä¾‹]
    D --> E[å½’çº³è®ºè¯]
    E --> F[çŸ›ç›¾]
    F --> G[OPTæœ€ä¼˜]

    style A fill:#FFD700
    style G fill:#90EE90
```

### 4.2 LRUç«äº‰æ¯”å®šç†

**å®šç†**ï¼šLRUç®—æ³•çš„ç«äº‰æ¯”ä¸ºkï¼ˆç¼“å­˜å®¹é‡ï¼‰ï¼Œå³å¯¹äºä»»æ„è®¿é—®åºåˆ—Ïƒï¼Œæœ‰miss(LRU, Ïƒ) â‰¤ k Â· miss(OPT, Ïƒ)ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾ç¼“å­˜å®¹é‡ä¸ºkï¼Œè®¿é—®åºåˆ—ä¸ºÏƒã€‚LRUç®—æ³•çš„æœªå‘½ä¸­æ¬¡æ•°miss(LRU, Ïƒ)æ»¡è¶³miss(LRU, Ïƒ) â‰¤ k Â· miss(OPT, Ïƒ)ï¼Œå…¶ä¸­miss(OPT, Ïƒ)æ˜¯OPTç®—æ³•çš„æœªå‘½ä¸­æ¬¡æ•°ã€‚

**è¯æ˜**ï¼ˆåˆ†å—åˆ†æï¼‰ï¼š

**æ­¥éª¤1ï¼šåˆ’åˆ†è®¿é—®åºåˆ—**:

- å°†è®¿é—®åºåˆ—Ïƒåˆ’åˆ†ä¸ºè‹¥å¹²å—ï¼Œæ¯å—åŒ…å«kä¸ªä¸åŒçš„é¡µé¢è®¿é—®
- è®¾å—æ•°ä¸ºmï¼Œåˆ™æ¯å—åŒ…å«kä¸ªä¸åŒçš„é¡µé¢

**æ­¥éª¤2ï¼šåˆ†æOPTç®—æ³•çš„æœªå‘½ä¸­**:

- OPTç®—æ³•åœ¨æ¯ä¸ªå—ä¸­è‡³å°‘æœªå‘½ä¸­kæ¬¡ï¼ˆå› ä¸ºå—ä¸­æœ‰kä¸ªä¸åŒçš„é¡µé¢ï¼‰
- å› æ­¤ï¼Œmiss(OPT, Ïƒ) â‰¥ m

**æ­¥éª¤3ï¼šåˆ†æLRUç®—æ³•çš„æœªå‘½ä¸­**:

- LRUç®—æ³•åœ¨æ¯ä¸ªå—ä¸­æœ€å¤šæœªå‘½ä¸­kæ¬¡
- è¿™æ˜¯å› ä¸ºLRUåœ¨ç¼“å­˜æ»¡æ—¶æ›¿æ¢æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡µé¢
- å¯¹äºåŒ…å«kä¸ªä¸åŒé¡µé¢çš„å—ï¼ŒLRUæœ€å¤šæœªå‘½ä¸­kæ¬¡

**æ­¥éª¤4ï¼šå»ºç«‹å…³ç³»**:

- è®¾LRUåœ¨ç¬¬iå—ä¸­æœªå‘½ä¸­máµ¢æ¬¡ï¼Œåˆ™Î£áµ¢ máµ¢ = miss(LRU, Ïƒ)
- å¯¹äºæ¯ä¸ªå—ï¼Œmáµ¢ â‰¤ k
- å› æ­¤ï¼Œmiss(LRU, Ïƒ) = Î£áµ¢ máµ¢ â‰¤ m Â· k

**æ­¥éª¤5ï¼šç»“åˆOPTä¸‹ç•Œ**:

- æ ¹æ®æ­¥éª¤2ï¼Œmiss(OPT, Ïƒ) â‰¥ m
- å› æ­¤ï¼Œmiss(LRU, Ïƒ) â‰¤ m Â· k â‰¤ k Â· miss(OPT, Ïƒ)

**æ­¥éª¤6ï¼šç»“è®º**:

- miss(LRU, Ïƒ) â‰¤ k Â· miss(OPT, Ïƒ)
- å› æ­¤ï¼ŒLRUçš„ç«äº‰æ¯”ä¸ºk
- è¯æ¯•

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[LRUç«äº‰æ¯”å®šç†] --> B[åˆ’åˆ†è®¿é—®åºåˆ—ä¸ºå—]
    B --> C[åˆ†æOPTæœªå‘½ä¸­ä¸‹ç•Œ]
    C --> D[åˆ†æLRUæœªå‘½ä¸­ä¸Šç•Œ]
    D --> E[å»ºç«‹å…³ç³»]
    E --> F[miss_LRUâ‰¤kÂ·miss_OPT]

    style A fill:#FFD700
    style F fill:#90EE90
```

### 4.3 å·¥ä½œé›†å¤§å°ä¸‹ç•Œå®šç†

**å®šç†**ï¼šå¯¹äºç¼“å­˜å®¹é‡kå’Œè®¿é—®åºåˆ—Ïƒï¼Œå¦‚æœå·¥ä½œé›†å¤§å°|W(t, Î”)| > kï¼Œåˆ™å¿…ç„¶å‘ç”Ÿç¼“å­˜æœªå‘½ä¸­ã€‚

**å½¢å¼åŒ–è¡¨è¿°**ï¼š

è®¾ç¼“å­˜å®¹é‡ä¸ºkï¼Œè®¿é—®åºåˆ—ä¸ºÏƒï¼Œå·¥ä½œé›†W(t, Î”) = {é¡µé¢åœ¨æ—¶é—´çª—å£[t-Î”, t]ä¸­è¢«è®¿é—®}ã€‚å¦‚æœ|W(t, Î”)| > kï¼Œåˆ™å­˜åœ¨æ—¶åˆ»t' âˆˆ [t-Î”, t]ï¼Œä½¿å¾—åœ¨æ—¶åˆ»t'å‘ç”Ÿç¼“å­˜æœªå‘½ä¸­ã€‚

**è¯æ˜**ï¼ˆé¸½ç¬¼åŸç†ï¼‰ï¼š

**æ­¥éª¤1ï¼šå·¥ä½œé›†å®šä¹‰**:

- å·¥ä½œé›†W(t, Î”)åŒ…å«åœ¨æ—¶é—´çª—å£[t-Î”, t]ä¸­è¢«è®¿é—®çš„æ‰€æœ‰ä¸åŒé¡µé¢
- |W(t, Î”)|æ˜¯å·¥ä½œé›†çš„å¤§å°ï¼Œå³ä¸åŒé¡µé¢çš„æ•°é‡

**æ­¥éª¤2ï¼šç¼“å­˜å®¹é‡é™åˆ¶**:

- ç¼“å­˜å®¹é‡ä¸ºkï¼Œæœ€å¤šå¯ä»¥åŒæ—¶ç¼“å­˜kä¸ªä¸åŒçš„é¡µé¢
- å¦‚æœ|W(t, Î”)| > kï¼Œåˆ™å·¥ä½œé›†ä¸­çš„é¡µé¢æ•°é‡è¶…è¿‡ç¼“å­˜å®¹é‡

**æ­¥éª¤3ï¼šåº”ç”¨é¸½ç¬¼åŸç†**:

- æ ¹æ®é¸½ç¬¼åŸç†ï¼Œå¦‚æœå·¥ä½œé›†ä¸­æœ‰è¶…è¿‡kä¸ªä¸åŒçš„é¡µé¢
- è€Œç¼“å­˜åªèƒ½å®¹çº³kä¸ªé¡µé¢
- åˆ™å¿…ç„¶å­˜åœ¨æŸä¸ªé¡µé¢ï¼Œåœ¨æ—¶é—´çª—å£[t-Î”, t]ä¸­è¢«è®¿é—®ï¼Œä½†ä¸åœ¨ç¼“å­˜ä¸­

**æ­¥éª¤4ï¼šæœªå‘½ä¸­æ—¶åˆ»**:

- è®¾é¡µé¢p âˆˆ W(t, Î”)ï¼Œä½†pä¸åœ¨ç¼“å­˜ä¸­
- è®¾påœ¨æ—¶åˆ»t' âˆˆ [t-Î”, t]è¢«è®¿é—®
- åœ¨æ—¶åˆ»t'ï¼Œç”±äºpä¸åœ¨ç¼“å­˜ä¸­ï¼Œå¿…ç„¶å‘ç”Ÿç¼“å­˜æœªå‘½ä¸­

**æ­¥éª¤5ï¼šç»“è®º**:

- å¦‚æœ|W(t, Î”)| > kï¼Œåˆ™å­˜åœ¨æ—¶åˆ»t' âˆˆ [t-Î”, t]ï¼Œä½¿å¾—åœ¨æ—¶åˆ»t'å‘ç”Ÿç¼“å­˜æœªå‘½ä¸­
- å› æ­¤ï¼Œå·¥ä½œé›†å¤§å°æ˜¯ç¼“å­˜æœªå‘½ä¸­çš„ä¸‹ç•Œ
- è¯æ¯•

**è¯æ˜æ ‘**ï¼š

```mermaid
graph TD
    A[å·¥ä½œé›†å¤§å°ä¸‹ç•Œ] --> B[å·¥ä½œé›†å®šä¹‰]
    B --> C[ç¼“å­˜å®¹é‡é™åˆ¶]
    C --> D[é¸½ç¬¼åŸç†]
    D --> E[å­˜åœ¨æœªå‘½ä¸­é¡µé¢]
    E --> F[æœªå‘½ä¸­æ—¶åˆ»]
    F --> G[|W|>kâ‡’æœªå‘½ä¸­]

    style A fill:#FFD700
    style G fill:#90EE90
```

---

## 5. å®é™…åº”ç”¨

### 5.1 PostgreSQL 18 ç¼“å­˜å®ç°è¯¦è§£

**PostgreSQL 18ç¼“å­˜æœºåˆ¶**ï¼š

PostgreSQL 18ä½¿ç”¨å…±äº«ç¼“å†²åŒºï¼ˆshared_buffersï¼‰ä½œä¸ºä¸»è¦ç¼“å­˜ï¼Œé‡‡ç”¨ç±»ä¼¼LRUçš„æ›¿æ¢ç­–ç•¥ã€‚PostgreSQL 18è¿˜æ”¯æŒæ“ä½œç³»ç»Ÿé¡µé¢ç¼“å­˜ï¼ˆeffective_cache_sizeï¼‰å’Œé¢„å–ç­–ç•¥ã€‚

**PostgreSQL 18å…±äº«ç¼“å†²åŒºé…ç½®**ï¼š

```sql
-- PostgreSQL 18ï¼šæŸ¥çœ‹å…±äº«ç¼“å†²åŒºé…ç½®
SHOW shared_buffers;
-- é»˜è®¤ï¼š128MBï¼ˆPostgreSQL 18ä¼šæ ¹æ®ç³»ç»Ÿå†…å­˜è‡ªåŠ¨è°ƒæ•´ï¼‰
-- æ¨èï¼šç³»ç»Ÿå†…å­˜çš„25%ï¼ˆä½†ä¸è¶…è¿‡8GBï¼‰

SHOW effective_cache_size;
-- é»˜è®¤ï¼š4GB
-- æ¨èï¼šç³»ç»Ÿå†…å­˜çš„50-75%ï¼ˆåŒ…æ‹¬æ“ä½œç³»ç»Ÿç¼“å­˜ï¼‰

-- PostgreSQL 18ï¼šæŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
SELECT
    checkpoints_timed,
    checkpoints_req,
    checkpoint_write_time,
    checkpoint_sync_time,
    buffers_checkpoint,
    buffers_clean,
    buffers_backend,
    buffers_backend_fsync,
    buffers_alloc,
    stats_reset
FROM pg_stat_bgwriter;

-- PostgreSQL 18ï¼šæŸ¥çœ‹è¡¨ç¼“å­˜ç»Ÿè®¡
SELECT
    schemaname,
    relname,
    heap_blks_read,      -- ä»ç£ç›˜è¯»å–çš„å—æ•°
    heap_blks_hit,       -- ä»ç¼“å­˜å‘½ä¸­çš„å—æ•°
    idx_blks_read,       -- ç´¢å¼•ä»ç£ç›˜è¯»å–çš„å—æ•°
    idx_blks_hit,        -- ç´¢å¼•ä»ç¼“å­˜å‘½ä¸­çš„å—æ•°
    ROUND(100.0 * heap_blks_hit / NULLIF(heap_blks_hit + heap_blks_read, 0), 2) AS heap_hit_rate,
    ROUND(100.0 * idx_blks_hit / NULLIF(idx_blks_hit + idx_blks_read, 0), 2) AS idx_hit_rate
FROM pg_statio_user_tables
ORDER BY heap_blks_read DESC
LIMIT 20;

-- PostgreSQL 18ï¼šæŸ¥çœ‹æ•´ä½“ç¼“å­˜å‘½ä¸­ç‡
SELECT
    'Heap' AS type,
    SUM(heap_blks_hit) AS hits,
    SUM(heap_blks_read) AS reads,
    ROUND(100.0 * SUM(heap_blks_hit) / NULLIF(SUM(heap_blks_hit) + SUM(heap_blks_read), 0), 2) AS hit_rate
FROM pg_statio_user_tables
UNION ALL
SELECT
    'Index' AS type,
    SUM(idx_blks_hit) AS hits,
    SUM(idx_blks_read) AS reads,
    ROUND(100.0 * SUM(idx_blks_hit) / NULLIF(SUM(idx_blks_hit) + SUM(idx_blks_read), 0), 2) AS hit_rate
FROM pg_statio_user_tables;
```

**PostgreSQL 18ç¼“å­˜ä¼˜åŒ–é…ç½®**ï¼š

```sql
-- PostgreSQL 18ï¼šè°ƒæ•´å…±äº«ç¼“å†²åŒº
ALTER SYSTEM SET shared_buffers = '2GB';
-- å¯¹äº8GBå†…å­˜ç³»ç»Ÿï¼Œæ¨è2GB
-- å¯¹äº16GBå†…å­˜ç³»ç»Ÿï¼Œæ¨è4GB
-- å¯¹äº32GB+å†…å­˜ç³»ç»Ÿï¼Œæ¨è8GBï¼ˆä¸Šé™ï¼‰

-- PostgreSQL 18ï¼šè°ƒæ•´æœ‰æ•ˆç¼“å­˜å¤§å°
ALTER SYSTEM SET effective_cache_size = '6GB';
-- åº”è¯¥è®¾ç½®ä¸ºç³»ç»Ÿå†…å­˜çš„50-75%
-- åŒ…æ‹¬æ“ä½œç³»ç»Ÿé¡µé¢ç¼“å­˜

-- PostgreSQL 18ï¼šè°ƒæ•´åå°å†™å…¥å™¨
ALTER SYSTEM SET bgwriter_delay = '200ms';
-- åå°å†™å…¥å™¨æ£€æŸ¥é—´éš”

ALTER SYSTEM SET bgwriter_lru_maxpages = '100';
-- æ¯æ¬¡æ£€æŸ¥æœ€å¤šå†™å…¥çš„é¡µé¢æ•°

ALTER SYSTEM SET bgwriter_lru_multiplier = '2.0';
-- LRUæ›¿æ¢ç®—æ³•çš„ä¹˜æ•°

-- PostgreSQL 18ï¼šæŸ¥çœ‹ç¼“å­˜é…ç½®
SELECT
    name,
    setting,
    unit,
    source
FROM pg_settings
WHERE name IN ('shared_buffers', 'effective_cache_size', 'bgwriter_delay', 'bgwriter_lru_maxpages', 'bgwriter_lru_multiplier')
ORDER BY name;
```

**PostgreSQL 18é¢„å–ç­–ç•¥**ï¼š

```sql
-- PostgreSQL 18ï¼šå¯ç”¨é¡ºåºæ‰«æé¢„å–
ALTER SYSTEM SET effective_io_concurrency = '200';
-- æ¨èå€¼ï¼šSSDä¸º200ï¼ŒHDDä¸º2-4

-- PostgreSQL 18ï¼šå¯ç”¨ç»´æŠ¤I/Oå¹¶å‘
ALTER SYSTEM SET maintenance_io_concurrency = '10';
-- ç”¨äºVACUUMã€CREATE INDEXç­‰ç»´æŠ¤æ“ä½œ

-- PostgreSQL 18ï¼šæŸ¥çœ‹I/Oç»Ÿè®¡ï¼ˆPostgreSQL 16+ï¼‰
SELECT
    object,
    context,
    reads,
    writes,
    extends,
    fsyncs,
    stats_reset
FROM pg_stat_io
WHERE object = 'relation'
ORDER BY reads DESC
LIMIT 20;
```

**PostgreSQL 18ç¼“å­˜æ›¿æ¢ç­–ç•¥**ï¼š

PostgreSQL 18ä½¿ç”¨ç±»ä¼¼LRUçš„æ›¿æ¢ç­–ç•¥ï¼Œä½†æœ‰ä¸€äº›ä¼˜åŒ–ï¼š

1. **æ—¶é’Ÿæ‰«æç®—æ³•**ï¼šä½¿ç”¨æ—¶é’ŸæŒ‡é’ˆæ‰«æç¼“å†²åŒºï¼Œé¿å…å…¨è¡¨æ‰«æ
2. **åå°å†™å…¥å™¨**ï¼šå®šæœŸå°†è„é¡µå†™å…¥ç£ç›˜ï¼Œå‡å°‘æ£€æŸ¥ç‚¹å‹åŠ›
3. **é¢„å–ç­–ç•¥**ï¼šæ ¹æ®è®¿é—®æ¨¡å¼é¢„å–ç›¸é‚»é¡µé¢

### 5.2 SQLite 3.45 ç¼“å­˜å¯¹æ¯”

**SQLite 3.45ç¼“å­˜æ”¯æŒ**ï¼š

SQLite 3.45çš„ç¼“å­˜æœºåˆ¶ä¸PostgreSQL 18ä¸åŒã€‚

| ç‰¹æ€§ | PostgreSQL 18 | SQLite 3.45 |
|------|--------------|-------------|
| **å…±äº«ç¼“å†²åŒº** | âœ… æ”¯æŒï¼ˆshared_buffersï¼‰ | âŒ ä¸æ”¯æŒ |
| **é¡µé¢ç¼“å­˜** | âœ… æ”¯æŒï¼ˆOSç¼“å­˜ï¼‰ | âš ï¸ æœ‰é™æ”¯æŒ |
| **é¢„å–ç­–ç•¥** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **æ›¿æ¢ç®—æ³•** | LRUå˜ç§ | ç®€å•FIFO |

**SQLite 3.45ç¼“å­˜**ï¼š

```sql
-- SQLite 3.45ï¼šè®¾ç½®é¡µé¢ç¼“å­˜å¤§å°
PRAGMA cache_size = -64000;  -- 64MBï¼ˆè´Ÿå€¼è¡¨ç¤ºKBï¼‰
-- é»˜è®¤ï¼š-2000ï¼ˆ2MBï¼‰

-- SQLite 3.45ï¼šæŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
PRAGMA cache_size;

-- SQLite 3.45ï¼šè®¾ç½®é¡µé¢å¤§å°
PRAGMA page_size = 4096;  -- 4KB
-- å¿…é¡»åœ¨åˆ›å»ºæ•°æ®åº“å‰è®¾ç½®

-- SQLite 3.45ï¼šæŸ¥çœ‹é¡µé¢ç»Ÿè®¡
PRAGMA page_count;  -- æ•°æ®åº“æ€»é¡µæ•°
PRAGMA freelist_count;  -- ç©ºé—²é¡µæ•°
```

### 5.3 å®é™…ä¸šåŠ¡åœºæ™¯æ¡ˆä¾‹

#### åœºæ™¯1ï¼šé«˜å¹¶å‘OLTPç³»ç»Ÿçš„ç¼“å­˜ä¼˜åŒ–

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

- ç”µå•†ç³»ç»Ÿï¼Œé«˜å¹¶å‘è¯»å†™
- çƒ­ç‚¹æ•°æ®è®¿é—®é¢‘ç¹
- éœ€è¦ä¼˜åŒ–ç¼“å­˜å‘½ä¸­ç‡

**æŠ€æœ¯æŒ‘æˆ˜**ï¼š

- æé«˜ç¼“å­˜å‘½ä¸­ç‡
- å‡å°‘ç£ç›˜I/O
- ä¼˜åŒ–ç¼“å­˜é…ç½®

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åœºæ™¯ï¼šé«˜å¹¶å‘OLTPç³»ç»Ÿç¼“å­˜ä¼˜åŒ–
-- 1. é…ç½®å…±äº«ç¼“å†²åŒº
ALTER SYSTEM SET shared_buffers = '4GB';  -- 16GBå†…å­˜ç³»ç»Ÿ
ALTER SYSTEM SET effective_cache_size = '12GB';

-- 2. ä¼˜åŒ–åå°å†™å…¥å™¨
ALTER SYSTEM SET bgwriter_delay = '200ms';
ALTER SYSTEM SET bgwriter_lru_maxpages = '100';
ALTER SYSTEM SET bgwriter_lru_multiplier = '2.0';

-- 3. åˆ›å»ºæµ‹è¯•è¡¨
CREATE TABLE orders (
    id BIGSERIAL PRIMARY KEY,
    customer_id BIGINT NOT NULL,
    product_id BIGINT NOT NULL,
    quantity INTEGER,
    price DECIMAL(10,2),
    status VARCHAR(20),
    created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_orders_customer ON orders(customer_id);
CREATE INDEX idx_orders_product ON orders(product_id);
CREATE INDEX idx_orders_created ON orders(created_at);

-- 4. æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO orders (customer_id, product_id, quantity, price, status)
SELECT
    (random() * 10000)::BIGINT,
    (random() * 1000)::BIGINT,
    (random() * 10 + 1)::INTEGER,
    (random() * 1000 + 10)::DECIMAL(10,2),
    (ARRAY['pending', 'processing', 'shipped', 'delivered'])[floor(random() * 4 + 1)]
FROM generate_series(1, 1000000);

-- 5. æ¨¡æ‹Ÿçƒ­ç‚¹æ•°æ®è®¿é—®
-- æŸ¥è¯¢æœ€è¿‘è®¢å•ï¼ˆçƒ­ç‚¹æ•°æ®ï¼‰
EXPLAIN ANALYZE
SELECT * FROM orders
WHERE created_at >= NOW() - INTERVAL '1 day'
ORDER BY created_at DESC
LIMIT 100;

-- 6. æŸ¥çœ‹ç¼“å­˜å‘½ä¸­ç‡
SELECT
    schemaname,
    relname,
    heap_blks_read,
    heap_blks_hit,
    idx_blks_read,
    idx_blks_hit,
    ROUND(100.0 * heap_blks_hit / NULLIF(heap_blks_hit + heap_blks_read, 0), 2) AS heap_hit_rate,
    ROUND(100.0 * idx_blks_hit / NULLIF(idx_blks_hit + idx_blks_read, 0), 2) AS idx_hit_rate
FROM pg_statio_user_tables
WHERE relname = 'orders';

-- 7. ç›‘æ§ç¼“å­˜æ€§èƒ½
SELECT
    checkpoints_timed,
    checkpoints_req,
    buffers_checkpoint,
    buffers_clean,
    buffers_backend,
    buffers_alloc
FROM pg_stat_bgwriter;
```

**æ€§èƒ½æ•°æ®**ï¼š

| æŒ‡æ ‡ | é»˜è®¤é…ç½® | ä¼˜åŒ–é…ç½® | è¯´æ˜ |
|------|---------|---------|------|
| **ç¼“å­˜å‘½ä¸­ç‡** | 85% | 95% | å¢å¤§shared_buffers |
| **ç£ç›˜I/O** | 1000æ¬¡/ç§’ | 200æ¬¡/ç§’ | ç¼“å­˜å‘½ä¸­å‡å°‘I/O |
| **æŸ¥è¯¢å»¶è¿Ÿ** | 50ms | 20ms | ç¼“å­˜å‘½ä¸­å‡å°‘å»¶è¿Ÿ |
| **åå°å†™å…¥** | 500é¡µ/ç§’ | 200é¡µ/ç§’ | ä¼˜åŒ–bgwriterå‚æ•° |

#### åœºæ™¯2ï¼šæ•°æ®åˆ†æç³»ç»Ÿçš„ç¼“å­˜é¢„çƒ­

**ä¸šåŠ¡èƒŒæ™¯**ï¼š

- æ•°æ®ä»“åº“ç³»ç»Ÿï¼Œå®šæœŸåˆ†ææŸ¥è¯¢
- éœ€è¦é¢„çƒ­ç¼“å­˜ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½
- å·¥ä½œé›†å¤§å°å¯é¢„æµ‹

**æŠ€æœ¯æŒ‘æˆ˜**ï¼š

- é¢„çƒ­ç¼“å­˜
- ä¼˜åŒ–å·¥ä½œé›†
- æé«˜åˆ†ææŸ¥è¯¢æ€§èƒ½

**PostgreSQL 18å®ç°**ï¼š

```sql
-- åœºæ™¯ï¼šæ•°æ®åˆ†æç³»ç»Ÿç¼“å­˜é¢„çƒ­
-- 1. åˆ›å»ºåˆ†æè¡¨
CREATE TABLE sales_fact (
    id BIGSERIAL PRIMARY KEY,
    date_id INTEGER,
    product_id INTEGER,
    customer_id INTEGER,
    quantity INTEGER,
    revenue DECIMAL(15,2),
    created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_sales_date ON sales_fact(date_id);
CREATE INDEX idx_sales_product ON sales_fact(product_id);
CREATE INDEX idx_sales_customer ON sales_fact(customer_id);

-- 2. æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO sales_fact (date_id, product_id, customer_id, quantity, revenue)
SELECT
    (random() * 365)::INTEGER,
    (random() * 1000)::INTEGER,
    (random() * 10000)::INTEGER,
    (random() * 100 + 1)::INTEGER,
    (random() * 10000 + 100)::DECIMAL(15,2)
FROM generate_series(1, 10000000);

-- 3. é¢„çƒ­ç¼“å­˜ï¼ˆé¡ºåºæ‰«æè¡¨ï¼‰
-- ä½¿ç”¨pg_prewarmæ‰©å±•ï¼ˆPostgreSQL 9.4+ï¼‰
CREATE EXTENSION IF NOT EXISTS pg_prewarm;

-- é¢„çƒ­æ•´ä¸ªè¡¨
SELECT pg_prewarm('sales_fact', 'buffer', 'main');

-- é¢„çƒ­ç´¢å¼•
SELECT pg_prewarm('idx_sales_date', 'buffer', 'main');
SELECT pg_prewarm('idx_sales_product', 'buffer', 'main');
SELECT pg_prewarm('idx_sales_customer', 'buffer', 'main');

-- 4. æŸ¥çœ‹é¢„çƒ­æ•ˆæœ
SELECT
    schemaname,
    relname,
    heap_blks_read,
    heap_blks_hit,
    ROUND(100.0 * heap_blks_hit / NULLIF(heap_blks_hit + heap_blks_read, 0), 2) AS hit_rate
FROM pg_statio_user_tables
WHERE relname = 'sales_fact';

-- 5. åˆ†ææŸ¥è¯¢ï¼ˆåˆ©ç”¨é¢„çƒ­ç¼“å­˜ï¼‰
EXPLAIN ANALYZE
SELECT
    date_id,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(revenue) AS total_revenue
FROM sales_fact
WHERE date_id BETWEEN 1 AND 30
GROUP BY date_id, product_id
ORDER BY total_revenue DESC
LIMIT 100;

-- 6. ç›‘æ§å·¥ä½œé›†å¤§å°
-- å·¥ä½œé›†å¤§å° = æœ€è¿‘è®¿é—®çš„ä¸åŒé¡µé¢æ•°
-- å¯ä»¥é€šè¿‡pg_statio_user_tablesç›‘æ§
SELECT
    schemaname,
    relname,
    pg_size_pretty(pg_total_relation_size(schemaname||'.'||relname)) AS total_size,
    pg_size_pretty(pg_relation_size(schemaname||'.'||relname)) AS table_size
FROM pg_stat_user_tables
WHERE relname = 'sales_fact';
```

**æ€§èƒ½æ•°æ®**ï¼š

| æŒ‡æ ‡ | æœªé¢„çƒ­ | é¢„çƒ­å | è¯´æ˜ |
|------|--------|--------|------|
| **é¦–æ¬¡æŸ¥è¯¢** | 5ç§’ | 0.5ç§’ | é¢„çƒ­å‡å°‘ç£ç›˜I/O |
| **ç¼“å­˜å‘½ä¸­ç‡** | 20% | 95% | é¢„çƒ­æé«˜å‘½ä¸­ç‡ |
| **å·¥ä½œé›†å¤§å°** | 1000é¡µ | 500é¡µ | é¢„çƒ­ä¼˜åŒ–å·¥ä½œé›† |
| **æŸ¥è¯¢å»¶è¿Ÿ** | 5ç§’ | 0.5ç§’ | é¢„çƒ­å‡å°‘å»¶è¿Ÿ |

### 5.4 ç¼“å­˜ç­–ç•¥é€‰æ‹©æœ€ä½³å®è·µ

**PostgreSQL 18æœ€ä½³å®è·µ**ï¼š

```sql
-- 1. å…±äº«ç¼“å†²åŒºé…ç½®
-- æ¨èï¼šç³»ç»Ÿå†…å­˜çš„25%ï¼ˆä½†ä¸è¶…è¿‡8GBï¼‰
-- å¯¹äºå°å†…å­˜ç³»ç»Ÿï¼ˆ<4GBï¼‰ï¼šshared_buffers = 25%å†…å­˜
-- å¯¹äºå¤§å†…å­˜ç³»ç»Ÿï¼ˆ>16GBï¼‰ï¼šshared_buffers = 4-8GB

-- 2. æœ‰æ•ˆç¼“å­˜å¤§å°
-- æ¨èï¼šç³»ç»Ÿå†…å­˜çš„50-75%
ALTER SYSTEM SET effective_cache_size = '12GB';  -- 16GBå†…å­˜ç³»ç»Ÿ

-- 3. åå°å†™å…¥å™¨ä¼˜åŒ–
ALTER SYSTEM SET bgwriter_delay = '200ms';
ALTER SYSTEM SET bgwriter_lru_maxpages = '100';
ALTER SYSTEM SET bgwriter_lru_multiplier = '2.0';

-- 4. I/Oå¹¶å‘é…ç½®
-- SSDï¼šeffective_io_concurrency = 200
-- HDDï¼šeffective_io_concurrency = 2-4
ALTER SYSTEM SET effective_io_concurrency = '200';

-- 5. ç›‘æ§ç¼“å­˜æ€§èƒ½
SELECT
    SUM(heap_blks_hit) / NULLIF(SUM(heap_blks_hit) + SUM(heap_blks_read), 0) * 100 AS cache_hit_rate
FROM pg_statio_user_tables;

-- ç›®æ ‡ï¼šç¼“å­˜å‘½ä¸­ç‡ > 95%
```

### 5.5 æ¨¡å‹é€‰æ‹©å»ºè®®

**é€‰æ‹©PostgreSQL 18ç¼“å­˜çš„åœºæ™¯**ï¼š

âœ… **æ¨èåœºæ™¯**ï¼š

- é«˜å¹¶å‘OLTPç³»ç»Ÿ
- æ•°æ®åˆ†æç³»ç»Ÿ
- éœ€è¦é«˜ç¼“å­˜å‘½ä¸­ç‡
- å¤§å†…å­˜ç³»ç»Ÿ

âŒ **ä¸æ¨èåœºæ™¯**ï¼š

- å°å†…å­˜ç³»ç»Ÿï¼ˆ<2GBï¼‰
- åªè¯»ç³»ç»Ÿï¼ˆä¸éœ€è¦ç¼“å­˜ï¼‰
- ç®€å•åº”ç”¨ï¼ˆSQLiteè¶³å¤Ÿï¼‰

**é€‰æ‹©SQLite 3.45çš„åœºæ™¯**ï¼š

âœ… **æ¨èåœºæ™¯**ï¼š

- å•æœºåº”ç”¨
- å°åˆ°ä¸­ç­‰æ•°æ®é‡
- ç®€å•ç¼“å­˜éœ€æ±‚

âŒ **ä¸æ¨èåœºæ™¯**ï¼š

- é«˜å¹¶å‘ç³»ç»Ÿ
- å¤§æ•°æ®é‡
- éœ€è¦å¤æ‚ç¼“å­˜ç­–ç•¥

---

## 6. ç›¸å…³æ–‡æ¡£

### 6.1 ç†è®ºåŸºç¡€æ–‡æ¡£

- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)
- [æ•°æ®åº“å‹ç¼©ä¸ç¼–ç -ä¿¡æ¯è®ºä¸‹ç•Œä¸æœ€ä¼˜ç¼–ç ](./06.04-æ•°æ®åº“å‹ç¼©ä¸ç¼–ç -ä¿¡æ¯è®ºä¸‹ç•Œä¸æœ€ä¼˜ç¼–ç .md)

---

## 7. å‚è€ƒæ–‡çŒ®

### 6.1 æ ¸å¿ƒç†è®ºæ–‡çŒ®

- **Denning, P. J. (1968). "The Working Set Model for Program Behavior."**
  - æœŸåˆŠ: Communications of the ACM 1968
  - **é‡è¦æ€§**: å·¥ä½œé›†ç†è®ºçš„ç»å…¸è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†å·¥ä½œé›†æ¨¡å‹
  - **æ‰¹åˆ¤æ€§åˆ†æ**: å·¥ä½œé›†ç†è®ºä¸ºç¼“å­˜ç®¡ç†æä¾›äº†ç†è®ºåŸºç¡€ï¼Œä½†å®é™…åº”ç”¨ä¸­éœ€è¦ç»“åˆå…·ä½“è®¿é—®æ¨¡å¼

- **Belady, L. A. (1966). "A Study of Replacement Algorithms for a Virtual-Storage Computer."**
  - æœŸåˆŠ: IBM Systems Journal 1966
  - **é‡è¦æ€§**: é¡µé¢æ›¿æ¢ç®—æ³•çš„ç»å…¸ç ”ç©¶
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†OPTç®—æ³•å’ŒBeladyå¼‚å¸¸

### 6.2 æ›¿æ¢ç®—æ³•ç›¸å…³

- **O'Neil, E. J., et al. (1993). "The LRU-K Page Replacement Algorithm for Database Disk Buffering."**
  - ä¼šè®®: SIGMOD 1993
  - **é‡è¦æ€§**: LRU-Kç®—æ³•çš„ç»å…¸è®ºæ–‡
  - **æ ¸å¿ƒè´¡çŒ®**: æå‡ºäº†æ”¹è¿›çš„LRUç®—æ³•

### 6.3 PostgreSQLå®ç°ç›¸å…³

- **[PostgreSQLå®˜æ–¹æ–‡æ¡£ - å…±äº«ç¼“å†²åŒº](<https://www.postgresql.org/docs/current/runtime-config-resource.html#GUC-SHARED-BUFFERS>)**
  - PostgreSQLå…±äº«ç¼“å†²åŒºé…ç½®è¯´æ˜

### 7.4 ç›¸å…³æ–‡æ¡£

- [ç†è®ºåŸºç¡€å¯¼èˆª](../README.md)
- [æ•°æ®åº“å‹ç¼©ä¸ç¼–ç -ä¿¡æ¯è®ºä¸‹ç•Œä¸æœ€ä¼˜ç¼–ç ](./06.04-æ•°æ®åº“å‹ç¼©ä¸ç¼–ç -ä¿¡æ¯è®ºä¸‹ç•Œä¸æœ€ä¼˜ç¼–ç .md)

---

**æœ€åæ›´æ–°**: 2025-01-16
**ç»´æŠ¤è€…**: Documentation Team
**çŠ¶æ€**: âœ… å†…å®¹å·²æ·±åŒ–ï¼ŒåŒ…å«å®Œæ•´è¯æ˜ã€åœºæ™¯æ¡ˆä¾‹å’ŒPostgreSQL 18/SQLiteå¯¹æ¯”
