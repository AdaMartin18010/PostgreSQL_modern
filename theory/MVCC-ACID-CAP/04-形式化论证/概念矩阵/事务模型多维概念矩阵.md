# äº‹åŠ¡æ¨¡å‹å¤šç»´æ¦‚å¿µçŸ©é˜µ

> **æ–‡æ¡£ç¼–å·**: MATRIX-004
> **ä¸»é¢˜**: äº‹åŠ¡æ¨¡å‹å¤šç»´æ¦‚å¿µå¯¹æ¯”çŸ©é˜µ
> **ç‰ˆæœ¬**: PostgreSQL 17 & 18
> **çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ“‘ ç›®å½•

- [äº‹åŠ¡æ¨¡å‹å¤šç»´æ¦‚å¿µçŸ©é˜µ](#äº‹åŠ¡æ¨¡å‹å¤šç»´æ¦‚å¿µçŸ©é˜µ)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [ğŸ“‹ æ¦‚è¿°](#-æ¦‚è¿°)
  - [ğŸ“Š ç¬¬ä¸€éƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹å®šä¹‰çŸ©é˜µ](#-ç¬¬ä¸€éƒ¨åˆ†äº‹åŠ¡æ¨¡å‹å®šä¹‰çŸ©é˜µ)
  - [ğŸ“Š ç¬¬äºŒéƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹å±æ€§çŸ©é˜µ](#-ç¬¬äºŒéƒ¨åˆ†äº‹åŠ¡æ¨¡å‹å±æ€§çŸ©é˜µ)
  - [ğŸ“Š ç¬¬ä¸‰éƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹å®ç°æœºåˆ¶çŸ©é˜µ](#-ç¬¬ä¸‰éƒ¨åˆ†äº‹åŠ¡æ¨¡å‹å®ç°æœºåˆ¶çŸ©é˜µ)
  - [ğŸ“Š ç¬¬å››éƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹ä¸MVCCå…³ç³»çŸ©é˜µ](#-ç¬¬å››éƒ¨åˆ†äº‹åŠ¡æ¨¡å‹ä¸mvccå…³ç³»çŸ©é˜µ)
  - [ğŸ“Š ç¬¬äº”éƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹ä¸CAPå…³ç³»çŸ©é˜µ](#-ç¬¬äº”éƒ¨åˆ†äº‹åŠ¡æ¨¡å‹ä¸capå…³ç³»çŸ©é˜µ)
  - [ğŸ“š å¤–éƒ¨èµ„æºå¼•ç”¨](#-å¤–éƒ¨èµ„æºå¼•ç”¨)
    - [Wikipediaèµ„æº](#wikipediaèµ„æº)
    - [å­¦æœ¯è®ºæ–‡](#å­¦æœ¯è®ºæ–‡)
    - [å®˜æ–¹æ–‡æ¡£](#å®˜æ–¹æ–‡æ¡£)

---

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£é€šè¿‡å¤šç»´çŸ©é˜µå¯¹æ¯”çš„æ–¹å¼ï¼Œå…¨é¢å±•ç¤ºä¸åŒäº‹åŠ¡æ¨¡å‹çš„å®šä¹‰ã€å±æ€§ã€å®ç°æœºåˆ¶ã€ä¸MVCCçš„å…³ç³»ä»¥åŠä¸CAPçš„å…³ç³»ã€‚

**äº‹åŠ¡æ¨¡å‹**ï¼š

- æœ¬åœ°äº‹åŠ¡ï¼ˆLocal Transactionï¼‰
- ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰
- XAäº‹åŠ¡
- Sagaæ¨¡å¼
- TCCæ¨¡å¼
- æœ€ç»ˆä¸€è‡´æ€§ï¼ˆEventual Consistencyï¼‰

---

## ğŸ“Š ç¬¬ä¸€éƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹å®šä¹‰çŸ©é˜µ

| ç»´åº¦ | æœ¬åœ°äº‹åŠ¡ | 2PC | XAäº‹åŠ¡ | Saga | TCC | æœ€ç»ˆä¸€è‡´æ€§ |
|------|---------|-----|--------|------|-----|-----------|
| **å®šä¹‰** | å•æ•°æ®åº“å†…çš„äº‹åŠ¡ | åˆ†å¸ƒå¼äº‹åŠ¡åè°ƒåè®® | åŸºäºXAæ ‡å‡†çš„åˆ†å¸ƒå¼äº‹åŠ¡ | é•¿äº‹åŠ¡è¡¥å¿æ¨¡å¼ | è¡¥å¿å‹äº‹åŠ¡æ¨¡å¼ | æœ€ç»ˆè¾¾åˆ°ä¸€è‡´æ€§çš„æ¨¡å‹ |
| **èŒƒå›´** | å•èŠ‚ç‚¹ | å¤šèŠ‚ç‚¹ | å¤šèµ„æºç®¡ç†å™¨ | å¤šæœåŠ¡ | å¤šæœåŠ¡ | åˆ†å¸ƒå¼ç³»ç»Ÿ |
| **ä¸€è‡´æ€§** | å¼ºä¸€è‡´æ€§ | å¼ºä¸€è‡´æ€§ | å¼ºä¸€è‡´æ€§ | æœ€ç»ˆä¸€è‡´æ€§ | æœ€ç»ˆä¸€è‡´æ€§ | æœ€ç»ˆä¸€è‡´æ€§ |
| **Wikipedia** | [Database Transaction](https://en.wikipedia.org/wiki/Database_transaction) | [Two-Phase Commit](https://en.wikipedia.org/wiki/Two-phase_commit_protocol) | [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) | [Saga Pattern](https://en.wikipedia.org/wiki/Saga_pattern) | [Compensating Transaction](https://en.wikipedia.org/wiki/Compensating_transaction) | [Eventual Consistency](https://en.wikipedia.org/wiki/Eventual_consistency) |

---

## ğŸ“Š ç¬¬äºŒéƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹å±æ€§çŸ©é˜µ

| å±æ€§ | æœ¬åœ°äº‹åŠ¡ | 2PC | XAäº‹åŠ¡ | Saga | TCC | æœ€ç»ˆä¸€è‡´æ€§ |
|------|---------|-----|--------|------|-----|-----------|
| **åŸå­æ€§** | âœ… å¼º | âœ… å¼º | âœ… å¼º | âš ï¸ å¼± | âš ï¸ å¼± | âŒ æ—  |
| **ä¸€è‡´æ€§** | âœ… å¼º | âœ… å¼º | âœ… å¼º | âš ï¸ æœ€ç»ˆ | âš ï¸ æœ€ç»ˆ | âš ï¸ æœ€ç»ˆ |
| **éš”ç¦»æ€§** | âœ… å¼º | âœ… å¼º | âœ… å¼º | âŒ æ—  | âŒ æ—  | âŒ æ—  |
| **æŒä¹…æ€§** | âœ… å¼º | âœ… å¼º | âœ… å¼º | âœ… å¼º | âœ… å¼º | âœ… å¼º |
| **æ€§èƒ½** | é«˜ | ä½ | ä½ | é«˜ | é«˜ | æœ€é«˜ |
| **å¯ç”¨æ€§** | é«˜ | ä½ | ä½ | é«˜ | é«˜ | æœ€é«˜ |

---

## ğŸ“Š ç¬¬ä¸‰éƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹å®ç°æœºåˆ¶çŸ©é˜µ

| æœºåˆ¶ | æœ¬åœ°äº‹åŠ¡ | 2PC | XAäº‹åŠ¡ | Saga | TCC | æœ€ç»ˆä¸€è‡´æ€§ |
|------|---------|-----|--------|------|-----|-----------|
| **åè°ƒå™¨** | æ—  | éœ€è¦ | éœ€è¦ | å¯é€‰ | å¯é€‰ | æ—  |
| **å‚ä¸è€…** | 1ä¸ª | å¤šä¸ª | å¤šä¸ª | å¤šä¸ª | å¤šä¸ª | å¤šä¸ª |
| **é˜»å¡** | æ—  | æœ‰ | æœ‰ | æ—  | æ—  | æ—  |
| **å›æ»š** | ç®€å• | å¤æ‚ | å¤æ‚ | è¡¥å¿ | è¡¥å¿ | æ—  |
| **MVCCæ”¯æŒ** | âœ… å®Œå…¨ | âš ï¸ éƒ¨åˆ† | âš ï¸ éƒ¨åˆ† | âŒ æ—  | âŒ æ—  | âŒ æ—  |

---

## ğŸ“Š ç¬¬å››éƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹ä¸MVCCå…³ç³»çŸ©é˜µ

| MVCCç‰¹æ€§ | æœ¬åœ°äº‹åŠ¡ | 2PC | XAäº‹åŠ¡ | Saga | TCC | æœ€ç»ˆä¸€è‡´æ€§ |
|---------|---------|-----|--------|------|-----|-----------|
| **ç‰ˆæœ¬é“¾** | âœ… ä½¿ç”¨ | âš ï¸ éƒ¨åˆ† | âš ï¸ éƒ¨åˆ† | âŒ ä¸ä½¿ç”¨ | âŒ ä¸ä½¿ç”¨ | âŒ ä¸ä½¿ç”¨ |
| **å¿«ç…§éš”ç¦»** | âœ… æ”¯æŒ | âš ï¸ å—é™ | âš ï¸ å—é™ | âŒ ä¸æ”¯æŒ | âŒ ä¸æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **å¯è§æ€§è§„åˆ™** | âœ… å®Œå…¨ | âš ï¸ å—é™ | âš ï¸ å—é™ | âŒ ä¸é€‚ç”¨ | âŒ ä¸é€‚ç”¨ | âŒ ä¸é€‚ç”¨ |
| **ç‰ˆæœ¬å›æ”¶** | âœ… æ­£å¸¸ | âš ï¸ å»¶è¿Ÿ | âš ï¸ å»¶è¿Ÿ | âŒ ä¸é€‚ç”¨ | âŒ ä¸é€‚ç”¨ | âŒ ä¸é€‚ç”¨ |

---

## ğŸ“Š ç¬¬äº”éƒ¨åˆ†ï¼šäº‹åŠ¡æ¨¡å‹ä¸CAPå…³ç³»çŸ©é˜µ

| CAPç»´åº¦ | æœ¬åœ°äº‹åŠ¡ | 2PC | XAäº‹åŠ¡ | Saga | TCC | æœ€ç»ˆä¸€è‡´æ€§ |
|---------|---------|-----|--------|------|-----|-----------|
| **ä¸€è‡´æ€§(C)** | å¼ºä¸€è‡´æ€§ | å¼ºä¸€è‡´æ€§ | å¼ºä¸€è‡´æ€§ | æœ€ç»ˆä¸€è‡´æ€§ | æœ€ç»ˆä¸€è‡´æ€§ | æœ€ç»ˆä¸€è‡´æ€§ |
| **å¯ç”¨æ€§(A)** | é«˜å¯ç”¨æ€§ | ä½å¯ç”¨æ€§ | ä½å¯ç”¨æ€§ | é«˜å¯ç”¨æ€§ | é«˜å¯ç”¨æ€§ | æœ€é«˜å¯ç”¨æ€§ |
| **åˆ†åŒºå®¹é”™(P)** | ä¸é€‚ç”¨ | æ”¯æŒ | æ”¯æŒ | æ”¯æŒ | æ”¯æŒ | å®Œå…¨æ”¯æŒ |
| **CAPé€‰æ‹©** | CA | CP | CP | AP | AP | AP |

---

## ğŸ“š å¤–éƒ¨èµ„æºå¼•ç”¨

### Wikipediaèµ„æº

1. **äº‹åŠ¡æ¨¡å‹ç›¸å…³**ï¼š
   - [Database Transaction](https://en.wikipedia.org/wiki/Database_transaction)
   - [Distributed Transaction](https://en.wikipedia.org/wiki/Distributed_transaction)
   - [Two-Phase Commit Protocol](https://en.wikipedia.org/wiki/Two-phase_commit_protocol)
   - [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA)
   - [Saga Pattern](https://en.wikipedia.org/wiki/Saga_pattern)
   - [Compensating Transaction](https://en.wikipedia.org/wiki/Compensating_transaction)
   - [Eventual Consistency](https://en.wikipedia.org/wiki/Eventual_consistency)

2. **åˆ†å¸ƒå¼ç³»ç»Ÿ**ï¼š
   - [Distributed Database](https://en.wikipedia.org/wiki/Distributed_database)
   - [CAP Theorem](https://en.wikipedia.org/wiki/CAP_theorem)
   - [ACID](https://en.wikipedia.org/wiki/ACID)

### å­¦æœ¯è®ºæ–‡

1. **ä¸¤é˜¶æ®µæäº¤**ï¼š
   - Gray, J. (1978). "Notes on Database Operating Systems"
   - Lampson, B. (1981). "Atomic Transactions"

2. **åˆ†å¸ƒå¼äº‹åŠ¡**ï¼š
   - Gray, J., & Reuter, A. (1993). "Transaction Processing: Concepts and Techniques"
   - Bernstein, P. A., & Goodman, N. (1981). "Concurrency Control in Distributed Database Systems"

3. **æœ€ç»ˆä¸€è‡´æ€§**ï¼š
   - Vogels, W. (2009). "Eventually Consistent"
   - Pritchett, D. (2008). "BASE: An ACID Alternative"

### å®˜æ–¹æ–‡æ¡£

1. **PostgreSQLå®˜æ–¹æ–‡æ¡£**ï¼š
   - [Two-Phase Commit](https://www.postgresql.org/docs/current/sql-prepare-transaction.html)
   - [XA Transactions](https://www.postgresql.org/docs/current/xa.html)
   - [Transaction Isolation](https://www.postgresql.org/docs/current/transaction-iso.html)

2. **æ ‡å‡†æ–‡æ¡£**ï¼š
   - X/Open XA Specification
   - ISO/IEC 9075 (SQL Standard)

---

**æœ€åæ›´æ–°**: 2024å¹´
**ç»´æŠ¤çŠ¶æ€**: âœ… å·²å®Œæˆ
