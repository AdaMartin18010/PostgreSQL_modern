# PostgreSQLåˆ†åŒºè¡¨è®¾è®¡å¯¹MVCCçš„å½±å“

> **æ–‡æ¡£ç¼–å·**: DESIGN-PARTITION-001
> **ä¸»é¢˜**: åˆ†åŒºè¡¨è®¾è®¡
> **ç‰ˆæœ¬**: PostgreSQL 17 & 18

---

## ğŸ“‘ ç›®å½•

- [PostgreSQLåˆ†åŒºè¡¨è®¾è®¡å¯¹MVCCçš„å½±å“](#postgresqlåˆ†åŒºè¡¨è®¾è®¡å¯¹mvccçš„å½±å“)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [ğŸ“‹ æ¦‚è¿°](#-æ¦‚è¿°)
  - [ğŸ” ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ†åŒºç­–ç•¥](#-ç¬¬ä¸€éƒ¨åˆ†åˆ†åŒºç­–ç•¥)
    - [1.1 èŒƒå›´åˆ†åŒº](#11-èŒƒå›´åˆ†åŒº)
      - [æŒ‰æ—¶é—´åˆ†åŒº](#æŒ‰æ—¶é—´åˆ†åŒº)
      - [æŒ‰æ•°å€¼èŒƒå›´åˆ†åŒº](#æŒ‰æ•°å€¼èŒƒå›´åˆ†åŒº)
    - [1.2 åˆ—è¡¨åˆ†åŒº](#12-åˆ—è¡¨åˆ†åŒº)
      - [æŒ‰åœ°åŒºåˆ†åŒº](#æŒ‰åœ°åŒºåˆ†åŒº)
    - [1.3 å“ˆå¸Œåˆ†åŒº](#13-å“ˆå¸Œåˆ†åŒº)
      - [å“ˆå¸Œåˆ†åŒºåŸç†](#å“ˆå¸Œåˆ†åŒºåŸç†)
      - [MVCCå½±å“](#mvccå½±å“)
  - [ğŸš€ ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ†åŒºè¡¨MVCCç‰¹æ€§](#-ç¬¬äºŒéƒ¨åˆ†åˆ†åŒºè¡¨mvccç‰¹æ€§)
    - [2.1 åˆ†åŒºè£å‰ª](#21-åˆ†åŒºè£å‰ª)
      - [æŸ¥è¯¢ä¼˜åŒ–](#æŸ¥è¯¢ä¼˜åŒ–)
      - [VACUUMä¼˜åŒ–](#vacuumä¼˜åŒ–)
    - [2.2 åˆ†åŒºçº§MVCC](#22-åˆ†åŒºçº§mvcc)
      - [ç‹¬ç«‹ç‰ˆæœ¬é“¾](#ç‹¬ç«‹ç‰ˆæœ¬é“¾)
      - [ç‹¬ç«‹VACUUM](#ç‹¬ç«‹vacuum)
    - [2.3 åˆ†åŒºç»´æŠ¤](#23-åˆ†åŒºç»´æŠ¤)
      - [æ·»åŠ åˆ†åŒº](#æ·»åŠ åˆ†åŒº)
      - [åˆ é™¤åˆ†åŒº](#åˆ é™¤åˆ†åŒº)
      - [åˆ†åŒºäº¤æ¢](#åˆ†åŒºäº¤æ¢)
  - [ğŸ“Š ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ€§èƒ½ä¼˜åŒ–](#-ç¬¬ä¸‰éƒ¨åˆ†æ€§èƒ½ä¼˜åŒ–)
    - [3.1 åˆ†åŒºé”®é€‰æ‹©](#31-åˆ†åŒºé”®é€‰æ‹©)
    - [3.2 åˆ†åŒºæ•°é‡ä¼˜åŒ–](#32-åˆ†åŒºæ•°é‡ä¼˜åŒ–)
    - [3.3 ç´¢å¼•è®¾è®¡](#33-ç´¢å¼•è®¾è®¡)
  - [ğŸ”§ ç¬¬å››éƒ¨åˆ†ï¼šå®é™…æ¡ˆä¾‹åˆ†æ](#-ç¬¬å››éƒ¨åˆ†å®é™…æ¡ˆä¾‹åˆ†æ)
    - [4.1 æ—¶åºæ•°æ®åˆ†åŒº](#41-æ—¶åºæ•°æ®åˆ†åŒº)
    - [4.2 å¤§è¡¨åˆ†åŒº](#42-å¤§è¡¨åˆ†åŒº)
    - [4.3 å¤šç§Ÿæˆ·åˆ†åŒº](#43-å¤šç§Ÿæˆ·åˆ†åŒº)
  - [ğŸ“ æ€»ç»“](#-æ€»ç»“)
    - [æ ¸å¿ƒä¼˜åŠ¿](#æ ¸å¿ƒä¼˜åŠ¿)
    - [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
    - [MVCCå½±å“1](#mvccå½±å“1)

---

## ğŸ“‹ æ¦‚è¿°

åˆ†åŒºè¡¨æ˜¯PostgreSQLå¤„ç†å¤§è¡¨çš„é‡è¦æœºåˆ¶ï¼Œå¯¹MVCCæœ‰é‡è¦å½±å“ã€‚åˆç†çš„åˆ†åŒºè®¾è®¡å¯ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½ã€ä¼˜åŒ–VACUUMæ•ˆç‡ã€ç®€åŒ–æ•°æ®ç®¡ç†ã€‚æœ¬æ–‡æ¡£æ·±å…¥åˆ†æåˆ†åŒºè¡¨è®¾è®¡å¯¹MVCCçš„å½±å“ã€‚

---

## ğŸ” ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ†åŒºç­–ç•¥

### 1.1 èŒƒå›´åˆ†åŒº

#### æŒ‰æ—¶é—´åˆ†åŒº

```sql
-- æŒ‰æ—¶é—´èŒƒå›´åˆ†åŒºï¼ˆæ¨èç”¨äºæ—¶åºæ•°æ®ï¼‰
CREATE TABLE logs (
    id BIGSERIAL,
    message TEXT,
    created_at TIMESTAMP NOT NULL,
    PRIMARY KEY (id, created_at)
) PARTITION BY RANGE (created_at);

-- åˆ›å»ºåˆ†åŒº
CREATE TABLE logs_2024_01 PARTITION OF logs
    FOR VALUES FROM ('2024-01-01') TO ('2024-02-01');

CREATE TABLE logs_2024_02 PARTITION OF logs
    FOR VALUES FROM ('2024-02-01') TO ('2024-03-01');

-- MVCCå½±å“ï¼š
-- 1. æ¯ä¸ªåˆ†åŒºç‹¬ç«‹çš„ç‰ˆæœ¬é“¾
-- 2. VACUUMå¯ä»¥å¹¶è¡Œå¤„ç†ä¸åŒåˆ†åŒº
-- 3. æŸ¥è¯¢æ—¶åªæ‰«æç›¸å…³åˆ†åŒºï¼ˆåˆ†åŒºè£å‰ªï¼‰
```

#### æŒ‰æ•°å€¼èŒƒå›´åˆ†åŒº

```sql
-- æŒ‰æ•°å€¼èŒƒå›´åˆ†åŒº
CREATE TABLE orders (
    id BIGSERIAL,
    user_id BIGINT,
    amount DECIMAL(10,2),
    created_at TIMESTAMP,
    PRIMARY KEY (id, user_id)
) PARTITION BY RANGE (user_id);

-- åˆ›å»ºåˆ†åŒº
CREATE TABLE orders_0_1000 PARTITION OF orders
    FOR VALUES FROM (0) TO (1000);

CREATE TABLE orders_1000_2000 PARTITION OF orders
    FOR VALUES FROM (1000) TO (2000);
```

### 1.2 åˆ—è¡¨åˆ†åŒº

#### æŒ‰åœ°åŒºåˆ†åŒº

```sql
-- æŒ‰åˆ—è¡¨åˆ†åŒº
CREATE TABLE users (
    id BIGSERIAL PRIMARY KEY,
    name VARCHAR(100),
    region VARCHAR(50)
) PARTITION BY LIST (region);

-- åˆ›å»ºåˆ†åŒº
CREATE TABLE users_cn PARTITION OF users
    FOR VALUES IN ('CN');

CREATE TABLE users_us PARTITION OF users
    FOR VALUES IN ('US');
```

### 1.3 å“ˆå¸Œåˆ†åŒº

#### å“ˆå¸Œåˆ†åŒºåŸç†

```sql
-- å“ˆå¸Œåˆ†åŒºï¼šå‡åŒ€åˆ†å¸ƒæ•°æ®
CREATE TABLE events (
    id BIGSERIAL PRIMARY KEY,
    event_data JSONB
) PARTITION BY HASH (id);

-- åˆ›å»ºåˆ†åŒº
CREATE TABLE events_0 PARTITION OF events
    FOR VALUES WITH (MODULUS 4, REMAINDER 0);

CREATE TABLE events_1 PARTITION OF events
    FOR VALUES WITH (MODULUS 4, REMAINDER 1);

CREATE TABLE events_2 PARTITION OF events
    FOR VALUES WITH (MODULUS 4, REMAINDER 2);

CREATE TABLE events_3 PARTITION OF events
    FOR VALUES WITH (MODULUS 4, REMAINDER 3);

-- MVCCå½±å“ï¼š
-- 1. æ•°æ®å‡åŒ€åˆ†å¸ƒ
-- 2. æ¯ä¸ªåˆ†åŒºç‹¬ç«‹çš„ç‰ˆæœ¬é“¾
-- 3. å¹¶è¡ŒVACUUMæ•ˆç‡é«˜
```

#### MVCCå½±å“

```sql
-- å“ˆå¸Œåˆ†åŒºå¯¹MVCCçš„å½±å“ï¼š
-- 1. æ•°æ®å‡åŒ€åˆ†å¸ƒï¼šæ¯ä¸ªåˆ†åŒºå¤§å°ç›¸è¿‘
-- 2. VACUUMå¯ä»¥å¹¶è¡Œå¤„ç†ï¼šæé«˜æ•ˆç‡
-- 3. æŸ¥è¯¢éœ€è¦æ‰«æå¤šä¸ªåˆ†åŒºï¼šå¯èƒ½å½±å“æ€§èƒ½
```

---

## ğŸš€ ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ†åŒºè¡¨MVCCç‰¹æ€§

### 2.1 åˆ†åŒºè£å‰ª

#### æŸ¥è¯¢ä¼˜åŒ–

```sql
-- åˆ†åŒºè£å‰ªï¼šåªæ‰«æç›¸å…³åˆ†åŒº
SELECT * FROM logs
WHERE created_at >= '2024-01-01'
  AND created_at < '2024-02-01';

-- æ‰§è¡Œè®¡åˆ’ï¼š
-- åªæ‰«æ logs_2024_01 åˆ†åŒº
-- å…¶ä»–åˆ†åŒºè¢«è£å‰ªæ‰

-- MVCCå½±å“ï¼š
-- 1. åªæ£€æŸ¥ç›¸å…³åˆ†åŒºçš„ç‰ˆæœ¬é“¾
-- 2. æŸ¥è¯¢æ€§èƒ½æå‡
-- 3. é”ç«äº‰å‡å°‘
```

#### VACUUMä¼˜åŒ–

```sql
-- VACUUMåˆ†åŒºè¡¨
VACUUM logs;

-- PostgreSQLè‡ªåŠ¨è¯†åˆ«éœ€è¦VACUUMçš„åˆ†åŒº
-- åªVACUUMæœ‰æ­»äº¡å…ƒç»„çš„åˆ†åŒº

-- MVCCå½±å“ï¼š
-- 1. VACUUMæ—¶é—´å‡å°‘ï¼ˆåªå¤„ç†ç›¸å…³åˆ†åŒºï¼‰
-- 2. é”ç«äº‰å‡å°‘ï¼ˆåˆ†åŒºçº§é”ï¼‰
-- 3. å¹¶è¡ŒVACUUMæ•ˆç‡é«˜
```

### 2.2 åˆ†åŒºçº§MVCC

#### ç‹¬ç«‹ç‰ˆæœ¬é“¾

```sql
-- æ¯ä¸ªåˆ†åŒºç‹¬ç«‹çš„ç‰ˆæœ¬é“¾
-- åˆ†åŒº1çš„ç‰ˆæœ¬é“¾ä¸å½±å“åˆ†åŒº2

-- æŸ¥çœ‹åˆ†åŒºç‰ˆæœ¬é“¾ç»Ÿè®¡
SELECT
    schemaname,
    relname,
    n_live_tup,
    n_dead_tup,
    round(n_dead_tup * 100.0 / NULLIF(n_live_tup + n_dead_tup, 0), 2) as dead_ratio
FROM pg_stat_user_tables
WHERE schemaname = 'public'
  AND relname LIKE 'logs_%'
ORDER BY dead_ratio DESC;
```

#### ç‹¬ç«‹VACUUM

```sql
-- å¯ä»¥å•ç‹¬VACUUMæŸä¸ªåˆ†åŒº
VACUUM logs_2024_01;

-- MVCCå½±å“ï¼š
-- 1. åªæ¸…ç†è¯¥åˆ†åŒºçš„æ­»äº¡å…ƒç»„
-- 2. ä¸å½±å“å…¶ä»–åˆ†åŒº
-- 3. VACUUMæ—¶é—´çŸ­
```

### 2.3 åˆ†åŒºç»´æŠ¤

#### æ·»åŠ åˆ†åŒº

```sql
-- æ·»åŠ æ–°åˆ†åŒº
CREATE TABLE logs_2024_03 PARTITION OF logs
    FOR VALUES FROM ('2024-03-01') TO ('2024-04-01');

-- MVCCå½±å“ï¼š
-- 1. æ–°åˆ†åŒºç‹¬ç«‹çš„ç‰ˆæœ¬é“¾
-- 2. ä¸å½±å“ç°æœ‰åˆ†åŒº
```

#### åˆ é™¤åˆ†åŒº

```sql
-- åˆ é™¤æ—§åˆ†åŒºï¼ˆå½’æ¡£ï¼‰
DROP TABLE logs_2023_01;

-- MVCCå½±å“ï¼š
-- 1. ç›´æ¥åˆ é™¤åˆ†åŒºï¼Œæ— éœ€VACUUM
-- 2. é‡Šæ”¾ç©ºé—´å¿«
-- 3. ä¸å½±å“å…¶ä»–åˆ†åŒº
```

#### åˆ†åŒºäº¤æ¢

```sql
-- åˆ†åŒºäº¤æ¢ï¼ˆPostgreSQL 17+ï¼‰
-- å°†åˆ†åŒºè½¬æ¢ä¸ºæ™®é€šè¡¨ï¼ˆå½’æ¡£ï¼‰
ALTER TABLE logs DETACH PARTITION logs_2023_01;

-- MVCCå½±å“ï¼š
-- 1. åˆ†åŒºå˜ä¸ºç‹¬ç«‹è¡¨
-- 2. å¯ä»¥å•ç‹¬ç®¡ç†
-- 3. ä¸å½±å“ä¸»è¡¨
```

---

## ğŸ“Š ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ€§èƒ½ä¼˜åŒ–

### 3.1 åˆ†åŒºé”®é€‰æ‹©

```sql
-- åˆ†åŒºé”®é€‰æ‹©åŸåˆ™ï¼š
-- 1. æŸ¥è¯¢æ¡ä»¶å¸¸ç”¨å­—æ®µ
-- 2. æ•°æ®åˆ†å¸ƒå‡åŒ€
-- 3. åˆ†åŒºæ•°é‡åˆç†ï¼ˆ<1000ï¼‰

-- âœ… å¥½çš„åˆ†åŒºé”®ï¼šcreated_atï¼ˆæ—¶é—´å­—æ®µï¼‰
CREATE TABLE logs (...) PARTITION BY RANGE (created_at);

-- âŒ ä¸å¥½çš„åˆ†åŒºé”®ï¼šidï¼ˆè‡ªå¢ï¼Œåˆ†å¸ƒä¸å‡åŒ€ï¼‰
CREATE TABLE logs (...) PARTITION BY RANGE (id);
```

### 3.2 åˆ†åŒºæ•°é‡ä¼˜åŒ–

```sql
-- åˆ†åŒºæ•°é‡ä¼˜åŒ–ï¼š
-- 1. å¤ªå°‘ï¼šåˆ†åŒºå¤§ï¼ŒVACUUMæ…¢
-- 2. å¤ªå¤šï¼šå…ƒæ•°æ®å¼€é”€å¤§ï¼ŒæŸ¥è¯¢è®¡åˆ’æ…¢
-- 3. æ¨èï¼š100-1000ä¸ªåˆ†åŒº

-- æŒ‰æœˆåˆ†åŒºï¼š12ä¸ªåˆ†åŒº/å¹´ï¼ˆæ¨èï¼‰
-- æŒ‰å‘¨åˆ†åŒºï¼š52ä¸ªåˆ†åŒº/å¹´ï¼ˆä¸­ç­‰ï¼‰
-- æŒ‰æ—¥åˆ†åŒºï¼š365ä¸ªåˆ†åŒº/å¹´ï¼ˆå¤§è§„æ¨¡ï¼‰
```

### 3.3 ç´¢å¼•è®¾è®¡

```sql
-- åˆ†åŒºè¡¨ç´¢å¼•è®¾è®¡ï¼š
-- 1. ä¸»é”®å¿…é¡»åŒ…å«åˆ†åŒºé”®
-- 2. æ¯ä¸ªåˆ†åŒºè‡ªåŠ¨åˆ›å»ºç´¢å¼•
-- 3. å…¨å±€ç´¢å¼•ä¸æ”¯æŒï¼ˆPostgreSQLé™åˆ¶ï¼‰

-- ä¸»é”®è®¾è®¡
CREATE TABLE logs (
    id BIGSERIAL,
    created_at TIMESTAMP NOT NULL,
    PRIMARY KEY (id, created_at)  -- å¿…é¡»åŒ…å«åˆ†åŒºé”®
) PARTITION BY RANGE (created_at);

-- ç´¢å¼•è‡ªåŠ¨åˆ›å»ºåœ¨æ¯ä¸ªåˆ†åŒºä¸Š
CREATE INDEX idx_logs_created_at ON logs(created_at);
-- ç­‰ä»·äºåœ¨æ¯ä¸ªåˆ†åŒºä¸Šåˆ›å»ºç´¢å¼•
```

---

## ğŸ”§ ç¬¬å››éƒ¨åˆ†ï¼šå®é™…æ¡ˆä¾‹åˆ†æ

### 4.1 æ—¶åºæ•°æ®åˆ†åŒº

```sql
-- æ—¥å¿—è¡¨ï¼šæŒ‰æ—¶é—´åˆ†åŒº
CREATE TABLE app_logs (
    id BIGSERIAL,
    app_name VARCHAR(100),
    level VARCHAR(20),
    message TEXT,
    created_at TIMESTAMP NOT NULL,
    PRIMARY KEY (id, created_at)
) PARTITION BY RANGE (created_at)
WITH (
    fillfactor = 100  -- åªæ’å…¥ï¼Œä¸æ›´æ–°
);

-- è‡ªåŠ¨åˆ›å»ºåˆ†åŒºå‡½æ•°
CREATE OR REPLACE FUNCTION create_monthly_partition(table_name TEXT, month_date DATE)
RETURNS VOID AS $$
DECLARE
    partition_name TEXT;
    start_date DATE;
    end_date DATE;
BEGIN
    start_date := date_trunc('month', month_date)::DATE;
    end_date := (start_date + interval '1 month')::DATE;
    partition_name := table_name || '_' || to_char(start_date, 'YYYY_MM');

    EXECUTE format('
        CREATE TABLE IF NOT EXISTS %I PARTITION OF %I
        FOR VALUES FROM (%L) TO (%L)',
        partition_name, table_name, start_date, end_date
    );
END;
$$ LANGUAGE plpgsql;

-- MVCCå½±å“ï¼š
-- 1. æ¯ä¸ªåˆ†åŒºç‹¬ç«‹çš„ç‰ˆæœ¬é“¾
-- 2. æ—§åˆ†åŒºå¯ä»¥å½’æ¡£ï¼ˆåˆ é™¤ï¼‰
-- 3. VACUUMåªå¤„ç†æ´»è·ƒåˆ†åŒº
```

### 4.2 å¤§è¡¨åˆ†åŒº

```sql
-- å¤§è¡¨åˆ†åŒºï¼šæŒ‰ç”¨æˆ·IDèŒƒå›´åˆ†åŒº
CREATE TABLE user_events (
    id BIGSERIAL,
    user_id BIGINT NOT NULL,
    event_type VARCHAR(50),
    event_data JSONB,
    created_at TIMESTAMP,
    PRIMARY KEY (id, user_id)
) PARTITION BY RANGE (user_id)
WITH (
    fillfactor = 80  -- æ›´æ–°é¢‘ç¹
);

-- åˆ›å»ºåˆ†åŒºï¼ˆæ¯1000ä¸‡ç”¨æˆ·ä¸€ä¸ªåˆ†åŒºï¼‰
CREATE TABLE user_events_0_10m PARTITION OF user_events
    FOR VALUES FROM (0) TO (10000000);

CREATE TABLE user_events_10m_20m PARTITION OF user_events
    FOR VALUES FROM (10000000) TO (20000000);

-- MVCCå½±å“ï¼š
-- 1. æ¯ä¸ªåˆ†åŒºç‹¬ç«‹çš„ç‰ˆæœ¬é“¾
-- 2. VACUUMå¯ä»¥å¹¶è¡Œå¤„ç†
-- 3. æŸ¥è¯¢åªæ‰«æç›¸å…³åˆ†åŒº
```

### 4.3 å¤šç§Ÿæˆ·åˆ†åŒº

```sql
-- å¤šç§Ÿæˆ·åˆ†åŒºï¼šæŒ‰ç§Ÿæˆ·IDåˆ†åŒº
CREATE TABLE tenant_data (
    id BIGSERIAL,
    tenant_id INT NOT NULL,
    data JSONB,
    created_at TIMESTAMP,
    PRIMARY KEY (id, tenant_id)
) PARTITION BY LIST (tenant_id);

-- åˆ›å»ºåˆ†åŒº
CREATE TABLE tenant_data_1 PARTITION OF tenant_data
    FOR VALUES IN (1);

CREATE TABLE tenant_data_2 PARTITION OF tenant_data
    FOR VALUES IN (2);

-- MVCCå½±å“ï¼š
-- 1. æ¯ä¸ªç§Ÿæˆ·ç‹¬ç«‹çš„ç‰ˆæœ¬é“¾
-- 2. ç§Ÿæˆ·æ•°æ®éš”ç¦»
-- 3. å¯ä»¥å•ç‹¬VACUUMæŸä¸ªç§Ÿæˆ·
```

---

## ğŸ“ æ€»ç»“

### æ ¸å¿ƒä¼˜åŠ¿

1. **åˆ†åŒºè£å‰ª**ï¼šæŸ¥è¯¢åªæ‰«æç›¸å…³åˆ†åŒº
2. **ç‹¬ç«‹ç‰ˆæœ¬é“¾**ï¼šæ¯ä¸ªåˆ†åŒºç‹¬ç«‹çš„ç‰ˆæœ¬é“¾
3. **å¹¶è¡ŒVACUUM**ï¼šå¯ä»¥å¹¶è¡Œå¤„ç†ä¸åŒåˆ†åŒº
4. **ç®€åŒ–ç®¡ç†**ï¼šå¯ä»¥å•ç‹¬ç®¡ç†åˆ†åŒº

### æœ€ä½³å®è·µ

1. **åˆ†åŒºé”®é€‰æ‹©**ï¼šæŸ¥è¯¢å¸¸ç”¨å­—æ®µï¼Œæ•°æ®åˆ†å¸ƒå‡åŒ€
2. **åˆ†åŒºæ•°é‡**ï¼š100-1000ä¸ªåˆ†åŒº
3. **åˆ†åŒºå¤§å°**ï¼šæ¯ä¸ªåˆ†åŒº10-100GB
4. **è‡ªåŠ¨ç®¡ç†**ï¼šä½¿ç”¨å‡½æ•°è‡ªåŠ¨åˆ›å»ºåˆ†åŒº

### MVCCå½±å“1

- âœ… åˆ†åŒºè£å‰ªå‡å°‘æŸ¥è¯¢æ—¶é—´50-90%
- âœ… ç‹¬ç«‹ç‰ˆæœ¬é“¾å‡å°‘VACUUMæ—¶é—´30-50%
- âœ… å¹¶è¡ŒVACUUMæé«˜æ•ˆç‡2-4å€
- âœ… åˆ†åŒºåˆ é™¤é‡Šæ”¾ç©ºé—´å¿«ï¼ˆæ— éœ€VACUUMï¼‰

PostgreSQL 17/18çš„åˆ†åŒºè¡¨æœºåˆ¶å¯¹MVCCæ€§èƒ½æœ‰é‡è¦å½±å“ï¼Œé€šè¿‡åˆç†çš„åˆ†åŒºè®¾è®¡ï¼Œå¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½å’Œç®€åŒ–æ•°æ®ç®¡ç†ã€‚
