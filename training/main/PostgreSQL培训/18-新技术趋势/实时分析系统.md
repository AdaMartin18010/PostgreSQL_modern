# å®æ—¶åˆ†æç³»ç»Ÿï¼šPostgreSQL å®æ—¶æ•°æ®åˆ†ææ–¹æ¡ˆ

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 1 æœˆ
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 17+/18+ with TimescaleDB
> **æ–‡æ¡£ç¼–å·**: 03-03-TREND-20

## ğŸ“‘ æ¦‚è¿°

å®æ—¶åˆ†æç³»ç»Ÿæ˜¯ç°ä»£æ•°æ®æ¶æ„çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼ŒPostgreSQL ç»“åˆ TimescaleDBã€ç‰©åŒ–è§†å›¾ã€è¿ç»­èšåˆç­‰æŠ€æœ¯ï¼Œæä¾›äº†å¼ºå¤§çš„å®æ—¶æ•°æ®åˆ†æèƒ½åŠ›ï¼Œæ»¡è¶³å®æ—¶æŠ¥è¡¨ã€å®æ—¶ç›‘æ§ã€å®æ—¶å†³ç­–ç­‰åœºæ™¯éœ€æ±‚ã€‚

## ğŸ¯ æ ¸å¿ƒä»·å€¼

- **å®æ—¶åˆ†æ**ï¼šæ¯«ç§’çº§æ•°æ®åˆ†æå“åº”
- **è¿ç»­èšåˆ**ï¼šè‡ªåŠ¨ç»´æŠ¤çš„å®æ—¶èšåˆæ•°æ®
- **æµå¼çª—å£**ï¼šæ”¯æŒæ»‘åŠ¨çª—å£å’Œæ»šåŠ¨çª—å£åˆ†æ
- **é«˜å¹¶å‘æŸ¥è¯¢**ï¼šæ”¯æŒå¤§é‡å¹¶å‘åˆ†ææŸ¥è¯¢
- **æ•°æ®ä¸€è‡´æ€§**ï¼šä¿è¯åˆ†ææ•°æ®çš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§

## ğŸ“š ç›®å½•

- [å®æ—¶åˆ†æç³»ç»Ÿï¼šPostgreSQL å®æ—¶æ•°æ®åˆ†ææ–¹æ¡ˆ](#å®æ—¶åˆ†æç³»ç»Ÿpostgresql-å®æ—¶æ•°æ®åˆ†ææ–¹æ¡ˆ)
  - [ğŸ“‘ æ¦‚è¿°](#-æ¦‚è¿°)
  - [ğŸ¯ æ ¸å¿ƒä»·å€¼](#-æ ¸å¿ƒä»·å€¼)
  - [ğŸ“š ç›®å½•](#-ç›®å½•)
  - [1. å®æ—¶åˆ†æç³»ç»Ÿæ¦‚è¿°](#1-å®æ—¶åˆ†æç³»ç»Ÿæ¦‚è¿°)
    - [1.0 å®æ—¶åˆ†æç³»ç»ŸçŸ¥è¯†ä½“ç³»æ€ç»´å¯¼å›¾](#10-å®æ—¶åˆ†æç³»ç»ŸçŸ¥è¯†ä½“ç³»æ€ç»´å¯¼å›¾)
    - [1.1 å®æ—¶åˆ†ææ¶æ„](#11-å®æ—¶åˆ†ææ¶æ„)
    - [1.2 æŠ€æœ¯æ ˆ](#12-æŠ€æœ¯æ ˆ)
  - [2. è¿ç»­èšåˆ](#2-è¿ç»­èšåˆ)
    - [2.1 TimescaleDB è¿ç»­èšåˆ](#21-timescaledb-è¿ç»­èšåˆ)
    - [2.2 å®æ—¶æŸ¥è¯¢è¿ç»­èšåˆ](#22-å®æ—¶æŸ¥è¯¢è¿ç»­èšåˆ)
  - [3. å®æ—¶ç‰©åŒ–è§†å›¾](#3-å®æ—¶ç‰©åŒ–è§†å›¾)
    - [3.1 å¢é‡åˆ·æ–°ç‰©åŒ–è§†å›¾](#31-å¢é‡åˆ·æ–°ç‰©åŒ–è§†å›¾)
    - [3.2 è‡ªåŠ¨åˆ·æ–°ç­–ç•¥](#32-è‡ªåŠ¨åˆ·æ–°ç­–ç•¥)
  - [4. æµå¼çª—å£åˆ†æ](#4-æµå¼çª—å£åˆ†æ)
    - [4.1 æ»‘åŠ¨çª—å£](#41-æ»‘åŠ¨çª—å£)
    - [4.2 æ»šåŠ¨çª—å£](#42-æ»šåŠ¨çª—å£)
  - [5. å®æ—¶æŠ¥è¡¨](#5-å®æ—¶æŠ¥è¡¨)
    - [5.1 å®æ—¶ä»ªè¡¨æ¿æŸ¥è¯¢](#51-å®æ—¶ä»ªè¡¨æ¿æŸ¥è¯¢)
    - [5.2 å®æ—¶æ’å](#52-å®æ—¶æ’å)
  - [6. æ€§èƒ½ä¼˜åŒ–](#6-æ€§èƒ½ä¼˜åŒ–)
    - [6.1 ç´¢å¼•ä¼˜åŒ–](#61-ç´¢å¼•ä¼˜åŒ–)
    - [6.2 æŸ¥è¯¢ä¼˜åŒ–](#62-æŸ¥è¯¢ä¼˜åŒ–)
  - [7. å®é™…æ¡ˆä¾‹](#7-å®é™…æ¡ˆä¾‹)
    - [7.1 æ¡ˆä¾‹ï¼šå®æ—¶ä¸šåŠ¡ç›‘æ§ç³»ç»Ÿ](#71-æ¡ˆä¾‹å®æ—¶ä¸šåŠ¡ç›‘æ§ç³»ç»Ÿ)
  - [ğŸ“Š æ€»ç»“](#-æ€»ç»“)
  - [4. å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰](#4-å¸¸è§é—®é¢˜faq)
    - [4.1 å®æ—¶åˆ†æåŸºç¡€å¸¸è§é—®é¢˜](#41-å®æ—¶åˆ†æåŸºç¡€å¸¸è§é—®é¢˜)
      - [Q1: å¦‚ä½•å®ç°å®æ—¶æ•°æ®åˆ†æï¼Ÿ](#q1-å¦‚ä½•å®ç°å®æ—¶æ•°æ®åˆ†æ)
      - [Q2: å¦‚ä½•ä¼˜åŒ–å®æ—¶åˆ†ææ€§èƒ½ï¼Ÿ](#q2-å¦‚ä½•ä¼˜åŒ–å®æ—¶åˆ†ææ€§èƒ½)
    - [4.2 çª—å£åˆ†æå¸¸è§é—®é¢˜](#42-çª—å£åˆ†æå¸¸è§é—®é¢˜)
      - [Q3: å¦‚ä½•å®ç°æ»‘åŠ¨çª—å£åˆ†æï¼Ÿ](#q3-å¦‚ä½•å®ç°æ»‘åŠ¨çª—å£åˆ†æ)
  - [ğŸ“š å‚è€ƒèµ„æ–™](#-å‚è€ƒèµ„æ–™)
  - [ğŸ“š å‚è€ƒèµ„æ–™1](#-å‚è€ƒèµ„æ–™1)
    - [å®˜æ–¹æ–‡æ¡£](#å®˜æ–¹æ–‡æ¡£)
    - [æŠ€æœ¯è®ºæ–‡](#æŠ€æœ¯è®ºæ–‡)
    - [æŠ€æœ¯åšå®¢](#æŠ€æœ¯åšå®¢)
    - [ç¤¾åŒºèµ„æº](#ç¤¾åŒºèµ„æº)

---

## 1. å®æ—¶åˆ†æç³»ç»Ÿæ¦‚è¿°

### 1.0 å®æ—¶åˆ†æç³»ç»ŸçŸ¥è¯†ä½“ç³»æ€ç»´å¯¼å›¾

```mermaid
mindmap
  root((å®æ—¶åˆ†æç³»ç»Ÿ))
    è¿ç»­èšåˆ
      TimescaleDBè¿ç»­èšåˆ
        èšåˆåˆ›å»º
        èšåˆç»´æŠ¤
      å®æ—¶æŸ¥è¯¢è¿ç»­èšåˆ
        æŸ¥è¯¢æ–¹æ³•
        æŸ¥è¯¢ä¼˜åŒ–
    å®æ—¶ç‰©åŒ–è§†å›¾
      å¢é‡åˆ·æ–°ç‰©åŒ–è§†å›¾
        è§†å›¾åˆ›å»º
        åˆ·æ–°ç­–ç•¥
      è‡ªåŠ¨åˆ·æ–°ç­–ç•¥
        åˆ·æ–°é…ç½®
        åˆ·æ–°ä¼˜åŒ–
    æµå¼çª—å£åˆ†æ
      æ»‘åŠ¨çª—å£
        çª—å£å®šä¹‰
        çª—å£åˆ†æ
      æ»šåŠ¨çª—å£
        çª—å£å®šä¹‰
        çª—å£åˆ†æ
    å®æ—¶æŠ¥è¡¨
      å®æ—¶ä»ªè¡¨æ¿æŸ¥è¯¢
        æŸ¥è¯¢è®¾è®¡
        æŸ¥è¯¢ä¼˜åŒ–
      å®æ—¶æ’å
        æ’åè®¡ç®—
        æ’åä¼˜åŒ–
    æ€§èƒ½ä¼˜åŒ–
      ç´¢å¼•ä¼˜åŒ–
        ç´¢å¼•ç­–ç•¥
        ç´¢å¼•æ€§èƒ½
      æŸ¥è¯¢ä¼˜åŒ–
        æŸ¥è¯¢é‡å†™
        æŸ¥è¯¢ä¼˜åŒ–
```

### 1.1 å®æ—¶åˆ†ææ¶æ„

```text
æ•°æ®æº
â”œâ”€â”€ å®æ—¶æ•°æ®æµ
â”‚   â”œâ”€â”€ ç”¨æˆ·è¡Œä¸º
â”‚   â”œâ”€â”€ ä¸šåŠ¡äº‹ä»¶
â”‚   â””â”€â”€ ç³»ç»ŸæŒ‡æ ‡
â”œâ”€â”€ å®æ—¶å¤„ç†å±‚
â”‚   â”œâ”€â”€ è¿ç»­èšåˆ
â”‚   â”œâ”€â”€ ç‰©åŒ–è§†å›¾
â”‚   â””â”€â”€ æµå¼çª—å£
â””â”€â”€ åˆ†æåº”ç”¨
    â”œâ”€â”€ å®æ—¶æŠ¥è¡¨
    â”œâ”€â”€ å®æ—¶ç›‘æ§
    â””â”€â”€ å®æ—¶å†³ç­–
```

### 1.2 æŠ€æœ¯æ ˆ

- **TimescaleDB**ï¼šæ—¶åºæ•°æ®è¿ç»­èšåˆ
- **ç‰©åŒ–è§†å›¾**ï¼šé¢„è®¡ç®—çš„èšåˆæ•°æ®
- **é€»è¾‘å¤åˆ¶**ï¼šå®æ—¶æ•°æ®åŒæ­¥
- **æµå¼å¤„ç†**ï¼šå®æ—¶æ•°æ®å¤„ç†

---

## 2. è¿ç»­èšåˆ

### 2.1 TimescaleDB è¿ç»­èšåˆ

```sql
-- åˆ›å»ºè¶…è¡¨
CREATE TABLE metrics (
    time TIMESTAMPTZ NOT NULL,
    device_id INT,
    metric_name VARCHAR(50),
    value DOUBLE PRECISION
);

SELECT create_hypertable('metrics', 'time');

-- åˆ›å»ºè¿ç»­èšåˆ
CREATE MATERIALIZED VIEW hourly_metrics
WITH (timescaledb.continuous) AS
SELECT
    time_bucket('1 hour', time) AS hour,
    device_id,
    metric_name,
    AVG(value) AS avg_value,
    MAX(value) AS max_value,
    MIN(value) AS min_value,
    COUNT(*) AS count
FROM metrics
GROUP BY hour, device_id, metric_name;

-- è‡ªåŠ¨åˆ·æ–°ç­–ç•¥
SELECT add_continuous_aggregate_policy('hourly_metrics',
    start_offset => INTERVAL '3 hours',
    end_offset => INTERVAL '1 hour',
    schedule_interval => INTERVAL '1 hour');
```

### 2.2 å®æ—¶æŸ¥è¯¢è¿ç»­èšåˆ

```sql
-- æŸ¥è¯¢å®æ—¶èšåˆæ•°æ®
SELECT
    hour,
    device_id,
    metric_name,
    avg_value,
    max_value
FROM hourly_metrics
WHERE hour >= NOW() - INTERVAL '24 hours'
ORDER BY hour DESC;
```

---

## 3. å®æ—¶ç‰©åŒ–è§†å›¾

### 3.1 å¢é‡åˆ·æ–°ç‰©åŒ–è§†å›¾

```sql
-- åˆ›å»ºç‰©åŒ–è§†å›¾
CREATE MATERIALIZED VIEW realtime_stats AS
SELECT
    DATE_TRUNC('hour', created_at) AS hour,
    user_id,
    COUNT(*) AS event_count,
    SUM(amount) AS total_amount,
    AVG(amount) AS avg_amount
FROM events
GROUP BY hour, user_id;

-- åˆ›å»ºå”¯ä¸€ç´¢å¼•
CREATE UNIQUE INDEX ON realtime_stats (hour, user_id);

-- å¢é‡åˆ·æ–°
REFRESH MATERIALIZED VIEW CONCURRENTLY realtime_stats;
```

### 3.2 è‡ªåŠ¨åˆ·æ–°ç­–ç•¥

```sql
-- ä½¿ç”¨ pg_cron è‡ªåŠ¨åˆ·æ–°
SELECT cron.schedule(
    'refresh-realtime-stats',
    '*/5 * * * *',  -- æ¯ 5 åˆ†é’Ÿ
    $$REFRESH MATERIALIZED VIEW CONCURRENTLY realtime_stats$$
);
```

---

## 4. æµå¼çª—å£åˆ†æ

### 4.1 æ»‘åŠ¨çª—å£

```sql
-- æ»‘åŠ¨çª—å£èšåˆ
SELECT
    time_bucket('5 minutes', time) AS window_start,
    device_id,
    AVG(value) AS avg_value,
    COUNT(*) AS count
FROM metrics
WHERE time >= NOW() - INTERVAL '1 hour'
GROUP BY window_start, device_id
ORDER BY window_start DESC;
```

### 4.2 æ»šåŠ¨çª—å£

```sql
-- æ»šåŠ¨çª—å£èšåˆ
WITH windowed_data AS (
    SELECT
        time_bucket('1 hour', time) AS hour,
        device_id,
        value
    FROM metrics
    WHERE time >= NOW() - INTERVAL '24 hours'
)
SELECT
    hour,
    device_id,
    AVG(value) AS hourly_avg,
    STDDEV(value) AS hourly_stddev
FROM windowed_data
GROUP BY hour, device_id;
```

---

## 5. å®æ—¶æŠ¥è¡¨

### 5.1 å®æ—¶ä»ªè¡¨æ¿æŸ¥è¯¢

```sql
-- å®æ—¶ä¸šåŠ¡æŒ‡æ ‡
SELECT
    COUNT(DISTINCT user_id) AS active_users,
    COUNT(*) AS total_events,
    SUM(amount) AS total_revenue,
    AVG(amount) AS avg_order_value
FROM events
WHERE created_at >= NOW() - INTERVAL '1 hour';

-- å®æ—¶è¶‹åŠ¿åˆ†æ
SELECT
    DATE_TRUNC('minute', created_at) AS minute,
    COUNT(*) AS event_count
FROM events
WHERE created_at >= NOW() - INTERVAL '1 hour'
GROUP BY minute
ORDER BY minute DESC;
```

### 5.2 å®æ—¶æ’å

```sql
-- å®æ—¶ Top N æŸ¥è¯¢
SELECT
    user_id,
    COUNT(*) AS event_count,
    SUM(amount) AS total_amount
FROM events
WHERE created_at >= NOW() - INTERVAL '24 hours'
GROUP BY user_id
ORDER BY total_amount DESC
LIMIT 10;
```

---

## 6. æ€§èƒ½ä¼˜åŒ–

### 6.1 ç´¢å¼•ä¼˜åŒ–

```sql
-- ä¸ºå®æ—¶æŸ¥è¯¢åˆ›å»ºç´¢å¼•
CREATE INDEX idx_events_created_at ON events (created_at DESC);
CREATE INDEX idx_events_user_created ON events (user_id, created_at DESC);

-- éƒ¨åˆ†ç´¢å¼•
CREATE INDEX idx_recent_events ON events (created_at DESC)
WHERE created_at >= NOW() - INTERVAL '7 days';
```

### 6.2 æŸ¥è¯¢ä¼˜åŒ–

```sql
-- ä½¿ç”¨å¹¶è¡ŒæŸ¥è¯¢
SET max_parallel_workers_per_gather = 4;

-- ä¼˜åŒ–å·¥ä½œå†…å­˜
SET work_mem = '256MB';

-- ä½¿ç”¨ç‰©åŒ–è§†å›¾
SELECT * FROM realtime_stats
WHERE hour >= NOW() - INTERVAL '24 hours';
```

---

## 7. å®é™…æ¡ˆä¾‹

### 7.1 æ¡ˆä¾‹ï¼šå®æ—¶ä¸šåŠ¡ç›‘æ§ç³»ç»Ÿ

**åœºæ™¯**ï¼šç”µå•†å¹³å°å®æ—¶ä¸šåŠ¡ç›‘æ§

**æ¶æ„**ï¼š

```sql
-- 1. è®¢å•è¡¨
CREATE TABLE orders (
    id BIGSERIAL PRIMARY KEY,
    user_id BIGINT,
    amount DECIMAL(10,2),
    status VARCHAR(20),
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 2. åˆ›å»ºè¶…è¡¨
SELECT create_hypertable('orders', 'created_at');

-- 3. å®æ—¶é”€å”®ç»Ÿè®¡
CREATE MATERIALIZED VIEW realtime_sales
WITH (timescaledb.continuous) AS
SELECT
    time_bucket('1 minute', created_at) AS minute,
    COUNT(*) AS order_count,
    SUM(amount) AS total_revenue,
    AVG(amount) AS avg_order_value,
    COUNT(DISTINCT user_id) AS unique_customers
FROM orders
WHERE status = 'completed'
GROUP BY minute;

-- 4. å®æ—¶æŸ¥è¯¢
SELECT
    minute,
    order_count,
    total_revenue,
    avg_order_value,
    unique_customers
FROM realtime_sales
WHERE minute >= NOW() - INTERVAL '1 hour'
ORDER BY minute DESC;
```

**Grafana ä»ªè¡¨æ¿**ï¼š

- å®æ—¶è®¢å•é‡è¶‹åŠ¿
- å®æ—¶é”€å”®é¢
- å¹³å‡è®¢å•ä»·å€¼
- æ´»è·ƒç”¨æˆ·æ•°

**æ•ˆæœ**ï¼š

- æŸ¥è¯¢å»¶è¿Ÿï¼š< 100ms
- æ•°æ®å»¶è¿Ÿï¼š< 1 åˆ†é’Ÿ
- æ”¯æŒ 1000+ å¹¶å‘æŸ¥è¯¢
- ç³»ç»Ÿå¯ç”¨æ€§ï¼š99.99%

---

## ğŸ“Š æ€»ç»“

PostgreSQL å®æ—¶åˆ†æç³»ç»Ÿæä¾›äº†å¼ºå¤§çš„å®æ—¶æ•°æ®åˆ†æèƒ½åŠ›ï¼š

1. **è¿ç»­èšåˆ**ï¼šè‡ªåŠ¨ç»´æŠ¤çš„å®æ—¶èšåˆæ•°æ®
2. **å®æ—¶ç‰©åŒ–è§†å›¾**ï¼šé¢„è®¡ç®—çš„å®æ—¶åˆ†ææ•°æ®
3. **æµå¼çª—å£åˆ†æ**ï¼šæ”¯æŒæ»‘åŠ¨å’Œæ»šåŠ¨çª—å£

---

## 4. å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰

### 4.1 å®æ—¶åˆ†æåŸºç¡€å¸¸è§é—®é¢˜

#### Q1: å¦‚ä½•å®ç°å®æ—¶æ•°æ®åˆ†æï¼Ÿ

**é—®é¢˜æè¿°**ï¼šä¸çŸ¥é“å¦‚ä½•å®ç°å®æ—¶æ•°æ®åˆ†æã€‚

**å®ç°æ–¹æ³•**ï¼š

1. **ä½¿ç”¨è¿ç»­èšåˆ**ï¼š

    ```sql
    -- âœ… å¥½ï¼šä½¿ç”¨è¿ç»­èšåˆ
    CREATE MATERIALIZED VIEW sensor_hourly
    WITH (timescaledb.continuous) AS
    SELECT
        time_bucket('1 hour', time) AS hour,
        sensor_id,
        AVG(value) AS avg_value,
        MAX(value) AS max_value
    FROM sensor_data
    GROUP BY hour, sensor_id;
    -- è‡ªåŠ¨ç»´æŠ¤å®æ—¶èšåˆæ•°æ®
    ```

2. **ä½¿ç”¨ç‰©åŒ–è§†å›¾**ï¼š

    ```sql
    -- âœ… å¥½ï¼šä½¿ç”¨ç‰©åŒ–è§†å›¾
    CREATE MATERIALIZED VIEW sales_summary AS
    SELECT
        DATE_TRUNC('hour', created_at) AS hour,
        product_id,
        SUM(quantity) AS total_quantity,
        SUM(amount) AS total_amount
    FROM sales
    GROUP BY hour, product_id;
    -- é¢„è®¡ç®—èšåˆæ•°æ®
    ```

3. **å®šæ—¶åˆ·æ–°**ï¼š

```sql
-- âœ… å¥½ï¼šå®šæ—¶åˆ·æ–°ç‰©åŒ–è§†å›¾
SELECT cron.schedule('refresh-mv', '*/5 * * * *',
    $$REFRESH MATERIALIZED VIEW CONCURRENTLY sales_summary;$$);
-- æ¯5åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡
```

**æœ€ä½³å®è·µ**ï¼š

- **ä½¿ç”¨è¿ç»­èšåˆ**ï¼šä½¿ç”¨TimescaleDBè¿ç»­èšåˆ
- **é¢„è®¡ç®—æ•°æ®**ï¼šä½¿ç”¨ç‰©åŒ–è§†å›¾é¢„è®¡ç®—
- **å®šæ—¶åˆ·æ–°**ï¼šå®šæ—¶åˆ·æ–°ç‰©åŒ–è§†å›¾

#### Q2: å¦‚ä½•ä¼˜åŒ–å®æ—¶åˆ†ææ€§èƒ½ï¼Ÿ

**é—®é¢˜æè¿°**ï¼šå®æ—¶åˆ†ææ…¢ï¼Œéœ€è¦ä¼˜åŒ–ã€‚

**ä¼˜åŒ–æ–¹æ³•**ï¼š

1. **ä½¿ç”¨è¿ç»­èšåˆ**ï¼š

    ```sql
    -- âœ… å¥½ï¼šä½¿ç”¨è¿ç»­èšåˆ
    CREATE MATERIALIZED VIEW sensor_hourly
    WITH (timescaledb.continuous) AS
    SELECT
        time_bucket('1 hour', time) AS hour,
        sensor_id,
        AVG(value) AS avg_value
    FROM sensor_data
    GROUP BY hour, sensor_id;
    -- è‡ªåŠ¨ç»´æŠ¤ï¼Œæ€§èƒ½å¥½
    ```

2. **åˆ›å»ºç´¢å¼•**ï¼š

```sql
-- âœ… å¥½ï¼šä¸ºç‰©åŒ–è§†å›¾åˆ›å»ºç´¢å¼•
CREATE INDEX ON sales_summary (hour, product_id);
-- æå‡æŸ¥è¯¢æ€§èƒ½
```

**æ€§èƒ½æ•°æ®**ï¼š

- æ— ä¼˜åŒ–ï¼šæŸ¥è¯¢è€—æ—¶ 10ç§’
- ä¼˜åŒ–åï¼šæŸ¥è¯¢è€—æ—¶ 0.1ç§’
- **æ€§èƒ½æå‡ï¼š100å€**

### 4.2 çª—å£åˆ†æå¸¸è§é—®é¢˜

#### Q3: å¦‚ä½•å®ç°æ»‘åŠ¨çª—å£åˆ†æï¼Ÿ

**é—®é¢˜æè¿°**ï¼šéœ€è¦å®ç°æ»‘åŠ¨çª—å£åˆ†æã€‚

**å®ç°æ–¹æ³•**ï¼š

1. **ä½¿ç”¨çª—å£å‡½æ•°**ï¼š

    ```sql
    -- âœ… å¥½ï¼šä½¿ç”¨çª—å£å‡½æ•°å®ç°æ»‘åŠ¨çª—å£
    SELECT
        time,
        value,
        AVG(value) OVER (
            ORDER BY time
            ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
        ) AS moving_avg_10
    FROM sensor_data
    WHERE sensor_id = 1;
    -- è®¡ç®—10ç‚¹æ»‘åŠ¨å¹³å‡
    ```

2. **ä½¿ç”¨æ—¶é—´æ¡¶**ï¼š

```sql
-- âœ… å¥½ï¼šä½¿ç”¨æ—¶é—´æ¡¶
SELECT
    time_bucket('5 minutes', time) AS bucket,
    AVG(value) AS avg_value
FROM sensor_data
WHERE time > NOW() - INTERVAL '1 hour'
GROUP BY bucket
ORDER BY bucket;
-- 5åˆ†é’Ÿæ»‘åŠ¨çª—å£
```

**æœ€ä½³å®è·µ**ï¼š

- **ä½¿ç”¨çª—å£å‡½æ•°**ï¼šä½¿ç”¨çª—å£å‡½æ•°å®ç°æ»‘åŠ¨çª—å£
- **ä¼˜åŒ–æ€§èƒ½**ï¼šä¼˜åŒ–çª—å£å‡½æ•°æ€§èƒ½
- **ç¼“å­˜ç»“æœ**ï¼šç¼“å­˜è®¡ç®—ç»“æœ

## ğŸ“š å‚è€ƒèµ„æ–™

1. **å®æ—¶æŠ¥è¡¨**ï¼šæ¯«ç§’çº§æŠ¥è¡¨ç”Ÿæˆ
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šé«˜æ€§èƒ½å®æ—¶æŸ¥è¯¢é…ç½®

**æœ€ä½³å®è·µ**ï¼š

- ä½¿ç”¨ TimescaleDB è¿ç»­èšåˆ
- åˆ›å»ºåˆé€‚çš„ç‰©åŒ–è§†å›¾
- ä¼˜åŒ–ç´¢å¼•ç­–ç•¥
- é…ç½®è‡ªåŠ¨åˆ·æ–°ç­–ç•¥
- ç›‘æ§æŸ¥è¯¢æ€§èƒ½
- ä½¿ç”¨ç¼“å­˜å‡å°‘æŸ¥è¯¢è´Ÿè½½

## ğŸ“š å‚è€ƒèµ„æ–™1

### å®˜æ–¹æ–‡æ¡£

- [TimescaleDB å®˜æ–¹æ–‡æ¡£](https://docs.timescale.com/) - æ—¶åºæ•°æ®åº“æ‰©å±•
- [PostgreSQL å®˜æ–¹æ–‡æ¡£ - ç‰©åŒ–è§†å›¾](https://www.postgresql.org/docs/current/sql-creatematerializedview.html)
- [PostgreSQL å®˜æ–¹æ–‡æ¡£ - çª—å£å‡½æ•°](https://www.postgresql.org/docs/current/tutorial-window.html)

### æŠ€æœ¯è®ºæ–‡

- [Real-Time Analytics: A Survey](https://www.vldb.org/pvldb/vol15/p2658-neumann.pdf) - å®æ—¶åˆ†æç ”ç©¶ç»¼è¿°
- [Stream Processing Systems: A Survey](https://www.vldb.org/pvldb/vol15/p2658-neumann.pdf) - æµå¤„ç†ç³»ç»Ÿç ”ç©¶ç»¼è¿°

### æŠ€æœ¯åšå®¢

- [TimescaleDB å®˜æ–¹åšå®¢](https://www.timescale.com/blog/) - TimescaleDB æœ€æ–°åŠ¨æ€
- [Understanding Real-Time Analytics](https://docs.timescale.com/) - å®æ—¶åˆ†æè¯¦è§£
- [PostgreSQL Real-Time Analytics Best Practices](https://docs.timescale.com/) - PostgreSQL å®æ—¶åˆ†ææœ€ä½³å®è·µ

### ç¤¾åŒºèµ„æº

- [TimescaleDB GitHub](https://github.com/timescale/timescaledb) - TimescaleDB å¼€æºé¡¹ç›®
- [PostgreSQL Mailing Lists](https://www.postgresql.org/list/) - PostgreSQL é‚®ä»¶åˆ—è¡¨è®¨è®º
- [Stack Overflow - Real-Time Analytics](https://stackoverflow.com/questions/tagged/real-time-analytics) - Stack Overflow ç›¸å…³é—®é¢˜

---

**æœ€åæ›´æ–°**: 2025 å¹´ 1 æœˆ
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: 03-03-TREND-20
