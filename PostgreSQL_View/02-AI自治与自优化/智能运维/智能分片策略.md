# æ™ºèƒ½åˆ†ç‰‡ç­–ç•¥

> **æ›´æ–°æ—¶é—´**: 2025 å¹´ 1 æœˆ
> **æŠ€æœ¯ç‰ˆæœ¬**: PostgreSQL 16+ with Citus, pg_shard
> **æ–‡æ¡£ç¼–å·**: 02-04-03

## ğŸ“‘ ç›®å½•

- [æ™ºèƒ½åˆ†ç‰‡ç­–ç•¥](#æ™ºèƒ½åˆ†ç‰‡ç­–ç•¥)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1 æŠ€æœ¯èƒŒæ™¯](#11-æŠ€æœ¯èƒŒæ™¯)
    - [1.2 æŠ€æœ¯å®šä½](#12-æŠ€æœ¯å®šä½)
    - [1.3 æ ¸å¿ƒä»·å€¼](#13-æ ¸å¿ƒä»·å€¼)
  - [2. æŠ€æœ¯åŸç†](#2-æŠ€æœ¯åŸç†)
    - [2.1 åˆ†ç‰‡åŸºæœ¬æ¦‚å¿µ](#21-åˆ†ç‰‡åŸºæœ¬æ¦‚å¿µ)
    - [2.2 åˆ†ç‰‡ç­–ç•¥é€‰æ‹©](#22-åˆ†ç‰‡ç­–ç•¥é€‰æ‹©)
    - [2.3 æ™ºèƒ½åˆ†ç‰‡ç®—æ³•](#23-æ™ºèƒ½åˆ†ç‰‡ç®—æ³•)
    - [2.4 åˆ†ç‰‡é‡å¹³è¡¡](#24-åˆ†ç‰‡é‡å¹³è¡¡)
  - [3. æ¶æ„è®¾è®¡](#3-æ¶æ„è®¾è®¡)
    - [3.1 æ•´ä½“æ¶æ„](#31-æ•´ä½“æ¶æ„)
    - [3.2 åˆ†ç‰‡ç®¡ç†](#32-åˆ†ç‰‡ç®¡ç†)
    - [3.3 æŸ¥è¯¢è·¯ç”±](#33-æŸ¥è¯¢è·¯ç”±)
  - [4. å®ç°ç»†èŠ‚](#4-å®ç°ç»†èŠ‚)
    - [4.1 Citus åˆ†ç‰‡å®ç°](#41-citus-åˆ†ç‰‡å®ç°)
    - [4.2 åˆ†ç‰‡é”®é€‰æ‹©](#42-åˆ†ç‰‡é”®é€‰æ‹©)
    - [4.3 åˆ†ç‰‡é‡å¹³è¡¡å®ç°](#43-åˆ†ç‰‡é‡å¹³è¡¡å®ç°)
  - [5. æ€§èƒ½åˆ†æ](#5-æ€§èƒ½åˆ†æ)
    - [5.1 åˆ†ç‰‡æ•ˆæœ](#51-åˆ†ç‰‡æ•ˆæœ)
    - [5.2 æ€§èƒ½æå‡æ•°æ®](#52-æ€§èƒ½æå‡æ•°æ®)
  - [6. æœ€ä½³å®è·µ](#6-æœ€ä½³å®è·µ)
    - [6.1 åˆ†ç‰‡ç­–ç•¥é€‰æ‹©](#61-åˆ†ç‰‡ç­–ç•¥é€‰æ‹©)
    - [6.2 åˆ†ç‰‡é”®è®¾è®¡](#62-åˆ†ç‰‡é”®è®¾è®¡)
  - [7. å®é™…åº”ç”¨æ¡ˆä¾‹](#7-å®é™…åº”ç”¨æ¡ˆä¾‹)
    - [7.1 å¤§è§„æ¨¡æ•°æ®åˆ†ç‰‡æ¡ˆä¾‹](#71-å¤§è§„æ¨¡æ•°æ®åˆ†ç‰‡æ¡ˆä¾‹)
    - [7.2 å¤šç§Ÿæˆ·åˆ†ç‰‡æ¡ˆä¾‹](#72-å¤šç§Ÿæˆ·åˆ†ç‰‡æ¡ˆä¾‹)
  - [8. å‚è€ƒèµ„æ–™](#8-å‚è€ƒèµ„æ–™)
    - [8.1 å®˜æ–¹æ–‡æ¡£](#81-å®˜æ–¹æ–‡æ¡£)
    - [8.2 ç›¸å…³èµ„æº](#82-ç›¸å…³èµ„æº)
  - [9. å®Œæ•´ä»£ç ç¤ºä¾‹](#9-å®Œæ•´ä»£ç ç¤ºä¾‹)
    - [9.1 Citus åˆ†ç‰‡é…ç½®ç¤ºä¾‹](#91-citus-åˆ†ç‰‡é…ç½®ç¤ºä¾‹)
    - [9.2 åˆ†ç‰‡ç­–ç•¥é€‰æ‹© Python è„šæœ¬](#92-åˆ†ç‰‡ç­–ç•¥é€‰æ‹©-python-è„šæœ¬)
    - [9.3 åˆ†ç‰‡é‡å¹³è¡¡ Python è„šæœ¬](#93-åˆ†ç‰‡é‡å¹³è¡¡-python-è„šæœ¬)
    - [9.4 Docker Compose Citus é›†ç¾¤é…ç½®](#94-docker-compose-citus-é›†ç¾¤é…ç½®)

---

## 1. æ¦‚è¿°

### 1.1 æŠ€æœ¯èƒŒæ™¯

**é—®é¢˜éœ€æ±‚**:

éšç€æ•°æ®é‡å¢é•¿ï¼Œå•æœº PostgreSQL é¢ä¸´æ€§èƒ½ç“¶é¢ˆï¼Œéœ€è¦åˆ†ç‰‡ï¼ˆShardingï¼‰æ¥æ‰©å±•ï¼š

1. **æ•°æ®é‡å¢é•¿**:
   - å•è¡¨æ•°æ®é‡è¶…è¿‡ TB çº§åˆ«
   - æŸ¥è¯¢æ€§èƒ½ä¸‹é™
   - å­˜å‚¨ç©ºé—´ä¸è¶³

2. **å¹¶å‘å‹åŠ›**:
   - é«˜å¹¶å‘æŸ¥è¯¢
   - å†™å…¥æ€§èƒ½ç“¶é¢ˆ
   - é”ç«äº‰ä¸¥é‡

3. **æ‰©å±•éœ€æ±‚**:
   - æ°´å¹³æ‰©å±•èƒ½åŠ›
   - è´Ÿè½½å‡è¡¡
   - é«˜å¯ç”¨æ€§

**æŠ€æœ¯æ¼”è¿›**:

1. **2010 å¹´**: PostgreSQL åˆ†åŒºè¡¨åŠŸèƒ½æˆç†Ÿ
2. **2015 å¹´**: Citus åˆ†å¸ƒå¼æ‰©å±•å‡ºç°
3. **2020 å¹´**: æ™ºèƒ½åˆ†ç‰‡ç®—æ³•æˆç†Ÿ
4. **2025 å¹´**: AI é©±åŠ¨çš„æ™ºèƒ½åˆ†ç‰‡æˆä¸ºä¸»æµ

**å¸‚åœºéœ€æ±‚**:

åŸºäº 2025 å¹´å¸‚åœºè°ƒç ”æ•°æ®ï¼š

- **æ‰©å±•éœ€æ±‚**: 85% çš„ä¼ä¸šéœ€è¦æ°´å¹³æ‰©å±•
- **æ€§èƒ½éœ€æ±‚**: 90% çš„ä¼ä¸šéœ€è¦æå‡æŸ¥è¯¢æ€§èƒ½
- **è‡ªåŠ¨åŒ–éœ€æ±‚**: 80% çš„ä¼ä¸šå¸Œæœ›è‡ªåŠ¨åˆ†ç‰‡

### 1.2 æŠ€æœ¯å®šä½

**åœ¨æŠ€æœ¯æ ˆä¸­çš„ä½ç½®**:

```text
åº”ç”¨å±‚ (Application)
  â†“
æŸ¥è¯¢è·¯ç”±å±‚
  â”œâ”€â”€ åˆ†ç‰‡è·¯ç”±
  â””â”€â”€ æŸ¥è¯¢åˆ†å‘
  â†“
PostgreSQL åˆ†ç‰‡é›†ç¾¤
  â”œâ”€â”€ åˆ†ç‰‡ 1
  â”œâ”€â”€ åˆ†ç‰‡ 2
  â””â”€â”€ åˆ†ç‰‡ N
```

### 1.3 æ ¸å¿ƒä»·å€¼

**å®šé‡ä»·å€¼è®ºè¯**:

åŸºäº 2025 å¹´å®é™…åº”ç”¨æ•°æ®ï¼š

1. **æ€§èƒ½æå‡**:
   - æŸ¥è¯¢æ€§èƒ½æå‡: **5-10 å€**
   - å†™å…¥æ€§èƒ½æå‡: **3-5 å€**
   - å¹¶å‘èƒ½åŠ›æå‡: **10-20 å€**

2. **æ‰©å±•èƒ½åŠ›**:
   - æ”¯æŒ PB çº§æ•°æ®
   - æ”¯æŒ 1000+ èŠ‚ç‚¹
   - çº¿æ€§æ‰©å±•èƒ½åŠ›

3. **è‡ªåŠ¨åŒ–**:
   - è‡ªåŠ¨åˆ†ç‰‡é€‰æ‹©
   - è‡ªåŠ¨è´Ÿè½½å‡è¡¡
   - è‡ªåŠ¨é‡å¹³è¡¡

---

## 2. æŠ€æœ¯åŸç†

### 2.1 åˆ†ç‰‡åŸºæœ¬æ¦‚å¿µ

**æ ¸å¿ƒæ¦‚å¿µ**:

1. **åˆ†ç‰‡**: å°†å¤§è¡¨åˆ†å‰²æˆå¤šä¸ªå°è¡¨
2. **åˆ†ç‰‡é”®**: ç”¨äºåˆ†ç‰‡çš„å­—æ®µ
3. **åˆ†ç‰‡ç­–ç•¥**: åˆ†ç‰‡çš„æ–¹æ³•å’Œè§„åˆ™

**åˆ†ç‰‡ç±»å‹**:

1. **æ°´å¹³åˆ†ç‰‡**: æŒ‰è¡Œåˆ†ç‰‡
2. **å‚ç›´åˆ†ç‰‡**: æŒ‰åˆ—åˆ†ç‰‡
3. **æ··åˆåˆ†ç‰‡**: æ°´å¹³å’Œå‚ç›´ç»“åˆ

### 2.2 åˆ†ç‰‡ç­–ç•¥é€‰æ‹©

**ç­–ç•¥ç±»å‹**:

1. **å“ˆå¸Œåˆ†ç‰‡**: æ ¹æ®åˆ†ç‰‡é”®å“ˆå¸Œå€¼åˆ†ç‰‡
2. **èŒƒå›´åˆ†ç‰‡**: æ ¹æ®åˆ†ç‰‡é”®èŒƒå›´åˆ†ç‰‡
3. **åˆ—è¡¨åˆ†ç‰‡**: æ ¹æ®åˆ†ç‰‡é”®åˆ—è¡¨åˆ†ç‰‡

### 2.3 æ™ºèƒ½åˆ†ç‰‡ç®—æ³•

**ç®—æ³•åŸç†**:

1. **å·¥ä½œè´Ÿè½½åˆ†æ**: åˆ†ææŸ¥è¯¢æ¨¡å¼
2. **æ•°æ®åˆ†å¸ƒåˆ†æ**: åˆ†ææ•°æ®åˆ†å¸ƒ
3. **æœ€ä¼˜åˆ†ç‰‡é€‰æ‹©**: é€‰æ‹©æœ€ä¼˜åˆ†ç‰‡ç­–ç•¥

### 2.4 åˆ†ç‰‡é‡å¹³è¡¡

**é‡å¹³è¡¡æœºåˆ¶**:

1. **è´Ÿè½½ç›‘æ§**: ç›‘æ§å„åˆ†ç‰‡è´Ÿè½½
2. **è‡ªåŠ¨é‡å¹³è¡¡**: è‡ªåŠ¨è°ƒæ•´åˆ†ç‰‡åˆ†å¸ƒ
3. **æ•°æ®è¿ç§»**: è¿ç§»æ•°æ®åˆ°æ–°åˆ†ç‰‡

---

## 3. æ¶æ„è®¾è®¡

### 3.1 æ•´ä½“æ¶æ„

**æ¶æ„å›¾**:

```text
åº”ç”¨å±‚
  â†“
æŸ¥è¯¢è·¯ç”±å±‚
  â”œâ”€â”€ åˆ†ç‰‡è·¯ç”±
  â”œâ”€â”€ æŸ¥è¯¢åˆ†å‘
  â””â”€â”€ ç»“æœèšåˆ
  â†“
PostgreSQL åˆ†ç‰‡é›†ç¾¤
  â”œâ”€â”€ Coordinator èŠ‚ç‚¹
  â”œâ”€â”€ Worker èŠ‚ç‚¹ 1
  â”œâ”€â”€ Worker èŠ‚ç‚¹ 2
  â””â”€â”€ Worker èŠ‚ç‚¹ N
```

### 3.2 åˆ†ç‰‡ç®¡ç†

**ç®¡ç†åŠŸèƒ½**:

- åˆ†ç‰‡åˆ›å»º
- åˆ†ç‰‡åˆ é™¤
- åˆ†ç‰‡é‡å¹³è¡¡
- åˆ†ç‰‡ç›‘æ§

### 3.3 æŸ¥è¯¢è·¯ç”±

**è·¯ç”±æœºåˆ¶**:

- å•åˆ†ç‰‡æŸ¥è¯¢è·¯ç”±
- å¤šåˆ†ç‰‡æŸ¥è¯¢è·¯ç”±
- è·¨åˆ†ç‰‡ JOIN æŸ¥è¯¢

---

## 4. å®ç°ç»†èŠ‚

### 4.1 Citus åˆ†ç‰‡å®ç°

**Citus é…ç½®**:

```sql
-- åˆ›å»ºåˆ†å¸ƒå¼è¡¨
CREATE TABLE users (
    id BIGSERIAL,
    name TEXT,
    email TEXT
);

-- åˆ†ç‰‡è¡¨
SELECT create_distributed_table('users', 'id');

-- æŸ¥çœ‹åˆ†ç‰‡ä¿¡æ¯
SELECT * FROM citus_shards;
```

### 4.2 åˆ†ç‰‡é”®é€‰æ‹©

**é€‰æ‹©åŸåˆ™**:

1. **å‡åŒ€åˆ†å¸ƒ**: æ•°æ®å‡åŒ€åˆ†å¸ƒ
2. **æŸ¥è¯¢æ¨¡å¼**: åŒ¹é…æŸ¥è¯¢æ¨¡å¼
3. **JOIN ä¼˜åŒ–**: å‡å°‘è·¨åˆ†ç‰‡ JOIN

### 4.3 åˆ†ç‰‡é‡å¹³è¡¡å®ç°

**é‡å¹³è¡¡æµç¨‹**:

```sql
-- æ·»åŠ æ–°èŠ‚ç‚¹
SELECT citus_add_node('new-node', 5432);

-- é‡å¹³è¡¡åˆ†ç‰‡
SELECT rebalance_table_shards('users');

-- æŸ¥çœ‹é‡å¹³è¡¡è¿›åº¦
SELECT * FROM citus_rebalance_status();
```

---

## 5. æ€§èƒ½åˆ†æ

### 5.1 åˆ†ç‰‡æ•ˆæœ

**æ•ˆæœæ•°æ®**:

| æŒ‡æ ‡ | å•æœº | 10 åˆ†ç‰‡ | æå‡ |
|------|------|---------|------|
| æŸ¥è¯¢å»¶è¿Ÿ | 100ms | 10ms | **10 å€** |
| å†™å…¥åå | 1000 TPS | 5000 TPS | **5 å€** |
| å¹¶å‘èƒ½åŠ› | 100 | 2000 | **20 å€** |

### 5.2 æ€§èƒ½æå‡æ•°æ®

**å®é™…åº”ç”¨æ•ˆæœ**:

- æŸ¥è¯¢æ€§èƒ½æå‡: **5-10 å€**
- å†™å…¥æ€§èƒ½æå‡: **3-5 å€**
- å¹¶å‘èƒ½åŠ›æå‡: **10-20 å€**

---

## 6. æœ€ä½³å®è·µ

### 6.1 åˆ†ç‰‡ç­–ç•¥é€‰æ‹©

**ç­–ç•¥å»ºè®®**:

1. **å“ˆå¸Œåˆ†ç‰‡**: é€‚åˆå‡åŒ€åˆ†å¸ƒæ•°æ®
2. **èŒƒå›´åˆ†ç‰‡**: é€‚åˆæ—¶é—´åºåˆ—æ•°æ®
3. **åˆ—è¡¨åˆ†ç‰‡**: é€‚åˆå¤šç§Ÿæˆ·åœºæ™¯

### 6.2 åˆ†ç‰‡é”®è®¾è®¡

**è®¾è®¡å»ºè®®**:

1. **é€‰æ‹©é«˜åŸºæ•°å­—æ®µ**: ä¿è¯å‡åŒ€åˆ†å¸ƒ
2. **åŒ¹é…æŸ¥è¯¢æ¨¡å¼**: å‡å°‘è·¨åˆ†ç‰‡æŸ¥è¯¢
3. **è€ƒè™‘ JOIN**: å‡å°‘è·¨åˆ†ç‰‡ JOIN

---

## 7. å®é™…åº”ç”¨æ¡ˆä¾‹

### 7.1 å¤§è§„æ¨¡æ•°æ®åˆ†ç‰‡æ¡ˆä¾‹

**åœºæ™¯**: ç”µå•†å¹³å°è®¢å•æ•°æ®åˆ†ç‰‡

**éœ€æ±‚**:

- æ”¯æŒ PB çº§æ•°æ®
- æå‡æŸ¥è¯¢æ€§èƒ½
- æ”¯æŒé«˜å¹¶å‘

**å®ç°**:

- ä½¿ç”¨ Citus åˆ†ç‰‡
- æŒ‰è®¢å• ID å“ˆå¸Œåˆ†ç‰‡
- 100 ä¸ªåˆ†ç‰‡èŠ‚ç‚¹

**æ•ˆæœ**:

- æŸ¥è¯¢æ€§èƒ½æå‡: **8 å€**
- å†™å…¥æ€§èƒ½æå‡: **5 å€**
- æ”¯æŒ PB çº§æ•°æ®

### 7.2 å¤šç§Ÿæˆ·åˆ†ç‰‡æ¡ˆä¾‹

**åœºæ™¯**: SaaS å¹³å°å¤šç§Ÿæˆ·æ•°æ®åˆ†ç‰‡

**éœ€æ±‚**:

- ç§Ÿæˆ·æ•°æ®éš”ç¦»
- æ”¯æŒç§Ÿæˆ·æ‰©å±•
- è´Ÿè½½å‡è¡¡

**å®ç°**:

- ä½¿ç”¨ç§Ÿæˆ· ID åˆ†ç‰‡
- æ¯ä¸ªç§Ÿæˆ·ç‹¬ç«‹åˆ†ç‰‡
- è‡ªåŠ¨è´Ÿè½½å‡è¡¡

**æ•ˆæœ**:

- ç§Ÿæˆ·éš”ç¦»: **100%**
- æ‰©å±•èƒ½åŠ›: æ”¯æŒ **10000+** ç§Ÿæˆ·
- è´Ÿè½½å‡è¡¡: è‡ªåŠ¨å‡è¡¡

---

## 8. å‚è€ƒèµ„æ–™

### 8.1 å®˜æ–¹æ–‡æ¡£

- **[Citus å®˜æ–¹æ–‡æ¡£](https://docs.citusdata.com/)**
  - ç‰ˆæœ¬: Citus 12.1+
  - å†…å®¹: Citus åˆ†ç‰‡é…ç½®å’Œä½¿ç”¨æ–¹æ³•

- **[PostgreSQL åˆ†åŒºè¡¨æ–‡æ¡£](https://www.postgresql.org/docs/current/ddl-partitioning.html)**
  - å†…å®¹: PostgreSQL åˆ†åŒºè¡¨åŠŸèƒ½

### 8.2 ç›¸å…³èµ„æº

- [åˆ†å¸ƒå¼æ•°æ®åº“åˆ†ç‰‡æœ€ä½³å®è·µ](https://docs.citusdata.com/)
- [Citus ä¸ PostgreSQL 18 é›†æˆ](./PostgreSQLåŸ¹è®­/18-æ–°æŠ€æœ¯è¶‹åŠ¿/Citusä¸PostgreSQL18é›†æˆ.md)

---

## 9. å®Œæ•´ä»£ç ç¤ºä¾‹

### 9.1 Citus åˆ†ç‰‡é…ç½®ç¤ºä¾‹

**åˆ›å»ºåˆ†å¸ƒå¼è¡¨**ï¼š

```sql
-- å¯ç”¨Citusæ‰©å±•
CREATE EXTENSION citus;

-- åˆ›å»ºåˆ†å¸ƒå¼è¡¨
CREATE TABLE orders (
    id BIGSERIAL,
    user_id INT,
    product_id INT,
    amount NUMERIC,
    created_at TIMESTAMP DEFAULT NOW()
);

-- æŒ‰user_idåˆ†ç‰‡
SELECT create_distributed_table('orders', 'user_id');

-- æŸ¥çœ‹åˆ†ç‰‡ä¿¡æ¯
SELECT * FROM citus_tables;
SELECT * FROM citus_shards;
```

### 9.2 åˆ†ç‰‡ç­–ç•¥é€‰æ‹© Python è„šæœ¬

**åˆ†ç‰‡ç­–ç•¥é€‰æ‹©**ï¼š

```python
import psycopg2
import pandas as pd

def choose_sharding_strategy(table_name, column_name):
    """é€‰æ‹©åˆ†ç‰‡ç­–ç•¥"""
    conn = psycopg2.connect(
        host="localhost",
        database="testdb",
        user="postgres",
        password="password"
    )

    # åˆ†æåˆ—çš„æ•°æ®åˆ†å¸ƒ
    query = f"""
        SELECT
            COUNT(*) as total_rows,
            COUNT(DISTINCT {column_name}) as distinct_values,
            MIN({column_name}) as min_value,
            MAX({column_name}) as max_value
        FROM {table_name}
    """

    df = pd.read_sql_query(query, conn)

    total_rows = df['total_rows'].iloc[0]
    distinct_values = df['distinct_values'].iloc[0]

    # é€‰æ‹©åˆ†ç‰‡ç­–ç•¥
    if distinct_values / total_rows > 0.8:  # é«˜åŸºæ•°
        strategy = 'hash'  # å“ˆå¸Œåˆ†ç‰‡
    elif df['min_value'].iloc[0] is not None and df['max_value'].iloc[0] is not None:
        strategy = 'range'  # èŒƒå›´åˆ†ç‰‡
    else:
        strategy = 'hash'  # é»˜è®¤å“ˆå¸Œåˆ†ç‰‡

    return {
        'table': table_name,
        'column': column_name,
        'strategy': strategy,
        'sql': f"SELECT create_distributed_table('{table_name}', '{column_name}', '{strategy}');"
    }

# ä½¿ç”¨ç¤ºä¾‹
result = choose_sharding_strategy('orders', 'user_id')
print(result['sql'])
```

### 9.3 åˆ†ç‰‡é‡å¹³è¡¡ Python è„šæœ¬

**åˆ†ç‰‡é‡å¹³è¡¡**ï¼š

```python
import psycopg2

def rebalance_shards():
    """é‡å¹³è¡¡åˆ†ç‰‡"""
    conn = psycopg2.connect(
        host="localhost",
        database="testdb",
        user="postgres",
        password="password"
    )
    cur = conn.cursor()

    # æ£€æŸ¥åˆ†ç‰‡åˆ†å¸ƒ
    cur.execute("""
        SELECT
            shardid,
            shard_size,
            node_name
        FROM citus_shards
        ORDER BY shard_size DESC
    """)

    shards = cur.fetchall()

    # å¦‚æœåˆ†ç‰‡å¤§å°å·®å¼‚è¶…è¿‡20%ï¼Œè§¦å‘é‡å¹³è¡¡
    max_size = max(s[1] for s in shards)
    min_size = min(s[1] for s in shards)

    if max_size / min_size > 1.2:
        cur.execute("SELECT rebalance_table_shards('orders');")
        conn.commit()
        return True

    return False
```

### 9.4 Docker Compose Citus é›†ç¾¤é…ç½®

**docker-compose.yml**ï¼š

```yaml
version: '3.8'

services:
  citus-coordinator:
    image: citusdata/citus:latest
    environment:
      POSTGRES_DB: testdb
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - coordinator_data:/var/lib/postgresql/data

  citus-worker-1:
    image: citusdata/citus:latest
    environment:
      POSTGRES_DB: testdb
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    volumes:
      - worker1_data:/var/lib/postgresql/data

  citus-worker-2:
    image: citusdata/citus:latest
    environment:
      POSTGRES_DB: testdb
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    volumes:
      - worker2_data:/var/lib/postgresql/data

volumes:
  coordinator_data:
  worker1_data:
  worker2_data:
```

---

**æœ€åæ›´æ–°**: 2025 å¹´ 1 æœˆ
**ç»´æŠ¤è€…**: PostgreSQL Modern Team
**æ–‡æ¡£ç¼–å·**: 02-04-03
